Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 240495
Set the seed as :  1
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
-----------------------Sliding file are generated -----------------------
================ LOCV Mode ====================
================ 10 CV ======================
================ the 0 th CV Experiment ================ 
Leave one Out Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.0001465  0.000181   0.00097182 0.00123001 0.0004852  0.00060716]
Train data number :  17901
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1989
Test data number :  9947
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.389167547225952
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.0492157  Vali Loss: 0.6225628 Vali Accuracy: 0.7652086  Vali weighted F1: 0.7318783  Vali macro F1 0.5302934 
Validation loss decreased (inf --> 0.622563).  Saving model ...
Epoch: 2 cost time: 6.359959363937378
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.5280439  Vali Loss: 0.5312510 Vali Accuracy: 0.8154852  Vali weighted F1: 0.8142123  Vali macro F1 0.7921410 
new best score!!!!
Validation loss decreased (0.622563 --> 0.531251).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.339674472808838
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.3651432  Vali Loss: 0.2878615 Vali Accuracy: 0.8969331  Vali weighted F1: 0.8957095  Vali macro F1 0.8655604 
new best score!!!!
Validation loss decreased (0.531251 --> 0.287861).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.374525547027588
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.2616880  Vali Loss: 0.2200435 Vali Accuracy: 0.9270990  Vali weighted F1: 0.9270502  Vali macro F1 0.9019923 
new best score!!!!
Validation loss decreased (0.287861 --> 0.220044).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.338100433349609
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.2114354  Vali Loss: 0.1953318 Vali Accuracy: 0.9301156  Vali weighted F1: 0.9311987  Vali macro F1 0.9131511 
new best score!!!!
Validation loss decreased (0.220044 --> 0.195332).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.3670220375061035
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.1730748  Vali Loss: 0.1739623 Vali Accuracy: 0.9376571  Vali weighted F1: 0.9368642  Vali macro F1 0.9177205 
new best score!!!!
Validation loss decreased (0.195332 --> 0.173962).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.319539546966553
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.1533725  Vali Loss: 0.1613562 Vali Accuracy: 0.9451986  Vali weighted F1: 0.9448027  Vali macro F1 0.9314199 
new best score!!!!
Validation loss decreased (0.173962 --> 0.161356).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.364879846572876
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1423818  Vali Loss: 0.1492001 Vali Accuracy: 0.9527401  Vali weighted F1: 0.9539209  Vali macro F1 0.9432330 
new best score!!!!
Validation loss decreased (0.161356 --> 0.149200).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.300398349761963
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1268336  Vali Loss: 0.1111103 Vali Accuracy: 0.9587733  Vali weighted F1: 0.9590672  Vali macro F1 0.9494401 
new best score!!!!
Validation loss decreased (0.149200 --> 0.111110).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.331451654434204
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1144734  Vali Loss: 0.1093842 Vali Accuracy: 0.9627954  Vali weighted F1: 0.9630516  Vali macro F1 0.9558635 
new best score!!!!
Validation loss decreased (0.111110 --> 0.109384).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.30037522315979
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1013714  Vali Loss: 0.0958011 Vali Accuracy: 0.9683258  Vali weighted F1: 0.9687240  Vali macro F1 0.9608024 
new best score!!!!
Validation loss decreased (0.109384 --> 0.095801).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.314096212387085
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.1005240  Vali Loss: 0.0848525 Vali Accuracy: 0.9708396  Vali weighted F1: 0.9707696  Vali macro F1 0.9624930 
new best score!!!!
Validation loss decreased (0.095801 --> 0.084852).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.322461843490601
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0868946  Vali Loss: 0.0819618 Vali Accuracy: 0.9718451  Vali weighted F1: 0.9719553  Vali macro F1 0.9641539 
new best score!!!!
Validation loss decreased (0.084852 --> 0.081962).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.309283018112183
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0777022  Vali Loss: 0.0690294 Vali Accuracy: 0.9728507  Vali weighted F1: 0.9727924  Vali macro F1 0.9667655 
new best score!!!!
Validation loss decreased (0.081962 --> 0.069029).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.3006744384765625
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0824299  Vali Loss: 0.0713613 Vali Accuracy: 0.9758673  Vali weighted F1: 0.9758804  Vali macro F1 0.9699924 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.289657354354858
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0679698  Vali Loss: 0.0619731 Vali Accuracy: 0.9783811  Vali weighted F1: 0.9784506  Vali macro F1 0.9739641 
new best score!!!!
Validation loss decreased (0.069029 --> 0.061973).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.331572532653809
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0632209  Vali Loss: 0.0715157 Vali Accuracy: 0.9748617  Vali weighted F1: 0.9750591  Vali macro F1 0.9649384 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 6.319003343582153
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0622640  Vali Loss: 0.0686388 Vali Accuracy: 0.9768728  Vali weighted F1: 0.9770956  Vali macro F1 0.9691762 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 6.321753263473511
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0562174  Vali Loss: 0.0654303 Vali Accuracy: 0.9778783  Vali weighted F1: 0.9777580  Vali macro F1 0.9738146 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 20 cost time: 6.330270051956177
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0589945  Vali Loss: 0.0540187 Vali Accuracy: 0.9798894  Vali weighted F1: 0.9798864  Vali macro F1 0.9745229 
new best score!!!!
Validation loss decreased (0.061973 --> 0.054019).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.310740947723389
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0452534  Vali Loss: 0.0543631 Vali Accuracy: 0.9824032  Vali weighted F1: 0.9824768  Vali macro F1 0.9775240 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 6.315459966659546
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0479441  Vali Loss: 0.0499100 Vali Accuracy: 0.9808949  Vali weighted F1: 0.9810128  Vali macro F1 0.9745464 
new best score!!!!
Validation loss decreased (0.054019 --> 0.049910).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.307993412017822
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0491197  Vali Loss: 0.0597491 Vali Accuracy: 0.9803922  Vali weighted F1: 0.9805136  Vali macro F1 0.9730448 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 6.311528205871582
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0392531  Vali Loss: 0.0462470 Vali Accuracy: 0.9834087  Vali weighted F1: 0.9833400  Vali macro F1 0.9767216 
new best score!!!!
Validation loss decreased (0.049910 --> 0.046247).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.306438446044922
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0419239  Vali Loss: 0.0474033 Vali Accuracy: 0.9834087  Vali weighted F1: 0.9833735  Vali macro F1 0.9782240 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 6.315000534057617
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0328807  Vali Loss: 0.0538709 Vali Accuracy: 0.9803922  Vali weighted F1: 0.9803332  Vali macro F1 0.9743186 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 6.325250864028931
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0345650  Vali Loss: 0.0511394 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9817636  Vali macro F1 0.9775021 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 28 cost time: 6.295240640640259
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0298955  Vali Loss: 0.0453598 Vali Accuracy: 0.9839115  Vali weighted F1: 0.9839602  Vali macro F1 0.9780350 
new best score!!!!
Validation loss decreased (0.046247 --> 0.045360).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.292708873748779
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0284545  Vali Loss: 0.0398394 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9849754  Vali macro F1 0.9795872 
new best score!!!!
Validation loss decreased (0.045360 --> 0.039839).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.287405252456665
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0299183  Vali Loss: 0.0545192 Vali Accuracy: 0.9808949  Vali weighted F1: 0.9806758  Vali macro F1 0.9753885 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 6.286261081695557
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0333648  Vali Loss: 0.0454412 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9859437  Vali macro F1 0.9815218 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 6.2982964515686035
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0255211  Vali Loss: 0.0562041 Vali Accuracy: 0.9813977  Vali weighted F1: 0.9814128  Vali macro F1 0.9747774 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 6.304183721542358
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0318798  Vali Loss: 0.0437739 Vali Accuracy: 0.9864253  Vali weighted F1: 0.9863760  Vali macro F1 0.9810580 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 34 cost time: 6.3116395473480225
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0227710  Vali Loss: 0.0707024 Vali Accuracy: 0.9773756  Vali weighted F1: 0.9771575  Vali macro F1 0.9714148 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 35 cost time: 6.291887044906616
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0177493  Vali Loss: 0.0387210 Vali Accuracy: 0.9864253  Vali weighted F1: 0.9864506  Vali macro F1 0.9810846 
new best score!!!!
Validation loss decreased (0.039839 --> 0.038721).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.289390325546265
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0124107  Vali Loss: 0.0374472 Vali Accuracy: 0.9864253  Vali weighted F1: 0.9864462  Vali macro F1 0.9810862 
new best score!!!!
Validation loss decreased (0.038721 --> 0.037447).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.292845249176025
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0117589  Vali Loss: 0.0357792 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874517  Vali macro F1 0.9826960 
new best score!!!!
Validation loss decreased (0.037447 --> 0.035779).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 6.2939698696136475
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0117292  Vali Loss: 0.0341158 Vali Accuracy: 0.9879336  Vali weighted F1: 0.9879538  Vali macro F1 0.9829397 
new best score!!!!
Validation loss decreased (0.035779 --> 0.034116).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 6.3006041049957275
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0118051  Vali Loss: 0.0346663 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869560  Vali macro F1 0.9811079 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 6.318328380584717
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0115214  Vali Loss: 0.0330775 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874534  Vali macro F1 0.9821346 
new best score!!!!
Validation loss decreased (0.034116 --> 0.033078).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 6.301854372024536
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0109247  Vali Loss: 0.0336544 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874659  Vali macro F1 0.9819408 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 6.291893482208252
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0103386  Vali Loss: 0.0342540 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874679  Vali macro F1 0.9808701 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 6.288959741592407
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0090603  Vali Loss: 0.0334590 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874814  Vali macro F1 0.9819405 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 6.291779518127441
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0110026  Vali Loss: 0.0292839 Vali Accuracy: 0.9899447  Vali weighted F1: 0.9899787  Vali macro F1 0.9853756 
new best score!!!!
Validation loss decreased (0.033078 --> 0.029284).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 6.296504259109497
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0092202  Vali Loss: 0.0313183 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874358  Vali macro F1 0.9809447 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 6.30243992805481
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0090021  Vali Loss: 0.0298234 Vali Accuracy: 0.9889392  Vali weighted F1: 0.9889668  Vali macro F1 0.9839908 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 6.315437316894531
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0088447  Vali Loss: 0.0303406 Vali Accuracy: 0.9889392  Vali weighted F1: 0.9889831  Vali macro F1 0.9843608 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 6.291193008422852
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0100400  Vali Loss: 0.0315087 Vali Accuracy: 0.9884364  Vali weighted F1: 0.9884831  Vali macro F1 0.9835554 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 6.286681652069092
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0091880  Vali Loss: 0.0349744 Vali Accuracy: 0.9879336  Vali weighted F1: 0.9879806  Vali macro F1 0.9833115 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 50 cost time: 6.285650730133057
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0086063  Vali Loss: 0.0328719 Vali Accuracy: 0.9894419  Vali weighted F1: 0.9894735  Vali macro F1 0.9848275 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 6.293792486190796
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0086752  Vali Loss: 0.0314996 Vali Accuracy: 0.9894419  Vali weighted F1: 0.9894735  Vali macro F1 0.9848275 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 6.28887939453125
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0078306  Vali Loss: 0.0306055 Vali Accuracy: 0.9899447  Vali weighted F1: 0.9899643  Vali macro F1 0.9852666 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 53 cost time: 6.313977241516113
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0088103  Vali Loss: 0.0309024 Vali Accuracy: 0.9894419  Vali weighted F1: 0.9894623  Vali macro F1 0.9844584 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 54 cost time: 6.303864002227783
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0088502  Vali Loss: 0.0309483 Vali Accuracy: 0.9884364  Vali weighted F1: 0.9884831  Vali macro F1 0.9835554 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 55 cost time: 6.294907093048096
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0088089  Vali Loss: 0.0309256 Vali Accuracy: 0.9889392  Vali weighted F1: 0.9889719  Vali macro F1 0.9839917 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 6.297166347503662
VALI: Epoch: 56, Steps: 70 | Train Loss: 0.0081958  Vali Loss: 0.0309236 Vali Accuracy: 0.9884364  Vali weighted F1: 0.9884831  Vali macro F1 0.9835554 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 57 cost time: 6.29749608039856
VALI: Epoch: 57, Steps: 70 | Train Loss: 0.0081765  Vali Loss: 0.0309948 Vali Accuracy: 0.9884364  Vali weighted F1: 0.9884831  Vali macro F1 0.9835554 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 58 cost time: 6.2906084060668945
VALI: Epoch: 58, Steps: 70 | Train Loss: 0.0078404  Vali Loss: 0.0309303 Vali Accuracy: 0.9884364  Vali weighted F1: 0.9884831  Vali macro F1 0.9835554 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 59 cost time: 6.29078221321106
VALI: Epoch: 59, Steps: 70 | Train Loss: 0.0090750  Vali Loss: 0.0308685 Vali Accuracy: 0.9889392  Vali weighted F1: 0.9889719  Vali macro F1 0.9839917 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8428672  Test weighted F1: 0.8523242  Test macro F1 0.8094816 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 240495
pruned model Parameter : 244174
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.347005844116211
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0098539  Vali Loss: 0.0304730 Vali Accuracy: 0.9884364  Vali weighted F1: 0.9884445  Vali macro F1 0.9839417 
Validation loss decreased (inf --> 0.030473).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.307378768920898
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0100494  Vali Loss: 0.0320490 Vali Accuracy: 0.9894419  Vali weighted F1: 0.9894317  Vali macro F1 0.9856766 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.323452472686768
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0099654  Vali Loss: 0.0306013 Vali Accuracy: 0.9894419  Vali weighted F1: 0.9894827  Vali macro F1 0.9851649 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.3251214027404785
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0085842  Vali Loss: 0.0345494 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869340  Vali macro F1 0.9804733 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.319995641708374
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0083231  Vali Loss: 0.0310816 Vali Accuracy: 0.9879336  Vali weighted F1: 0.9879501  Vali macro F1 0.9831153 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.324671506881714
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0089117  Vali Loss: 0.0342987 Vali Accuracy: 0.9889392  Vali weighted F1: 0.9889504  Vali macro F1 0.9831973 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.3417723178863525
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0082032  Vali Loss: 0.0339312 Vali Accuracy: 0.9884364  Vali weighted F1: 0.9884276  Vali macro F1 0.9819707 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.313153982162476
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0087925  Vali Loss: 0.0356458 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874316  Vali macro F1 0.9807477 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.336255073547363
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0089637  Vali Loss: 0.0349955 Vali Accuracy: 0.9894419  Vali weighted F1: 0.9894296  Vali macro F1 0.9839044 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.325493335723877
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0079149  Vali Loss: 0.0309183 Vali Accuracy: 0.9894419  Vali weighted F1: 0.9894301  Vali macro F1 0.9847908 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 11 cost time: 6.328249931335449
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0067456  Vali Loss: 0.0296516 Vali Accuracy: 0.9899447  Vali weighted F1: 0.9899385  Vali macro F1 0.9840847 
new best score!!!!
Validation loss decreased (0.030473 --> 0.029652).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 6.321850538253784
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0066462  Vali Loss: 0.0302066 Vali Accuracy: 0.9899447  Vali weighted F1: 0.9899415  Vali macro F1 0.9840835 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 6.328404903411865
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0082723  Vali Loss: 0.0300046 Vali Accuracy: 0.9899447  Vali weighted F1: 0.9899415  Vali macro F1 0.9840835 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 6.337823390960693
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0069477  Vali Loss: 0.0299398 Vali Accuracy: 0.9899447  Vali weighted F1: 0.9899415  Vali macro F1 0.9840835 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 6.336928367614746
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0071893  Vali Loss: 0.0302383 Vali Accuracy: 0.9904475  Vali weighted F1: 0.9904445  Vali macro F1 0.9848918 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 6.30679988861084
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0069800  Vali Loss: 0.0302781 Vali Accuracy: 0.9894419  Vali weighted F1: 0.9894355  Vali macro F1 0.9832766 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 17 cost time: 6.307515859603882
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0076308  Vali Loss: 0.0302882 Vali Accuracy: 0.9889392  Vali weighted F1: 0.9889298  Vali macro F1 0.9824706 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 6.309259653091431
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0077241  Vali Loss: 0.0302843 Vali Accuracy: 0.9894419  Vali weighted F1: 0.9894355  Vali macro F1 0.9832766 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 6.312829971313477
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0063714  Vali Loss: 0.0303492 Vali Accuracy: 0.9894419  Vali weighted F1: 0.9894355  Vali macro F1 0.9832766 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 6.400446891784668
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0069613  Vali Loss: 0.0304251 Vali Accuracy: 0.9894419  Vali weighted F1: 0.9894355  Vali macro F1 0.9832766 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 6.335049867630005
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0066926  Vali Loss: 0.0304386 Vali Accuracy: 0.9894419  Vali weighted F1: 0.9894355  Vali macro F1 0.9832766 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Fine Tuning Epoch: 22 cost time: 6.313245534896851
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0067357  Vali Loss: 0.0304331 Vali Accuracy: 0.9894419  Vali weighted F1: 0.9894355  Vali macro F1 0.9832766 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 6.305356502532959
Fine Tuning VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0067469  Vali Loss: 0.0304306 Vali Accuracy: 0.9894419  Vali weighted F1: 0.9894355  Vali macro F1 0.9832766 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 6.306469678878784
Fine Tuning VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0067539  Vali Loss: 0.0304387 Vali Accuracy: 0.9894419  Vali weighted F1: 0.9894355  Vali macro F1 0.9832766 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 6.313348293304443
Fine Tuning VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0068680  Vali Loss: 0.0304390 Vali Accuracy: 0.9894419  Vali weighted F1: 0.9894355  Vali macro F1 0.9832766 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 6.368354082107544
Fine Tuning VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0061410  Vali Loss: 0.0304336 Vali Accuracy: 0.9894419  Vali weighted F1: 0.9894355  Vali macro F1 0.9832766 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8333166  Test weighted F1: 0.8440605  Test macro F1 0.7997586 
================ the 1 th CV Experiment ================ 
Leave one Out Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00014928 0.00018305 0.00110011 0.00139082 0.00051151 0.00062189]
Train data number :  17353
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1929
Test data number :  12988
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.118022918701172
VALI: Epoch: 1, Steps: 68 | Train Loss: 1.0486742  Vali Loss: 0.6870580 Vali Accuracy: 0.7423536  Vali weighted F1: 0.6842671  Vali macro F1 0.4676919 
Validation loss decreased (inf --> 0.687058).  Saving model ...
Epoch: 2 cost time: 6.13227391242981
VALI: Epoch: 2, Steps: 68 | Train Loss: 0.5576393  Vali Loss: 0.5085515 Vali Accuracy: 0.8221877  Vali weighted F1: 0.8043248  Vali macro F1 0.7605678 
new best score!!!!
Validation loss decreased (0.687058 --> 0.508552).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.117440938949585
VALI: Epoch: 3, Steps: 68 | Train Loss: 0.4372818  Vali Loss: 0.4402630 Vali Accuracy: 0.8455158  Vali weighted F1: 0.8422868  Vali macro F1 0.8108251 
new best score!!!!
Validation loss decreased (0.508552 --> 0.440263).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.129004955291748
VALI: Epoch: 4, Steps: 68 | Train Loss: 0.3337587  Vali Loss: 0.2969078 Vali Accuracy: 0.9020218  Vali weighted F1: 0.8968583  Vali macro F1 0.8741236 
new best score!!!!
Validation loss decreased (0.440263 --> 0.296908).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.181520938873291
VALI: Epoch: 5, Steps: 68 | Train Loss: 0.2526363  Vali Loss: 0.2177153 Vali Accuracy: 0.9289787  Vali weighted F1: 0.9275791  Vali macro F1 0.9081382 
new best score!!!!
Validation loss decreased (0.296908 --> 0.217715).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.160602331161499
VALI: Epoch: 6, Steps: 68 | Train Loss: 0.2170350  Vali Loss: 0.2017436 Vali Accuracy: 0.9362364  Vali weighted F1: 0.9349150  Vali macro F1 0.9186847 
new best score!!!!
Validation loss decreased (0.217715 --> 0.201744).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.155531167984009
VALI: Epoch: 7, Steps: 68 | Train Loss: 0.1844031  Vali Loss: 0.1954860 Vali Accuracy: 0.9383100  Vali weighted F1: 0.9370156  Vali macro F1 0.9210175 
new best score!!!!
Validation loss decreased (0.201744 --> 0.195486).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.1664605140686035
VALI: Epoch: 8, Steps: 68 | Train Loss: 0.1557878  Vali Loss: 0.1688720 Vali Accuracy: 0.9434940  Vali weighted F1: 0.9434617  Vali macro F1 0.9278532 
new best score!!!!
Validation loss decreased (0.195486 --> 0.168872).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.193080186843872
VALI: Epoch: 9, Steps: 68 | Train Loss: 0.1429977  Vali Loss: 0.1536782 Vali Accuracy: 0.9481597  Vali weighted F1: 0.9475130  Vali macro F1 0.9328779 
new best score!!!!
Validation loss decreased (0.168872 --> 0.153678).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.189311265945435
VALI: Epoch: 10, Steps: 68 | Train Loss: 0.1339590  Vali Loss: 0.1339979 Vali Accuracy: 0.9528253  Vali weighted F1: 0.9526933  Vali macro F1 0.9380074 
new best score!!!!
Validation loss decreased (0.153678 --> 0.133998).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.189477205276489
VALI: Epoch: 11, Steps: 68 | Train Loss: 0.1076664  Vali Loss: 0.1141919 Vali Accuracy: 0.9616382  Vali weighted F1: 0.9615862  Vali macro F1 0.9540215 
new best score!!!!
Validation loss decreased (0.133998 --> 0.114192).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.175518751144409
VALI: Epoch: 12, Steps: 68 | Train Loss: 0.1018282  Vali Loss: 0.1180992 Vali Accuracy: 0.9652670  Vali weighted F1: 0.9653837  Vali macro F1 0.9556330 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 6.198938369750977
VALI: Epoch: 13, Steps: 68 | Train Loss: 0.0889354  Vali Loss: 0.1014075 Vali Accuracy: 0.9678590  Vali weighted F1: 0.9675329  Vali macro F1 0.9597942 
new best score!!!!
Validation loss decreased (0.114192 --> 0.101407).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.189151287078857
VALI: Epoch: 14, Steps: 68 | Train Loss: 0.0801839  Vali Loss: 0.1470821 Vali Accuracy: 0.9543805  Vali weighted F1: 0.9543333  Vali macro F1 0.9446311 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.1775548458099365
VALI: Epoch: 15, Steps: 68 | Train Loss: 0.0907745  Vali Loss: 0.0841516 Vali Accuracy: 0.9704510  Vali weighted F1: 0.9704876  Vali macro F1 0.9625075 
new best score!!!!
Validation loss decreased (0.101407 --> 0.084152).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.178976774215698
VALI: Epoch: 16, Steps: 68 | Train Loss: 0.0662764  Vali Loss: 0.0933551 Vali Accuracy: 0.9668222  Vali weighted F1: 0.9666169  Vali macro F1 0.9591767 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 6.186074256896973
VALI: Epoch: 17, Steps: 68 | Train Loss: 0.0685553  Vali Loss: 0.0708424 Vali Accuracy: 0.9756350  Vali weighted F1: 0.9757295  Vali macro F1 0.9700968 
new best score!!!!
Validation loss decreased (0.084152 --> 0.070842).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.173542261123657
VALI: Epoch: 18, Steps: 68 | Train Loss: 0.0544072  Vali Loss: 0.0698216 Vali Accuracy: 0.9771903  Vali weighted F1: 0.9771869  Vali macro F1 0.9717918 
new best score!!!!
Validation loss decreased (0.070842 --> 0.069822).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.18639612197876
VALI: Epoch: 19, Steps: 68 | Train Loss: 0.0556399  Vali Loss: 0.0770836 Vali Accuracy: 0.9761534  Vali weighted F1: 0.9762475  Vali macro F1 0.9679489 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 6.1976318359375
VALI: Epoch: 20, Steps: 68 | Train Loss: 0.0484374  Vali Loss: 0.0744714 Vali Accuracy: 0.9725246  Vali weighted F1: 0.9721573  Vali macro F1 0.9678102 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 6.18129563331604
VALI: Epoch: 21, Steps: 68 | Train Loss: 0.0487829  Vali Loss: 0.0669509 Vali Accuracy: 0.9792639  Vali weighted F1: 0.9792039  Vali macro F1 0.9740871 
new best score!!!!
Validation loss decreased (0.069822 --> 0.066951).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.1875762939453125
VALI: Epoch: 22, Steps: 68 | Train Loss: 0.0413766  Vali Loss: 0.0621478 Vali Accuracy: 0.9823743  Vali weighted F1: 0.9823874  Vali macro F1 0.9769931 
new best score!!!!
Validation loss decreased (0.066951 --> 0.062148).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.193095922470093
VALI: Epoch: 23, Steps: 68 | Train Loss: 0.0404855  Vali Loss: 0.0632701 Vali Accuracy: 0.9808191  Vali weighted F1: 0.9808612  Vali macro F1 0.9755831 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 6.1808412075042725
VALI: Epoch: 24, Steps: 68 | Train Loss: 0.0351553  Vali Loss: 0.0685239 Vali Accuracy: 0.9782271  Vali weighted F1: 0.9781275  Vali macro F1 0.9723126 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 6.189321279525757
VALI: Epoch: 25, Steps: 68 | Train Loss: 0.0437396  Vali Loss: 0.0682798 Vali Accuracy: 0.9782271  Vali weighted F1: 0.9779990  Vali macro F1 0.9732982 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 26 cost time: 6.193396091461182
VALI: Epoch: 26, Steps: 68 | Train Loss: 0.0403252  Vali Loss: 0.0615608 Vali Accuracy: 0.9787455  Vali weighted F1: 0.9786965  Vali macro F1 0.9736254 
new best score!!!!
Validation loss decreased (0.062148 --> 0.061561).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.194431304931641
VALI: Epoch: 27, Steps: 68 | Train Loss: 0.0343343  Vali Loss: 0.0655987 Vali Accuracy: 0.9761534  Vali weighted F1: 0.9761568  Vali macro F1 0.9684087 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.177735090255737
VALI: Epoch: 28, Steps: 68 | Train Loss: 0.0313503  Vali Loss: 0.0663101 Vali Accuracy: 0.9787455  Vali weighted F1: 0.9787181  Vali macro F1 0.9732821 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 6.173166036605835
VALI: Epoch: 29, Steps: 68 | Train Loss: 0.0277607  Vali Loss: 0.0507789 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9839794  Vali macro F1 0.9790596 
new best score!!!!
Validation loss decreased (0.061561 --> 0.050779).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.188390731811523
VALI: Epoch: 30, Steps: 68 | Train Loss: 0.0245904  Vali Loss: 0.0603240 Vali Accuracy: 0.9834111  Vali weighted F1: 0.9833384  Vali macro F1 0.9803972 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 6.176538944244385
VALI: Epoch: 31, Steps: 68 | Train Loss: 0.0229335  Vali Loss: 0.0622932 Vali Accuracy: 0.9860031  Vali weighted F1: 0.9860553  Vali macro F1 0.9822478 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 6.18013858795166
VALI: Epoch: 32, Steps: 68 | Train Loss: 0.0246269  Vali Loss: 0.0563816 Vali Accuracy: 0.9870399  Vali weighted F1: 0.9870251  Vali macro F1 0.9830932 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 6.200258255004883
VALI: Epoch: 33, Steps: 68 | Train Loss: 0.0224573  Vali Loss: 0.0644729 Vali Accuracy: 0.9808191  Vali weighted F1: 0.9809039  Vali macro F1 0.9741896 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 34 cost time: 6.196102619171143
VALI: Epoch: 34, Steps: 68 | Train Loss: 0.0264828  Vali Loss: 0.0495078 Vali Accuracy: 0.9875583  Vali weighted F1: 0.9875783  Vali macro F1 0.9842855 
new best score!!!!
Validation loss decreased (0.050779 --> 0.049508).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 6.177988052368164
VALI: Epoch: 35, Steps: 68 | Train Loss: 0.0179119  Vali Loss: 0.0549846 Vali Accuracy: 0.9854847  Vali weighted F1: 0.9855450  Vali macro F1 0.9813181 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 6.188231945037842
VALI: Epoch: 36, Steps: 68 | Train Loss: 0.0158991  Vali Loss: 0.0764547 Vali Accuracy: 0.9803007  Vali weighted F1: 0.9803432  Vali macro F1 0.9757922 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 6.180244445800781
VALI: Epoch: 37, Steps: 68 | Train Loss: 0.0281978  Vali Loss: 0.0600003 Vali Accuracy: 0.9844479  Vali weighted F1: 0.9844961  Vali macro F1 0.9801378 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 6.1800782680511475
VALI: Epoch: 38, Steps: 68 | Train Loss: 0.0253656  Vali Loss: 0.0589307 Vali Accuracy: 0.9834111  Vali weighted F1: 0.9833547  Vali macro F1 0.9802342 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 6.187404632568359
VALI: Epoch: 39, Steps: 68 | Train Loss: 0.0156297  Vali Loss: 0.0495934 Vali Accuracy: 0.9870399  Vali weighted F1: 0.9870337  Vali macro F1 0.9834961 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 40 cost time: 6.210180044174194
VALI: Epoch: 40, Steps: 68 | Train Loss: 0.0091786  Vali Loss: 0.0439469 Vali Accuracy: 0.9885951  Vali weighted F1: 0.9886031  Vali macro F1 0.9852850 
new best score!!!!
Validation loss decreased (0.049508 --> 0.043947).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 6.187483310699463
VALI: Epoch: 41, Steps: 68 | Train Loss: 0.0086104  Vali Loss: 0.0442767 Vali Accuracy: 0.9896319  Vali weighted F1: 0.9896397  Vali macro F1 0.9863631 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 6.2075910568237305
VALI: Epoch: 42, Steps: 68 | Train Loss: 0.0080401  Vali Loss: 0.0449741 Vali Accuracy: 0.9885951  Vali weighted F1: 0.9885999  Vali macro F1 0.9851746 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 6.189453601837158
VALI: Epoch: 43, Steps: 68 | Train Loss: 0.0069591  Vali Loss: 0.0437402 Vali Accuracy: 0.9896319  Vali weighted F1: 0.9896538  Vali macro F1 0.9863921 
new best score!!!!
Validation loss decreased (0.043947 --> 0.043740).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 6.19208550453186
VALI: Epoch: 44, Steps: 68 | Train Loss: 0.0067122  Vali Loss: 0.0459705 Vali Accuracy: 0.9885951  Vali weighted F1: 0.9885998  Vali macro F1 0.9848197 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 6.187055826187134
VALI: Epoch: 45, Steps: 68 | Train Loss: 0.0072832  Vali Loss: 0.0466599 Vali Accuracy: 0.9901503  Vali weighted F1: 0.9901709  Vali macro F1 0.9872068 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 6.1933629512786865
VALI: Epoch: 46, Steps: 68 | Train Loss: 0.0070157  Vali Loss: 0.0506215 Vali Accuracy: 0.9891135  Vali weighted F1: 0.9891368  Vali macro F1 0.9862693 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 6.244739770889282
VALI: Epoch: 47, Steps: 68 | Train Loss: 0.0064153  Vali Loss: 0.0447691 Vali Accuracy: 0.9891135  Vali weighted F1: 0.9891332  Vali macro F1 0.9854490 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 6.168752670288086
VALI: Epoch: 48, Steps: 68 | Train Loss: 0.0058142  Vali Loss: 0.0441481 Vali Accuracy: 0.9901503  Vali weighted F1: 0.9901555  Vali macro F1 0.9870785 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 49 cost time: 6.173652410507202
VALI: Epoch: 49, Steps: 68 | Train Loss: 0.0058594  Vali Loss: 0.0441144 Vali Accuracy: 0.9906687  Vali weighted F1: 0.9906689  Vali macro F1 0.9875309 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 6.162531137466431
VALI: Epoch: 50, Steps: 68 | Train Loss: 0.0059820  Vali Loss: 0.0445622 Vali Accuracy: 0.9885951  Vali weighted F1: 0.9886094  Vali macro F1 0.9849598 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 6.1830480098724365
VALI: Epoch: 51, Steps: 68 | Train Loss: 0.0060186  Vali Loss: 0.0447709 Vali Accuracy: 0.9891135  Vali weighted F1: 0.9891332  Vali macro F1 0.9854490 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 6.172072410583496
VALI: Epoch: 52, Steps: 68 | Train Loss: 0.0058495  Vali Loss: 0.0449123 Vali Accuracy: 0.9891135  Vali weighted F1: 0.9891332  Vali macro F1 0.9854490 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 6.1879355907440186
VALI: Epoch: 53, Steps: 68 | Train Loss: 0.0055459  Vali Loss: 0.0452475 Vali Accuracy: 0.9891135  Vali weighted F1: 0.9891332  Vali macro F1 0.9854490 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 54 cost time: 6.186324596405029
VALI: Epoch: 54, Steps: 68 | Train Loss: 0.0053165  Vali Loss: 0.0451665 Vali Accuracy: 0.9891135  Vali weighted F1: 0.9891332  Vali macro F1 0.9854490 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 6.176466226577759
VALI: Epoch: 55, Steps: 68 | Train Loss: 0.0058970  Vali Loss: 0.0451764 Vali Accuracy: 0.9891135  Vali weighted F1: 0.9891332  Vali macro F1 0.9854490 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 56 cost time: 6.171100616455078
VALI: Epoch: 56, Steps: 68 | Train Loss: 0.0062391  Vali Loss: 0.0452206 Vali Accuracy: 0.9891135  Vali weighted F1: 0.9891332  Vali macro F1 0.9854490 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 57 cost time: 6.16656231880188
VALI: Epoch: 57, Steps: 68 | Train Loss: 0.0055348  Vali Loss: 0.0452491 Vali Accuracy: 0.9891135  Vali weighted F1: 0.9891332  Vali macro F1 0.9854490 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 58 cost time: 6.179072141647339
VALI: Epoch: 58, Steps: 68 | Train Loss: 0.0060609  Vali Loss: 0.0452772 Vali Accuracy: 0.9885951  Vali weighted F1: 0.9886094  Vali macro F1 0.9849598 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9535725  Test weighted F1: 0.9539863  Test macro F1 0.9281950 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 240495
pruned model Parameter : 244174
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.222943544387817
Fine Tuning VALI: Epoch: 1, Steps: 68 | Train Loss: 0.0076296  Vali Loss: 0.0511565 Vali Accuracy: 0.9891135  Vali weighted F1: 0.9891373  Vali macro F1 0.9855609 
Validation loss decreased (inf --> 0.051157).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.203890323638916
Fine Tuning VALI: Epoch: 2, Steps: 68 | Train Loss: 0.0067989  Vali Loss: 0.0482006 Vali Accuracy: 0.9870399  Vali weighted F1: 0.9870655  Vali macro F1 0.9827472 
new best score!!!!
Validation loss decreased (0.051157 --> 0.048201).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.171448230743408
Fine Tuning VALI: Epoch: 3, Steps: 68 | Train Loss: 0.0067589  Vali Loss: 0.0542996 Vali Accuracy: 0.9891135  Vali weighted F1: 0.9891010  Vali macro F1 0.9858827 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.1678266525268555
Fine Tuning VALI: Epoch: 4, Steps: 68 | Train Loss: 0.0063615  Vali Loss: 0.0481324 Vali Accuracy: 0.9891135  Vali weighted F1: 0.9891411  Vali macro F1 0.9857955 
new best score!!!!
Validation loss decreased (0.048201 --> 0.048132).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.177329778671265
Fine Tuning VALI: Epoch: 5, Steps: 68 | Train Loss: 0.0059210  Vali Loss: 0.0459502 Vali Accuracy: 0.9901503  Vali weighted F1: 0.9901573  Vali macro F1 0.9870591 
new best score!!!!
Validation loss decreased (0.048132 --> 0.045950).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.185546636581421
Fine Tuning VALI: Epoch: 6, Steps: 68 | Train Loss: 0.0057223  Vali Loss: 0.0441350 Vali Accuracy: 0.9896319  Vali weighted F1: 0.9896459  Vali macro F1 0.9865797 
new best score!!!!
Validation loss decreased (0.045950 --> 0.044135).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.171268463134766
Fine Tuning VALI: Epoch: 7, Steps: 68 | Train Loss: 0.0052968  Vali Loss: 0.0508232 Vali Accuracy: 0.9896319  Vali weighted F1: 0.9896266  Vali macro F1 0.9864583 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.197545289993286
Fine Tuning VALI: Epoch: 8, Steps: 68 | Train Loss: 0.0067566  Vali Loss: 0.0467564 Vali Accuracy: 0.9911871  Vali weighted F1: 0.9911976  Vali macro F1 0.9889802 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 6.176281213760376
Fine Tuning VALI: Epoch: 9, Steps: 68 | Train Loss: 0.0055397  Vali Loss: 0.0493957 Vali Accuracy: 0.9901503  Vali weighted F1: 0.9901461  Vali macro F1 0.9860055 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 6.182963132858276
Fine Tuning VALI: Epoch: 10, Steps: 68 | Train Loss: 0.0054232  Vali Loss: 0.0483547 Vali Accuracy: 0.9906687  Vali weighted F1: 0.9906627  Vali macro F1 0.9878565 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 11 cost time: 6.178891658782959
Fine Tuning VALI: Epoch: 11, Steps: 68 | Train Loss: 0.0044377  Vali Loss: 0.0501827 Vali Accuracy: 0.9885951  Vali weighted F1: 0.9886079  Vali macro F1 0.9849478 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 12 cost time: 6.186422348022461
Fine Tuning VALI: Epoch: 12, Steps: 68 | Train Loss: 0.0049120  Vali Loss: 0.0512238 Vali Accuracy: 0.9891135  Vali weighted F1: 0.9891222  Vali macro F1 0.9845195 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 6.185824871063232
Fine Tuning VALI: Epoch: 13, Steps: 68 | Train Loss: 0.0048132  Vali Loss: 0.0508919 Vali Accuracy: 0.9885951  Vali weighted F1: 0.9886113  Vali macro F1 0.9833617 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 6.200059652328491
Fine Tuning VALI: Epoch: 14, Steps: 68 | Train Loss: 0.0046797  Vali Loss: 0.0506979 Vali Accuracy: 0.9880767  Vali weighted F1: 0.9881040  Vali macro F1 0.9829055 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 6.2072906494140625
Fine Tuning VALI: Epoch: 15, Steps: 68 | Train Loss: 0.0047907  Vali Loss: 0.0492098 Vali Accuracy: 0.9896319  Vali weighted F1: 0.9896592  Vali macro F1 0.9872549 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 6.192378520965576
Fine Tuning VALI: Epoch: 16, Steps: 68 | Train Loss: 0.0053140  Vali Loss: 0.0498723 Vali Accuracy: 0.9896319  Vali weighted F1: 0.9896325  Vali macro F1 0.9854464 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 17 cost time: 6.201496601104736
Fine Tuning VALI: Epoch: 17, Steps: 68 | Train Loss: 0.0038641  Vali Loss: 0.0515465 Vali Accuracy: 0.9896319  Vali weighted F1: 0.9896389  Vali macro F1 0.9852275 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 6.199822902679443
Fine Tuning VALI: Epoch: 18, Steps: 68 | Train Loss: 0.0040821  Vali Loss: 0.0500691 Vali Accuracy: 0.9885951  Vali weighted F1: 0.9886014  Vali macro F1 0.9835764 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 6.201252698898315
Fine Tuning VALI: Epoch: 19, Steps: 68 | Train Loss: 0.0039382  Vali Loss: 0.0485804 Vali Accuracy: 0.9896319  Vali weighted F1: 0.9896389  Vali macro F1 0.9852275 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 6.198692560195923
Fine Tuning VALI: Epoch: 20, Steps: 68 | Train Loss: 0.0036694  Vali Loss: 0.0476639 Vali Accuracy: 0.9896319  Vali weighted F1: 0.9896389  Vali macro F1 0.9852275 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 6.21710467338562
Fine Tuning VALI: Epoch: 21, Steps: 68 | Train Loss: 0.0034137  Vali Loss: 0.0466785 Vali Accuracy: 0.9896319  Vali weighted F1: 0.9896467  Vali macro F1 0.9850101 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9517247  Test weighted F1: 0.9518639  Test macro F1 0.9263856 
================ the 2 th CV Experiment ================ 
Leave one Out Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.00014773 0.00018282 0.00097561 0.00126743 0.0005005  0.00061237]
Train data number :  17684
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1965
Test data number :  11154
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.377163410186768
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.0357210  Vali Loss: 0.6515659 Vali Accuracy: 0.7526718  Vali weighted F1: 0.7081667  Vali macro F1 0.5102315 
Validation loss decreased (inf --> 0.651566).  Saving model ...
Epoch: 2 cost time: 6.291501998901367
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.5077585  Vali Loss: 0.6144592 Vali Accuracy: 0.8045802  Vali weighted F1: 0.7758799  Vali macro F1 0.7271002 
new best score!!!!
Validation loss decreased (0.651566 --> 0.614459).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.308652400970459
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.3863720  Vali Loss: 0.3182944 Vali Accuracy: 0.8916031  Vali weighted F1: 0.8834798  Vali macro F1 0.8443072 
new best score!!!!
Validation loss decreased (0.614459 --> 0.318294).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.306025743484497
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.3122166  Vali Loss: 0.2907316 Vali Accuracy: 0.9027990  Vali weighted F1: 0.8965307  Vali macro F1 0.8600154 
new best score!!!!
Validation loss decreased (0.318294 --> 0.290732).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.306488513946533
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.2644243  Vali Loss: 0.3107902 Vali Accuracy: 0.9027990  Vali weighted F1: 0.8955334  Vali macro F1 0.8716273 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 6 cost time: 6.330063343048096
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.2327419  Vali Loss: 0.2459288 Vali Accuracy: 0.9195929  Vali weighted F1: 0.9192439  Vali macro F1 0.8915306 
new best score!!!!
Validation loss decreased (0.290732 --> 0.245929).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.306645393371582
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.2176549  Vali Loss: 0.1693464 Vali Accuracy: 0.9475827  Vali weighted F1: 0.9472019  Vali macro F1 0.9288901 
new best score!!!!
Validation loss decreased (0.245929 --> 0.169346).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.320931434631348
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1557075  Vali Loss: 0.1510338 Vali Accuracy: 0.9491094  Vali weighted F1: 0.9491254  Vali macro F1 0.9282151 
new best score!!!!
Validation loss decreased (0.169346 --> 0.151034).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.312007904052734
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1364943  Vali Loss: 0.1317528 Vali Accuracy: 0.9597964  Vali weighted F1: 0.9603011  Vali macro F1 0.9473609 
new best score!!!!
Validation loss decreased (0.151034 --> 0.131753).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.319573163986206
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1217252  Vali Loss: 0.1109585 Vali Accuracy: 0.9623410  Vali weighted F1: 0.9627018  Vali macro F1 0.9458060 
new best score!!!!
Validation loss decreased (0.131753 --> 0.110958).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.311205863952637
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1096852  Vali Loss: 0.1107645 Vali Accuracy: 0.9623410  Vali weighted F1: 0.9628007  Vali macro F1 0.9471130 
new best score!!!!
Validation loss decreased (0.110958 --> 0.110764).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.314587831497192
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0989816  Vali Loss: 0.0971434 Vali Accuracy: 0.9730280  Vali weighted F1: 0.9733621  Vali macro F1 0.9619141 
new best score!!!!
Validation loss decreased (0.110764 --> 0.097143).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.33770227432251
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0894243  Vali Loss: 0.0899220 Vali Accuracy: 0.9704835  Vali weighted F1: 0.9707033  Vali macro F1 0.9550334 
new best score!!!!
Validation loss decreased (0.097143 --> 0.089922).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.3081114292144775
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0871349  Vali Loss: 0.1098004 Vali Accuracy: 0.9653944  Vali weighted F1: 0.9652973  Vali macro F1 0.9486122 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.29957914352417
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0768408  Vali Loss: 0.1058031 Vali Accuracy: 0.9623410  Vali weighted F1: 0.9623037  Vali macro F1 0.9493600 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 16 cost time: 6.334045886993408
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0793770  Vali Loss: 0.0828276 Vali Accuracy: 0.9740458  Vali weighted F1: 0.9738114  Vali macro F1 0.9638980 
new best score!!!!
Validation loss decreased (0.089922 --> 0.082828).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.3603432178497314
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0768402  Vali Loss: 0.0647914 Vali Accuracy: 0.9791349  Vali weighted F1: 0.9791664  Vali macro F1 0.9670514 
new best score!!!!
Validation loss decreased (0.082828 --> 0.064791).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.337932825088501
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0686893  Vali Loss: 0.0813943 Vali Accuracy: 0.9730280  Vali weighted F1: 0.9730943  Vali macro F1 0.9643376 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.361286640167236
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0548679  Vali Loss: 0.0753339 Vali Accuracy: 0.9755725  Vali weighted F1: 0.9755894  Vali macro F1 0.9618681 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 6.323536396026611
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0734713  Vali Loss: 0.0628109 Vali Accuracy: 0.9826972  Vali weighted F1: 0.9826118  Vali macro F1 0.9745763 
new best score!!!!
Validation loss decreased (0.064791 --> 0.062811).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.314128875732422
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0491113  Vali Loss: 0.0554101 Vali Accuracy: 0.9801527  Vali weighted F1: 0.9802802  Vali macro F1 0.9711743 
new best score!!!!
Validation loss decreased (0.062811 --> 0.055410).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.314578533172607
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0453532  Vali Loss: 0.0656803 Vali Accuracy: 0.9770992  Vali weighted F1: 0.9774693  Vali macro F1 0.9700435 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.305668354034424
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0447713  Vali Loss: 0.0682892 Vali Accuracy: 0.9765903  Vali weighted F1: 0.9768918  Vali macro F1 0.9674733 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 6.318135738372803
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0411752  Vali Loss: 0.0479608 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9837167  Vali macro F1 0.9756448 
new best score!!!!
Validation loss decreased (0.055410 --> 0.047961).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.326793432235718
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0421614  Vali Loss: 0.0503044 Vali Accuracy: 0.9821883  Vali weighted F1: 0.9823995  Vali macro F1 0.9745096 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 6.336005449295044
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0368538  Vali Loss: 0.0510775 Vali Accuracy: 0.9816794  Vali weighted F1: 0.9817859  Vali macro F1 0.9723676 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 6.318435192108154
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0320359  Vali Loss: 0.1302531 Vali Accuracy: 0.9567430  Vali weighted F1: 0.9563973  Vali macro F1 0.9406686 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 28 cost time: 6.315646171569824
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0746188  Vali Loss: 0.0542187 Vali Accuracy: 0.9811705  Vali weighted F1: 0.9811896  Vali macro F1 0.9702321 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 29 cost time: 6.313975095748901
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0325776  Vali Loss: 0.0449234 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9847365  Vali macro F1 0.9774202 
new best score!!!!
Validation loss decreased (0.047961 --> 0.044923).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.322053670883179
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0281395  Vali Loss: 0.0520848 Vali Accuracy: 0.9821883  Vali weighted F1: 0.9823734  Vali macro F1 0.9752828 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 6.326405763626099
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0325266  Vali Loss: 0.0421460 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9857278  Vali macro F1 0.9788532 
new best score!!!!
Validation loss decreased (0.044923 --> 0.042146).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.351893424987793
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0209729  Vali Loss: 0.0453531 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9852196  Vali macro F1 0.9762590 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 6.329467535018921
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0180902  Vali Loss: 0.0499972 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9837426  Vali macro F1 0.9762667 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 6.312608480453491
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0235229  Vali Loss: 0.0351223 Vali Accuracy: 0.9867684  Vali weighted F1: 0.9868067  Vali macro F1 0.9795291 
new best score!!!!
Validation loss decreased (0.042146 --> 0.035122).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 6.31016993522644
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0199513  Vali Loss: 0.0501540 Vali Accuracy: 0.9821883  Vali weighted F1: 0.9823615  Vali macro F1 0.9739091 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 6.309347867965698
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0245430  Vali Loss: 0.0361823 Vali Accuracy: 0.9903308  Vali weighted F1: 0.9903050  Vali macro F1 0.9846127 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 6.315950632095337
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0162419  Vali Loss: 0.0489113 Vali Accuracy: 0.9842239  Vali weighted F1: 0.9841588  Vali macro F1 0.9747051 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 6.325343608856201
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0319088  Vali Loss: 0.0465077 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9836531  Vali macro F1 0.9751710 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 6.33997106552124
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0182897  Vali Loss: 0.0373399 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9852542  Vali macro F1 0.9777345 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 40 cost time: 6.316577911376953
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0114152  Vali Loss: 0.0342438 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9882946  Vali macro F1 0.9823761 
new best score!!!!
Validation loss decreased (0.035122 --> 0.034244).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 6.313402891159058
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0090303  Vali Loss: 0.0323971 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9883096  Vali macro F1 0.9816936 
new best score!!!!
Validation loss decreased (0.034244 --> 0.032397).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 6.310492992401123
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0095328  Vali Loss: 0.0321661 Vali Accuracy: 0.9888041  Vali weighted F1: 0.9888194  Vali macro F1 0.9825259 
new best score!!!!
Validation loss decreased (0.032397 --> 0.032166).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 6.32688570022583
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0084167  Vali Loss: 0.0329669 Vali Accuracy: 0.9888041  Vali weighted F1: 0.9888045  Vali macro F1 0.9825035 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 6.315619945526123
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0076892  Vali Loss: 0.0327951 Vali Accuracy: 0.9888041  Vali weighted F1: 0.9888045  Vali macro F1 0.9825035 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 6.340548753738403
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0082565  Vali Loss: 0.0335931 Vali Accuracy: 0.9898219  Vali weighted F1: 0.9898150  Vali macro F1 0.9834532 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 46 cost time: 6.333233118057251
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0074954  Vali Loss: 0.0336900 Vali Accuracy: 0.9893130  Vali weighted F1: 0.9893063  Vali macro F1 0.9832045 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 47 cost time: 6.310290336608887
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0074942  Vali Loss: 0.0322045 Vali Accuracy: 0.9888041  Vali weighted F1: 0.9888099  Vali macro F1 0.9821546 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 48 cost time: 6.3138813972473145
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0074740  Vali Loss: 0.0325837 Vali Accuracy: 0.9888041  Vali weighted F1: 0.9888099  Vali macro F1 0.9821546 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 6.300182104110718
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0076825  Vali Loss: 0.0325922 Vali Accuracy: 0.9888041  Vali weighted F1: 0.9888099  Vali macro F1 0.9821546 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 6.307527542114258
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0074760  Vali Loss: 0.0324141 Vali Accuracy: 0.9888041  Vali weighted F1: 0.9888099  Vali macro F1 0.9821546 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 6.306708574295044
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0077693  Vali Loss: 0.0327434 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9882942  Vali macro F1 0.9816501 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 52 cost time: 6.336744546890259
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0069038  Vali Loss: 0.0325926 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9882942  Vali macro F1 0.9816501 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 53 cost time: 6.316958665847778
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0071955  Vali Loss: 0.0325750 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9882942  Vali macro F1 0.9816501 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 6.319979190826416
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0069411  Vali Loss: 0.0325820 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9882942  Vali macro F1 0.9816501 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 6.314573287963867
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0068868  Vali Loss: 0.0325522 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9882942  Vali macro F1 0.9816501 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 56 cost time: 6.300962209701538
VALI: Epoch: 56, Steps: 70 | Train Loss: 0.0066269  Vali Loss: 0.0325291 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9882942  Vali macro F1 0.9816501 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 57 cost time: 6.30419397354126
VALI: Epoch: 57, Steps: 70 | Train Loss: 0.0068039  Vali Loss: 0.0325118 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9882942  Vali macro F1 0.9816501 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8422987  Test weighted F1: 0.8523008  Test macro F1 0.8414414 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 240495
pruned model Parameter : 244174
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.3660173416137695
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0086438  Vali Loss: 0.0349269 Vali Accuracy: 0.9888041  Vali weighted F1: 0.9887830  Vali macro F1 0.9829200 
Validation loss decreased (inf --> 0.034927).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.311176538467407
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0111443  Vali Loss: 0.0332701 Vali Accuracy: 0.9893130  Vali weighted F1: 0.9893254  Vali macro F1 0.9832619 
new best score!!!!
Validation loss decreased (0.034927 --> 0.033270).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.318282127380371
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0083161  Vali Loss: 0.0305316 Vali Accuracy: 0.9898219  Vali weighted F1: 0.9898227  Vali macro F1 0.9829829 
new best score!!!!
Validation loss decreased (0.033270 --> 0.030532).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.308093070983887
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0084309  Vali Loss: 0.0322876 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9877961  Vali macro F1 0.9826498 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.327999114990234
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0081833  Vali Loss: 0.0320023 Vali Accuracy: 0.9893130  Vali weighted F1: 0.9893354  Vali macro F1 0.9829495 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 6.317218542098999
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0069656  Vali Loss: 0.0315310 Vali Accuracy: 0.9893130  Vali weighted F1: 0.9893289  Vali macro F1 0.9829099 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 6.337044954299927
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0062397  Vali Loss: 0.0316378 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9882992  Vali macro F1 0.9813294 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 8 cost time: 6.365730047225952
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0058990  Vali Loss: 0.0315336 Vali Accuracy: 0.9888041  Vali weighted F1: 0.9888076  Vali macro F1 0.9833558 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 9 cost time: 6.334591388702393
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0060464  Vali Loss: 0.0343772 Vali Accuracy: 0.9898219  Vali weighted F1: 0.9898340  Vali macro F1 0.9841938 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.33367133140564
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0060884  Vali Loss: 0.0356207 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9882395  Vali macro F1 0.9819981 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 6.33897852897644
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0054560  Vali Loss: 0.0334680 Vali Accuracy: 0.9898219  Vali weighted F1: 0.9898053  Vali macro F1 0.9836911 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 6.330209255218506
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0055328  Vali Loss: 0.0353587 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9882922  Vali macro F1 0.9815522 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 6.329352617263794
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0058130  Vali Loss: 0.0316887 Vali Accuracy: 0.9913486  Vali weighted F1: 0.9913362  Vali macro F1 0.9853883 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 14 cost time: 6.364784002304077
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0051639  Vali Loss: 0.0308790 Vali Accuracy: 0.9908397  Vali weighted F1: 0.9908378  Vali macro F1 0.9848143 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 6.348235607147217
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0049221  Vali Loss: 0.0306176 Vali Accuracy: 0.9908397  Vali weighted F1: 0.9908378  Vali macro F1 0.9848143 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 6.348581314086914
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0046236  Vali Loss: 0.0309455 Vali Accuracy: 0.9903308  Vali weighted F1: 0.9903185  Vali macro F1 0.9841912 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 6.33701491355896
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0051174  Vali Loss: 0.0312317 Vali Accuracy: 0.9908397  Vali weighted F1: 0.9908378  Vali macro F1 0.9848143 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 6.333314657211304
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0051994  Vali Loss: 0.0311042 Vali Accuracy: 0.9908397  Vali weighted F1: 0.9908378  Vali macro F1 0.9848143 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8386229  Test weighted F1: 0.8491686  Test macro F1 0.8377732 
================ the 3 th CV Experiment ================ 
Leave one Out Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00014881 0.00018454 0.00100503 0.00125313 0.00051787 0.00062112]
Train data number :  17473
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1942
Test data number :  12314
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.264230966567993
VALI: Epoch: 1, Steps: 69 | Train Loss: 1.0566355  Vali Loss: 0.6240428 Vali Accuracy: 0.7543769  Vali weighted F1: 0.6977992  Vali macro F1 0.4631058 
Validation loss decreased (inf --> 0.624043).  Saving model ...
Epoch: 2 cost time: 6.267433404922485
VALI: Epoch: 2, Steps: 69 | Train Loss: 0.5532499  Vali Loss: 0.4369779 Vali Accuracy: 0.8470649  Vali weighted F1: 0.8233526  Vali macro F1 0.7647525 
new best score!!!!
Validation loss decreased (0.624043 --> 0.436978).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.261496543884277
VALI: Epoch: 3, Steps: 69 | Train Loss: 0.3787291  Vali Loss: 0.2988432 Vali Accuracy: 0.8892894  Vali weighted F1: 0.8872109  Vali macro F1 0.8502765 
new best score!!!!
Validation loss decreased (0.436978 --> 0.298843).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.2340168952941895
VALI: Epoch: 4, Steps: 69 | Train Loss: 0.2877229  Vali Loss: 0.2318558 Vali Accuracy: 0.9243048  Vali weighted F1: 0.9241613  Vali macro F1 0.8990241 
new best score!!!!
Validation loss decreased (0.298843 --> 0.231856).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.24377179145813
VALI: Epoch: 5, Steps: 69 | Train Loss: 0.2308910  Vali Loss: 0.1867578 Vali Accuracy: 0.9397528  Vali weighted F1: 0.9396085  Vali macro F1 0.9164435 
new best score!!!!
Validation loss decreased (0.231856 --> 0.186758).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.2476723194122314
VALI: Epoch: 6, Steps: 69 | Train Loss: 0.2034365  Vali Loss: 0.1871545 Vali Accuracy: 0.9412976  Vali weighted F1: 0.9404715  Vali macro F1 0.9163039 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 7 cost time: 6.230104446411133
VALI: Epoch: 7, Steps: 69 | Train Loss: 0.1812344  Vali Loss: 0.1839224 Vali Accuracy: 0.9356334  Vali weighted F1: 0.9370514  Vali macro F1 0.9145025 
new best score!!!!
Validation loss decreased (0.186758 --> 0.183922).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.26665472984314
VALI: Epoch: 8, Steps: 69 | Train Loss: 0.1710528  Vali Loss: 0.1439677 Vali Accuracy: 0.9515963  Vali weighted F1: 0.9516598  Vali macro F1 0.9293590 
new best score!!!!
Validation loss decreased (0.183922 --> 0.143968).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.2546539306640625
VALI: Epoch: 9, Steps: 69 | Train Loss: 0.1459366  Vali Loss: 0.1390773 Vali Accuracy: 0.9567456  Vali weighted F1: 0.9564636  Vali macro F1 0.9362379 
new best score!!!!
Validation loss decreased (0.143968 --> 0.139077).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.323660373687744
VALI: Epoch: 10, Steps: 69 | Train Loss: 0.1418696  Vali Loss: 0.1279523 Vali Accuracy: 0.9582904  Vali weighted F1: 0.9587739  Vali macro F1 0.9390764 
new best score!!!!
Validation loss decreased (0.139077 --> 0.127952).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.232832670211792
VALI: Epoch: 11, Steps: 69 | Train Loss: 0.1232492  Vali Loss: 0.1199341 Vali Accuracy: 0.9634398  Vali weighted F1: 0.9639201  Vali macro F1 0.9476374 
new best score!!!!
Validation loss decreased (0.127952 --> 0.119934).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.23593282699585
VALI: Epoch: 12, Steps: 69 | Train Loss: 0.1147143  Vali Loss: 0.1206845 Vali Accuracy: 0.9593203  Vali weighted F1: 0.9595639  Vali macro F1 0.9405489 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 6.234259605407715
VALI: Epoch: 13, Steps: 69 | Train Loss: 0.1022757  Vali Loss: 0.0977710 Vali Accuracy: 0.9701339  Vali weighted F1: 0.9702888  Vali macro F1 0.9554710 
new best score!!!!
Validation loss decreased (0.119934 --> 0.097771).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.242672681808472
VALI: Epoch: 14, Steps: 69 | Train Loss: 0.0931562  Vali Loss: 0.1010149 Vali Accuracy: 0.9660144  Vali weighted F1: 0.9656466  Vali macro F1 0.9497507 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.2635817527771
VALI: Epoch: 15, Steps: 69 | Train Loss: 0.0932879  Vali Loss: 0.1025292 Vali Accuracy: 0.9680742  Vali weighted F1: 0.9683087  Vali macro F1 0.9569095 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 16 cost time: 6.25113582611084
VALI: Epoch: 16, Steps: 69 | Train Loss: 0.0764603  Vali Loss: 0.0802521 Vali Accuracy: 0.9706488  Vali weighted F1: 0.9707108  Vali macro F1 0.9590167 
new best score!!!!
Validation loss decreased (0.097771 --> 0.080252).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.2383201122283936
VALI: Epoch: 17, Steps: 69 | Train Loss: 0.0826877  Vali Loss: 0.1196886 Vali Accuracy: 0.9588054  Vali weighted F1: 0.9579527  Vali macro F1 0.9408267 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 6.233173131942749
VALI: Epoch: 18, Steps: 69 | Train Loss: 0.0715916  Vali Loss: 0.0718865 Vali Accuracy: 0.9752832  Vali weighted F1: 0.9754350  Vali macro F1 0.9642403 
new best score!!!!
Validation loss decreased (0.080252 --> 0.071886).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.237163305282593
VALI: Epoch: 19, Steps: 69 | Train Loss: 0.0625954  Vali Loss: 0.0934282 Vali Accuracy: 0.9685891  Vali weighted F1: 0.9681259  Vali macro F1 0.9563446 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 6.23024582862854
VALI: Epoch: 20, Steps: 69 | Train Loss: 0.0653242  Vali Loss: 0.0625098 Vali Accuracy: 0.9778579  Vali weighted F1: 0.9780383  Vali macro F1 0.9693616 
new best score!!!!
Validation loss decreased (0.071886 --> 0.062510).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.244882106781006
VALI: Epoch: 21, Steps: 69 | Train Loss: 0.0645691  Vali Loss: 0.0600556 Vali Accuracy: 0.9819773  Vali weighted F1: 0.9820502  Vali macro F1 0.9750532 
new best score!!!!
Validation loss decreased (0.062510 --> 0.060056).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.24430775642395
VALI: Epoch: 22, Steps: 69 | Train Loss: 0.0517848  Vali Loss: 0.0641353 Vali Accuracy: 0.9799176  Vali weighted F1: 0.9799635  Vali macro F1 0.9714597 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.242870330810547
VALI: Epoch: 23, Steps: 69 | Train Loss: 0.0507998  Vali Loss: 0.0919494 Vali Accuracy: 0.9711637  Vali weighted F1: 0.9706606  Vali macro F1 0.9607926 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 6.237032175064087
VALI: Epoch: 24, Steps: 69 | Train Loss: 0.0549253  Vali Loss: 0.0657842 Vali Accuracy: 0.9768280  Vali weighted F1: 0.9771320  Vali macro F1 0.9683969 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 25 cost time: 6.245420932769775
VALI: Epoch: 25, Steps: 69 | Train Loss: 0.0443511  Vali Loss: 0.0671774 Vali Accuracy: 0.9778579  Vali weighted F1: 0.9778679  Vali macro F1 0.9690783 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 26 cost time: 6.233717679977417
VALI: Epoch: 26, Steps: 69 | Train Loss: 0.0430347  Vali Loss: 0.0768010 Vali Accuracy: 0.9737384  Vali weighted F1: 0.9734495  Vali macro F1 0.9644384 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 27 cost time: 6.228039503097534
VALI: Epoch: 27, Steps: 69 | Train Loss: 0.0292664  Vali Loss: 0.0606077 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9809585  Vali macro F1 0.9741848 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.251708030700684
VALI: Epoch: 28, Steps: 69 | Train Loss: 0.0241564  Vali Loss: 0.0622685 Vali Accuracy: 0.9799176  Vali weighted F1: 0.9798237  Vali macro F1 0.9724639 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 6.251584529876709
VALI: Epoch: 29, Steps: 69 | Train Loss: 0.0234588  Vali Loss: 0.0639162 Vali Accuracy: 0.9799176  Vali weighted F1: 0.9799494  Vali macro F1 0.9730836 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 6.250329494476318
VALI: Epoch: 30, Steps: 69 | Train Loss: 0.0243745  Vali Loss: 0.0629291 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9804501  Vali macro F1 0.9739797 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 31 cost time: 6.257657289505005
VALI: Epoch: 31, Steps: 69 | Train Loss: 0.0235164  Vali Loss: 0.0625738 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9809492  Vali macro F1 0.9744450 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 32 cost time: 6.2640061378479
VALI: Epoch: 32, Steps: 69 | Train Loss: 0.0202324  Vali Loss: 0.0623673 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9804380  Vali macro F1 0.9735504 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 6.2463788986206055
VALI: Epoch: 33, Steps: 69 | Train Loss: 0.0213676  Vali Loss: 0.0620680 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9804380  Vali macro F1 0.9735504 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 6.256134510040283
VALI: Epoch: 34, Steps: 69 | Train Loss: 0.0209444  Vali Loss: 0.0619953 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9804380  Vali macro F1 0.9735504 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 35 cost time: 6.265541315078735
VALI: Epoch: 35, Steps: 69 | Train Loss: 0.0216350  Vali Loss: 0.0620024 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9804380  Vali macro F1 0.9735504 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 36 cost time: 6.2462499141693115
VALI: Epoch: 36, Steps: 69 | Train Loss: 0.0218021  Vali Loss: 0.0619561 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9809634  Vali macro F1 0.9741711 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9526555  Test weighted F1: 0.9526548  Test macro F1 0.9386802 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 240495
pruned model Parameter : 244174
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.265016555786133
Fine Tuning VALI: Epoch: 1, Steps: 69 | Train Loss: 0.0432466  Vali Loss: 0.0594648 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9809511  Vali macro F1 0.9737344 
Validation loss decreased (inf --> 0.059465).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.253373146057129
Fine Tuning VALI: Epoch: 2, Steps: 69 | Train Loss: 0.0363717  Vali Loss: 0.0591838 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9804452  Vali macro F1 0.9732163 
new best score!!!!
Validation loss decreased (0.059465 --> 0.059184).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.236379623413086
Fine Tuning VALI: Epoch: 3, Steps: 69 | Train Loss: 0.0381040  Vali Loss: 0.0583215 Vali Accuracy: 0.9819773  Vali weighted F1: 0.9820258  Vali macro F1 0.9752380 
new best score!!!!
Validation loss decreased (0.059184 --> 0.058322).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.234118223190308
Fine Tuning VALI: Epoch: 4, Steps: 69 | Train Loss: 0.0341595  Vali Loss: 0.0580470 Vali Accuracy: 0.9819773  Vali weighted F1: 0.9819872  Vali macro F1 0.9755847 
new best score!!!!
Validation loss decreased (0.058322 --> 0.058047).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.264512300491333
Fine Tuning VALI: Epoch: 5, Steps: 69 | Train Loss: 0.0333124  Vali Loss: 0.0566930 Vali Accuracy: 0.9819773  Vali weighted F1: 0.9819215  Vali macro F1 0.9751361 
new best score!!!!
Validation loss decreased (0.058047 --> 0.056693).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.238863229751587
Fine Tuning VALI: Epoch: 6, Steps: 69 | Train Loss: 0.0331528  Vali Loss: 0.0579446 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9809565  Vali macro F1 0.9742003 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.259990692138672
Fine Tuning VALI: Epoch: 7, Steps: 69 | Train Loss: 0.0319904  Vali Loss: 0.0555536 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9825482  Vali macro F1 0.9762958 
new best score!!!!
Validation loss decreased (0.056693 --> 0.055554).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 6.247173309326172
Fine Tuning VALI: Epoch: 8, Steps: 69 | Train Loss: 0.0311261  Vali Loss: 0.0575367 Vali Accuracy: 0.9819773  Vali weighted F1: 0.9819253  Vali macro F1 0.9755767 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.260177850723267
Fine Tuning VALI: Epoch: 9, Steps: 69 | Train Loss: 0.0300895  Vali Loss: 0.0586606 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9804829  Vali macro F1 0.9730282 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 6.251354932785034
Fine Tuning VALI: Epoch: 10, Steps: 69 | Train Loss: 0.0316528  Vali Loss: 0.0601128 Vali Accuracy: 0.9799176  Vali weighted F1: 0.9799417  Vali macro F1 0.9728103 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 6.249385118484497
Fine Tuning VALI: Epoch: 11, Steps: 69 | Train Loss: 0.0286829  Vali Loss: 0.0587895 Vali Accuracy: 0.9835221  Vali weighted F1: 0.9835588  Vali macro F1 0.9779859 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 6.250046014785767
Fine Tuning VALI: Epoch: 12, Steps: 69 | Train Loss: 0.0273920  Vali Loss: 0.0575812 Vali Accuracy: 0.9819773  Vali weighted F1: 0.9819970  Vali macro F1 0.9759942 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 13 cost time: 6.247330665588379
Fine Tuning VALI: Epoch: 13, Steps: 69 | Train Loss: 0.0273061  Vali Loss: 0.0577050 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9814867  Vali macro F1 0.9751229 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.253772258758545
Fine Tuning VALI: Epoch: 14, Steps: 69 | Train Loss: 0.0268142  Vali Loss: 0.0585884 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9815238  Vali macro F1 0.9751813 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.256996154785156
Fine Tuning VALI: Epoch: 15, Steps: 69 | Train Loss: 0.0255582  Vali Loss: 0.0621877 Vali Accuracy: 0.9819773  Vali weighted F1: 0.9819315  Vali macro F1 0.9757926 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.2567548751831055
Fine Tuning VALI: Epoch: 16, Steps: 69 | Train Loss: 0.0258123  Vali Loss: 0.0613782 Vali Accuracy: 0.9799176  Vali weighted F1: 0.9798569  Vali macro F1 0.9732746 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 6.246541738510132
Fine Tuning VALI: Epoch: 17, Steps: 69 | Train Loss: 0.0249572  Vali Loss: 0.0587245 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9815259  Vali macro F1 0.9747144 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 18 cost time: 6.260062217712402
Fine Tuning VALI: Epoch: 18, Steps: 69 | Train Loss: 0.0232665  Vali Loss: 0.0567672 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9825151  Vali macro F1 0.9758602 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 6.254222393035889
Fine Tuning VALI: Epoch: 19, Steps: 69 | Train Loss: 0.0234610  Vali Loss: 0.0568709 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9824905  Vali macro F1 0.9761919 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 6.235100507736206
Fine Tuning VALI: Epoch: 20, Steps: 69 | Train Loss: 0.0214145  Vali Loss: 0.0568488 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9825030  Vali macro F1 0.9761377 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 6.2397215366363525
Fine Tuning VALI: Epoch: 21, Steps: 69 | Train Loss: 0.0222083  Vali Loss: 0.0572216 Vali Accuracy: 0.9830072  Vali weighted F1: 0.9830241  Vali macro F1 0.9767498 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 6.248129844665527
Fine Tuning VALI: Epoch: 22, Steps: 69 | Train Loss: 0.0214332  Vali Loss: 0.0571054 Vali Accuracy: 0.9830072  Vali weighted F1: 0.9830168  Vali macro F1 0.9767454 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9584213  Test weighted F1: 0.9577671  Test macro F1 0.9441108 
================ the 4 th CV Experiment ================ 
Leave one Out Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.00015069 0.00018522 0.00137552 0.001443   0.00053476 0.00064267]
Train data number :  16881
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1876
Test data number :  15610
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.021517992019653
VALI: Epoch: 1, Steps: 66 | Train Loss: 1.0444845  Vali Loss: 0.6617838 Vali Accuracy: 0.7670576  Vali weighted F1: 0.7065175  Vali macro F1 0.4872099 
Validation loss decreased (inf --> 0.661784).  Saving model ...
Epoch: 2 cost time: 6.020514011383057
VALI: Epoch: 2, Steps: 66 | Train Loss: 0.5309868  Vali Loss: 0.4411824 Vali Accuracy: 0.8470149  Vali weighted F1: 0.8304233  Vali macro F1 0.7830709 
new best score!!!!
Validation loss decreased (0.661784 --> 0.441182).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.039820432662964
VALI: Epoch: 3, Steps: 66 | Train Loss: 0.3762508  Vali Loss: 0.3284131 Vali Accuracy: 0.8789979  Vali weighted F1: 0.8716476  Vali macro F1 0.8399783 
new best score!!!!
Validation loss decreased (0.441182 --> 0.328413).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.012980937957764
VALI: Epoch: 4, Steps: 66 | Train Loss: 0.2931451  Vali Loss: 0.2724899 Vali Accuracy: 0.9019190  Vali weighted F1: 0.8969964  Vali macro F1 0.8741055 
new best score!!!!
Validation loss decreased (0.328413 --> 0.272490).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.014123201370239
VALI: Epoch: 5, Steps: 66 | Train Loss: 0.2562589  Vali Loss: 0.2679341 Vali Accuracy: 0.9115139  Vali weighted F1: 0.9062693  Vali macro F1 0.8906001 
new best score!!!!
Validation loss decreased (0.272490 --> 0.267934).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.02390718460083
VALI: Epoch: 6, Steps: 66 | Train Loss: 0.2090426  Vali Loss: 0.2238186 Vali Accuracy: 0.9280384  Vali weighted F1: 0.9258446  Vali macro F1 0.9116786 
new best score!!!!
Validation loss decreased (0.267934 --> 0.223819).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.03286075592041
VALI: Epoch: 7, Steps: 66 | Train Loss: 0.1854195  Vali Loss: 0.1906802 Vali Accuracy: 0.9381663  Vali weighted F1: 0.9370597  Vali macro F1 0.9263223 
new best score!!!!
Validation loss decreased (0.223819 --> 0.190680).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.040883541107178
VALI: Epoch: 8, Steps: 66 | Train Loss: 0.1622624  Vali Loss: 0.1612671 Vali Accuracy: 0.9472281  Vali weighted F1: 0.9470102  Vali macro F1 0.9362981 
new best score!!!!
Validation loss decreased (0.190680 --> 0.161267).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.027581214904785
VALI: Epoch: 9, Steps: 66 | Train Loss: 0.1475161  Vali Loss: 0.1571133 Vali Accuracy: 0.9530917  Vali weighted F1: 0.9527863  Vali macro F1 0.9425308 
new best score!!!!
Validation loss decreased (0.161267 --> 0.157113).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.038363218307495
VALI: Epoch: 10, Steps: 66 | Train Loss: 0.1397729  Vali Loss: 0.1397734 Vali Accuracy: 0.9546908  Vali weighted F1: 0.9542525  Vali macro F1 0.9421316 
new best score!!!!
Validation loss decreased (0.157113 --> 0.139773).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.036182880401611
VALI: Epoch: 11, Steps: 66 | Train Loss: 0.1341060  Vali Loss: 0.1427409 Vali Accuracy: 0.9573561  Vali weighted F1: 0.9563851  Vali macro F1 0.9459318 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 6.029492139816284
VALI: Epoch: 12, Steps: 66 | Train Loss: 0.1266283  Vali Loss: 0.1381207 Vali Accuracy: 0.9573561  Vali weighted F1: 0.9565348  Vali macro F1 0.9467420 
new best score!!!!
Validation loss decreased (0.139773 --> 0.138121).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.030643463134766
VALI: Epoch: 13, Steps: 66 | Train Loss: 0.1044999  Vali Loss: 0.1291133 Vali Accuracy: 0.9648188  Vali weighted F1: 0.9645862  Vali macro F1 0.9551436 
new best score!!!!
Validation loss decreased (0.138121 --> 0.129113).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.027456283569336
VALI: Epoch: 14, Steps: 66 | Train Loss: 0.1076242  Vali Loss: 0.1352843 Vali Accuracy: 0.9584222  Vali weighted F1: 0.9582471  Vali macro F1 0.9495978 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.022676229476929
VALI: Epoch: 15, Steps: 66 | Train Loss: 0.1010324  Vali Loss: 0.1177733 Vali Accuracy: 0.9642857  Vali weighted F1: 0.9641506  Vali macro F1 0.9544296 
new best score!!!!
Validation loss decreased (0.129113 --> 0.117773).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.016537427902222
VALI: Epoch: 16, Steps: 66 | Train Loss: 0.0892310  Vali Loss: 0.1259936 Vali Accuracy: 0.9637527  Vali weighted F1: 0.9637606  Vali macro F1 0.9429371 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 6.03639554977417
VALI: Epoch: 17, Steps: 66 | Train Loss: 0.0871171  Vali Loss: 0.1081204 Vali Accuracy: 0.9712154  Vali weighted F1: 0.9711568  Vali macro F1 0.9616122 
new best score!!!!
Validation loss decreased (0.117773 --> 0.108120).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.040937900543213
VALI: Epoch: 18, Steps: 66 | Train Loss: 0.0785205  Vali Loss: 0.0959745 Vali Accuracy: 0.9680171  Vali weighted F1: 0.9676521  Vali macro F1 0.9493098 
new best score!!!!
Validation loss decreased (0.108120 --> 0.095974).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.022953271865845
VALI: Epoch: 19, Steps: 66 | Train Loss: 0.0797567  Vali Loss: 0.1148402 Vali Accuracy: 0.9658849  Vali weighted F1: 0.9656012  Vali macro F1 0.9558891 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 6.024075031280518
VALI: Epoch: 20, Steps: 66 | Train Loss: 0.0754865  Vali Loss: 0.1078587 Vali Accuracy: 0.9616205  Vali weighted F1: 0.9610971  Vali macro F1 0.9424525 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 6.0218260288238525
VALI: Epoch: 21, Steps: 66 | Train Loss: 0.0693509  Vali Loss: 0.1084039 Vali Accuracy: 0.9674840  Vali weighted F1: 0.9670390  Vali macro F1 0.9489227 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 22 cost time: 6.031069278717041
VALI: Epoch: 22, Steps: 66 | Train Loss: 0.0573678  Vali Loss: 0.0858172 Vali Accuracy: 0.9781450  Vali weighted F1: 0.9779731  Vali macro F1 0.9720609 
new best score!!!!
Validation loss decreased (0.095974 --> 0.085817).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.026709318161011
VALI: Epoch: 23, Steps: 66 | Train Loss: 0.0569688  Vali Loss: 0.0918442 Vali Accuracy: 0.9749467  Vali weighted F1: 0.9749176  Vali macro F1 0.9693443 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 6.023501873016357
VALI: Epoch: 24, Steps: 66 | Train Loss: 0.0527198  Vali Loss: 0.0772706 Vali Accuracy: 0.9786780  Vali weighted F1: 0.9785364  Vali macro F1 0.9703889 
new best score!!!!
Validation loss decreased (0.085817 --> 0.077271).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.0368428230285645
VALI: Epoch: 25, Steps: 66 | Train Loss: 0.0505620  Vali Loss: 0.0851753 Vali Accuracy: 0.9770789  Vali weighted F1: 0.9771882  Vali macro F1 0.9698769 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 6.022869825363159
VALI: Epoch: 26, Steps: 66 | Train Loss: 0.0514528  Vali Loss: 0.1223029 Vali Accuracy: 0.9674840  Vali weighted F1: 0.9669896  Vali macro F1 0.9592794 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 6.027394533157349
VALI: Epoch: 27, Steps: 66 | Train Loss: 0.0521175  Vali Loss: 0.1241735 Vali Accuracy: 0.9664179  Vali weighted F1: 0.9655322  Vali macro F1 0.9589485 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 28 cost time: 6.028477191925049
VALI: Epoch: 28, Steps: 66 | Train Loss: 0.0475435  Vali Loss: 0.0809331 Vali Accuracy: 0.9760128  Vali weighted F1: 0.9758929  Vali macro F1 0.9694389 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 29 cost time: 6.021621942520142
VALI: Epoch: 29, Steps: 66 | Train Loss: 0.0481737  Vali Loss: 0.0954107 Vali Accuracy: 0.9744136  Vali weighted F1: 0.9744348  Vali macro F1 0.9667645 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 30 cost time: 6.029073476791382
VALI: Epoch: 30, Steps: 66 | Train Loss: 0.0345880  Vali Loss: 0.0823416 Vali Accuracy: 0.9792111  Vali weighted F1: 0.9790801  Vali macro F1 0.9711153 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 6.012112617492676
VALI: Epoch: 31, Steps: 66 | Train Loss: 0.0269690  Vali Loss: 0.0822504 Vali Accuracy: 0.9786780  Vali weighted F1: 0.9785278  Vali macro F1 0.9698623 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 6.039627552032471
VALI: Epoch: 32, Steps: 66 | Train Loss: 0.0245466  Vali Loss: 0.0847139 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9796045  Vali macro F1 0.9728833 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 6.032390117645264
VALI: Epoch: 33, Steps: 66 | Train Loss: 0.0234742  Vali Loss: 0.0846049 Vali Accuracy: 0.9802772  Vali weighted F1: 0.9802216  Vali macro F1 0.9742506 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 34 cost time: 6.038124322891235
VALI: Epoch: 34, Steps: 66 | Train Loss: 0.0248476  Vali Loss: 0.0865404 Vali Accuracy: 0.9818763  Vali weighted F1: 0.9818572  Vali macro F1 0.9761433 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 35 cost time: 6.01472806930542
VALI: Epoch: 35, Steps: 66 | Train Loss: 0.0220039  Vali Loss: 0.0847155 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9813231  Vali macro F1 0.9752943 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 6.025607109069824
VALI: Epoch: 36, Steps: 66 | Train Loss: 0.0210305  Vali Loss: 0.0849380 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9813231  Vali macro F1 0.9752943 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 6.024957180023193
VALI: Epoch: 37, Steps: 66 | Train Loss: 0.0213162  Vali Loss: 0.0831545 Vali Accuracy: 0.9824094  Vali weighted F1: 0.9823712  Vali macro F1 0.9766894 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 6.019742727279663
VALI: Epoch: 38, Steps: 66 | Train Loss: 0.0216486  Vali Loss: 0.0845283 Vali Accuracy: 0.9818763  Vali weighted F1: 0.9818379  Vali macro F1 0.9758597 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 6.03834342956543
VALI: Epoch: 39, Steps: 66 | Train Loss: 0.0222265  Vali Loss: 0.0836031 Vali Accuracy: 0.9818763  Vali weighted F1: 0.9818379  Vali macro F1 0.9758597 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9015375  Test weighted F1: 0.9054628  Test macro F1 0.8649876 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 240495
pruned model Parameter : 244174
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.0373876094818115
Fine Tuning VALI: Epoch: 1, Steps: 66 | Train Loss: 0.0366121  Vali Loss: 0.0822555 Vali Accuracy: 0.9786780  Vali weighted F1: 0.9785621  Vali macro F1 0.9727937 
Validation loss decreased (inf --> 0.082256).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.003725051879883
Fine Tuning VALI: Epoch: 2, Steps: 66 | Train Loss: 0.0348114  Vali Loss: 0.0848660 Vali Accuracy: 0.9770789  Vali weighted F1: 0.9769020  Vali macro F1 0.9703173 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.012908697128296
Fine Tuning VALI: Epoch: 3, Steps: 66 | Train Loss: 0.0349976  Vali Loss: 0.0788898 Vali Accuracy: 0.9781450  Vali weighted F1: 0.9779792  Vali macro F1 0.9719447 
new best score!!!!
Validation loss decreased (0.082256 --> 0.078890).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.018580913543701
Fine Tuning VALI: Epoch: 4, Steps: 66 | Train Loss: 0.0327839  Vali Loss: 0.0756252 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9807639  Vali macro F1 0.9749770 
new best score!!!!
Validation loss decreased (0.078890 --> 0.075625).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.027757167816162
Fine Tuning VALI: Epoch: 5, Steps: 66 | Train Loss: 0.0306123  Vali Loss: 0.0840069 Vali Accuracy: 0.9781450  Vali weighted F1: 0.9779808  Vali macro F1 0.9722059 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 6.048262596130371
Fine Tuning VALI: Epoch: 6, Steps: 66 | Train Loss: 0.0300564  Vali Loss: 0.0805832 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9812522  Vali macro F1 0.9753841 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 7 cost time: 6.043265342712402
Fine Tuning VALI: Epoch: 7, Steps: 66 | Train Loss: 0.0290867  Vali Loss: 0.0799686 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9807628  Vali macro F1 0.9750219 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 8 cost time: 6.040057182312012
Fine Tuning VALI: Epoch: 8, Steps: 66 | Train Loss: 0.0293887  Vali Loss: 0.0781592 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9813008  Vali macro F1 0.9750996 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 9 cost time: 6.028742790222168
Fine Tuning VALI: Epoch: 9, Steps: 66 | Train Loss: 0.0272604  Vali Loss: 0.0805225 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9795852  Vali macro F1 0.9738171 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 10 cost time: 6.024584531784058
Fine Tuning VALI: Epoch: 10, Steps: 66 | Train Loss: 0.0272176  Vali Loss: 0.0765803 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9806991  Vali macro F1 0.9741768 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 6.026414155960083
Fine Tuning VALI: Epoch: 11, Steps: 66 | Train Loss: 0.0259518  Vali Loss: 0.0822005 Vali Accuracy: 0.9792111  Vali weighted F1: 0.9789859  Vali macro F1 0.9736119 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 6.02789306640625
Fine Tuning VALI: Epoch: 12, Steps: 66 | Train Loss: 0.0255014  Vali Loss: 0.0780838 Vali Accuracy: 0.9818763  Vali weighted F1: 0.9817577  Vali macro F1 0.9762047 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 6.026364088058472
Fine Tuning VALI: Epoch: 13, Steps: 66 | Train Loss: 0.0258301  Vali Loss: 0.0798849 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9812387  Vali macro F1 0.9756974 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 14 cost time: 6.037158489227295
Fine Tuning VALI: Epoch: 14, Steps: 66 | Train Loss: 0.0247862  Vali Loss: 0.0847041 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9795817  Vali macro F1 0.9741985 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 15 cost time: 6.039923906326294
Fine Tuning VALI: Epoch: 15, Steps: 66 | Train Loss: 0.0235673  Vali Loss: 0.0817015 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9812160  Vali macro F1 0.9762355 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.0152058601379395
Fine Tuning VALI: Epoch: 16, Steps: 66 | Train Loss: 0.0223996  Vali Loss: 0.0786659 Vali Accuracy: 0.9818763  Vali weighted F1: 0.9817606  Vali macro F1 0.9761620 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 6.009796142578125
Fine Tuning VALI: Epoch: 17, Steps: 66 | Train Loss: 0.0215316  Vali Loss: 0.0793415 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9806591  Vali macro F1 0.9750219 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 6.014718294143677
Fine Tuning VALI: Epoch: 18, Steps: 66 | Train Loss: 0.0215059  Vali Loss: 0.0796636 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9812220  Vali macro F1 0.9753239 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 6.013960361480713
Fine Tuning VALI: Epoch: 19, Steps: 66 | Train Loss: 0.0212849  Vali Loss: 0.0783696 Vali Accuracy: 0.9829424  Vali weighted F1: 0.9828482  Vali macro F1 0.9775207 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9026906  Test weighted F1: 0.9066741  Test macro F1 0.8672624 
================ the 5 th CV Experiment ================ 
Leave one Out Experiment : The 6 Part as the test
[-] Target sampling weights:  [0.00014231 0.00018433 0.00095329 0.00125471 0.00053248 0.00064185]
Train data number :  17734
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1971
Test data number :  10878
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.373697280883789
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.0186656  Vali Loss: 0.6374453 Vali Accuracy: 0.7579909  Vali weighted F1: 0.7114163  Vali macro F1 0.5043364 
Validation loss decreased (inf --> 0.637445).  Saving model ...
Epoch: 2 cost time: 6.323691368103027
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.4888975  Vali Loss: 0.4020749 Vali Accuracy: 0.8584475  Vali weighted F1: 0.8424353  Vali macro F1 0.7942303 
new best score!!!!
Validation loss decreased (0.637445 --> 0.402075).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.319140911102295
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.3331955  Vali Loss: 0.3039457 Vali Accuracy: 0.8954845  Vali weighted F1: 0.8920014  Vali macro F1 0.8650508 
new best score!!!!
Validation loss decreased (0.402075 --> 0.303946).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.320931434631348
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.2577762  Vali Loss: 0.2367599 Vali Accuracy: 0.9193303  Vali weighted F1: 0.9194868  Vali macro F1 0.8939033 
new best score!!!!
Validation loss decreased (0.303946 --> 0.236760).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.319651126861572
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.2239599  Vali Loss: 0.2142141 Vali Accuracy: 0.9279554  Vali weighted F1: 0.9272018  Vali macro F1 0.9088424 
new best score!!!!
Validation loss decreased (0.236760 --> 0.214214).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.32197904586792
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.1800918  Vali Loss: 0.2353638 Vali Accuracy: 0.9208524  Vali weighted F1: 0.9195845  Vali macro F1 0.8964860 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 7 cost time: 6.3490447998046875
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.1594664  Vali Loss: 0.1672176 Vali Accuracy: 0.9401319  Vali weighted F1: 0.9407955  Vali macro F1 0.9179730 
new best score!!!!
Validation loss decreased (0.214214 --> 0.167218).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.335903882980347
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1440584  Vali Loss: 0.1433799 Vali Accuracy: 0.9523085  Vali weighted F1: 0.9520224  Vali macro F1 0.9349632 
new best score!!!!
Validation loss decreased (0.167218 --> 0.143380).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.330353260040283
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1220870  Vali Loss: 0.1328964 Vali Accuracy: 0.9568747  Vali weighted F1: 0.9576111  Vali macro F1 0.9390205 
new best score!!!!
Validation loss decreased (0.143380 --> 0.132896).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.335090637207031
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1121424  Vali Loss: 0.1224877 Vali Accuracy: 0.9553526  Vali weighted F1: 0.9562484  Vali macro F1 0.9414534 
new best score!!!!
Validation loss decreased (0.132896 --> 0.122488).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.324710369110107
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1033007  Vali Loss: 0.1173868 Vali Accuracy: 0.9594115  Vali weighted F1: 0.9591826  Vali macro F1 0.9444717 
new best score!!!!
Validation loss decreased (0.122488 --> 0.117387).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.330073118209839
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0949964  Vali Loss: 0.1124327 Vali Accuracy: 0.9578894  Vali weighted F1: 0.9582096  Vali macro F1 0.9398506 
new best score!!!!
Validation loss decreased (0.117387 --> 0.112433).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.328169822692871
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0855740  Vali Loss: 0.1026869 Vali Accuracy: 0.9609335  Vali weighted F1: 0.9610519  Vali macro F1 0.9474512 
new best score!!!!
Validation loss decreased (0.112433 --> 0.102687).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.342599153518677
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0823844  Vali Loss: 0.1047228 Vali Accuracy: 0.9624556  Vali weighted F1: 0.9628643  Vali macro F1 0.9481030 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.341219902038574
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0804874  Vali Loss: 0.0961299 Vali Accuracy: 0.9624556  Vali weighted F1: 0.9627680  Vali macro F1 0.9446867 
new best score!!!!
Validation loss decreased (0.102687 --> 0.096130).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.334049224853516
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0682619  Vali Loss: 0.1221221 Vali Accuracy: 0.9619482  Vali weighted F1: 0.9618407  Vali macro F1 0.9495081 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 6.335393190383911
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0675962  Vali Loss: 0.0822498 Vali Accuracy: 0.9710807  Vali weighted F1: 0.9714476  Vali macro F1 0.9610638 
new best score!!!!
Validation loss decreased (0.096130 --> 0.082250).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.31870698928833
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0629492  Vali Loss: 0.1199041 Vali Accuracy: 0.9583968  Vali weighted F1: 0.9590535  Vali macro F1 0.9430672 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.327578544616699
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0587941  Vali Loss: 0.0866141 Vali Accuracy: 0.9705733  Vali weighted F1: 0.9704875  Vali macro F1 0.9608741 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 6.3288843631744385
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0560824  Vali Loss: 0.1050037 Vali Accuracy: 0.9654997  Vali weighted F1: 0.9660105  Vali macro F1 0.9508287 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 21 cost time: 6.343554735183716
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0533926  Vali Loss: 0.0720143 Vali Accuracy: 0.9766616  Vali weighted F1: 0.9767270  Vali macro F1 0.9696509 
new best score!!!!
Validation loss decreased (0.082250 --> 0.072014).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.340826749801636
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0435140  Vali Loss: 0.0738162 Vali Accuracy: 0.9756469  Vali weighted F1: 0.9756132  Vali macro F1 0.9675560 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.333239793777466
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0446972  Vali Loss: 0.0835861 Vali Accuracy: 0.9741248  Vali weighted F1: 0.9746603  Vali macro F1 0.9680488 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 6.33480167388916
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0385880  Vali Loss: 0.0730404 Vali Accuracy: 0.9761542  Vali weighted F1: 0.9763141  Vali macro F1 0.9684542 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 25 cost time: 6.326408624649048
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0376835  Vali Loss: 0.0905011 Vali Accuracy: 0.9685439  Vali weighted F1: 0.9682527  Vali macro F1 0.9587581 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 26 cost time: 6.328600645065308
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0469274  Vali Loss: 0.0698256 Vali Accuracy: 0.9761542  Vali weighted F1: 0.9762483  Vali macro F1 0.9658515 
new best score!!!!
Validation loss decreased (0.072014 --> 0.069826).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.320836067199707
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0347821  Vali Loss: 0.1605949 Vali Accuracy: 0.9477423  Vali weighted F1: 0.9480480  Vali macro F1 0.9382751 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.351636171340942
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0367215  Vali Loss: 0.0757936 Vali Accuracy: 0.9746322  Vali weighted F1: 0.9748322  Vali macro F1 0.9632893 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 6.3547022342681885
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0306080  Vali Loss: 0.0618175 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9782684  Vali macro F1 0.9684699 
new best score!!!!
Validation loss decreased (0.069826 --> 0.061817).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.3424232006073
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0292743  Vali Loss: 0.0683572 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9777979  Vali macro F1 0.9677238 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 6.341513395309448
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0219570  Vali Loss: 0.0795303 Vali Accuracy: 0.9766616  Vali weighted F1: 0.9766692  Vali macro F1 0.9677189 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 6.333433151245117
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0242563  Vali Loss: 0.0786034 Vali Accuracy: 0.9756469  Vali weighted F1: 0.9755240  Vali macro F1 0.9661508 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 6.324061393737793
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0275208  Vali Loss: 0.0742105 Vali Accuracy: 0.9756469  Vali weighted F1: 0.9759333  Vali macro F1 0.9641851 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 34 cost time: 6.331982135772705
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0202709  Vali Loss: 0.1142686 Vali Accuracy: 0.9690512  Vali weighted F1: 0.9686105  Vali macro F1 0.9575307 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 35 cost time: 6.352078437805176
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0169288  Vali Loss: 0.0638684 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802906  Vali macro F1 0.9720236 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 6.373177528381348
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0112908  Vali Loss: 0.0599854 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9838043  Vali macro F1 0.9775269 
new best score!!!!
Validation loss decreased (0.061817 --> 0.059985).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.340991973876953
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0105819  Vali Loss: 0.0598909 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827826  Vali macro F1 0.9758584 
new best score!!!!
Validation loss decreased (0.059985 --> 0.059891).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 6.343803882598877
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0105929  Vali Loss: 0.0593481 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9833056  Vali macro F1 0.9770200 
new best score!!!!
Validation loss decreased (0.059891 --> 0.059348).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 6.341172933578491
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0096755  Vali Loss: 0.0610643 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827954  Vali macro F1 0.9767423 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 6.340081691741943
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0090083  Vali Loss: 0.0621906 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837862  Vali macro F1 0.9775270 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 6.324582099914551
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0090802  Vali Loss: 0.0629906 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832789  Vali macro F1 0.9763120 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 6.360376596450806
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0087176  Vali Loss: 0.0638047 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832791  Vali macro F1 0.9763186 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 6.358902215957642
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0091225  Vali Loss: 0.0636351 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9817802  Vali macro F1 0.9745092 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 44 cost time: 6.331679344177246
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0085876  Vali Loss: 0.0626028 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9822913  Vali macro F1 0.9750157 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 6.3406593799591064
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0083781  Vali Loss: 0.0619950 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832962  Vali macro F1 0.9766901 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 6.326995849609375
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0089826  Vali Loss: 0.0620487 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832962  Vali macro F1 0.9766901 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 6.3249900341033936
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0081010  Vali Loss: 0.0616351 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832962  Vali macro F1 0.9766901 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 6.346523761749268
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0079635  Vali Loss: 0.0616290 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827969  Vali macro F1 0.9761525 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 49 cost time: 6.360682487487793
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0080347  Vali Loss: 0.0616201 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827969  Vali macro F1 0.9761525 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 6.347806453704834
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0085601  Vali Loss: 0.0615724 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827969  Vali macro F1 0.9761525 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 6.346491813659668
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0081951  Vali Loss: 0.0616185 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9822985  Vali macro F1 0.9756171 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 6.343388557434082
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0080281  Vali Loss: 0.0616545 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827969  Vali macro F1 0.9761525 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 6.342025995254517
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0077163  Vali Loss: 0.0616036 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827969  Vali macro F1 0.9761525 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9184593  Test weighted F1: 0.9159835  Test macro F1 0.9147190 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 240495
pruned model Parameter : 244174
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.334733247756958
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0119039  Vali Loss: 0.0599097 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9823087  Vali macro F1 0.9752923 
Validation loss decreased (inf --> 0.059910).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.33701753616333
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0090092  Vali Loss: 0.0647485 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9822491  Vali macro F1 0.9744175 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.350453615188599
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0092826  Vali Loss: 0.0617317 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9807357  Vali macro F1 0.9723057 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.314408302307129
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0097720  Vali Loss: 0.0668031 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802539  Vali macro F1 0.9727760 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.324840784072876
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0096563  Vali Loss: 0.0616823 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9807497  Vali macro F1 0.9726640 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.329429388046265
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0083423  Vali Loss: 0.0662228 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9817513  Vali macro F1 0.9742185 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.323364734649658
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0084111  Vali Loss: 0.0621913 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9817521  Vali macro F1 0.9746625 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.325556755065918
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0081668  Vali Loss: 0.0629923 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802626  Vali macro F1 0.9718867 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.352938652038574
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0074354  Vali Loss: 0.0633887 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9822671  Vali macro F1 0.9751453 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.353098392486572
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0081252  Vali Loss: 0.0631520 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9817813  Vali macro F1 0.9746759 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 11 cost time: 6.326420783996582
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0072047  Vali Loss: 0.0633939 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9812536  Vali macro F1 0.9740321 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.328752756118774
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0068604  Vali Loss: 0.0635674 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9812536  Vali macro F1 0.9740321 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.323108911514282
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0067122  Vali Loss: 0.0632258 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9817594  Vali macro F1 0.9748710 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.328258991241455
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0065112  Vali Loss: 0.0632070 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9817594  Vali macro F1 0.9748710 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.336813449859619
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0060932  Vali Loss: 0.0636384 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9817719  Vali macro F1 0.9746094 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 16 cost time: 6.339497327804565
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0067389  Vali Loss: 0.0635666 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9817719  Vali macro F1 0.9746094 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9177238  Test weighted F1: 0.9159081  Test macro F1 0.9138875 
================ the 6 th CV Experiment ================ 
Leave one Out Experiment : The 7 Part as the test
[-] Target sampling weights:  [0.00014215 0.00017848 0.00096525 0.00123916 0.0004771  0.00060096]
Train data number :  18241
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2027
Test data number :  8061
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.4984636306762695
VALI: Epoch: 1, Steps: 72 | Train Loss: 1.0146792  Vali Loss: 0.6299998 Vali Accuracy: 0.7661569  Vali weighted F1: 0.7131666  Vali macro F1 0.5049563 
Validation loss decreased (inf --> 0.630000).  Saving model ...
Epoch: 2 cost time: 6.511910438537598
VALI: Epoch: 2, Steps: 72 | Train Loss: 0.5263349  Vali Loss: 0.3861138 Vali Accuracy: 0.8598915  Vali weighted F1: 0.8426730  Vali macro F1 0.7917053 
new best score!!!!
Validation loss decreased (0.630000 --> 0.386114).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.488440752029419
VALI: Epoch: 3, Steps: 72 | Train Loss: 0.3538923  Vali Loss: 0.3012925 Vali Accuracy: 0.8914652  Vali weighted F1: 0.8849597  Vali macro F1 0.8547820 
new best score!!!!
Validation loss decreased (0.386114 --> 0.301292).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.4903740882873535
VALI: Epoch: 4, Steps: 72 | Train Loss: 0.2813773  Vali Loss: 0.2156187 Vali Accuracy: 0.9264924  Vali weighted F1: 0.9255105  Vali macro F1 0.9058383 
new best score!!!!
Validation loss decreased (0.301292 --> 0.215619).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.520512819290161
VALI: Epoch: 5, Steps: 72 | Train Loss: 0.2189500  Vali Loss: 0.1753240 Vali Accuracy: 0.9407992  Vali weighted F1: 0.9403766  Vali macro F1 0.9226564 
new best score!!!!
Validation loss decreased (0.215619 --> 0.175324).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.530293941497803
VALI: Epoch: 6, Steps: 72 | Train Loss: 0.1867897  Vali Loss: 0.1547495 Vali Accuracy: 0.9511593  Vali weighted F1: 0.9518861  Vali macro F1 0.9374556 
new best score!!!!
Validation loss decreased (0.175324 --> 0.154749).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.5208213329315186
VALI: Epoch: 7, Steps: 72 | Train Loss: 0.1694281  Vali Loss: 0.1600170 Vali Accuracy: 0.9481993  Vali weighted F1: 0.9496369  Vali macro F1 0.9350223 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 8 cost time: 6.506999492645264
VALI: Epoch: 8, Steps: 72 | Train Loss: 0.1467818  Vali Loss: 0.1251106 Vali Accuracy: 0.9615195  Vali weighted F1: 0.9618312  Vali macro F1 0.9512133 
new best score!!!!
Validation loss decreased (0.154749 --> 0.125111).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.51073431968689
VALI: Epoch: 9, Steps: 72 | Train Loss: 0.1340719  Vali Loss: 0.1252289 Vali Accuracy: 0.9590528  Vali weighted F1: 0.9589211  Vali macro F1 0.9449503 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 6.5174031257629395
VALI: Epoch: 10, Steps: 72 | Train Loss: 0.1259868  Vali Loss: 0.1279085 Vali Accuracy: 0.9590528  Vali weighted F1: 0.9598545  Vali macro F1 0.9498072 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 11 cost time: 6.503539800643921
VALI: Epoch: 11, Steps: 72 | Train Loss: 0.1159870  Vali Loss: 0.1000258 Vali Accuracy: 0.9694129  Vali weighted F1: 0.9696362  Vali macro F1 0.9613003 
new best score!!!!
Validation loss decreased (0.125111 --> 0.100026).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.52480411529541
VALI: Epoch: 12, Steps: 72 | Train Loss: 0.1029728  Vali Loss: 0.0908377 Vali Accuracy: 0.9738530  Vali weighted F1: 0.9741953  Vali macro F1 0.9659356 
new best score!!!!
Validation loss decreased (0.100026 --> 0.090838).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.498364448547363
VALI: Epoch: 13, Steps: 72 | Train Loss: 0.0985303  Vali Loss: 0.0852728 Vali Accuracy: 0.9708929  Vali weighted F1: 0.9710923  Vali macro F1 0.9617290 
new best score!!!!
Validation loss decreased (0.090838 --> 0.085273).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.505502462387085
VALI: Epoch: 14, Steps: 72 | Train Loss: 0.0901200  Vali Loss: 0.0950405 Vali Accuracy: 0.9644795  Vali weighted F1: 0.9651607  Vali macro F1 0.9512552 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.513988971710205
VALI: Epoch: 15, Steps: 72 | Train Loss: 0.0848768  Vali Loss: 0.0848421 Vali Accuracy: 0.9738530  Vali weighted F1: 0.9742465  Vali macro F1 0.9652351 
new best score!!!!
Validation loss decreased (0.085273 --> 0.084842).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.517354965209961
VALI: Epoch: 16, Steps: 72 | Train Loss: 0.0829430  Vali Loss: 0.0732250 Vali Accuracy: 0.9768130  Vali weighted F1: 0.9770099  Vali macro F1 0.9693326 
new best score!!!!
Validation loss decreased (0.084842 --> 0.073225).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.51788854598999
VALI: Epoch: 17, Steps: 72 | Train Loss: 0.0761655  Vali Loss: 0.0686173 Vali Accuracy: 0.9812531  Vali weighted F1: 0.9812853  Vali macro F1 0.9740784 
new best score!!!!
Validation loss decreased (0.073225 --> 0.068617).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.527045965194702
VALI: Epoch: 18, Steps: 72 | Train Loss: 0.0689993  Vali Loss: 0.0704584 Vali Accuracy: 0.9787864  Vali weighted F1: 0.9789089  Vali macro F1 0.9695306 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.519888639450073
VALI: Epoch: 19, Steps: 72 | Train Loss: 0.0659849  Vali Loss: 0.0629837 Vali Accuracy: 0.9802664  Vali weighted F1: 0.9804660  Vali macro F1 0.9732586 
new best score!!!!
Validation loss decreased (0.068617 --> 0.062984).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.509450912475586
VALI: Epoch: 20, Steps: 72 | Train Loss: 0.0604584  Vali Loss: 0.0574650 Vali Accuracy: 0.9817464  Vali weighted F1: 0.9818352  Vali macro F1 0.9734520 
new best score!!!!
Validation loss decreased (0.062984 --> 0.057465).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.508363962173462
VALI: Epoch: 21, Steps: 72 | Train Loss: 0.0512798  Vali Loss: 0.0615342 Vali Accuracy: 0.9782930  Vali weighted F1: 0.9782455  Vali macro F1 0.9696467 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 6.49313497543335
VALI: Epoch: 22, Steps: 72 | Train Loss: 0.0652856  Vali Loss: 0.0570060 Vali Accuracy: 0.9802664  Vali weighted F1: 0.9802938  Vali macro F1 0.9724062 
new best score!!!!
Validation loss decreased (0.057465 --> 0.057006).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.5034966468811035
VALI: Epoch: 23, Steps: 72 | Train Loss: 0.0521752  Vali Loss: 0.0714602 Vali Accuracy: 0.9787864  Vali weighted F1: 0.9791084  Vali macro F1 0.9703745 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 6.52325963973999
VALI: Epoch: 24, Steps: 72 | Train Loss: 0.0445612  Vali Loss: 0.0520394 Vali Accuracy: 0.9847065  Vali weighted F1: 0.9847100  Vali macro F1 0.9779594 
new best score!!!!
Validation loss decreased (0.057006 --> 0.052039).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.531157493591309
VALI: Epoch: 25, Steps: 72 | Train Loss: 0.0509378  Vali Loss: 0.0546636 Vali Accuracy: 0.9847065  Vali weighted F1: 0.9848129  Vali macro F1 0.9782878 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 6.50317645072937
VALI: Epoch: 26, Steps: 72 | Train Loss: 0.0460001  Vali Loss: 0.0718355 Vali Accuracy: 0.9758263  Vali weighted F1: 0.9754912  Vali macro F1 0.9660510 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 6.490983009338379
VALI: Epoch: 27, Steps: 72 | Train Loss: 0.0423929  Vali Loss: 0.0576727 Vali Accuracy: 0.9802664  Vali weighted F1: 0.9804269  Vali macro F1 0.9723955 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 28 cost time: 6.4985573291778564
VALI: Epoch: 28, Steps: 72 | Train Loss: 0.0399729  Vali Loss: 0.0532680 Vali Accuracy: 0.9832264  Vali weighted F1: 0.9833949  Vali macro F1 0.9762518 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 29 cost time: 6.503464698791504
VALI: Epoch: 29, Steps: 72 | Train Loss: 0.0406110  Vali Loss: 0.0473557 Vali Accuracy: 0.9871732  Vali weighted F1: 0.9872117  Vali macro F1 0.9822074 
new best score!!!!
Validation loss decreased (0.052039 --> 0.047356).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.512165546417236
VALI: Epoch: 30, Steps: 72 | Train Loss: 0.0292816  Vali Loss: 0.0409758 Vali Accuracy: 0.9871732  Vali weighted F1: 0.9871813  Vali macro F1 0.9818359 
new best score!!!!
Validation loss decreased (0.047356 --> 0.040976).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.524580955505371
VALI: Epoch: 31, Steps: 72 | Train Loss: 0.0309335  Vali Loss: 0.0412396 Vali Accuracy: 0.9851998  Vali weighted F1: 0.9851615  Vali macro F1 0.9798061 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 6.511317014694214
VALI: Epoch: 32, Steps: 72 | Train Loss: 0.0313018  Vali Loss: 0.0559455 Vali Accuracy: 0.9847065  Vali weighted F1: 0.9847616  Vali macro F1 0.9790023 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 6.5124711990356445
VALI: Epoch: 33, Steps: 72 | Train Loss: 0.0298969  Vali Loss: 0.0543444 Vali Accuracy: 0.9847065  Vali weighted F1: 0.9846994  Vali macro F1 0.9788252 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 34 cost time: 6.511143684387207
VALI: Epoch: 34, Steps: 72 | Train Loss: 0.0278528  Vali Loss: 0.0413674 Vali Accuracy: 0.9861865  Vali weighted F1: 0.9861646  Vali macro F1 0.9814695 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 35 cost time: 6.503043174743652
VALI: Epoch: 35, Steps: 72 | Train Loss: 0.0250412  Vali Loss: 0.0477416 Vali Accuracy: 0.9851998  Vali weighted F1: 0.9853266  Vali macro F1 0.9794545 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 36 cost time: 6.504876375198364
VALI: Epoch: 36, Steps: 72 | Train Loss: 0.0169018  Vali Loss: 0.0378984 Vali Accuracy: 0.9896399  Vali weighted F1: 0.9896050  Vali macro F1 0.9863420 
new best score!!!!
Validation loss decreased (0.040976 --> 0.037898).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.5151262283325195
VALI: Epoch: 37, Steps: 72 | Train Loss: 0.0149040  Vali Loss: 0.0387551 Vali Accuracy: 0.9891465  Vali weighted F1: 0.9891192  Vali macro F1 0.9857561 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 6.534409999847412
VALI: Epoch: 38, Steps: 72 | Train Loss: 0.0152346  Vali Loss: 0.0405091 Vali Accuracy: 0.9881598  Vali weighted F1: 0.9881409  Vali macro F1 0.9844581 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 6.522474527359009
VALI: Epoch: 39, Steps: 72 | Train Loss: 0.0138178  Vali Loss: 0.0397649 Vali Accuracy: 0.9886532  Vali weighted F1: 0.9886364  Vali macro F1 0.9846024 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 40 cost time: 6.5064003467559814
VALI: Epoch: 40, Steps: 72 | Train Loss: 0.0131341  Vali Loss: 0.0393649 Vali Accuracy: 0.9896399  Vali weighted F1: 0.9896220  Vali macro F1 0.9862759 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 41 cost time: 6.508179664611816
VALI: Epoch: 41, Steps: 72 | Train Loss: 0.0131176  Vali Loss: 0.0389948 Vali Accuracy: 0.9881598  Vali weighted F1: 0.9881269  Vali macro F1 0.9843041 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 42 cost time: 6.5214362144470215
VALI: Epoch: 42, Steps: 72 | Train Loss: 0.0120728  Vali Loss: 0.0392496 Vali Accuracy: 0.9886532  Vali weighted F1: 0.9886292  Vali macro F1 0.9848236 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 6.5118653774261475
VALI: Epoch: 43, Steps: 72 | Train Loss: 0.0122283  Vali Loss: 0.0392392 Vali Accuracy: 0.9886532  Vali weighted F1: 0.9886292  Vali macro F1 0.9848236 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 6.534559726715088
VALI: Epoch: 44, Steps: 72 | Train Loss: 0.0114878  Vali Loss: 0.0388798 Vali Accuracy: 0.9886532  Vali weighted F1: 0.9886292  Vali macro F1 0.9848236 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 6.511159181594849
VALI: Epoch: 45, Steps: 72 | Train Loss: 0.0120551  Vali Loss: 0.0388356 Vali Accuracy: 0.9886532  Vali weighted F1: 0.9886292  Vali macro F1 0.9848236 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 46 cost time: 6.535423517227173
VALI: Epoch: 46, Steps: 72 | Train Loss: 0.0121416  Vali Loss: 0.0390206 Vali Accuracy: 0.9886532  Vali weighted F1: 0.9886292  Vali macro F1 0.9848236 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 47 cost time: 6.656575441360474
VALI: Epoch: 47, Steps: 72 | Train Loss: 0.0115088  Vali Loss: 0.0390265 Vali Accuracy: 0.9886532  Vali weighted F1: 0.9886292  Vali macro F1 0.9848236 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 6.6604344844818115
VALI: Epoch: 48, Steps: 72 | Train Loss: 0.0113598  Vali Loss: 0.0390419 Vali Accuracy: 0.9886532  Vali weighted F1: 0.9886292  Vali macro F1 0.9848236 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 6.681148290634155
VALI: Epoch: 49, Steps: 72 | Train Loss: 0.0099845  Vali Loss: 0.0390732 Vali Accuracy: 0.9886532  Vali weighted F1: 0.9886292  Vali macro F1 0.9848236 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 50 cost time: 6.734719753265381
VALI: Epoch: 50, Steps: 72 | Train Loss: 0.0116062  Vali Loss: 0.0390930 Vali Accuracy: 0.9886532  Vali weighted F1: 0.9886292  Vali macro F1 0.9848236 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 51 cost time: 6.666667699813843
VALI: Epoch: 51, Steps: 72 | Train Loss: 0.0117373  Vali Loss: 0.0391120 Vali Accuracy: 0.9886532  Vali weighted F1: 0.9886292  Vali macro F1 0.9848236 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8403424  Test weighted F1: 0.8354552  Test macro F1 0.6212720 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 240495
pruned model Parameter : 244174
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.714040040969849
Fine Tuning VALI: Epoch: 1, Steps: 72 | Train Loss: 0.0145042  Vali Loss: 0.0408878 Vali Accuracy: 0.9886532  Vali weighted F1: 0.9886324  Vali macro F1 0.9852927 
Validation loss decreased (inf --> 0.040888).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.64705753326416
Fine Tuning VALI: Epoch: 2, Steps: 72 | Train Loss: 0.0139320  Vali Loss: 0.0390662 Vali Accuracy: 0.9896399  Vali weighted F1: 0.9896330  Vali macro F1 0.9860543 
new best score!!!!
Validation loss decreased (0.040888 --> 0.039066).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.700733184814453
Fine Tuning VALI: Epoch: 3, Steps: 72 | Train Loss: 0.0130109  Vali Loss: 0.0369193 Vali Accuracy: 0.9896399  Vali weighted F1: 0.9896299  Vali macro F1 0.9853660 
new best score!!!!
Validation loss decreased (0.039066 --> 0.036919).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.678839683532715
Fine Tuning VALI: Epoch: 4, Steps: 72 | Train Loss: 0.0118949  Vali Loss: 0.0399480 Vali Accuracy: 0.9896399  Vali weighted F1: 0.9896254  Vali macro F1 0.9856787 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.679230213165283
Fine Tuning VALI: Epoch: 5, Steps: 72 | Train Loss: 0.0117367  Vali Loss: 0.0415807 Vali Accuracy: 0.9886532  Vali weighted F1: 0.9886191  Vali macro F1 0.9851702 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 6.6693947315216064
Fine Tuning VALI: Epoch: 6, Steps: 72 | Train Loss: 0.0107574  Vali Loss: 0.0405974 Vali Accuracy: 0.9891465  Vali weighted F1: 0.9891294  Vali macro F1 0.9854397 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 6.681647062301636
Fine Tuning VALI: Epoch: 7, Steps: 72 | Train Loss: 0.0111039  Vali Loss: 0.0389438 Vali Accuracy: 0.9901332  Vali weighted F1: 0.9901343  Vali macro F1 0.9865709 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 8 cost time: 6.6786789894104
Fine Tuning VALI: Epoch: 8, Steps: 72 | Train Loss: 0.0115699  Vali Loss: 0.0411090 Vali Accuracy: 0.9896399  Vali weighted F1: 0.9896266  Vali macro F1 0.9861530 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 9 cost time: 6.713394641876221
Fine Tuning VALI: Epoch: 9, Steps: 72 | Train Loss: 0.0111356  Vali Loss: 0.0426382 Vali Accuracy: 0.9901332  Vali weighted F1: 0.9901253  Vali macro F1 0.9867665 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.6911962032318115
Fine Tuning VALI: Epoch: 10, Steps: 72 | Train Loss: 0.0098922  Vali Loss: 0.0440956 Vali Accuracy: 0.9896399  Vali weighted F1: 0.9896266  Vali macro F1 0.9861530 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 6.652189254760742
Fine Tuning VALI: Epoch: 11, Steps: 72 | Train Loss: 0.0093815  Vali Loss: 0.0402443 Vali Accuracy: 0.9901332  Vali weighted F1: 0.9901150  Vali macro F1 0.9865168 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 6.673763751983643
Fine Tuning VALI: Epoch: 12, Steps: 72 | Train Loss: 0.0092764  Vali Loss: 0.0398904 Vali Accuracy: 0.9906265  Vali weighted F1: 0.9906276  Vali macro F1 0.9866825 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 6.7161805629730225
Fine Tuning VALI: Epoch: 13, Steps: 72 | Train Loss: 0.0095812  Vali Loss: 0.0428719 Vali Accuracy: 0.9896399  Vali weighted F1: 0.9896419  Vali macro F1 0.9863020 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 14 cost time: 6.691964387893677
Fine Tuning VALI: Epoch: 14, Steps: 72 | Train Loss: 0.0093865  Vali Loss: 0.0411572 Vali Accuracy: 0.9911199  Vali weighted F1: 0.9911208  Vali macro F1 0.9875200 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 6.907694339752197
Fine Tuning VALI: Epoch: 15, Steps: 72 | Train Loss: 0.0082167  Vali Loss: 0.0407612 Vali Accuracy: 0.9911199  Vali weighted F1: 0.9911208  Vali macro F1 0.9875200 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 6.913471460342407
Fine Tuning VALI: Epoch: 16, Steps: 72 | Train Loss: 0.0075094  Vali Loss: 0.0402645 Vali Accuracy: 0.9911199  Vali weighted F1: 0.9911196  Vali macro F1 0.9875242 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 6.722107887268066
Fine Tuning VALI: Epoch: 17, Steps: 72 | Train Loss: 0.0080622  Vali Loss: 0.0399933 Vali Accuracy: 0.9911199  Vali weighted F1: 0.9911196  Vali macro F1 0.9875242 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 6.667683362960815
Fine Tuning VALI: Epoch: 18, Steps: 72 | Train Loss: 0.0081811  Vali Loss: 0.0401342 Vali Accuracy: 0.9911199  Vali weighted F1: 0.9911196  Vali macro F1 0.9875242 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8300459  Test weighted F1: 0.8282068  Test macro F1 0.6169264 
================ the 7 th CV Experiment ================ 
Leave one Out Experiment : The 8 Part as the test
[-] Target sampling weights:  [0.0001451  0.00016764 0.0010142  0.00132979 0.00050327 0.00062933]
Train data number :  18171
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2019
Test data number :  8450
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.777326345443726
VALI: Epoch: 1, Steps: 71 | Train Loss: 1.0115051  Vali Loss: 0.6461688 Vali Accuracy: 0.7607727  Vali weighted F1: 0.7146588  Vali macro F1 0.5036747 
Validation loss decreased (inf --> 0.646169).  Saving model ...
Epoch: 2 cost time: 6.769132852554321
VALI: Epoch: 2, Steps: 71 | Train Loss: 0.5084283  Vali Loss: 0.4204019 Vali Accuracy: 0.8439822  Vali weighted F1: 0.8217561  Vali macro F1 0.7592057 
new best score!!!!
Validation loss decreased (0.646169 --> 0.420402).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.67126202583313
VALI: Epoch: 3, Steps: 71 | Train Loss: 0.3498998  Vali Loss: 0.3025361 Vali Accuracy: 0.8875681  Vali weighted F1: 0.8844372  Vali macro F1 0.8432753 
new best score!!!!
Validation loss decreased (0.420402 --> 0.302536).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.6264073848724365
VALI: Epoch: 4, Steps: 71 | Train Loss: 0.2606492  Vali Loss: 0.2262953 Vali Accuracy: 0.9202576  Vali weighted F1: 0.9207542  Vali macro F1 0.8910242 
new best score!!!!
Validation loss decreased (0.302536 --> 0.226295).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.639830112457275
VALI: Epoch: 5, Steps: 71 | Train Loss: 0.2098831  Vali Loss: 0.2219753 Vali Accuracy: 0.9242199  Vali weighted F1: 0.9204746  Vali macro F1 0.8932242 
new best score!!!!
Validation loss decreased (0.226295 --> 0.221975).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.622191429138184
VALI: Epoch: 6, Steps: 71 | Train Loss: 0.1775126  Vali Loss: 0.1733675 Vali Accuracy: 0.9410599  Vali weighted F1: 0.9405056  Vali macro F1 0.9168017 
new best score!!!!
Validation loss decreased (0.221975 --> 0.173368).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.642638444900513
VALI: Epoch: 7, Steps: 71 | Train Loss: 0.1545572  Vali Loss: 0.1638901 Vali Accuracy: 0.9405646  Vali weighted F1: 0.9402677  Vali macro F1 0.9184839 
new best score!!!!
Validation loss decreased (0.173368 --> 0.163890).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.640206336975098
VALI: Epoch: 8, Steps: 71 | Train Loss: 0.1420246  Vali Loss: 0.1431936 Vali Accuracy: 0.9519564  Vali weighted F1: 0.9521627  Vali macro F1 0.9310669 
new best score!!!!
Validation loss decreased (0.163890 --> 0.143194).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.612706422805786
VALI: Epoch: 9, Steps: 71 | Train Loss: 0.1267156  Vali Loss: 0.1370892 Vali Accuracy: 0.9504705  Vali weighted F1: 0.9503887  Vali macro F1 0.9293603 
new best score!!!!
Validation loss decreased (0.143194 --> 0.137089).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.601949691772461
VALI: Epoch: 10, Steps: 71 | Train Loss: 0.1160358  Vali Loss: 0.1355755 Vali Accuracy: 0.9519564  Vali weighted F1: 0.9525854  Vali macro F1 0.9303267 
new best score!!!!
Validation loss decreased (0.137089 --> 0.135576).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.750015020370483
VALI: Epoch: 11, Steps: 71 | Train Loss: 0.1099141  Vali Loss: 0.1214720 Vali Accuracy: 0.9598811  Vali weighted F1: 0.9600586  Vali macro F1 0.9475639 
new best score!!!!
Validation loss decreased (0.135576 --> 0.121472).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.705793142318726
VALI: Epoch: 12, Steps: 71 | Train Loss: 0.0982781  Vali Loss: 0.1123949 Vali Accuracy: 0.9564141  Vali weighted F1: 0.9568297  Vali macro F1 0.9368160 
new best score!!!!
Validation loss decreased (0.121472 --> 0.112395).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.664257526397705
VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0894622  Vali Loss: 0.0972970 Vali Accuracy: 0.9668153  Vali weighted F1: 0.9668236  Vali macro F1 0.9511942 
new best score!!!!
Validation loss decreased (0.112395 --> 0.097297).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.6470396518707275
VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0801688  Vali Loss: 0.1080622 Vali Accuracy: 0.9623576  Vali weighted F1: 0.9629238  Vali macro F1 0.9475018 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.642375469207764
VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0762061  Vali Loss: 0.1045459 Vali Accuracy: 0.9613670  Vali weighted F1: 0.9616859  Vali macro F1 0.9448085 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 16 cost time: 6.645152807235718
VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0803457  Vali Loss: 0.0949454 Vali Accuracy: 0.9683011  Vali weighted F1: 0.9678226  Vali macro F1 0.9536750 
new best score!!!!
Validation loss decreased (0.097297 --> 0.094945).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.633363723754883
VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0692560  Vali Loss: 0.0934823 Vali Accuracy: 0.9683011  Vali weighted F1: 0.9683599  Vali macro F1 0.9514907 
new best score!!!!
Validation loss decreased (0.094945 --> 0.093482).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.774278879165649
VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0637117  Vali Loss: 0.0719469 Vali Accuracy: 0.9767211  Vali weighted F1: 0.9766677  Vali macro F1 0.9642231 
new best score!!!!
Validation loss decreased (0.093482 --> 0.071947).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.736958980560303
VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0582905  Vali Loss: 0.0803770 Vali Accuracy: 0.9717682  Vali weighted F1: 0.9716836  Vali macro F1 0.9592366 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 6.781273365020752
VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0505766  Vali Loss: 0.0722657 Vali Accuracy: 0.9777117  Vali weighted F1: 0.9776355  Vali macro F1 0.9719247 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 6.664090633392334
VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0539571  Vali Loss: 0.0794118 Vali Accuracy: 0.9737494  Vali weighted F1: 0.9738109  Vali macro F1 0.9664501 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 22 cost time: 6.662538528442383
VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0456955  Vali Loss: 0.0634161 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9802258  Vali macro F1 0.9741373 
new best score!!!!
Validation loss decreased (0.071947 --> 0.063416).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.606579303741455
VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0409974  Vali Loss: 0.0694567 Vali Accuracy: 0.9752353  Vali weighted F1: 0.9754514  Vali macro F1 0.9679137 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 6.629090309143066
VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0364117  Vali Loss: 0.0612868 Vali Accuracy: 0.9796929  Vali weighted F1: 0.9797499  Vali macro F1 0.9715223 
new best score!!!!
Validation loss decreased (0.063416 --> 0.061287).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.6011810302734375
VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0313645  Vali Loss: 0.0654581 Vali Accuracy: 0.9791976  Vali weighted F1: 0.9793210  Vali macro F1 0.9707190 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 6.6150219440460205
VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0295019  Vali Loss: 0.0870068 Vali Accuracy: 0.9757306  Vali weighted F1: 0.9761582  Vali macro F1 0.9695990 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 6.628628492355347
VALI: Epoch: 27, Steps: 71 | Train Loss: 0.0338609  Vali Loss: 0.0594940 Vali Accuracy: 0.9816741  Vali weighted F1: 0.9817298  Vali macro F1 0.9753572 
new best score!!!!
Validation loss decreased (0.061287 --> 0.059494).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.585246801376343
VALI: Epoch: 28, Steps: 71 | Train Loss: 0.0271199  Vali Loss: 0.0547461 Vali Accuracy: 0.9811788  Vali weighted F1: 0.9812428  Vali macro F1 0.9714504 
new best score!!!!
Validation loss decreased (0.059494 --> 0.054746).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.582628488540649
VALI: Epoch: 29, Steps: 71 | Train Loss: 0.0316053  Vali Loss: 0.0822820 Vali Accuracy: 0.9747400  Vali weighted F1: 0.9750055  Vali macro F1 0.9679783 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 6.606052398681641
VALI: Epoch: 30, Steps: 71 | Train Loss: 0.0274223  Vali Loss: 0.0613532 Vali Accuracy: 0.9811788  Vali weighted F1: 0.9810679  Vali macro F1 0.9743136 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 6.6260600090026855
VALI: Epoch: 31, Steps: 71 | Train Loss: 0.0233566  Vali Loss: 0.0528327 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9836468  Vali macro F1 0.9775579 
new best score!!!!
Validation loss decreased (0.054746 --> 0.052833).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.617186069488525
VALI: Epoch: 32, Steps: 71 | Train Loss: 0.0199946  Vali Loss: 0.0500786 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9805812  Vali macro F1 0.9710945 
new best score!!!!
Validation loss decreased (0.052833 --> 0.050079).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.57626748085022
VALI: Epoch: 33, Steps: 71 | Train Loss: 0.0218070  Vali Loss: 0.0619779 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9837127  Vali macro F1 0.9775812 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 6.610220670700073
VALI: Epoch: 34, Steps: 71 | Train Loss: 0.0179097  Vali Loss: 0.0698954 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9807417  Vali macro F1 0.9742387 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 6.596270799636841
VALI: Epoch: 35, Steps: 71 | Train Loss: 0.0183108  Vali Loss: 0.0561434 Vali Accuracy: 0.9816741  Vali weighted F1: 0.9817313  Vali macro F1 0.9760745 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 36 cost time: 6.615082502365112
VALI: Epoch: 36, Steps: 71 | Train Loss: 0.0189516  Vali Loss: 0.0768383 Vali Accuracy: 0.9791976  Vali weighted F1: 0.9792690  Vali macro F1 0.9711809 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 37 cost time: 6.611961364746094
VALI: Epoch: 37, Steps: 71 | Train Loss: 0.0152668  Vali Loss: 0.0856525 Vali Accuracy: 0.9777117  Vali weighted F1: 0.9773731  Vali macro F1 0.9712230 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 38 cost time: 6.60253381729126
VALI: Epoch: 38, Steps: 71 | Train Loss: 0.0112742  Vali Loss: 0.0504189 Vali Accuracy: 0.9841506  Vali weighted F1: 0.9841725  Vali macro F1 0.9774051 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 6.601945638656616
VALI: Epoch: 39, Steps: 71 | Train Loss: 0.0080660  Vali Loss: 0.0505763 Vali Accuracy: 0.9821694  Vali weighted F1: 0.9821797  Vali macro F1 0.9744124 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 6.777663946151733
VALI: Epoch: 40, Steps: 71 | Train Loss: 0.0068175  Vali Loss: 0.0522966 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9826862  Vali macro F1 0.9756213 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 6.609591245651245
VALI: Epoch: 41, Steps: 71 | Train Loss: 0.0063795  Vali Loss: 0.0502414 Vali Accuracy: 0.9821694  Vali weighted F1: 0.9821922  Vali macro F1 0.9747977 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 42 cost time: 6.54027247428894
VALI: Epoch: 42, Steps: 71 | Train Loss: 0.0063895  Vali Loss: 0.0488203 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9827024  Vali macro F1 0.9754236 
new best score!!!!
Validation loss decreased (0.050079 --> 0.048820).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 6.569742202758789
VALI: Epoch: 43, Steps: 71 | Train Loss: 0.0058095  Vali Loss: 0.0487021 Vali Accuracy: 0.9821694  Vali weighted F1: 0.9822082  Vali macro F1 0.9745869 
new best score!!!!
Validation loss decreased (0.048820 --> 0.048702).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 6.634261131286621
VALI: Epoch: 44, Steps: 71 | Train Loss: 0.0057995  Vali Loss: 0.0485023 Vali Accuracy: 0.9851412  Vali weighted F1: 0.9851299  Vali macro F1 0.9789382 
new best score!!!!
Validation loss decreased (0.048702 --> 0.048502).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 6.61605429649353
VALI: Epoch: 45, Steps: 71 | Train Loss: 0.0059232  Vali Loss: 0.0494287 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9836650  Vali macro F1 0.9771492 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 6.61235785484314
VALI: Epoch: 46, Steps: 71 | Train Loss: 0.0057045  Vali Loss: 0.0483773 Vali Accuracy: 0.9846459  Vali weighted F1: 0.9846433  Vali macro F1 0.9785978 
new best score!!!!
Validation loss decreased (0.048502 --> 0.048377).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 6.66327691078186
VALI: Epoch: 47, Steps: 71 | Train Loss: 0.0050097  Vali Loss: 0.0504667 Vali Accuracy: 0.9841506  Vali weighted F1: 0.9841802  Vali macro F1 0.9780387 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 6.644104480743408
VALI: Epoch: 48, Steps: 71 | Train Loss: 0.0048375  Vali Loss: 0.0479759 Vali Accuracy: 0.9851412  Vali weighted F1: 0.9851158  Vali macro F1 0.9791523 
new best score!!!!
Validation loss decreased (0.048377 --> 0.047976).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 6.634634494781494
VALI: Epoch: 49, Steps: 71 | Train Loss: 0.0053956  Vali Loss: 0.0496329 Vali Accuracy: 0.9841506  Vali weighted F1: 0.9841120  Vali macro F1 0.9778327 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 6.6464924812316895
VALI: Epoch: 50, Steps: 71 | Train Loss: 0.0049433  Vali Loss: 0.0468644 Vali Accuracy: 0.9861317  Vali weighted F1: 0.9861236  Vali macro F1 0.9802472 
new best score!!!!
Validation loss decreased (0.047976 --> 0.046864).  Saving model ...
new best score!!!!
Epoch: 51 cost time: 6.577271223068237
VALI: Epoch: 51, Steps: 71 | Train Loss: 0.0052811  Vali Loss: 0.0469932 Vali Accuracy: 0.9866270  Vali weighted F1: 0.9865749  Vali macro F1 0.9806684 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 6.592735528945923
VALI: Epoch: 52, Steps: 71 | Train Loss: 0.0053439  Vali Loss: 0.0469453 Vali Accuracy: 0.9861317  Vali weighted F1: 0.9861463  Vali macro F1 0.9801802 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 53 cost time: 6.579335689544678
VALI: Epoch: 53, Steps: 71 | Train Loss: 0.0045236  Vali Loss: 0.0500077 Vali Accuracy: 0.9846459  Vali weighted F1: 0.9846093  Vali macro F1 0.9786588 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 54 cost time: 6.789952278137207
VALI: Epoch: 54, Steps: 71 | Train Loss: 0.0051665  Vali Loss: 0.0472824 Vali Accuracy: 0.9851412  Vali weighted F1: 0.9851006  Vali macro F1 0.9787497 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 55 cost time: 6.576634168624878
VALI: Epoch: 55, Steps: 71 | Train Loss: 0.0042691  Vali Loss: 0.0504721 Vali Accuracy: 0.9841506  Vali weighted F1: 0.9841323  Vali macro F1 0.9778329 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 56 cost time: 6.5843236446380615
VALI: Epoch: 56, Steps: 71 | Train Loss: 0.0040521  Vali Loss: 0.0496565 Vali Accuracy: 0.9841506  Vali weighted F1: 0.9841323  Vali macro F1 0.9778329 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 57 cost time: 6.570972204208374
VALI: Epoch: 57, Steps: 71 | Train Loss: 0.0042186  Vali Loss: 0.0491577 Vali Accuracy: 0.9851412  Vali weighted F1: 0.9851299  Vali macro F1 0.9791609 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 58 cost time: 6.569210052490234
VALI: Epoch: 58, Steps: 71 | Train Loss: 0.0044517  Vali Loss: 0.0490058 Vali Accuracy: 0.9846459  Vali weighted F1: 0.9846368  Vali macro F1 0.9783386 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 59 cost time: 7.769765377044678
VALI: Epoch: 59, Steps: 71 | Train Loss: 0.0042886  Vali Loss: 0.0483949 Vali Accuracy: 0.9846459  Vali weighted F1: 0.9846368  Vali macro F1 0.9783386 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 60 cost time: 6.554955959320068
VALI: Epoch: 60, Steps: 71 | Train Loss: 0.0041105  Vali Loss: 0.0489480 Vali Accuracy: 0.9846459  Vali weighted F1: 0.9846558  Vali macro F1 0.9783695 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 61 cost time: 6.996834993362427
VALI: Epoch: 61, Steps: 71 | Train Loss: 0.0040989  Vali Loss: 0.0487414 Vali Accuracy: 0.9846459  Vali weighted F1: 0.9846558  Vali macro F1 0.9783695 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 62 cost time: 6.621249437332153
VALI: Epoch: 62, Steps: 71 | Train Loss: 0.0041056  Vali Loss: 0.0487297 Vali Accuracy: 0.9846459  Vali weighted F1: 0.9846558  Vali macro F1 0.9783695 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 63 cost time: 6.728110313415527
VALI: Epoch: 63, Steps: 71 | Train Loss: 0.0040068  Vali Loss: 0.0485673 Vali Accuracy: 0.9851412  Vali weighted F1: 0.9851388  Vali macro F1 0.9788097 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 64 cost time: 6.558207035064697
VALI: Epoch: 64, Steps: 71 | Train Loss: 0.0042919  Vali Loss: 0.0483902 Vali Accuracy: 0.9851412  Vali weighted F1: 0.9851388  Vali macro F1 0.9788097 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 65 cost time: 6.56771183013916
VALI: Epoch: 65, Steps: 71 | Train Loss: 0.0040128  Vali Loss: 0.0483567 Vali Accuracy: 0.9851412  Vali weighted F1: 0.9851388  Vali macro F1 0.9788097 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.7661538  Test weighted F1: 0.7724954  Test macro F1 0.8089027 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 240495
pruned model Parameter : 244174
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.682841539382935
Fine Tuning VALI: Epoch: 1, Steps: 71 | Train Loss: 0.0052652  Vali Loss: 0.0485246 Vali Accuracy: 0.9856365  Vali weighted F1: 0.9856735  Vali macro F1 0.9784486 
Validation loss decreased (inf --> 0.048525).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.5768492221832275
Fine Tuning VALI: Epoch: 2, Steps: 71 | Train Loss: 0.0054589  Vali Loss: 0.0494206 Vali Accuracy: 0.9856365  Vali weighted F1: 0.9856079  Vali macro F1 0.9794945 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.579054117202759
Fine Tuning VALI: Epoch: 3, Steps: 71 | Train Loss: 0.0055092  Vali Loss: 0.0498674 Vali Accuracy: 0.9856365  Vali weighted F1: 0.9856215  Vali macro F1 0.9797760 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.60677433013916
Fine Tuning VALI: Epoch: 4, Steps: 71 | Train Loss: 0.0040537  Vali Loss: 0.0458604 Vali Accuracy: 0.9881129  Vali weighted F1: 0.9881049  Vali macro F1 0.9823977 
new best score!!!!
Validation loss decreased (0.048525 --> 0.045860).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.589380264282227
Fine Tuning VALI: Epoch: 5, Steps: 71 | Train Loss: 0.0042465  Vali Loss: 0.0478039 Vali Accuracy: 0.9861317  Vali weighted F1: 0.9861296  Vali macro F1 0.9805074 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 6.590023517608643
Fine Tuning VALI: Epoch: 6, Steps: 71 | Train Loss: 0.0038046  Vali Loss: 0.0479550 Vali Accuracy: 0.9856365  Vali weighted F1: 0.9856033  Vali macro F1 0.9797462 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 7 cost time: 6.6376683712005615
Fine Tuning VALI: Epoch: 7, Steps: 71 | Train Loss: 0.0056117  Vali Loss: 0.0456262 Vali Accuracy: 0.9866270  Vali weighted F1: 0.9866396  Vali macro F1 0.9805696 
new best score!!!!
Validation loss decreased (0.045860 --> 0.045626).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 6.613276243209839
Fine Tuning VALI: Epoch: 8, Steps: 71 | Train Loss: 0.0047537  Vali Loss: 0.0457516 Vali Accuracy: 0.9856365  Vali weighted F1: 0.9855975  Vali macro F1 0.9789107 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.636062383651733
Fine Tuning VALI: Epoch: 9, Steps: 71 | Train Loss: 0.0042104  Vali Loss: 0.0482518 Vali Accuracy: 0.9866270  Vali weighted F1: 0.9866082  Vali macro F1 0.9803787 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 6.623535394668579
Fine Tuning VALI: Epoch: 10, Steps: 71 | Train Loss: 0.0034921  Vali Loss: 0.0481912 Vali Accuracy: 0.9871223  Vali weighted F1: 0.9871030  Vali macro F1 0.9809321 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 6.656285524368286
Fine Tuning VALI: Epoch: 11, Steps: 71 | Train Loss: 0.0040846  Vali Loss: 0.0554713 Vali Accuracy: 0.9841506  Vali weighted F1: 0.9841718  Vali macro F1 0.9774047 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 6.610945224761963
Fine Tuning VALI: Epoch: 12, Steps: 71 | Train Loss: 0.0039227  Vali Loss: 0.0471084 Vali Accuracy: 0.9866270  Vali weighted F1: 0.9866316  Vali macro F1 0.9812447 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 13 cost time: 6.591617107391357
Fine Tuning VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0036178  Vali Loss: 0.0488734 Vali Accuracy: 0.9861317  Vali weighted F1: 0.9860989  Vali macro F1 0.9796722 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.616056203842163
Fine Tuning VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0034672  Vali Loss: 0.0482736 Vali Accuracy: 0.9866270  Vali weighted F1: 0.9866005  Vali macro F1 0.9804607 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.720513105392456
Fine Tuning VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0036150  Vali Loss: 0.0539429 Vali Accuracy: 0.9841506  Vali weighted F1: 0.9841517  Vali macro F1 0.9764623 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.791173934936523
Fine Tuning VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0033387  Vali Loss: 0.0514799 Vali Accuracy: 0.9851412  Vali weighted F1: 0.9851263  Vali macro F1 0.9775732 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 6.830358266830444
Fine Tuning VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0030035  Vali Loss: 0.0519910 Vali Accuracy: 0.9861317  Vali weighted F1: 0.9861139  Vali macro F1 0.9779737 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 18 cost time: 6.708626747131348
Fine Tuning VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0030066  Vali Loss: 0.0530209 Vali Accuracy: 0.9846459  Vali weighted F1: 0.9846544  Vali macro F1 0.9768684 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 6.636646747589111
Fine Tuning VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0026728  Vali Loss: 0.0529971 Vali Accuracy: 0.9846459  Vali weighted F1: 0.9846544  Vali macro F1 0.9769010 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 6.77773118019104
Fine Tuning VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0027431  Vali Loss: 0.0521635 Vali Accuracy: 0.9871223  Vali weighted F1: 0.9870941  Vali macro F1 0.9803835 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 6.826389789581299
Fine Tuning VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0028817  Vali Loss: 0.0501984 Vali Accuracy: 0.9866270  Vali weighted F1: 0.9866065  Vali macro F1 0.9801640 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 6.752891778945923
Fine Tuning VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0026336  Vali Loss: 0.0514205 Vali Accuracy: 0.9866270  Vali weighted F1: 0.9865999  Vali macro F1 0.9801418 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.7655621  Test weighted F1: 0.7735368  Test macro F1 0.8045351 
================ the 8 th CV Experiment ================ 
Leave one Out Experiment : The 9 Part as the test
[-] Target sampling weights:  [0.00014648 0.00017775 0.00108932 0.00131579 0.00049628 0.00062933]
Train data number :  17735
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1971
Test data number :  10867
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.608533143997192
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.0335290  Vali Loss: 0.6721648 Vali Accuracy: 0.7493658  Vali weighted F1: 0.6905615  Vali macro F1 0.4670997 
Validation loss decreased (inf --> 0.672165).  Saving model ...
Epoch: 2 cost time: 6.489919662475586
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.5249096  Vali Loss: 0.4140697 Vali Accuracy: 0.8609843  Vali weighted F1: 0.8510440  Vali macro F1 0.8099485 
new best score!!!!
Validation loss decreased (0.672165 --> 0.414070).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.490459680557251
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.3568565  Vali Loss: 0.2972781 Vali Accuracy: 0.8985287  Vali weighted F1: 0.8929830  Vali macro F1 0.8629030 
new best score!!!!
Validation loss decreased (0.414070 --> 0.297278).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.489018201828003
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.2630991  Vali Loss: 0.2376102 Vali Accuracy: 0.9269406  Vali weighted F1: 0.9249845  Vali macro F1 0.9051432 
new best score!!!!
Validation loss decreased (0.297278 --> 0.237610).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.508216619491577
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.2236315  Vali Loss: 0.1791044 Vali Accuracy: 0.9406393  Vali weighted F1: 0.9403964  Vali macro F1 0.9210414 
new best score!!!!
Validation loss decreased (0.237610 --> 0.179104).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.477133512496948
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.1860087  Vali Loss: 0.2173931 Vali Accuracy: 0.9299848  Vali weighted F1: 0.9271876  Vali macro F1 0.9052184 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 7 cost time: 6.486979007720947
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.1561762  Vali Loss: 0.1513640 Vali Accuracy: 0.9487570  Vali weighted F1: 0.9490752  Vali macro F1 0.9307909 
new best score!!!!
Validation loss decreased (0.179104 --> 0.151364).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.487614631652832
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1416440  Vali Loss: 0.1457355 Vali Accuracy: 0.9512938  Vali weighted F1: 0.9505663  Vali macro F1 0.9346674 
new best score!!!!
Validation loss decreased (0.151364 --> 0.145736).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.43604850769043
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1285653  Vali Loss: 0.1196499 Vali Accuracy: 0.9589041  Vali weighted F1: 0.9589604  Vali macro F1 0.9450279 
new best score!!!!
Validation loss decreased (0.145736 --> 0.119650).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.492007255554199
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1206283  Vali Loss: 0.1406885 Vali Accuracy: 0.9457128  Vali weighted F1: 0.9444122  Vali macro F1 0.9264304 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.507935285568237
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1169326  Vali Loss: 0.1104608 Vali Accuracy: 0.9609335  Vali weighted F1: 0.9605690  Vali macro F1 0.9473031 
new best score!!!!
Validation loss decreased (0.119650 --> 0.110461).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.518442869186401
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0978455  Vali Loss: 0.1156236 Vali Accuracy: 0.9614409  Vali weighted F1: 0.9614901  Vali macro F1 0.9499296 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 6.4804418087005615
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0894371  Vali Loss: 0.0923911 Vali Accuracy: 0.9680365  Vali weighted F1: 0.9679933  Vali macro F1 0.9573586 
new best score!!!!
Validation loss decreased (0.110461 --> 0.092391).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.5015013217926025
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0834451  Vali Loss: 0.0812187 Vali Accuracy: 0.9731101  Vali weighted F1: 0.9729812  Vali macro F1 0.9630953 
new best score!!!!
Validation loss decreased (0.092391 --> 0.081219).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.611990690231323
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0927244  Vali Loss: 0.0980800 Vali Accuracy: 0.9654997  Vali weighted F1: 0.9649115  Vali macro F1 0.9552783 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.707226753234863
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0729293  Vali Loss: 0.0822234 Vali Accuracy: 0.9715880  Vali weighted F1: 0.9717739  Vali macro F1 0.9609094 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 17 cost time: 6.519331216812134
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0689714  Vali Loss: 0.0827570 Vali Accuracy: 0.9736175  Vali weighted F1: 0.9732691  Vali macro F1 0.9656115 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 18 cost time: 6.496643543243408
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0693608  Vali Loss: 0.0893267 Vali Accuracy: 0.9736175  Vali weighted F1: 0.9736352  Vali macro F1 0.9627905 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 19 cost time: 6.49161434173584
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0619808  Vali Loss: 0.0773874 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9772142  Vali macro F1 0.9695864 
new best score!!!!
Validation loss decreased (0.081219 --> 0.077387).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.493948221206665
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0581069  Vali Loss: 0.0861043 Vali Accuracy: 0.9690512  Vali weighted F1: 0.9684337  Vali macro F1 0.9595877 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.650984525680542
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0541389  Vali Loss: 0.0680042 Vali Accuracy: 0.9766616  Vali weighted F1: 0.9766523  Vali macro F1 0.9673098 
new best score!!!!
Validation loss decreased (0.077387 --> 0.068004).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.760005235671997
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0502936  Vali Loss: 0.0797533 Vali Accuracy: 0.9746322  Vali weighted F1: 0.9746885  Vali macro F1 0.9654373 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.599268674850464
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0493370  Vali Loss: 0.0603382 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9816698  Vali macro F1 0.9736550 
new best score!!!!
Validation loss decreased (0.068004 --> 0.060338).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.541861534118652
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0395464  Vali Loss: 0.0610770 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9791578  Vali macro F1 0.9697681 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 6.509446144104004
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0509232  Vali Loss: 0.0882617 Vali Accuracy: 0.9726027  Vali weighted F1: 0.9724557  Vali macro F1 0.9473131 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 6.5101847648620605
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0414750  Vali Loss: 0.0631033 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9821330  Vali macro F1 0.9749857 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 27 cost time: 6.507644414901733
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0412994  Vali Loss: 0.0562620 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842584  Vali macro F1 0.9775480 
new best score!!!!
Validation loss decreased (0.060338 --> 0.056262).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.4894373416900635
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0312057  Vali Loss: 0.0672329 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9821729  Vali macro F1 0.9742785 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 6.605613470077515
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0281892  Vali Loss: 0.0637664 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9823050  Vali macro F1 0.9747188 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 6.640532970428467
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0328236  Vali Loss: 0.0552043 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842840  Vali macro F1 0.9763882 
new best score!!!!
Validation loss decreased (0.056262 --> 0.055204).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.4876604080200195
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0268328  Vali Loss: 0.0544726 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832333  Vali macro F1 0.9744025 
new best score!!!!
Validation loss decreased (0.055204 --> 0.054473).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.509682655334473
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0345411  Vali Loss: 0.0769587 Vali Accuracy: 0.9741248  Vali weighted F1: 0.9737859  Vali macro F1 0.9647367 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 6.50466251373291
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0399032  Vali Loss: 0.0594968 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9791928  Vali macro F1 0.9723354 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 6.510186672210693
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0233844  Vali Loss: 0.0551706 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837260  Vali macro F1 0.9764315 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 35 cost time: 6.4940025806427
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0262715  Vali Loss: 0.0601876 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9811592  Vali macro F1 0.9734007 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 36 cost time: 6.511221408843994
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0215946  Vali Loss: 0.0545651 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842140  Vali macro F1 0.9768339 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 37 cost time: 6.503781318664551
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0130274  Vali Loss: 0.0537451 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842147  Vali macro F1 0.9766147 
new best score!!!!
Validation loss decreased (0.054473 --> 0.053745).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 6.483767509460449
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0112026  Vali Loss: 0.0535453 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842241  Vali macro F1 0.9766212 
new best score!!!!
Validation loss decreased (0.053745 --> 0.053545).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 6.454408645629883
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0092690  Vali Loss: 0.0544030 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842147  Vali macro F1 0.9766147 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 6.459336280822754
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0109086  Vali Loss: 0.0530892 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9857742  Vali macro F1 0.9784486 
new best score!!!!
Validation loss decreased (0.053545 --> 0.053089).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 6.50374436378479
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0101925  Vali Loss: 0.0562536 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847375  Vali macro F1 0.9774357 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 6.431217432022095
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0092266  Vali Loss: 0.0537156 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9857640  Vali macro F1 0.9787652 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 6.440569639205933
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0090537  Vali Loss: 0.0555978 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847282  Vali macro F1 0.9774289 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 6.441650390625
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0084668  Vali Loss: 0.0557324 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852516  Vali macro F1 0.9779522 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 45 cost time: 6.429640769958496
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0074766  Vali Loss: 0.0544819 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852516  Vali macro F1 0.9779522 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 46 cost time: 6.456279516220093
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0086608  Vali Loss: 0.0542089 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852516  Vali macro F1 0.9779522 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 6.627295017242432
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0073645  Vali Loss: 0.0544693 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852516  Vali macro F1 0.9779522 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 48 cost time: 6.661516427993774
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0077061  Vali Loss: 0.0543699 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852516  Vali macro F1 0.9779522 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 49 cost time: 6.640978574752808
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0083264  Vali Loss: 0.0543191 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852516  Vali macro F1 0.9779522 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 50 cost time: 6.498758316040039
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0073143  Vali Loss: 0.0544533 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852516  Vali macro F1 0.9779522 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 51 cost time: 6.480980396270752
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0083272  Vali Loss: 0.0544627 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852516  Vali macro F1 0.9779522 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 6.544883728027344
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0080603  Vali Loss: 0.0544301 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852516  Vali macro F1 0.9779522 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 53 cost time: 6.485336065292358
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0081465  Vali Loss: 0.0544226 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852516  Vali macro F1 0.9779522 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 54 cost time: 6.455832242965698
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0072622  Vali Loss: 0.0544195 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852516  Vali macro F1 0.9779522 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 55 cost time: 6.444546222686768
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0072770  Vali Loss: 0.0544396 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852516  Vali macro F1 0.9779522 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9360449  Test weighted F1: 0.9369535  Test macro F1 0.9012446 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 240495
pruned model Parameter : 244174
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.65210747718811
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0108371  Vali Loss: 0.0543573 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9857640  Vali macro F1 0.9787652 
Validation loss decreased (inf --> 0.054357).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.598458528518677
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0085380  Vali Loss: 0.0565735 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9857555  Vali macro F1 0.9787591 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.620166778564453
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0092761  Vali Loss: 0.0561499 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9858239  Vali macro F1 0.9784204 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.54337215423584
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0073671  Vali Loss: 0.0557145 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852431  Vali macro F1 0.9779464 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.393627166748047
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0076083  Vali Loss: 0.0560043 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9867753  Vali macro F1 0.9797913 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.305953741073608
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0074345  Vali Loss: 0.0561797 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9857561  Vali macro F1 0.9784143 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.32410192489624
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0079840  Vali Loss: 0.0584277 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9857752  Vali macro F1 0.9783989 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.307999610900879
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0063283  Vali Loss: 0.0558685 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9862713  Vali macro F1 0.9789842 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.308651447296143
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0070750  Vali Loss: 0.0567781 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9867753  Vali macro F1 0.9797913 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.302399635314941
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0070207  Vali Loss: 0.0568661 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9858160  Vali macro F1 0.9781469 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 11 cost time: 6.299054384231567
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0066710  Vali Loss: 0.0562209 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852776  Vali macro F1 0.9779661 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.310127019882202
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0064907  Vali Loss: 0.0566655 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852700  Vali macro F1 0.9776408 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.300393342971802
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0058874  Vali Loss: 0.0564448 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852700  Vali macro F1 0.9776408 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.319937229156494
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0055730  Vali Loss: 0.0564999 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852700  Vali macro F1 0.9776408 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.323764324188232
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0055343  Vali Loss: 0.0564676 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852700  Vali macro F1 0.9776408 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 16 cost time: 6.311132907867432
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0052200  Vali Loss: 0.0564803 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852700  Vali macro F1 0.9776408 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9365970  Test weighted F1: 0.9374701  Test macro F1 0.9017418 
================ the 9 th CV Experiment ================ 
Leave one Out Experiment : The 10 Part as the test
[-] Target sampling weights:  [0.00013931 0.00018355 0.00106724 0.00127551 0.00049116 0.00059347]
Train data number :  18068
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2008
Test data number :  9022
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.427600622177124
VALI: Epoch: 1, Steps: 71 | Train Loss: 1.0041145  Vali Loss: 0.6327778 Vali Accuracy: 0.7509960  Vali weighted F1: 0.6929804  Vali macro F1 0.4691980 
Validation loss decreased (inf --> 0.632778).  Saving model ...
Epoch: 2 cost time: 6.402599811553955
VALI: Epoch: 2, Steps: 71 | Train Loss: 0.5176075  Vali Loss: 0.4150832 Vali Accuracy: 0.8471116  Vali weighted F1: 0.8335651  Vali macro F1 0.7722818 
new best score!!!!
Validation loss decreased (0.632778 --> 0.415083).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.415005922317505
VALI: Epoch: 3, Steps: 71 | Train Loss: 0.3586343  Vali Loss: 0.2899773 Vali Accuracy: 0.8929283  Vali weighted F1: 0.8892171  Vali macro F1 0.8402540 
new best score!!!!
Validation loss decreased (0.415083 --> 0.289977).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.430639982223511
VALI: Epoch: 4, Steps: 71 | Train Loss: 0.2658477  Vali Loss: 0.2277671 Vali Accuracy: 0.9168327  Vali weighted F1: 0.9169654  Vali macro F1 0.8873676 
new best score!!!!
Validation loss decreased (0.289977 --> 0.227767).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.4369728565216064
VALI: Epoch: 5, Steps: 71 | Train Loss: 0.2053202  Vali Loss: 0.1956775 Vali Accuracy: 0.9362550  Vali weighted F1: 0.9362013  Vali macro F1 0.9187894 
new best score!!!!
Validation loss decreased (0.227767 --> 0.195677).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.4102160930633545
VALI: Epoch: 6, Steps: 71 | Train Loss: 0.1730120  Vali Loss: 0.1679625 Vali Accuracy: 0.9377490  Vali weighted F1: 0.9385232  Vali macro F1 0.9179048 
new best score!!!!
Validation loss decreased (0.195677 --> 0.167963).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.43487286567688
VALI: Epoch: 7, Steps: 71 | Train Loss: 0.1500593  Vali Loss: 0.1429969 Vali Accuracy: 0.9457171  Vali weighted F1: 0.9456765  Vali macro F1 0.9287529 
new best score!!!!
Validation loss decreased (0.167963 --> 0.142997).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.602034091949463
VALI: Epoch: 8, Steps: 71 | Train Loss: 0.1489690  Vali Loss: 0.1369573 Vali Accuracy: 0.9497012  Vali weighted F1: 0.9491755  Vali macro F1 0.9352305 
new best score!!!!
Validation loss decreased (0.142997 --> 0.136957).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.587906360626221
VALI: Epoch: 9, Steps: 71 | Train Loss: 0.1321734  Vali Loss: 0.1329635 Vali Accuracy: 0.9551793  Vali weighted F1: 0.9550467  Vali macro F1 0.9340164 
new best score!!!!
Validation loss decreased (0.136957 --> 0.132964).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.595059633255005
VALI: Epoch: 10, Steps: 71 | Train Loss: 0.1256778  Vali Loss: 0.1093714 Vali Accuracy: 0.9626494  Vali weighted F1: 0.9624943  Vali macro F1 0.9520752 
new best score!!!!
Validation loss decreased (0.132964 --> 0.109371).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.565466403961182
VALI: Epoch: 11, Steps: 71 | Train Loss: 0.1084151  Vali Loss: 0.1438529 Vali Accuracy: 0.9521912  Vali weighted F1: 0.9511941  Vali macro F1 0.9329761 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 6.554150342941284
VALI: Epoch: 12, Steps: 71 | Train Loss: 0.1025264  Vali Loss: 0.1094692 Vali Accuracy: 0.9621514  Vali weighted F1: 0.9616285  Vali macro F1 0.9510528 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 13 cost time: 6.563649654388428
VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0957058  Vali Loss: 0.1542995 Vali Accuracy: 0.9526892  Vali weighted F1: 0.9519798  Vali macro F1 0.9407915 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 14 cost time: 6.57079291343689
VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0943081  Vali Loss: 0.1023097 Vali Accuracy: 0.9661355  Vali weighted F1: 0.9665213  Vali macro F1 0.9575621 
new best score!!!!
Validation loss decreased (0.109371 --> 0.102310).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.581135272979736
VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0795249  Vali Loss: 0.0928033 Vali Accuracy: 0.9701195  Vali weighted F1: 0.9700743  Vali macro F1 0.9608704 
new best score!!!!
Validation loss decreased (0.102310 --> 0.092803).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.590449571609497
VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0743649  Vali Loss: 0.0871322 Vali Accuracy: 0.9711155  Vali weighted F1: 0.9709922  Vali macro F1 0.9628532 
new best score!!!!
Validation loss decreased (0.092803 --> 0.087132).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.603041887283325
VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0750333  Vali Loss: 0.1198658 Vali Accuracy: 0.9586653  Vali weighted F1: 0.9584545  Vali macro F1 0.9451430 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 6.645036935806274
VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0722267  Vali Loss: 0.0852907 Vali Accuracy: 0.9736056  Vali weighted F1: 0.9736118  Vali macro F1 0.9659522 
new best score!!!!
Validation loss decreased (0.087132 --> 0.085291).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.588616847991943
VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0645293  Vali Loss: 0.0855218 Vali Accuracy: 0.9726096  Vali weighted F1: 0.9724778  Vali macro F1 0.9643919 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 6.5992114543914795
VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0554047  Vali Loss: 0.0917251 Vali Accuracy: 0.9716135  Vali weighted F1: 0.9719956  Vali macro F1 0.9624408 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 6.568089008331299
VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0600014  Vali Loss: 0.0808650 Vali Accuracy: 0.9721116  Vali weighted F1: 0.9723090  Vali macro F1 0.9621321 
new best score!!!!
Validation loss decreased (0.085291 --> 0.080865).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.5587379932403564
VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0590085  Vali Loss: 0.0766496 Vali Accuracy: 0.9746016  Vali weighted F1: 0.9746120  Vali macro F1 0.9658904 
new best score!!!!
Validation loss decreased (0.080865 --> 0.076650).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.463476181030273
VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0465431  Vali Loss: 0.0682900 Vali Accuracy: 0.9765936  Vali weighted F1: 0.9765317  Vali macro F1 0.9684616 
new best score!!!!
Validation loss decreased (0.076650 --> 0.068290).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.463632345199585
VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0414364  Vali Loss: 0.0790794 Vali Accuracy: 0.9721116  Vali weighted F1: 0.9723588  Vali macro F1 0.9636987 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 6.480311870574951
VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0399521  Vali Loss: 0.0651709 Vali Accuracy: 0.9790837  Vali weighted F1: 0.9789496  Vali macro F1 0.9697196 
new best score!!!!
Validation loss decreased (0.068290 --> 0.065171).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.43254828453064
VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0517827  Vali Loss: 0.0798889 Vali Accuracy: 0.9731076  Vali weighted F1: 0.9734445  Vali macro F1 0.9644458 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 6.427413702011108
VALI: Epoch: 27, Steps: 71 | Train Loss: 0.0375849  Vali Loss: 0.0700325 Vali Accuracy: 0.9800797  Vali weighted F1: 0.9799483  Vali macro F1 0.9731489 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 6.423446893692017
VALI: Epoch: 28, Steps: 71 | Train Loss: 0.0334958  Vali Loss: 0.0664298 Vali Accuracy: 0.9785857  Vali weighted F1: 0.9786978  Vali macro F1 0.9699102 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 29 cost time: 6.415994882583618
VALI: Epoch: 29, Steps: 71 | Train Loss: 0.0272572  Vali Loss: 0.0685278 Vali Accuracy: 0.9800797  Vali weighted F1: 0.9799477  Vali macro F1 0.9718465 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 30 cost time: 6.434532165527344
VALI: Epoch: 30, Steps: 71 | Train Loss: 0.0307045  Vali Loss: 0.0610725 Vali Accuracy: 0.9780876  Vali weighted F1: 0.9781175  Vali macro F1 0.9721565 
new best score!!!!
Validation loss decreased (0.065171 --> 0.061073).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.447168588638306
VALI: Epoch: 31, Steps: 71 | Train Loss: 0.0330434  Vali Loss: 0.0682032 Vali Accuracy: 0.9790837  Vali weighted F1: 0.9792191  Vali macro F1 0.9713085 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 6.458500385284424
VALI: Epoch: 32, Steps: 71 | Train Loss: 0.0225576  Vali Loss: 0.0637583 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9818952  Vali macro F1 0.9747544 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 6.444908380508423
VALI: Epoch: 33, Steps: 71 | Train Loss: 0.0244022  Vali Loss: 0.0735471 Vali Accuracy: 0.9765936  Vali weighted F1: 0.9766558  Vali macro F1 0.9685304 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 34 cost time: 6.450214147567749
VALI: Epoch: 34, Steps: 71 | Train Loss: 0.0233633  Vali Loss: 0.0601865 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9819246  Vali macro F1 0.9756683 
new best score!!!!
Validation loss decreased (0.061073 --> 0.060186).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 6.43079686164856
VALI: Epoch: 35, Steps: 71 | Train Loss: 0.0279668  Vali Loss: 0.0503854 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9830648  Vali macro F1 0.9764319 
new best score!!!!
Validation loss decreased (0.060186 --> 0.050385).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.443800926208496
VALI: Epoch: 36, Steps: 71 | Train Loss: 0.0175920  Vali Loss: 0.0512263 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9825982  Vali macro F1 0.9762374 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 6.456530570983887
VALI: Epoch: 37, Steps: 71 | Train Loss: 0.0183297  Vali Loss: 0.0737873 Vali Accuracy: 0.9755976  Vali weighted F1: 0.9757101  Vali macro F1 0.9676905 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 6.463937282562256
VALI: Epoch: 38, Steps: 71 | Train Loss: 0.0217084  Vali Loss: 0.0666716 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9809820  Vali macro F1 0.9735926 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 6.440996170043945
VALI: Epoch: 39, Steps: 71 | Train Loss: 0.0237749  Vali Loss: 0.0572811 Vali Accuracy: 0.9800797  Vali weighted F1: 0.9801927  Vali macro F1 0.9741707 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 40 cost time: 6.4585583209991455
VALI: Epoch: 40, Steps: 71 | Train Loss: 0.0260666  Vali Loss: 0.0836742 Vali Accuracy: 0.9770916  Vali weighted F1: 0.9768351  Vali macro F1 0.9691183 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 41 cost time: 6.443012714385986
VALI: Epoch: 41, Steps: 71 | Train Loss: 0.0160279  Vali Loss: 0.0492974 Vali Accuracy: 0.9845618  Vali weighted F1: 0.9845482  Vali macro F1 0.9794359 
new best score!!!!
Validation loss decreased (0.050385 --> 0.049297).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 6.439925193786621
VALI: Epoch: 42, Steps: 71 | Train Loss: 0.0105730  Vali Loss: 0.0501823 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9835517  Vali macro F1 0.9777429 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 6.423783779144287
VALI: Epoch: 43, Steps: 71 | Train Loss: 0.0095200  Vali Loss: 0.0485008 Vali Accuracy: 0.9850598  Vali weighted F1: 0.9850312  Vali macro F1 0.9808221 
new best score!!!!
Validation loss decreased (0.049297 --> 0.048501).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 6.446095705032349
VALI: Epoch: 44, Steps: 71 | Train Loss: 0.0091808  Vali Loss: 0.0481562 Vali Accuracy: 0.9845618  Vali weighted F1: 0.9845364  Vali macro F1 0.9799664 
new best score!!!!
Validation loss decreased (0.048501 --> 0.048156).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 6.498417615890503
VALI: Epoch: 45, Steps: 71 | Train Loss: 0.0088625  Vali Loss: 0.0508807 Vali Accuracy: 0.9850598  Vali weighted F1: 0.9850650  Vali macro F1 0.9801385 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 6.513453245162964
VALI: Epoch: 46, Steps: 71 | Train Loss: 0.0083186  Vali Loss: 0.0490173 Vali Accuracy: 0.9840637  Vali weighted F1: 0.9840879  Vali macro F1 0.9792214 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 6.513840436935425
VALI: Epoch: 47, Steps: 71 | Train Loss: 0.0078547  Vali Loss: 0.0494150 Vali Accuracy: 0.9860558  Vali weighted F1: 0.9860320  Vali macro F1 0.9812992 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 6.5636372566223145
VALI: Epoch: 48, Steps: 71 | Train Loss: 0.0069800  Vali Loss: 0.0509246 Vali Accuracy: 0.9860558  Vali weighted F1: 0.9860440  Vali macro F1 0.9809516 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 6.550985336303711
VALI: Epoch: 49, Steps: 71 | Train Loss: 0.0075223  Vali Loss: 0.0519665 Vali Accuracy: 0.9855578  Vali weighted F1: 0.9855459  Vali macro F1 0.9807099 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 50 cost time: 6.540397882461548
VALI: Epoch: 50, Steps: 71 | Train Loss: 0.0067072  Vali Loss: 0.0508485 Vali Accuracy: 0.9860558  Vali weighted F1: 0.9860289  Vali macro F1 0.9819134 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 6.571860074996948
VALI: Epoch: 51, Steps: 71 | Train Loss: 0.0072554  Vali Loss: 0.0504113 Vali Accuracy: 0.9860558  Vali weighted F1: 0.9860443  Vali macro F1 0.9815569 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 6.608131647109985
VALI: Epoch: 52, Steps: 71 | Train Loss: 0.0065393  Vali Loss: 0.0501056 Vali Accuracy: 0.9860558  Vali weighted F1: 0.9860443  Vali macro F1 0.9815569 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 53 cost time: 6.5682151317596436
VALI: Epoch: 53, Steps: 71 | Train Loss: 0.0060718  Vali Loss: 0.0502612 Vali Accuracy: 0.9855578  Vali weighted F1: 0.9855459  Vali macro F1 0.9807099 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 54 cost time: 6.579968452453613
VALI: Epoch: 54, Steps: 71 | Train Loss: 0.0067106  Vali Loss: 0.0502177 Vali Accuracy: 0.9860558  Vali weighted F1: 0.9860443  Vali macro F1 0.9815569 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 55 cost time: 6.559634208679199
VALI: Epoch: 55, Steps: 71 | Train Loss: 0.0062117  Vali Loss: 0.0502045 Vali Accuracy: 0.9860558  Vali weighted F1: 0.9860443  Vali macro F1 0.9815569 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 6.560302734375
VALI: Epoch: 56, Steps: 71 | Train Loss: 0.0074232  Vali Loss: 0.0501102 Vali Accuracy: 0.9860558  Vali weighted F1: 0.9860443  Vali macro F1 0.9815569 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 57 cost time: 6.555607795715332
VALI: Epoch: 57, Steps: 71 | Train Loss: 0.0061637  Vali Loss: 0.0501347 Vali Accuracy: 0.9860558  Vali weighted F1: 0.9860443  Vali macro F1 0.9815569 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 58 cost time: 6.633988857269287
VALI: Epoch: 58, Steps: 71 | Train Loss: 0.0064436  Vali Loss: 0.0500680 Vali Accuracy: 0.9860558  Vali weighted F1: 0.9860443  Vali macro F1 0.9815569 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 59 cost time: 6.6223273277282715
VALI: Epoch: 59, Steps: 71 | Train Loss: 0.0064709  Vali Loss: 0.0500303 Vali Accuracy: 0.9860558  Vali weighted F1: 0.9860443  Vali macro F1 0.9815569 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9211926  Test weighted F1: 0.9201578  Test macro F1 0.8963140 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 240495
pruned model Parameter : 244174
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.567708492279053
Fine Tuning VALI: Epoch: 1, Steps: 71 | Train Loss: 0.0097905  Vali Loss: 0.0521672 Vali Accuracy: 0.9850598  Vali weighted F1: 0.9850248  Vali macro F1 0.9805592 
Validation loss decreased (inf --> 0.052167).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.445347785949707
Fine Tuning VALI: Epoch: 2, Steps: 71 | Train Loss: 0.0080528  Vali Loss: 0.0497250 Vali Accuracy: 0.9845618  Vali weighted F1: 0.9845766  Vali macro F1 0.9796951 
new best score!!!!
Validation loss decreased (0.052167 --> 0.049725).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.399364471435547
Fine Tuning VALI: Epoch: 3, Steps: 71 | Train Loss: 0.0072418  Vali Loss: 0.0504794 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9835912  Vali macro F1 0.9783775 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.402922630310059
Fine Tuning VALI: Epoch: 4, Steps: 71 | Train Loss: 0.0068976  Vali Loss: 0.0504787 Vali Accuracy: 0.9845618  Vali weighted F1: 0.9845906  Vali macro F1 0.9799563 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.411532640457153
Fine Tuning VALI: Epoch: 5, Steps: 71 | Train Loss: 0.0074010  Vali Loss: 0.0549025 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9830963  Vali macro F1 0.9776475 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 6.436161994934082
Fine Tuning VALI: Epoch: 6, Steps: 71 | Train Loss: 0.0066913  Vali Loss: 0.0517933 Vali Accuracy: 0.9845618  Vali weighted F1: 0.9845772  Vali macro F1 0.9796736 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 6.430427312850952
Fine Tuning VALI: Epoch: 7, Steps: 71 | Train Loss: 0.0061133  Vali Loss: 0.0500908 Vali Accuracy: 0.9855578  Vali weighted F1: 0.9855458  Vali macro F1 0.9801056 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 8 cost time: 6.413250923156738
Fine Tuning VALI: Epoch: 8, Steps: 71 | Train Loss: 0.0058730  Vali Loss: 0.0580532 Vali Accuracy: 0.9840637  Vali weighted F1: 0.9841088  Vali macro F1 0.9780266 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.41370153427124
Fine Tuning VALI: Epoch: 9, Steps: 71 | Train Loss: 0.0054605  Vali Loss: 0.0513299 Vali Accuracy: 0.9850598  Vali weighted F1: 0.9850807  Vali macro F1 0.9789943 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 6.41269063949585
Fine Tuning VALI: Epoch: 10, Steps: 71 | Train Loss: 0.0056738  Vali Loss: 0.0495090 Vali Accuracy: 0.9850598  Vali weighted F1: 0.9850574  Vali macro F1 0.9789575 
new best score!!!!
Validation loss decreased (0.049725 --> 0.049509).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 6.413261890411377
Fine Tuning VALI: Epoch: 11, Steps: 71 | Train Loss: 0.0058971  Vali Loss: 0.0467508 Vali Accuracy: 0.9860558  Vali weighted F1: 0.9860425  Vali macro F1 0.9817182 
new best score!!!!
Validation loss decreased (0.049509 --> 0.046751).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 6.434501886367798
Fine Tuning VALI: Epoch: 12, Steps: 71 | Train Loss: 0.0056141  Vali Loss: 0.0493397 Vali Accuracy: 0.9840637  Vali weighted F1: 0.9840907  Vali macro F1 0.9773037 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 6.434785842895508
Fine Tuning VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0056941  Vali Loss: 0.0542000 Vali Accuracy: 0.9855578  Vali weighted F1: 0.9855175  Vali macro F1 0.9801111 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 6.440175294876099
Fine Tuning VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0045700  Vali Loss: 0.0576649 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9835487  Vali macro F1 0.9772492 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 6.435757398605347
Fine Tuning VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0047337  Vali Loss: 0.0536004 Vali Accuracy: 0.9840637  Vali weighted F1: 0.9840600  Vali macro F1 0.9784954 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 6.433687925338745
Fine Tuning VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0047591  Vali Loss: 0.0552602 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9835728  Vali macro F1 0.9767939 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 17 cost time: 6.432982444763184
Fine Tuning VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0040988  Vali Loss: 0.0525946 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9836055  Vali macro F1 0.9769630 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 6.442946195602417
Fine Tuning VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0045359  Vali Loss: 0.0552060 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9836055  Vali macro F1 0.9769630 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 6.447320222854614
Fine Tuning VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0039397  Vali Loss: 0.0507624 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9835835  Vali macro F1 0.9773061 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 6.438290596008301
Fine Tuning VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0041023  Vali Loss: 0.0517185 Vali Accuracy: 0.9840637  Vali weighted F1: 0.9840998  Vali macro F1 0.9778011 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 6.434269666671753
Fine Tuning VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0037454  Vali Loss: 0.0525001 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9835835  Vali macro F1 0.9773061 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 22 cost time: 6.439432144165039
Fine Tuning VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0043837  Vali Loss: 0.0523560 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9835835  Vali macro F1 0.9773061 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 6.425811290740967
Fine Tuning VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0039766  Vali Loss: 0.0524683 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9835835  Vali macro F1 0.9773061 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 6.4328837394714355
Fine Tuning VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0039353  Vali Loss: 0.0523607 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9835835  Vali macro F1 0.9773061 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 6.441877841949463
Fine Tuning VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0039897  Vali Loss: 0.0521680 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9835835  Vali macro F1 0.9773061 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 6.449155330657959
Fine Tuning VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0041375  Vali Loss: 0.0523810 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9836055  Vali macro F1 0.9769630 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9313899  Test weighted F1: 0.9287761  Test macro F1 0.8742970 
Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 240495
Set the seed as :  2
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
-----------------------Sliding file are generated -----------------------
================ LOCV Mode ====================
================ 10 CV ======================
================ the 0 th CV Experiment ================ 
Leave one Out Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.00014674 0.00018002 0.00097466 0.00124224 0.00048757 0.00060643]
Train data number :  17901
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1989
Test data number :  9947
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.348559856414795
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.0281597  Vali Loss: 0.6368679 Vali Accuracy: 0.7596782  Vali weighted F1: 0.7094806  Vali macro F1 0.5071420 
Validation loss decreased (inf --> 0.636868).  Saving model ...
Epoch: 2 cost time: 6.358867883682251
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.5127413  Vali Loss: 0.4675047 Vali Accuracy: 0.8305681  Vali weighted F1: 0.8117378  Vali macro F1 0.7541530 
new best score!!!!
Validation loss decreased (0.636868 --> 0.467505).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.349013328552246
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.3838158  Vali Loss: 0.3398458 Vali Accuracy: 0.8758170  Vali weighted F1: 0.8703221  Vali macro F1 0.8271899 
new best score!!!!
Validation loss decreased (0.467505 --> 0.339846).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.350320339202881
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.3081239  Vali Loss: 0.2831535 Vali Accuracy: 0.9024635  Vali weighted F1: 0.9019564  Vali macro F1 0.8680131 
new best score!!!!
Validation loss decreased (0.339846 --> 0.283153).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.374572038650513
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.2282253  Vali Loss: 0.2102739 Vali Accuracy: 0.9291101  Vali weighted F1: 0.9284356  Vali macro F1 0.9017732 
new best score!!!!
Validation loss decreased (0.283153 --> 0.210274).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.376063585281372
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.1905633  Vali Loss: 0.2020697 Vali Accuracy: 0.9230769  Vali weighted F1: 0.9216862  Vali macro F1 0.8881879 
new best score!!!!
Validation loss decreased (0.210274 --> 0.202070).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.363368511199951
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.1695490  Vali Loss: 0.1506583 Vali Accuracy: 0.9441931  Vali weighted F1: 0.9443626  Vali macro F1 0.9179885 
new best score!!!!
Validation loss decreased (0.202070 --> 0.150658).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.365264415740967
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1478490  Vali Loss: 0.1400426 Vali Accuracy: 0.9482152  Vali weighted F1: 0.9484687  Vali macro F1 0.9283624 
new best score!!!!
Validation loss decreased (0.150658 --> 0.140043).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.361436605453491
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1319594  Vali Loss: 0.1298346 Vali Accuracy: 0.9482152  Vali weighted F1: 0.9484213  Vali macro F1 0.9191315 
new best score!!!!
Validation loss decreased (0.140043 --> 0.129835).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.363737344741821
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1187079  Vali Loss: 0.1330864 Vali Accuracy: 0.9542484  Vali weighted F1: 0.9549800  Vali macro F1 0.9369548 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.348849773406982
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1129649  Vali Loss: 0.1306766 Vali Accuracy: 0.9547511  Vali weighted F1: 0.9556683  Vali macro F1 0.9443060 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 12 cost time: 6.360849142074585
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.1043066  Vali Loss: 0.1106115 Vali Accuracy: 0.9632981  Vali weighted F1: 0.9634974  Vali macro F1 0.9536640 
new best score!!!!
Validation loss decreased (0.129835 --> 0.110611).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.3598597049713135
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.1024343  Vali Loss: 0.1142951 Vali Accuracy: 0.9617898  Vali weighted F1: 0.9617847  Vali macro F1 0.9470110 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 6.352867126464844
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0870495  Vali Loss: 0.1006655 Vali Accuracy: 0.9683258  Vali weighted F1: 0.9685507  Vali macro F1 0.9603894 
new best score!!!!
Validation loss decreased (0.110611 --> 0.100665).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.365265369415283
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0776330  Vali Loss: 0.1029294 Vali Accuracy: 0.9653092  Vali weighted F1: 0.9652654  Vali macro F1 0.9557716 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.350768089294434
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0762031  Vali Loss: 0.0877978 Vali Accuracy: 0.9718451  Vali weighted F1: 0.9716527  Vali macro F1 0.9645491 
new best score!!!!
Validation loss decreased (0.100665 --> 0.087798).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.3649582862854
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0670019  Vali Loss: 0.0762066 Vali Accuracy: 0.9743590  Vali weighted F1: 0.9743753  Vali macro F1 0.9669669 
new best score!!!!
Validation loss decreased (0.087798 --> 0.076207).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.369802236557007
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0670166  Vali Loss: 0.0917009 Vali Accuracy: 0.9688286  Vali weighted F1: 0.9690279  Vali macro F1 0.9573786 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.375606298446655
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0581615  Vali Loss: 0.0723549 Vali Accuracy: 0.9753645  Vali weighted F1: 0.9754902  Vali macro F1 0.9687898 
new best score!!!!
Validation loss decreased (0.076207 --> 0.072355).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.375736713409424
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0497398  Vali Loss: 0.0705993 Vali Accuracy: 0.9768728  Vali weighted F1: 0.9768749  Vali macro F1 0.9687109 
new best score!!!!
Validation loss decreased (0.072355 --> 0.070599).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.368139266967773
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0502207  Vali Loss: 0.0830637 Vali Accuracy: 0.9708396  Vali weighted F1: 0.9709615  Vali macro F1 0.9625508 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 6.348628282546997
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0496263  Vali Loss: 0.0833127 Vali Accuracy: 0.9698341  Vali weighted F1: 0.9700399  Vali macro F1 0.9614220 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 6.350221633911133
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0495593  Vali Loss: 0.0626197 Vali Accuracy: 0.9778783  Vali weighted F1: 0.9778930  Vali macro F1 0.9709896 
new best score!!!!
Validation loss decreased (0.070599 --> 0.062620).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.361213684082031
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0388002  Vali Loss: 0.0665787 Vali Accuracy: 0.9758673  Vali weighted F1: 0.9759029  Vali macro F1 0.9676734 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 6.34944224357605
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0433236  Vali Loss: 0.0713262 Vali Accuracy: 0.9733534  Vali weighted F1: 0.9731945  Vali macro F1 0.9656238 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 6.3729963302612305
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0341354  Vali Loss: 0.0738752 Vali Accuracy: 0.9713424  Vali weighted F1: 0.9712496  Vali macro F1 0.9650921 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 27 cost time: 6.361286163330078
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0368423  Vali Loss: 0.0640983 Vali Accuracy: 0.9788839  Vali weighted F1: 0.9788722  Vali macro F1 0.9720792 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 28 cost time: 6.355933427810669
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0390210  Vali Loss: 0.0769701 Vali Accuracy: 0.9768728  Vali weighted F1: 0.9768570  Vali macro F1 0.9693006 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 29 cost time: 6.350032329559326
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0233087  Vali Loss: 0.0577219 Vali Accuracy: 0.9803922  Vali weighted F1: 0.9803352  Vali macro F1 0.9733955 
new best score!!!!
Validation loss decreased (0.062620 --> 0.057722).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.360881090164185
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0195355  Vali Loss: 0.0586575 Vali Accuracy: 0.9803922  Vali weighted F1: 0.9802973  Vali macro F1 0.9731052 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 6.351762294769287
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0187395  Vali Loss: 0.0596702 Vali Accuracy: 0.9798894  Vali weighted F1: 0.9797737  Vali macro F1 0.9723894 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 6.348902463912964
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0183531  Vali Loss: 0.0589121 Vali Accuracy: 0.9824032  Vali weighted F1: 0.9823972  Vali macro F1 0.9769769 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 6.382422685623169
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0173799  Vali Loss: 0.0573037 Vali Accuracy: 0.9808949  Vali weighted F1: 0.9808849  Vali macro F1 0.9741571 
new best score!!!!
Validation loss decreased (0.057722 --> 0.057304).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.3678765296936035
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0159805  Vali Loss: 0.0593600 Vali Accuracy: 0.9808949  Vali weighted F1: 0.9809031  Vali macro F1 0.9749247 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 6.362097263336182
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0156768  Vali Loss: 0.0599683 Vali Accuracy: 0.9813977  Vali weighted F1: 0.9813923  Vali macro F1 0.9753452 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 6.360329866409302
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0156259  Vali Loss: 0.0577584 Vali Accuracy: 0.9813977  Vali weighted F1: 0.9813801  Vali macro F1 0.9745538 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 6.361853122711182
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0143512  Vali Loss: 0.0593501 Vali Accuracy: 0.9829060  Vali weighted F1: 0.9828752  Vali macro F1 0.9779329 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 6.359890699386597
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0144374  Vali Loss: 0.0585852 Vali Accuracy: 0.9813977  Vali weighted F1: 0.9814003  Vali macro F1 0.9746215 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 39 cost time: 6.374049186706543
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0144415  Vali Loss: 0.0582554 Vali Accuracy: 0.9824032  Vali weighted F1: 0.9824091  Vali macro F1 0.9766444 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 6.3676910400390625
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0140581  Vali Loss: 0.0579914 Vali Accuracy: 0.9824032  Vali weighted F1: 0.9824091  Vali macro F1 0.9766444 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 6.357084274291992
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0143853  Vali Loss: 0.0581933 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9818938  Vali macro F1 0.9758066 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 6.360597372055054
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0128159  Vali Loss: 0.0585979 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9818938  Vali macro F1 0.9758066 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 6.3575286865234375
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0135470  Vali Loss: 0.0581737 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9818883  Vali macro F1 0.9753664 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 44 cost time: 6.353179216384888
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0138935  Vali Loss: 0.0582239 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9818883  Vali macro F1 0.9753664 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 6.350489616394043
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0140543  Vali Loss: 0.0582584 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9818883  Vali macro F1 0.9753664 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 6.369884014129639
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0130809  Vali Loss: 0.0582942 Vali Accuracy: 0.9813977  Vali weighted F1: 0.9813801  Vali macro F1 0.9745538 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 6.364343166351318
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0141776  Vali Loss: 0.0582824 Vali Accuracy: 0.9813977  Vali weighted F1: 0.9813801  Vali macro F1 0.9745538 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 6.349400758743286
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0136322  Vali Loss: 0.0582483 Vali Accuracy: 0.9813977  Vali weighted F1: 0.9813801  Vali macro F1 0.9745538 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8464864  Test weighted F1: 0.8587108  Test macro F1 0.8242294 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 240495
pruned model Parameter : 244174
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.353943824768066
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0174754  Vali Loss: 0.0582644 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9819087  Vali macro F1 0.9759050 
Validation loss decreased (inf --> 0.058264).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.335003614425659
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0188932  Vali Loss: 0.0596418 Vali Accuracy: 0.9813977  Vali weighted F1: 0.9814014  Vali macro F1 0.9744986 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.3334410190582275
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0158379  Vali Loss: 0.0592886 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9818931  Vali macro F1 0.9763464 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.337208986282349
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0142195  Vali Loss: 0.0594144 Vali Accuracy: 0.9808949  Vali weighted F1: 0.9809068  Vali macro F1 0.9746039 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.3824262619018555
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0146145  Vali Loss: 0.0624143 Vali Accuracy: 0.9803922  Vali weighted F1: 0.9802714  Vali macro F1 0.9732076 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.349058389663696
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0147156  Vali Loss: 0.0594790 Vali Accuracy: 0.9839115  Vali weighted F1: 0.9838649  Vali macro F1 0.9777429 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.346286773681641
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0140693  Vali Loss: 0.0590034 Vali Accuracy: 0.9824032  Vali weighted F1: 0.9823928  Vali macro F1 0.9765912 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.34263277053833
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0137524  Vali Loss: 0.0650482 Vali Accuracy: 0.9813977  Vali weighted F1: 0.9813328  Vali macro F1 0.9758907 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.342956066131592
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0125633  Vali Loss: 0.0583058 Vali Accuracy: 0.9808949  Vali weighted F1: 0.9809039  Vali macro F1 0.9751827 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.339684009552002
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0120301  Vali Loss: 0.0583447 Vali Accuracy: 0.9839115  Vali weighted F1: 0.9839087  Vali macro F1 0.9785797 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 11 cost time: 6.36670994758606
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0109619  Vali Loss: 0.0586441 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9819015  Vali macro F1 0.9762888 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.364854574203491
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0104631  Vali Loss: 0.0585034 Vali Accuracy: 0.9824032  Vali weighted F1: 0.9824008  Vali macro F1 0.9767375 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.350168704986572
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0114199  Vali Loss: 0.0583452 Vali Accuracy: 0.9824032  Vali weighted F1: 0.9824049  Vali macro F1 0.9765016 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.3557422161102295
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0112163  Vali Loss: 0.0575564 Vali Accuracy: 0.9834087  Vali weighted F1: 0.9834065  Vali macro F1 0.9783300 
new best score!!!!
Validation loss decreased (0.058264 --> 0.057556).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 6.359606027603149
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0111315  Vali Loss: 0.0579290 Vali Accuracy: 0.9829060  Vali weighted F1: 0.9829120  Vali macro F1 0.9779872 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.3668389320373535
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0112595  Vali Loss: 0.0583393 Vali Accuracy: 0.9824032  Vali weighted F1: 0.9824058  Vali macro F1 0.9771786 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 6.343416929244995
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0113107  Vali Loss: 0.0583942 Vali Accuracy: 0.9824032  Vali weighted F1: 0.9824049  Vali macro F1 0.9765016 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 6.372857332229614
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0112244  Vali Loss: 0.0573875 Vali Accuracy: 0.9834087  Vali weighted F1: 0.9834065  Vali macro F1 0.9783300 
new best score!!!!
Validation loss decreased (0.057556 --> 0.057388).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 6.356251001358032
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0104918  Vali Loss: 0.0576877 Vali Accuracy: 0.9824032  Vali weighted F1: 0.9824121  Vali macro F1 0.9765260 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 6.350396156311035
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0100428  Vali Loss: 0.0576687 Vali Accuracy: 0.9824032  Vali weighted F1: 0.9824066  Vali macro F1 0.9761784 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 6.339838266372681
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0106571  Vali Loss: 0.0579712 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9818850  Vali macro F1 0.9759005 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 6.339704275131226
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0100783  Vali Loss: 0.0582159 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9818981  Vali macro F1 0.9756915 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 23 cost time: 6.343779563903809
Fine Tuning VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0110112  Vali Loss: 0.0583990 Vali Accuracy: 0.9829060  Vali weighted F1: 0.9829013  Vali macro F1 0.9771988 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 24 cost time: 6.364373445510864
Fine Tuning VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0103684  Vali Loss: 0.0581633 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9818850  Vali macro F1 0.9759005 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 25 cost time: 6.369969129562378
Fine Tuning VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0099279  Vali Loss: 0.0580499 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9818850  Vali macro F1 0.9759005 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 26 cost time: 6.352018356323242
Fine Tuning VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0094986  Vali Loss: 0.0580448 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9818850  Vali macro F1 0.9759005 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 27 cost time: 6.352217197418213
Fine Tuning VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0108435  Vali Loss: 0.0580150 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9818850  Vali macro F1 0.9759005 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 28 cost time: 6.341747522354126
Fine Tuning VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0104804  Vali Loss: 0.0580286 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9818850  Vali macro F1 0.9759005 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Fine Tuning Epoch: 29 cost time: 6.343205451965332
Fine Tuning VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0097390  Vali Loss: 0.0580297 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9818850  Vali macro F1 0.9759005 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 30 cost time: 6.345053672790527
Fine Tuning VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0100307  Vali Loss: 0.0580301 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9818850  Vali macro F1 0.9759005 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 31 cost time: 6.374373912811279
Fine Tuning VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0106278  Vali Loss: 0.0580324 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9818850  Vali macro F1 0.9759005 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 32 cost time: 6.347620725631714
Fine Tuning VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0105175  Vali Loss: 0.0580337 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9818850  Vali macro F1 0.9759005 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 33 cost time: 6.353370428085327
Fine Tuning VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0099469  Vali Loss: 0.0580301 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9818850  Vali macro F1 0.9759005 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8517141  Test weighted F1: 0.8622867  Test macro F1 0.8310061 
================ the 1 th CV Experiment ================ 
Leave one Out Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00014952 0.00018225 0.0010989  0.00140056 0.0005071  0.00063211]
Train data number :  17353
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1929
Test data number :  12988
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.141905307769775
VALI: Epoch: 1, Steps: 68 | Train Loss: 1.0168922  Vali Loss: 0.7175426 Vali Accuracy: 0.7216174  Vali weighted F1: 0.6705007  Vali macro F1 0.4720896 
Validation loss decreased (inf --> 0.717543).  Saving model ...
Epoch: 2 cost time: 6.14660906791687
VALI: Epoch: 2, Steps: 68 | Train Loss: 0.5476220  Vali Loss: 0.5112657 Vali Accuracy: 0.8102644  Vali weighted F1: 0.7910905  Vali macro F1 0.7365165 
new best score!!!!
Validation loss decreased (0.717543 --> 0.511266).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.148008346557617
VALI: Epoch: 3, Steps: 68 | Train Loss: 0.3902223  Vali Loss: 0.3567624 Vali Accuracy: 0.8688440  Vali weighted F1: 0.8599010  Vali macro F1 0.8223357 
new best score!!!!
Validation loss decreased (0.511266 --> 0.356762).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.159196615219116
VALI: Epoch: 4, Steps: 68 | Train Loss: 0.2843499  Vali Loss: 0.2718638 Vali Accuracy: 0.9113530  Vali weighted F1: 0.9102652  Vali macro F1 0.8810420 
new best score!!!!
Validation loss decreased (0.356762 --> 0.271864).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.157485008239746
VALI: Epoch: 5, Steps: 68 | Train Loss: 0.2172967  Vali Loss: 0.2076796 Vali Accuracy: 0.9351996  Vali weighted F1: 0.9349125  Vali macro F1 0.9162933 
new best score!!!!
Validation loss decreased (0.271864 --> 0.207680).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.140888452529907
VALI: Epoch: 6, Steps: 68 | Train Loss: 0.1623387  Vali Loss: 0.1731777 Vali Accuracy: 0.9434940  Vali weighted F1: 0.9428879  Vali macro F1 0.9253985 
new best score!!!!
Validation loss decreased (0.207680 --> 0.173178).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.13834810256958
VALI: Epoch: 7, Steps: 68 | Train Loss: 0.1446801  Vali Loss: 0.1540731 Vali Accuracy: 0.9481597  Vali weighted F1: 0.9478437  Vali macro F1 0.9278203 
new best score!!!!
Validation loss decreased (0.173178 --> 0.154073).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.1482932567596436
VALI: Epoch: 8, Steps: 68 | Train Loss: 0.1233022  Vali Loss: 0.1454347 Vali Accuracy: 0.9543805  Vali weighted F1: 0.9539683  Vali macro F1 0.9423812 
new best score!!!!
Validation loss decreased (0.154073 --> 0.145435).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.152836084365845
VALI: Epoch: 9, Steps: 68 | Train Loss: 0.1100221  Vali Loss: 0.1134284 Vali Accuracy: 0.9595645  Vali weighted F1: 0.9597215  Vali macro F1 0.9533586 
new best score!!!!
Validation loss decreased (0.145435 --> 0.113428).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.152503728866577
VALI: Epoch: 10, Steps: 68 | Train Loss: 0.0961739  Vali Loss: 0.1046510 Vali Accuracy: 0.9683774  Vali weighted F1: 0.9682467  Vali macro F1 0.9623086 
new best score!!!!
Validation loss decreased (0.113428 --> 0.104651).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.171894311904907
VALI: Epoch: 11, Steps: 68 | Train Loss: 0.1030893  Vali Loss: 0.0990306 Vali Accuracy: 0.9657854  Vali weighted F1: 0.9657488  Vali macro F1 0.9605603 
new best score!!!!
Validation loss decreased (0.104651 --> 0.099031).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.174736499786377
VALI: Epoch: 12, Steps: 68 | Train Loss: 0.0838805  Vali Loss: 0.0884867 Vali Accuracy: 0.9699326  Vali weighted F1: 0.9699875  Vali macro F1 0.9652163 
new best score!!!!
Validation loss decreased (0.099031 --> 0.088487).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.153581380844116
VALI: Epoch: 13, Steps: 68 | Train Loss: 0.0764293  Vali Loss: 0.0871455 Vali Accuracy: 0.9720062  Vali weighted F1: 0.9719947  Vali macro F1 0.9634031 
new best score!!!!
Validation loss decreased (0.088487 --> 0.087146).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.153746843338013
VALI: Epoch: 14, Steps: 68 | Train Loss: 0.0642575  Vali Loss: 0.0827873 Vali Accuracy: 0.9740798  Vali weighted F1: 0.9739978  Vali macro F1 0.9682354 
new best score!!!!
Validation loss decreased (0.087146 --> 0.082787).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.141883134841919
VALI: Epoch: 15, Steps: 68 | Train Loss: 0.0620530  Vali Loss: 0.1244012 Vali Accuracy: 0.9647486  Vali weighted F1: 0.9649505  Vali macro F1 0.9599922 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.154638051986694
VALI: Epoch: 16, Steps: 68 | Train Loss: 0.0577487  Vali Loss: 0.0813452 Vali Accuracy: 0.9751166  Vali weighted F1: 0.9750464  Vali macro F1 0.9700915 
new best score!!!!
Validation loss decreased (0.082787 --> 0.081345).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.1452789306640625
VALI: Epoch: 17, Steps: 68 | Train Loss: 0.0580733  Vali Loss: 0.0649522 Vali Accuracy: 0.9792639  Vali weighted F1: 0.9793956  Vali macro F1 0.9756699 
new best score!!!!
Validation loss decreased (0.081345 --> 0.064952).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.1748573780059814
VALI: Epoch: 18, Steps: 68 | Train Loss: 0.0455424  Vali Loss: 0.0730668 Vali Accuracy: 0.9782271  Vali weighted F1: 0.9780700  Vali macro F1 0.9743308 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.16943621635437
VALI: Epoch: 19, Steps: 68 | Train Loss: 0.0483983  Vali Loss: 0.0686561 Vali Accuracy: 0.9756350  Vali weighted F1: 0.9756069  Vali macro F1 0.9701659 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 6.141845941543579
VALI: Epoch: 20, Steps: 68 | Train Loss: 0.0356579  Vali Loss: 0.0638727 Vali Accuracy: 0.9771903  Vali weighted F1: 0.9771872  Vali macro F1 0.9725215 
new best score!!!!
Validation loss decreased (0.064952 --> 0.063873).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.1455395221710205
VALI: Epoch: 21, Steps: 68 | Train Loss: 0.0399169  Vali Loss: 0.0665939 Vali Accuracy: 0.9808191  Vali weighted F1: 0.9808113  Vali macro F1 0.9762710 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 6.135425567626953
VALI: Epoch: 22, Steps: 68 | Train Loss: 0.0533622  Vali Loss: 0.0561086 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9813619  Vali macro F1 0.9778673 
new best score!!!!
Validation loss decreased (0.063873 --> 0.056109).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.155816555023193
VALI: Epoch: 23, Steps: 68 | Train Loss: 0.0316215  Vali Loss: 0.0788944 Vali Accuracy: 0.9720062  Vali weighted F1: 0.9719000  Vali macro F1 0.9671363 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 6.147655010223389
VALI: Epoch: 24, Steps: 68 | Train Loss: 0.0273838  Vali Loss: 0.0547095 Vali Accuracy: 0.9844479  Vali weighted F1: 0.9844509  Vali macro F1 0.9808415 
new best score!!!!
Validation loss decreased (0.056109 --> 0.054710).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.1737916469573975
VALI: Epoch: 25, Steps: 68 | Train Loss: 0.0276621  Vali Loss: 0.0753272 Vali Accuracy: 0.9777087  Vali weighted F1: 0.9776025  Vali macro F1 0.9726771 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 6.156018018722534
VALI: Epoch: 26, Steps: 68 | Train Loss: 0.0290089  Vali Loss: 0.0848732 Vali Accuracy: 0.9725246  Vali weighted F1: 0.9722608  Vali macro F1 0.9677793 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 6.1473774909973145
VALI: Epoch: 27, Steps: 68 | Train Loss: 0.0256035  Vali Loss: 0.0634613 Vali Accuracy: 0.9803007  Vali weighted F1: 0.9802924  Vali macro F1 0.9763273 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 28 cost time: 6.144446611404419
VALI: Epoch: 28, Steps: 68 | Train Loss: 0.0268488  Vali Loss: 0.0885276 Vali Accuracy: 0.9777087  Vali weighted F1: 0.9776740  Vali macro F1 0.9745602 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 29 cost time: 6.138289451599121
VALI: Epoch: 29, Steps: 68 | Train Loss: 0.0247254  Vali Loss: 0.0594265 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9817834  Vali macro F1 0.9795559 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 30 cost time: 6.158080816268921
VALI: Epoch: 30, Steps: 68 | Train Loss: 0.0148222  Vali Loss: 0.0509099 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9839081  Vali macro F1 0.9814111 
new best score!!!!
Validation loss decreased (0.054710 --> 0.050910).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.158468961715698
VALI: Epoch: 31, Steps: 68 | Train Loss: 0.0135802  Vali Loss: 0.0513120 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9839533  Vali macro F1 0.9814618 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 6.172660827636719
VALI: Epoch: 32, Steps: 68 | Train Loss: 0.0119732  Vali Loss: 0.0483976 Vali Accuracy: 0.9849663  Vali weighted F1: 0.9849596  Vali macro F1 0.9830130 
new best score!!!!
Validation loss decreased (0.050910 --> 0.048398).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.161273956298828
VALI: Epoch: 33, Steps: 68 | Train Loss: 0.0117140  Vali Loss: 0.0490238 Vali Accuracy: 0.9849663  Vali weighted F1: 0.9849978  Vali macro F1 0.9828115 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 6.150913953781128
VALI: Epoch: 34, Steps: 68 | Train Loss: 0.0116972  Vali Loss: 0.0489427 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9828795  Vali macro F1 0.9803970 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 6.152462959289551
VALI: Epoch: 35, Steps: 68 | Train Loss: 0.0114516  Vali Loss: 0.0508470 Vali Accuracy: 0.9849663  Vali weighted F1: 0.9849678  Vali macro F1 0.9832991 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 36 cost time: 6.143739700317383
VALI: Epoch: 36, Steps: 68 | Train Loss: 0.0114910  Vali Loss: 0.0494457 Vali Accuracy: 0.9844479  Vali weighted F1: 0.9844579  Vali macro F1 0.9822574 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 37 cost time: 6.152652740478516
VALI: Epoch: 37, Steps: 68 | Train Loss: 0.0105341  Vali Loss: 0.0493911 Vali Accuracy: 0.9849663  Vali weighted F1: 0.9849578  Vali macro F1 0.9828043 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 38 cost time: 6.14582633972168
VALI: Epoch: 38, Steps: 68 | Train Loss: 0.0105215  Vali Loss: 0.0495096 Vali Accuracy: 0.9854847  Vali weighted F1: 0.9854964  Vali macro F1 0.9830938 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 6.148632764816284
VALI: Epoch: 39, Steps: 68 | Train Loss: 0.0099855  Vali Loss: 0.0502121 Vali Accuracy: 0.9844479  Vali weighted F1: 0.9844361  Vali macro F1 0.9822384 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 6.1588499546051025
VALI: Epoch: 40, Steps: 68 | Train Loss: 0.0105533  Vali Loss: 0.0497850 Vali Accuracy: 0.9849663  Vali weighted F1: 0.9849680  Vali macro F1 0.9825640 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 6.149133205413818
VALI: Epoch: 41, Steps: 68 | Train Loss: 0.0096513  Vali Loss: 0.0500222 Vali Accuracy: 0.9849663  Vali weighted F1: 0.9849684  Vali macro F1 0.9827867 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 42 cost time: 6.136857509613037
VALI: Epoch: 42, Steps: 68 | Train Loss: 0.0092316  Vali Loss: 0.0504317 Vali Accuracy: 0.9849663  Vali weighted F1: 0.9849663  Vali macro F1 0.9827696 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 43 cost time: 6.149084091186523
VALI: Epoch: 43, Steps: 68 | Train Loss: 0.0098702  Vali Loss: 0.0504225 Vali Accuracy: 0.9849663  Vali weighted F1: 0.9849663  Vali macro F1 0.9827696 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 6.142742156982422
VALI: Epoch: 44, Steps: 68 | Train Loss: 0.0095126  Vali Loss: 0.0503884 Vali Accuracy: 0.9849663  Vali weighted F1: 0.9849556  Vali macro F1 0.9824959 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 6.1448071002960205
VALI: Epoch: 45, Steps: 68 | Train Loss: 0.0100058  Vali Loss: 0.0502854 Vali Accuracy: 0.9849663  Vali weighted F1: 0.9849680  Vali macro F1 0.9825640 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 46 cost time: 6.153431415557861
VALI: Epoch: 46, Steps: 68 | Train Loss: 0.0097329  Vali Loss: 0.0502350 Vali Accuracy: 0.9849663  Vali weighted F1: 0.9849680  Vali macro F1 0.9825640 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 47 cost time: 6.173916816711426
VALI: Epoch: 47, Steps: 68 | Train Loss: 0.0106783  Vali Loss: 0.0501802 Vali Accuracy: 0.9849663  Vali weighted F1: 0.9849680  Vali macro F1 0.9825640 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9554204  Test weighted F1: 0.9557000  Test macro F1 0.9289408 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 240495
pruned model Parameter : 244174
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.179455757141113
Fine Tuning VALI: Epoch: 1, Steps: 68 | Train Loss: 0.0142703  Vali Loss: 0.0524003 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9829487  Vali macro F1 0.9797083 
Validation loss decreased (inf --> 0.052400).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.15014910697937
Fine Tuning VALI: Epoch: 2, Steps: 68 | Train Loss: 0.0119845  Vali Loss: 0.0510263 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9839420  Vali macro F1 0.9812630 
new best score!!!!
Validation loss decreased (0.052400 --> 0.051026).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.1407647132873535
Fine Tuning VALI: Epoch: 3, Steps: 68 | Train Loss: 0.0113438  Vali Loss: 0.0494483 Vali Accuracy: 0.9849663  Vali weighted F1: 0.9849534  Vali macro F1 0.9833159 
new best score!!!!
Validation loss decreased (0.051026 --> 0.049448).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.1474528312683105
Fine Tuning VALI: Epoch: 4, Steps: 68 | Train Loss: 0.0113565  Vali Loss: 0.0536142 Vali Accuracy: 0.9834111  Vali weighted F1: 0.9833922  Vali macro F1 0.9806910 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.161752462387085
Fine Tuning VALI: Epoch: 5, Steps: 68 | Train Loss: 0.0106071  Vali Loss: 0.0511386 Vali Accuracy: 0.9849663  Vali weighted F1: 0.9849975  Vali macro F1 0.9828095 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 6.165499210357666
Fine Tuning VALI: Epoch: 6, Steps: 68 | Train Loss: 0.0097984  Vali Loss: 0.0551680 Vali Accuracy: 0.9844479  Vali weighted F1: 0.9844316  Vali macro F1 0.9824426 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 6.161835432052612
Fine Tuning VALI: Epoch: 7, Steps: 68 | Train Loss: 0.0100957  Vali Loss: 0.0609061 Vali Accuracy: 0.9823743  Vali weighted F1: 0.9823049  Vali macro F1 0.9799843 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 8 cost time: 6.155751705169678
Fine Tuning VALI: Epoch: 8, Steps: 68 | Train Loss: 0.0105895  Vali Loss: 0.0505823 Vali Accuracy: 0.9849663  Vali weighted F1: 0.9849367  Vali macro F1 0.9827707 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 9 cost time: 6.149467468261719
Fine Tuning VALI: Epoch: 9, Steps: 68 | Train Loss: 0.0097737  Vali Loss: 0.0517467 Vali Accuracy: 0.9865215  Vali weighted F1: 0.9865119  Vali macro F1 0.9837385 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.140899181365967
Fine Tuning VALI: Epoch: 10, Steps: 68 | Train Loss: 0.0083756  Vali Loss: 0.0529421 Vali Accuracy: 0.9844479  Vali weighted F1: 0.9844008  Vali macro F1 0.9824969 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 6.174964189529419
Fine Tuning VALI: Epoch: 11, Steps: 68 | Train Loss: 0.0087076  Vali Loss: 0.0519167 Vali Accuracy: 0.9849663  Vali weighted F1: 0.9849643  Vali macro F1 0.9822681 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 6.148325443267822
Fine Tuning VALI: Epoch: 12, Steps: 68 | Train Loss: 0.0091070  Vali Loss: 0.0528068 Vali Accuracy: 0.9849663  Vali weighted F1: 0.9849441  Vali macro F1 0.9827376 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 6.172356367111206
Fine Tuning VALI: Epoch: 13, Steps: 68 | Train Loss: 0.0085663  Vali Loss: 0.0496079 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9839518  Vali macro F1 0.9812794 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 14 cost time: 6.178215503692627
Fine Tuning VALI: Epoch: 14, Steps: 68 | Train Loss: 0.0079265  Vali Loss: 0.0496508 Vali Accuracy: 0.9860031  Vali weighted F1: 0.9860052  Vali macro F1 0.9838576 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 6.165477752685547
Fine Tuning VALI: Epoch: 15, Steps: 68 | Train Loss: 0.0079939  Vali Loss: 0.0501505 Vali Accuracy: 0.9854847  Vali weighted F1: 0.9854904  Vali macro F1 0.9830765 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 6.165306091308594
Fine Tuning VALI: Epoch: 16, Steps: 68 | Train Loss: 0.0068817  Vali Loss: 0.0498185 Vali Accuracy: 0.9854847  Vali weighted F1: 0.9854904  Vali macro F1 0.9830765 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 6.174392223358154
Fine Tuning VALI: Epoch: 17, Steps: 68 | Train Loss: 0.0069335  Vali Loss: 0.0496653 Vali Accuracy: 0.9849663  Vali weighted F1: 0.9849633  Vali macro F1 0.9825485 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 6.168288469314575
Fine Tuning VALI: Epoch: 18, Steps: 68 | Train Loss: 0.0074019  Vali Loss: 0.0497788 Vali Accuracy: 0.9844479  Vali weighted F1: 0.9844353  Vali macro F1 0.9820190 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9580382  Test weighted F1: 0.9584956  Test macro F1 0.9333939 
================ the 2 th CV Experiment ================ 
Leave one Out Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.00014912 0.00018139 0.00098425 0.00125471 0.00049529 0.00061237]
Train data number :  17684
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1965
Test data number :  11154
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.291987657546997
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.0057603  Vali Loss: 0.5968344 Vali Accuracy: 0.7781170  Vali weighted F1: 0.7209259  Vali macro F1 0.5002924 
Validation loss decreased (inf --> 0.596834).  Saving model ...
Epoch: 2 cost time: 6.302926540374756
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.5037618  Vali Loss: 0.4037938 Vali Accuracy: 0.8625954  Vali weighted F1: 0.8555310  Vali macro F1 0.8063172 
new best score!!!!
Validation loss decreased (0.596834 --> 0.403794).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.271871328353882
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.3572326  Vali Loss: 0.2801343 Vali Accuracy: 0.9027990  Vali weighted F1: 0.9056671  Vali macro F1 0.8676822 
new best score!!!!
Validation loss decreased (0.403794 --> 0.280134).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.278508186340332
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.2464830  Vali Loss: 0.2399663 Vali Accuracy: 0.9231552  Vali weighted F1: 0.9200411  Vali macro F1 0.8851165 
new best score!!!!
Validation loss decreased (0.280134 --> 0.239966).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.2895402908325195
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.1980643  Vali Loss: 0.1890533 Vali Accuracy: 0.9389313  Vali weighted F1: 0.9400232  Vali macro F1 0.9155454 
new best score!!!!
Validation loss decreased (0.239966 --> 0.189053).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.296334266662598
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.1670734  Vali Loss: 0.1771616 Vali Accuracy: 0.9414758  Vali weighted F1: 0.9413974  Vali macro F1 0.9122250 
new best score!!!!
Validation loss decreased (0.189053 --> 0.177162).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.289308071136475
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.1530688  Vali Loss: 0.1315524 Vali Accuracy: 0.9547074  Vali weighted F1: 0.9542623  Vali macro F1 0.9363441 
new best score!!!!
Validation loss decreased (0.177162 --> 0.131552).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.3144049644470215
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1440815  Vali Loss: 0.1257894 Vali Accuracy: 0.9597964  Vali weighted F1: 0.9593632  Vali macro F1 0.9461809 
new best score!!!!
Validation loss decreased (0.131552 --> 0.125789).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.282704591751099
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1259610  Vali Loss: 0.1199904 Vali Accuracy: 0.9597964  Vali weighted F1: 0.9599599  Vali macro F1 0.9466110 
new best score!!!!
Validation loss decreased (0.125789 --> 0.119990).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.285329580307007
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1090949  Vali Loss: 0.0987390 Vali Accuracy: 0.9684478  Vali weighted F1: 0.9681694  Vali macro F1 0.9576732 
new best score!!!!
Validation loss decreased (0.119990 --> 0.098739).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.293568849563599
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1079447  Vali Loss: 0.1211953 Vali Accuracy: 0.9592875  Vali weighted F1: 0.9592180  Vali macro F1 0.9443224 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 6.2916953563690186
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0940967  Vali Loss: 0.0969915 Vali Accuracy: 0.9653944  Vali weighted F1: 0.9651364  Vali macro F1 0.9540088 
new best score!!!!
Validation loss decreased (0.098739 --> 0.096991).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.281273603439331
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0948287  Vali Loss: 0.1603225 Vali Accuracy: 0.9460560  Vali weighted F1: 0.9441612  Vali macro F1 0.9253539 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 6.274808168411255
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0943964  Vali Loss: 0.0894385 Vali Accuracy: 0.9704835  Vali weighted F1: 0.9708238  Vali macro F1 0.9614791 
new best score!!!!
Validation loss decreased (0.096991 --> 0.089438).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.311076402664185
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0831606  Vali Loss: 0.1087647 Vali Accuracy: 0.9648855  Vali weighted F1: 0.9640046  Vali macro F1 0.9523514 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.287644386291504
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0730323  Vali Loss: 0.1157681 Vali Accuracy: 0.9582697  Vali weighted F1: 0.9590615  Vali macro F1 0.9440789 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 17 cost time: 6.288378000259399
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0680852  Vali Loss: 0.0788756 Vali Accuracy: 0.9740458  Vali weighted F1: 0.9741648  Vali macro F1 0.9639379 
new best score!!!!
Validation loss decreased (0.089438 --> 0.078876).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.2880859375
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0667081  Vali Loss: 0.0658061 Vali Accuracy: 0.9791349  Vali weighted F1: 0.9790423  Vali macro F1 0.9732412 
new best score!!!!
Validation loss decreased (0.078876 --> 0.065806).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.306484937667847
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0567445  Vali Loss: 0.0635682 Vali Accuracy: 0.9832061  Vali weighted F1: 0.9833554  Vali macro F1 0.9761549 
new best score!!!!
Validation loss decreased (0.065806 --> 0.063568).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.297935962677002
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0530426  Vali Loss: 0.0667903 Vali Accuracy: 0.9801527  Vali weighted F1: 0.9802276  Vali macro F1 0.9725491 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.279537200927734
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0483417  Vali Loss: 0.0568937 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9847866  Vali macro F1 0.9794166 
new best score!!!!
Validation loss decreased (0.063568 --> 0.056894).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.313650846481323
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0445000  Vali Loss: 0.0690228 Vali Accuracy: 0.9776081  Vali weighted F1: 0.9777151  Vali macro F1 0.9713693 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.291806697845459
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0489881  Vali Loss: 0.0658138 Vali Accuracy: 0.9786260  Vali weighted F1: 0.9785193  Vali macro F1 0.9722606 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 6.290902376174927
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0412499  Vali Loss: 0.0769101 Vali Accuracy: 0.9750636  Vali weighted F1: 0.9754506  Vali macro F1 0.9661687 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 25 cost time: 6.282532691955566
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0504985  Vali Loss: 0.0600509 Vali Accuracy: 0.9821883  Vali weighted F1: 0.9823365  Vali macro F1 0.9743006 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 26 cost time: 6.288736581802368
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0410009  Vali Loss: 0.0574296 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9838268  Vali macro F1 0.9780713 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 27 cost time: 6.284599781036377
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0241576  Vali Loss: 0.0504833 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9863106  Vali macro F1 0.9813266 
new best score!!!!
Validation loss decreased (0.056894 --> 0.050483).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.274662256240845
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0226006  Vali Loss: 0.0472441 Vali Accuracy: 0.9867684  Vali weighted F1: 0.9867951  Vali macro F1 0.9824435 
new best score!!!!
Validation loss decreased (0.050483 --> 0.047244).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.29967999458313
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0224895  Vali Loss: 0.0467111 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9852719  Vali macro F1 0.9804372 
new best score!!!!
Validation loss decreased (0.047244 --> 0.046711).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.2911601066589355
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0216354  Vali Loss: 0.0478605 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9857821  Vali macro F1 0.9806484 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 6.291150331497192
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0199309  Vali Loss: 0.0483447 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9858076  Vali macro F1 0.9803632 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 6.283769607543945
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0199759  Vali Loss: 0.0475716 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9852416  Vali macro F1 0.9782296 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 6.283216238021851
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0192510  Vali Loss: 0.0468559 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9852696  Vali macro F1 0.9780294 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 34 cost time: 6.282623052597046
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0181883  Vali Loss: 0.0454238 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9857850  Vali macro F1 0.9788471 
new best score!!!!
Validation loss decreased (0.046711 --> 0.045424).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 6.281198740005493
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0176005  Vali Loss: 0.0454091 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9873106  Vali macro F1 0.9819303 
new best score!!!!
Validation loss decreased (0.045424 --> 0.045409).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.309729814529419
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0172532  Vali Loss: 0.0469271 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9847521  Vali macro F1 0.9774751 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 6.272995948791504
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0153381  Vali Loss: 0.0473001 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9847327  Vali macro F1 0.9774398 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 6.278483867645264
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0161025  Vali Loss: 0.0454840 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9878133  Vali macro F1 0.9828049 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 6.27440333366394
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0152289  Vali Loss: 0.0480865 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9852507  Vali macro F1 0.9783065 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 40 cost time: 6.27792763710022
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0150458  Vali Loss: 0.0468426 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9847347  Vali macro F1 0.9779356 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 41 cost time: 6.276599407196045
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0151140  Vali Loss: 0.0467118 Vali Accuracy: 0.9842239  Vali weighted F1: 0.9842375  Vali macro F1 0.9769067 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 6.285279273986816
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0152586  Vali Loss: 0.0464755 Vali Accuracy: 0.9842239  Vali weighted F1: 0.9842375  Vali macro F1 0.9769067 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 6.295913934707642
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0144728  Vali Loss: 0.0460459 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9852548  Vali macro F1 0.9783003 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 6.276638746261597
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0140277  Vali Loss: 0.0463877 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9852548  Vali macro F1 0.9783003 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 45 cost time: 6.282902240753174
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0139211  Vali Loss: 0.0462616 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9852460  Vali macro F1 0.9786622 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 46 cost time: 6.272354364395142
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0145005  Vali Loss: 0.0462117 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9852460  Vali macro F1 0.9786622 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 6.278324842453003
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0145337  Vali Loss: 0.0462348 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9852460  Vali macro F1 0.9786622 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 48 cost time: 6.279700040817261
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0143406  Vali Loss: 0.0462563 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9852460  Vali macro F1 0.9786622 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 49 cost time: 6.302407264709473
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0149088  Vali Loss: 0.0462919 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9852460  Vali macro F1 0.9786622 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 50 cost time: 6.303842306137085
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0133285  Vali Loss: 0.0463164 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9852460  Vali macro F1 0.9786622 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8455263  Test weighted F1: 0.8526694  Test macro F1 0.8482136 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 240495
pruned model Parameter : 244174
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.327200889587402
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0179644  Vali Loss: 0.0477332 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9863016  Vali macro F1 0.9811917 
Validation loss decreased (inf --> 0.047733).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.303875207901001
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0196949  Vali Loss: 0.0477086 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9857443  Vali macro F1 0.9799089 
new best score!!!!
Validation loss decreased (0.047733 --> 0.047709).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.2823708057403564
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0169234  Vali Loss: 0.0471510 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9858357  Vali macro F1 0.9795129 
new best score!!!!
Validation loss decreased (0.047709 --> 0.047151).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.291942596435547
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0161093  Vali Loss: 0.0487936 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9852796  Vali macro F1 0.9779752 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.317873239517212
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0156239  Vali Loss: 0.0473875 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9847399  Vali macro F1 0.9773868 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 6.302137613296509
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0147999  Vali Loss: 0.0456172 Vali Accuracy: 0.9867684  Vali weighted F1: 0.9868092  Vali macro F1 0.9802248 
new best score!!!!
Validation loss decreased (0.047151 --> 0.045617).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.2980945110321045
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0150175  Vali Loss: 0.0456273 Vali Accuracy: 0.9867684  Vali weighted F1: 0.9867779  Vali macro F1 0.9815427 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.294513940811157
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0152235  Vali Loss: 0.0464271 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9872912  Vali macro F1 0.9819007 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 6.2965309619903564
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0145090  Vali Loss: 0.0502604 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9857279  Vali macro F1 0.9803402 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 6.2895424365997314
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0130872  Vali Loss: 0.0449705 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9873237  Vali macro F1 0.9821659 
new best score!!!!
Validation loss decreased (0.045617 --> 0.044971).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 6.28969669342041
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0144091  Vali Loss: 0.0437844 Vali Accuracy: 0.9867684  Vali weighted F1: 0.9867808  Vali macro F1 0.9821121 
new best score!!!!
Validation loss decreased (0.044971 --> 0.043784).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 6.298386096954346
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0133131  Vali Loss: 0.0496352 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9857227  Vali macro F1 0.9791217 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 6.3013856410980225
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0133367  Vali Loss: 0.0465623 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9857770  Vali macro F1 0.9795479 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 6.301743268966675
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0114985  Vali Loss: 0.0443295 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9883145  Vali macro F1 0.9825335 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 6.298070669174194
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0117895  Vali Loss: 0.0449467 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9872921  Vali macro F1 0.9815360 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 6.301846265792847
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0106934  Vali Loss: 0.0442391 Vali Accuracy: 0.9893130  Vali weighted F1: 0.9893440  Vali macro F1 0.9863092 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 17 cost time: 6.303107261657715
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0114904  Vali Loss: 0.0504567 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9857554  Vali macro F1 0.9782228 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 6.296790361404419
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0124541  Vali Loss: 0.0415926 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9883030  Vali macro F1 0.9847801 
new best score!!!!
Validation loss decreased (0.043784 --> 0.041593).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 6.31425404548645
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0103956  Vali Loss: 0.0436948 Vali Accuracy: 0.9898219  Vali weighted F1: 0.9898267  Vali macro F1 0.9868501 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 6.31493616104126
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0106756  Vali Loss: 0.0456516 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9882933  Vali macro F1 0.9820337 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 6.297229051589966
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0093483  Vali Loss: 0.0477640 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9872757  Vali macro F1 0.9807905 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 6.29229998588562
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0104573  Vali Loss: 0.0442669 Vali Accuracy: 0.9888041  Vali weighted F1: 0.9888115  Vali macro F1 0.9837739 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 23 cost time: 6.290312051773071
Fine Tuning VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0094171  Vali Loss: 0.0447870 Vali Accuracy: 0.9898219  Vali weighted F1: 0.9898254  Vali macro F1 0.9845982 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 24 cost time: 6.291368007659912
Fine Tuning VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0080844  Vali Loss: 0.0455707 Vali Accuracy: 0.9893130  Vali weighted F1: 0.9893076  Vali macro F1 0.9844643 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 25 cost time: 6.275646209716797
Fine Tuning VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0089622  Vali Loss: 0.0453668 Vali Accuracy: 0.9898219  Vali weighted F1: 0.9898201  Vali macro F1 0.9849722 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 26 cost time: 6.326823711395264
Fine Tuning VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0092892  Vali Loss: 0.0460377 Vali Accuracy: 0.9898219  Vali weighted F1: 0.9898201  Vali macro F1 0.9849722 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 27 cost time: 6.300305604934692
Fine Tuning VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0085773  Vali Loss: 0.0456279 Vali Accuracy: 0.9893130  Vali weighted F1: 0.9893138  Vali macro F1 0.9840920 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 28 cost time: 6.309484958648682
Fine Tuning VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0089275  Vali Loss: 0.0449187 Vali Accuracy: 0.9898219  Vali weighted F1: 0.9898281  Vali macro F1 0.9849891 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 29 cost time: 6.2836902141571045
Fine Tuning VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0084046  Vali Loss: 0.0449583 Vali Accuracy: 0.9893130  Vali weighted F1: 0.9893165  Vali macro F1 0.9844830 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 30 cost time: 6.295898675918579
Fine Tuning VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0091295  Vali Loss: 0.0451115 Vali Accuracy: 0.9893130  Vali weighted F1: 0.9893165  Vali macro F1 0.9844830 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 31 cost time: 6.293701171875
Fine Tuning VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0079604  Vali Loss: 0.0451284 Vali Accuracy: 0.9893130  Vali weighted F1: 0.9893165  Vali macro F1 0.9844830 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 32 cost time: 6.296460151672363
Fine Tuning VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0081931  Vali Loss: 0.0451605 Vali Accuracy: 0.9893130  Vali weighted F1: 0.9893165  Vali macro F1 0.9844830 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 33 cost time: 6.309115886688232
Fine Tuning VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0099602  Vali Loss: 0.0451700 Vali Accuracy: 0.9893130  Vali weighted F1: 0.9893165  Vali macro F1 0.9844830 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8416711  Test weighted F1: 0.8495214  Test macro F1 0.8445847 
================ the 3 th CV Experiment ================ 
Leave one Out Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00014914 0.00018464 0.000999   0.00124378 0.00051733 0.00061958]
Train data number :  17473
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1942
Test data number :  12314
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.190338134765625
VALI: Epoch: 1, Steps: 69 | Train Loss: 1.0083824  Vali Loss: 0.5766482 Vali Accuracy: 0.7842430  Vali weighted F1: 0.7383852  Vali macro F1 0.5195104 
Validation loss decreased (inf --> 0.576648).  Saving model ...
Epoch: 2 cost time: 6.1993162631988525
VALI: Epoch: 2, Steps: 69 | Train Loss: 0.4939435  Vali Loss: 0.4083743 Vali Accuracy: 0.8583934  Vali weighted F1: 0.8396072  Vali macro F1 0.7822898 
new best score!!!!
Validation loss decreased (0.576648 --> 0.408374).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.192063331604004
VALI: Epoch: 3, Steps: 69 | Train Loss: 0.3565468  Vali Loss: 0.3107065 Vali Accuracy: 0.8944387  Vali weighted F1: 0.8923125  Vali macro F1 0.8546292 
new best score!!!!
Validation loss decreased (0.408374 --> 0.310707).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.195113658905029
VALI: Epoch: 4, Steps: 69 | Train Loss: 0.2848188  Vali Loss: 0.2254234 Vali Accuracy: 0.9253347  Vali weighted F1: 0.9250321  Vali macro F1 0.8946718 
new best score!!!!
Validation loss decreased (0.310707 --> 0.225423).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.204626798629761
VALI: Epoch: 5, Steps: 69 | Train Loss: 0.2123281  Vali Loss: 0.1791469 Vali Accuracy: 0.9438723  Vali weighted F1: 0.9418622  Vali macro F1 0.9166641 
new best score!!!!
Validation loss decreased (0.225423 --> 0.179147).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.234249830245972
VALI: Epoch: 6, Steps: 69 | Train Loss: 0.1732841  Vali Loss: 0.1763117 Vali Accuracy: 0.9397528  Vali weighted F1: 0.9409387  Vali macro F1 0.9193192 
new best score!!!!
Validation loss decreased (0.179147 --> 0.176312).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.210872411727905
VALI: Epoch: 7, Steps: 69 | Train Loss: 0.1506140  Vali Loss: 0.1738648 Vali Accuracy: 0.9433574  Vali weighted F1: 0.9403140  Vali macro F1 0.9143686 
new best score!!!!
Validation loss decreased (0.176312 --> 0.173865).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.21157693862915
VALI: Epoch: 8, Steps: 69 | Train Loss: 0.1239245  Vali Loss: 0.1377016 Vali Accuracy: 0.9557158  Vali weighted F1: 0.9556294  Vali macro F1 0.9367160 
new best score!!!!
Validation loss decreased (0.173865 --> 0.137702).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.208735704421997
VALI: Epoch: 9, Steps: 69 | Train Loss: 0.1133414  Vali Loss: 0.1163166 Vali Accuracy: 0.9598352  Vali weighted F1: 0.9598806  Vali macro F1 0.9407345 
new best score!!!!
Validation loss decreased (0.137702 --> 0.116317).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.2133400440216064
VALI: Epoch: 10, Steps: 69 | Train Loss: 0.1060847  Vali Loss: 0.0874197 Vali Accuracy: 0.9721936  Vali weighted F1: 0.9724230  Vali macro F1 0.9596541 
new best score!!!!
Validation loss decreased (0.116317 --> 0.087420).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.19422459602356
VALI: Epoch: 11, Steps: 69 | Train Loss: 0.0900403  Vali Loss: 0.0859942 Vali Accuracy: 0.9727085  Vali weighted F1: 0.9729469  Vali macro F1 0.9597312 
new best score!!!!
Validation loss decreased (0.087420 --> 0.085994).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.221579551696777
VALI: Epoch: 12, Steps: 69 | Train Loss: 0.0829897  Vali Loss: 0.0882447 Vali Accuracy: 0.9706488  Vali weighted F1: 0.9703606  Vali macro F1 0.9554303 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 6.228004455566406
VALI: Epoch: 13, Steps: 69 | Train Loss: 0.0705504  Vali Loss: 0.0771677 Vali Accuracy: 0.9732235  Vali weighted F1: 0.9731992  Vali macro F1 0.9598303 
new best score!!!!
Validation loss decreased (0.085994 --> 0.077168).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.2077929973602295
VALI: Epoch: 14, Steps: 69 | Train Loss: 0.0704875  Vali Loss: 0.0890539 Vali Accuracy: 0.9716787  Vali weighted F1: 0.9715204  Vali macro F1 0.9585611 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.198285341262817
VALI: Epoch: 15, Steps: 69 | Train Loss: 0.0629573  Vali Loss: 0.0666651 Vali Accuracy: 0.9819773  Vali weighted F1: 0.9820877  Vali macro F1 0.9726181 
new best score!!!!
Validation loss decreased (0.077168 --> 0.066665).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.2022833824157715
VALI: Epoch: 16, Steps: 69 | Train Loss: 0.0679185  Vali Loss: 0.0712478 Vali Accuracy: 0.9794027  Vali weighted F1: 0.9796248  Vali macro F1 0.9676743 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 6.190549850463867
VALI: Epoch: 17, Steps: 69 | Train Loss: 0.0498741  Vali Loss: 0.0612146 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9826105  Vali macro F1 0.9729467 
new best score!!!!
Validation loss decreased (0.066665 --> 0.061215).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.199850082397461
VALI: Epoch: 18, Steps: 69 | Train Loss: 0.0440734  Vali Loss: 0.0649354 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9804911  Vali macro F1 0.9684287 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.215052843093872
VALI: Epoch: 19, Steps: 69 | Train Loss: 0.0462840  Vali Loss: 0.0764855 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9804588  Vali macro F1 0.9722626 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 6.192185878753662
VALI: Epoch: 20, Steps: 69 | Train Loss: 0.0468405  Vali Loss: 0.0697860 Vali Accuracy: 0.9819773  Vali weighted F1: 0.9820346  Vali macro F1 0.9733147 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 21 cost time: 6.195489883422852
VALI: Epoch: 21, Steps: 69 | Train Loss: 0.0355755  Vali Loss: 0.0621629 Vali Accuracy: 0.9835221  Vali weighted F1: 0.9835014  Vali macro F1 0.9740521 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 22 cost time: 6.193755149841309
VALI: Epoch: 22, Steps: 69 | Train Loss: 0.0414440  Vali Loss: 0.0567648 Vali Accuracy: 0.9850669  Vali weighted F1: 0.9850943  Vali macro F1 0.9778942 
new best score!!!!
Validation loss decreased (0.061215 --> 0.056765).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.208662271499634
VALI: Epoch: 23, Steps: 69 | Train Loss: 0.0389247  Vali Loss: 0.0576795 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9856484  Vali macro F1 0.9761969 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 6.2074902057647705
VALI: Epoch: 24, Steps: 69 | Train Loss: 0.0347799  Vali Loss: 0.0664612 Vali Accuracy: 0.9778579  Vali weighted F1: 0.9777303  Vali macro F1 0.9527509 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 6.22057843208313
VALI: Epoch: 25, Steps: 69 | Train Loss: 0.0362070  Vali Loss: 0.0524349 Vali Accuracy: 0.9835221  Vali weighted F1: 0.9836654  Vali macro F1 0.9755264 
new best score!!!!
Validation loss decreased (0.056765 --> 0.052435).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.2148597240448
VALI: Epoch: 26, Steps: 69 | Train Loss: 0.0298547  Vali Loss: 0.0587870 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9856436  Vali macro F1 0.9777477 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 6.211336612701416
VALI: Epoch: 27, Steps: 69 | Train Loss: 0.0244379  Vali Loss: 0.0597242 Vali Accuracy: 0.9840371  Vali weighted F1: 0.9841447  Vali macro F1 0.9755099 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 6.2071850299835205
VALI: Epoch: 28, Steps: 69 | Train Loss: 0.0304111  Vali Loss: 0.0570514 Vali Accuracy: 0.9845520  Vali weighted F1: 0.9846654  Vali macro F1 0.9749500 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 29 cost time: 6.197372674942017
VALI: Epoch: 29, Steps: 69 | Train Loss: 0.0260391  Vali Loss: 0.0554810 Vali Accuracy: 0.9850669  Vali weighted F1: 0.9850711  Vali macro F1 0.9767883 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 30 cost time: 6.208253383636475
VALI: Epoch: 30, Steps: 69 | Train Loss: 0.0249919  Vali Loss: 0.0525355 Vali Accuracy: 0.9845520  Vali weighted F1: 0.9845788  Vali macro F1 0.9760338 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 31 cost time: 6.200140714645386
VALI: Epoch: 31, Steps: 69 | Train Loss: 0.0145185  Vali Loss: 0.0450156 Vali Accuracy: 0.9881565  Vali weighted F1: 0.9881927  Vali macro F1 0.9803207 
new best score!!!!
Validation loss decreased (0.052435 --> 0.045016).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.226166248321533
VALI: Epoch: 32, Steps: 69 | Train Loss: 0.0119380  Vali Loss: 0.0461666 Vali Accuracy: 0.9897013  Vali weighted F1: 0.9897293  Vali macro F1 0.9826639 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 6.208301782608032
VALI: Epoch: 33, Steps: 69 | Train Loss: 0.0110042  Vali Loss: 0.0466885 Vali Accuracy: 0.9891864  Vali weighted F1: 0.9892171  Vali macro F1 0.9817587 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 6.213485479354858
VALI: Epoch: 34, Steps: 69 | Train Loss: 0.0112449  Vali Loss: 0.0445269 Vali Accuracy: 0.9871267  Vali weighted F1: 0.9871469  Vali macro F1 0.9791353 
new best score!!!!
Validation loss decreased (0.045016 --> 0.044527).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 6.2154810428619385
VALI: Epoch: 35, Steps: 69 | Train Loss: 0.0104605  Vali Loss: 0.0459681 Vali Accuracy: 0.9886715  Vali weighted F1: 0.9886996  Vali macro F1 0.9808340 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 6.216341257095337
VALI: Epoch: 36, Steps: 69 | Train Loss: 0.0102653  Vali Loss: 0.0470242 Vali Accuracy: 0.9897013  Vali weighted F1: 0.9897315  Vali macro F1 0.9826720 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 6.2119739055633545
VALI: Epoch: 37, Steps: 69 | Train Loss: 0.0090979  Vali Loss: 0.0464067 Vali Accuracy: 0.9897013  Vali weighted F1: 0.9897315  Vali macro F1 0.9826720 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 6.208920240402222
VALI: Epoch: 38, Steps: 69 | Train Loss: 0.0095324  Vali Loss: 0.0464714 Vali Accuracy: 0.9891864  Vali weighted F1: 0.9892118  Vali macro F1 0.9817397 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 6.226408958435059
VALI: Epoch: 39, Steps: 69 | Train Loss: 0.0088239  Vali Loss: 0.0446397 Vali Accuracy: 0.9897013  Vali weighted F1: 0.9897190  Vali macro F1 0.9829500 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 40 cost time: 6.222926378250122
VALI: Epoch: 40, Steps: 69 | Train Loss: 0.0086559  Vali Loss: 0.0439803 Vali Accuracy: 0.9891864  Vali weighted F1: 0.9892043  Vali macro F1 0.9820355 
new best score!!!!
Validation loss decreased (0.044527 --> 0.043980).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 6.2173895835876465
VALI: Epoch: 41, Steps: 69 | Train Loss: 0.0083584  Vali Loss: 0.0433923 Vali Accuracy: 0.9897013  Vali weighted F1: 0.9897166  Vali macro F1 0.9829413 
new best score!!!!
Validation loss decreased (0.043980 --> 0.043392).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 6.216207981109619
VALI: Epoch: 42, Steps: 69 | Train Loss: 0.0083711  Vali Loss: 0.0438632 Vali Accuracy: 0.9897013  Vali weighted F1: 0.9897166  Vali macro F1 0.9829413 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 6.2151079177856445
VALI: Epoch: 43, Steps: 69 | Train Loss: 0.0087603  Vali Loss: 0.0435727 Vali Accuracy: 0.9897013  Vali weighted F1: 0.9897166  Vali macro F1 0.9829413 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 6.224868297576904
VALI: Epoch: 44, Steps: 69 | Train Loss: 0.0087403  Vali Loss: 0.0440604 Vali Accuracy: 0.9891864  Vali weighted F1: 0.9891965  Vali macro F1 0.9823863 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 6.223151206970215
VALI: Epoch: 45, Steps: 69 | Train Loss: 0.0089123  Vali Loss: 0.0438254 Vali Accuracy: 0.9897013  Vali weighted F1: 0.9897166  Vali macro F1 0.9829413 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 46 cost time: 6.2926952838897705
VALI: Epoch: 46, Steps: 69 | Train Loss: 0.0080617  Vali Loss: 0.0437123 Vali Accuracy: 0.9897013  Vali weighted F1: 0.9897166  Vali macro F1 0.9829413 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 47 cost time: 6.366163015365601
VALI: Epoch: 47, Steps: 69 | Train Loss: 0.0084029  Vali Loss: 0.0437404 Vali Accuracy: 0.9897013  Vali weighted F1: 0.9897166  Vali macro F1 0.9829413 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 6.2304699420928955
VALI: Epoch: 48, Steps: 69 | Train Loss: 0.0091955  Vali Loss: 0.0438055 Vali Accuracy: 0.9897013  Vali weighted F1: 0.9897166  Vali macro F1 0.9829413 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 6.238476037979126
VALI: Epoch: 49, Steps: 69 | Train Loss: 0.0086440  Vali Loss: 0.0438309 Vali Accuracy: 0.9897013  Vali weighted F1: 0.9897166  Vali macro F1 0.9829413 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 50 cost time: 6.237765789031982
VALI: Epoch: 50, Steps: 69 | Train Loss: 0.0091784  Vali Loss: 0.0438638 Vali Accuracy: 0.9897013  Vali weighted F1: 0.9897166  Vali macro F1 0.9829413 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 51 cost time: 6.232101917266846
VALI: Epoch: 51, Steps: 69 | Train Loss: 0.0085224  Vali Loss: 0.0438836 Vali Accuracy: 0.9897013  Vali weighted F1: 0.9897166  Vali macro F1 0.9829413 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 52 cost time: 6.242327928543091
VALI: Epoch: 52, Steps: 69 | Train Loss: 0.0084928  Vali Loss: 0.0438927 Vali Accuracy: 0.9897013  Vali weighted F1: 0.9897166  Vali macro F1 0.9829413 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 6.239354372024536
VALI: Epoch: 53, Steps: 69 | Train Loss: 0.0090664  Vali Loss: 0.0438989 Vali Accuracy: 0.9897013  Vali weighted F1: 0.9897166  Vali macro F1 0.9829413 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 6.222047328948975
VALI: Epoch: 54, Steps: 69 | Train Loss: 0.0089611  Vali Loss: 0.0439035 Vali Accuracy: 0.9897013  Vali weighted F1: 0.9897166  Vali macro F1 0.9829413 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 55 cost time: 6.230770111083984
VALI: Epoch: 55, Steps: 69 | Train Loss: 0.0086375  Vali Loss: 0.0439111 Vali Accuracy: 0.9897013  Vali weighted F1: 0.9897166  Vali macro F1 0.9829413 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 56 cost time: 10.29247236251831
VALI: Epoch: 56, Steps: 69 | Train Loss: 0.0082069  Vali Loss: 0.0439128 Vali Accuracy: 0.9897013  Vali weighted F1: 0.9897166  Vali macro F1 0.9829413 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9674354  Test weighted F1: 0.9667861  Test macro F1 0.9548979 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 240495
pruned model Parameter : 244174
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.303269624710083
Fine Tuning VALI: Epoch: 1, Steps: 69 | Train Loss: 0.0093516  Vali Loss: 0.0480993 Vali Accuracy: 0.9891864  Vali weighted F1: 0.9892040  Vali macro F1 0.9821071 
Validation loss decreased (inf --> 0.048099).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.240813732147217
Fine Tuning VALI: Epoch: 2, Steps: 69 | Train Loss: 0.0095389  Vali Loss: 0.0449197 Vali Accuracy: 0.9897013  Vali weighted F1: 0.9897283  Vali macro F1 0.9827347 
new best score!!!!
Validation loss decreased (0.048099 --> 0.044920).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.232177734375
Fine Tuning VALI: Epoch: 3, Steps: 69 | Train Loss: 0.0084687  Vali Loss: 0.0468359 Vali Accuracy: 0.9891864  Vali weighted F1: 0.9892077  Vali macro F1 0.9823910 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.218808889389038
Fine Tuning VALI: Epoch: 4, Steps: 69 | Train Loss: 0.0084572  Vali Loss: 0.0497659 Vali Accuracy: 0.9886715  Vali weighted F1: 0.9886714  Vali macro F1 0.9814742 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.225153207778931
Fine Tuning VALI: Epoch: 5, Steps: 69 | Train Loss: 0.0088159  Vali Loss: 0.0430119 Vali Accuracy: 0.9881565  Vali weighted F1: 0.9881831  Vali macro F1 0.9812899 
new best score!!!!
Validation loss decreased (0.044920 --> 0.043012).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.216614007949829
Fine Tuning VALI: Epoch: 6, Steps: 69 | Train Loss: 0.0078501  Vali Loss: 0.0483466 Vali Accuracy: 0.9881565  Vali weighted F1: 0.9881642  Vali macro F1 0.9809707 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.218352556228638
Fine Tuning VALI: Epoch: 7, Steps: 69 | Train Loss: 0.0076105  Vali Loss: 0.0496639 Vali Accuracy: 0.9897013  Vali weighted F1: 0.9897149  Vali macro F1 0.9836058 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.228328227996826
Fine Tuning VALI: Epoch: 8, Steps: 69 | Train Loss: 0.0077204  Vali Loss: 0.0497282 Vali Accuracy: 0.9891864  Vali weighted F1: 0.9891880  Vali macro F1 0.9824586 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.229326963424683
Fine Tuning VALI: Epoch: 9, Steps: 69 | Train Loss: 0.0076375  Vali Loss: 0.0462541 Vali Accuracy: 0.9891864  Vali weighted F1: 0.9892187  Vali macro F1 0.9821399 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.241057872772217
Fine Tuning VALI: Epoch: 10, Steps: 69 | Train Loss: 0.0063555  Vali Loss: 0.0433506 Vali Accuracy: 0.9897013  Vali weighted F1: 0.9897418  Vali macro F1 0.9830717 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 11 cost time: 6.242961645126343
Fine Tuning VALI: Epoch: 11, Steps: 69 | Train Loss: 0.0063005  Vali Loss: 0.0431938 Vali Accuracy: 0.9897013  Vali weighted F1: 0.9897119  Vali macro F1 0.9832486 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.228187561035156
Fine Tuning VALI: Epoch: 12, Steps: 69 | Train Loss: 0.0070695  Vali Loss: 0.0462685 Vali Accuracy: 0.9891864  Vali weighted F1: 0.9892118  Vali macro F1 0.9817397 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.217276334762573
Fine Tuning VALI: Epoch: 13, Steps: 69 | Train Loss: 0.0067020  Vali Loss: 0.0431466 Vali Accuracy: 0.9902163  Vali weighted F1: 0.9902314  Vali macro F1 0.9838559 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.2279016971588135
Fine Tuning VALI: Epoch: 14, Steps: 69 | Train Loss: 0.0058708  Vali Loss: 0.0477122 Vali Accuracy: 0.9891864  Vali weighted F1: 0.9891968  Vali macro F1 0.9823330 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.223646402359009
Fine Tuning VALI: Epoch: 15, Steps: 69 | Train Loss: 0.0057593  Vali Loss: 0.0462034 Vali Accuracy: 0.9902163  Vali weighted F1: 0.9902317  Vali macro F1 0.9831823 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 16 cost time: 6.2599616050720215
Fine Tuning VALI: Epoch: 16, Steps: 69 | Train Loss: 0.0050236  Vali Loss: 0.0450106 Vali Accuracy: 0.9891864  Vali weighted F1: 0.9892098  Vali macro F1 0.9817354 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 6.226803302764893
Fine Tuning VALI: Epoch: 17, Steps: 69 | Train Loss: 0.0049744  Vali Loss: 0.0458644 Vali Accuracy: 0.9891864  Vali weighted F1: 0.9892015  Vali macro F1 0.9820257 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 6.248389720916748
Fine Tuning VALI: Epoch: 18, Steps: 69 | Train Loss: 0.0050483  Vali Loss: 0.0445709 Vali Accuracy: 0.9891864  Vali weighted F1: 0.9892015  Vali macro F1 0.9820257 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 6.227593898773193
Fine Tuning VALI: Epoch: 19, Steps: 69 | Train Loss: 0.0048466  Vali Loss: 0.0450924 Vali Accuracy: 0.9891864  Vali weighted F1: 0.9892015  Vali macro F1 0.9820257 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 6.22267484664917
Fine Tuning VALI: Epoch: 20, Steps: 69 | Train Loss: 0.0047514  Vali Loss: 0.0454370 Vali Accuracy: 0.9891864  Vali weighted F1: 0.9892015  Vali macro F1 0.9820257 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9671918  Test weighted F1: 0.9667627  Test macro F1 0.9561071 
================ the 4 th CV Experiment ================ 
Leave one Out Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.00014993 0.00018664 0.00140056 0.0014556  0.0005277  0.00064226]
Train data number :  16881
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1876
Test data number :  15610
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.996258020401001
VALI: Epoch: 1, Steps: 66 | Train Loss: 1.0090110  Vali Loss: 0.6190375 Vali Accuracy: 0.7793177  Vali weighted F1: 0.7274273  Vali macro F1 0.5028792 
Validation loss decreased (inf --> 0.619038).  Saving model ...
Epoch: 2 cost time: 5.995355844497681
VALI: Epoch: 2, Steps: 66 | Train Loss: 0.5276576  Vali Loss: 0.4063659 Vali Accuracy: 0.8528785  Vali weighted F1: 0.8390476  Vali macro F1 0.7881962 
new best score!!!!
Validation loss decreased (0.619038 --> 0.406366).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.001168251037598
VALI: Epoch: 3, Steps: 66 | Train Loss: 0.3799572  Vali Loss: 0.3289629 Vali Accuracy: 0.8832623  Vali weighted F1: 0.8723617  Vali macro F1 0.8368594 
new best score!!!!
Validation loss decreased (0.406366 --> 0.328963).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.989264726638794
VALI: Epoch: 4, Steps: 66 | Train Loss: 0.3024085  Vali Loss: 0.2477439 Vali Accuracy: 0.9120469  Vali weighted F1: 0.9108315  Vali macro F1 0.8851388 
new best score!!!!
Validation loss decreased (0.328963 --> 0.247744).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.013989448547363
VALI: Epoch: 5, Steps: 66 | Train Loss: 0.2199158  Vali Loss: 0.1845987 Vali Accuracy: 0.9381663  Vali weighted F1: 0.9371101  Vali macro F1 0.9183319 
new best score!!!!
Validation loss decreased (0.247744 --> 0.184599).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.010819435119629
VALI: Epoch: 6, Steps: 66 | Train Loss: 0.1899260  Vali Loss: 0.1615427 Vali Accuracy: 0.9445629  Vali weighted F1: 0.9446881  Vali macro F1 0.9284443 
new best score!!!!
Validation loss decreased (0.184599 --> 0.161543).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.006631374359131
VALI: Epoch: 7, Steps: 66 | Train Loss: 0.1691879  Vali Loss: 0.1674747 Vali Accuracy: 0.9450959  Vali weighted F1: 0.9462262  Vali macro F1 0.9284236 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 8 cost time: 5.999280691146851
VALI: Epoch: 8, Steps: 66 | Train Loss: 0.1573318  Vali Loss: 0.1367598 Vali Accuracy: 0.9493603  Vali weighted F1: 0.9493527  Vali macro F1 0.9326837 
new best score!!!!
Validation loss decreased (0.161543 --> 0.136760).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.001854419708252
VALI: Epoch: 9, Steps: 66 | Train Loss: 0.1316898  Vali Loss: 0.1230138 Vali Accuracy: 0.9546908  Vali weighted F1: 0.9547250  Vali macro F1 0.9395458 
new best score!!!!
Validation loss decreased (0.136760 --> 0.123014).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.011508464813232
VALI: Epoch: 10, Steps: 66 | Train Loss: 0.1237170  Vali Loss: 0.1686728 Vali Accuracy: 0.9408316  Vali weighted F1: 0.9429983  Vali macro F1 0.9258719 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 5.998464822769165
VALI: Epoch: 11, Steps: 66 | Train Loss: 0.1200889  Vali Loss: 0.1313843 Vali Accuracy: 0.9445629  Vali weighted F1: 0.9437008  Vali macro F1 0.9184183 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 12 cost time: 6.002840995788574
VALI: Epoch: 12, Steps: 66 | Train Loss: 0.1033932  Vali Loss: 0.1001580 Vali Accuracy: 0.9594883  Vali weighted F1: 0.9589572  Vali macro F1 0.9459451 
new best score!!!!
Validation loss decreased (0.123014 --> 0.100158).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.011995077133179
VALI: Epoch: 13, Steps: 66 | Train Loss: 0.0891581  Vali Loss: 0.1045931 Vali Accuracy: 0.9610874  Vali weighted F1: 0.9609644  Vali macro F1 0.9471868 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 6.017826557159424
VALI: Epoch: 14, Steps: 66 | Train Loss: 0.0829615  Vali Loss: 0.0889551 Vali Accuracy: 0.9642857  Vali weighted F1: 0.9645138  Vali macro F1 0.9526929 
new best score!!!!
Validation loss decreased (0.100158 --> 0.088955).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.995890140533447
VALI: Epoch: 15, Steps: 66 | Train Loss: 0.0759974  Vali Loss: 0.0929948 Vali Accuracy: 0.9637527  Vali weighted F1: 0.9642364  Vali macro F1 0.9522514 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.000688314437866
VALI: Epoch: 16, Steps: 66 | Train Loss: 0.0730133  Vali Loss: 0.1168012 Vali Accuracy: 0.9605544  Vali weighted F1: 0.9597028  Vali macro F1 0.9494437 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 17 cost time: 6.00356388092041
VALI: Epoch: 17, Steps: 66 | Train Loss: 0.0754974  Vali Loss: 0.0728275 Vali Accuracy: 0.9706823  Vali weighted F1: 0.9708040  Vali macro F1 0.9591092 
new best score!!!!
Validation loss decreased (0.088955 --> 0.072828).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.009128570556641
VALI: Epoch: 18, Steps: 66 | Train Loss: 0.0643856  Vali Loss: 0.0828064 Vali Accuracy: 0.9674840  Vali weighted F1: 0.9675700  Vali macro F1 0.9567904 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.008023977279663
VALI: Epoch: 19, Steps: 66 | Train Loss: 0.0574546  Vali Loss: 0.0882044 Vali Accuracy: 0.9733475  Vali weighted F1: 0.9734115  Vali macro F1 0.9656962 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 6.018190860748291
VALI: Epoch: 20, Steps: 66 | Train Loss: 0.0591388  Vali Loss: 0.0730096 Vali Accuracy: 0.9706823  Vali weighted F1: 0.9708438  Vali macro F1 0.9602878 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 21 cost time: 6.029668092727661
VALI: Epoch: 21, Steps: 66 | Train Loss: 0.0512914  Vali Loss: 0.0695157 Vali Accuracy: 0.9744136  Vali weighted F1: 0.9746822  Vali macro F1 0.9677831 
new best score!!!!
Validation loss decreased (0.072828 --> 0.069516).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.00900673866272
VALI: Epoch: 22, Steps: 66 | Train Loss: 0.0547399  Vali Loss: 0.0788079 Vali Accuracy: 0.9690832  Vali weighted F1: 0.9692518  Vali macro F1 0.9585937 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.014618635177612
VALI: Epoch: 23, Steps: 66 | Train Loss: 0.0490274  Vali Loss: 0.0743571 Vali Accuracy: 0.9690832  Vali weighted F1: 0.9692211  Vali macro F1 0.9572900 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 5.999873161315918
VALI: Epoch: 24, Steps: 66 | Train Loss: 0.0473346  Vali Loss: 0.0661915 Vali Accuracy: 0.9770789  Vali weighted F1: 0.9771728  Vali macro F1 0.9711321 
new best score!!!!
Validation loss decreased (0.069516 --> 0.066192).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 5.994813680648804
VALI: Epoch: 25, Steps: 66 | Train Loss: 0.0378608  Vali Loss: 0.0838641 Vali Accuracy: 0.9706823  Vali weighted F1: 0.9710786  Vali macro F1 0.9586778 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 5.998221158981323
VALI: Epoch: 26, Steps: 66 | Train Loss: 0.0431173  Vali Loss: 0.0828978 Vali Accuracy: 0.9738806  Vali weighted F1: 0.9738264  Vali macro F1 0.9653049 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 5.997642755508423
VALI: Epoch: 27, Steps: 66 | Train Loss: 0.0384799  Vali Loss: 0.0701357 Vali Accuracy: 0.9760128  Vali weighted F1: 0.9762105  Vali macro F1 0.9678692 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 28 cost time: 5.995146989822388
VALI: Epoch: 28, Steps: 66 | Train Loss: 0.0334489  Vali Loss: 0.0795588 Vali Accuracy: 0.9712154  Vali weighted F1: 0.9714896  Vali macro F1 0.9605898 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 29 cost time: 6.038442611694336
VALI: Epoch: 29, Steps: 66 | Train Loss: 0.0285166  Vali Loss: 0.0691546 Vali Accuracy: 0.9749467  Vali weighted F1: 0.9751896  Vali macro F1 0.9675649 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 30 cost time: 6.003515243530273
VALI: Epoch: 30, Steps: 66 | Train Loss: 0.0221312  Vali Loss: 0.0594041 Vali Accuracy: 0.9781450  Vali weighted F1: 0.9782344  Vali macro F1 0.9706089 
new best score!!!!
Validation loss decreased (0.066192 --> 0.059404).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 5.988367557525635
VALI: Epoch: 31, Steps: 66 | Train Loss: 0.0192458  Vali Loss: 0.0575853 Vali Accuracy: 0.9781450  Vali weighted F1: 0.9782943  Vali macro F1 0.9713748 
new best score!!!!
Validation loss decreased (0.059404 --> 0.057585).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 5.995856523513794
VALI: Epoch: 32, Steps: 66 | Train Loss: 0.0180816  Vali Loss: 0.0580256 Vali Accuracy: 0.9786780  Vali weighted F1: 0.9788223  Vali macro F1 0.9722574 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 6.000303745269775
VALI: Epoch: 33, Steps: 66 | Train Loss: 0.0168121  Vali Loss: 0.0593916 Vali Accuracy: 0.9792111  Vali weighted F1: 0.9793355  Vali macro F1 0.9728021 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 5.990491151809692
VALI: Epoch: 34, Steps: 66 | Train Loss: 0.0172219  Vali Loss: 0.0581105 Vali Accuracy: 0.9786780  Vali weighted F1: 0.9788077  Vali macro F1 0.9730401 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 35 cost time: 5.992115497589111
VALI: Epoch: 35, Steps: 66 | Train Loss: 0.0161630  Vali Loss: 0.0597114 Vali Accuracy: 0.9792111  Vali weighted F1: 0.9793580  Vali macro F1 0.9734709 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 36 cost time: 6.049910545349121
VALI: Epoch: 36, Steps: 66 | Train Loss: 0.0159459  Vali Loss: 0.0624463 Vali Accuracy: 0.9776119  Vali weighted F1: 0.9777556  Vali macro F1 0.9712539 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 37 cost time: 6.00243616104126
VALI: Epoch: 37, Steps: 66 | Train Loss: 0.0154990  Vali Loss: 0.0618914 Vali Accuracy: 0.9781450  Vali weighted F1: 0.9783060  Vali macro F1 0.9718068 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 5.995402574539185
VALI: Epoch: 38, Steps: 66 | Train Loss: 0.0143962  Vali Loss: 0.0613232 Vali Accuracy: 0.9776119  Vali weighted F1: 0.9777556  Vali macro F1 0.9712539 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 5.999662399291992
VALI: Epoch: 39, Steps: 66 | Train Loss: 0.0146206  Vali Loss: 0.0608391 Vali Accuracy: 0.9776119  Vali weighted F1: 0.9777556  Vali macro F1 0.9712539 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 40 cost time: 6.0044379234313965
VALI: Epoch: 40, Steps: 66 | Train Loss: 0.0147213  Vali Loss: 0.0609082 Vali Accuracy: 0.9781450  Vali weighted F1: 0.9783060  Vali macro F1 0.9718068 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 41 cost time: 5.989888906478882
VALI: Epoch: 41, Steps: 66 | Train Loss: 0.0155009  Vali Loss: 0.0613322 Vali Accuracy: 0.9776119  Vali weighted F1: 0.9777556  Vali macro F1 0.9712539 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 42 cost time: 5.987362623214722
VALI: Epoch: 42, Steps: 66 | Train Loss: 0.0142750  Vali Loss: 0.0612710 Vali Accuracy: 0.9776119  Vali weighted F1: 0.9777556  Vali macro F1 0.9712539 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 6.004102468490601
VALI: Epoch: 43, Steps: 66 | Train Loss: 0.0145872  Vali Loss: 0.0611792 Vali Accuracy: 0.9776119  Vali weighted F1: 0.9777556  Vali macro F1 0.9712539 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 6.01568078994751
VALI: Epoch: 44, Steps: 66 | Train Loss: 0.0142979  Vali Loss: 0.0611681 Vali Accuracy: 0.9776119  Vali weighted F1: 0.9777556  Vali macro F1 0.9712539 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 5.991870403289795
VALI: Epoch: 45, Steps: 66 | Train Loss: 0.0139821  Vali Loss: 0.0612028 Vali Accuracy: 0.9776119  Vali weighted F1: 0.9777556  Vali macro F1 0.9712539 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 46 cost time: 5.964404106140137
VALI: Epoch: 46, Steps: 66 | Train Loss: 0.0150765  Vali Loss: 0.0611761 Vali Accuracy: 0.9776119  Vali weighted F1: 0.9777556  Vali macro F1 0.9712539 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9253043  Test weighted F1: 0.9268298  Test macro F1 0.8905096 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 240495
pruned model Parameter : 244174
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.008788108825684
Fine Tuning VALI: Epoch: 1, Steps: 66 | Train Loss: 0.0189557  Vali Loss: 0.0617745 Vali Accuracy: 0.9776119  Vali weighted F1: 0.9778043  Vali macro F1 0.9706188 
Validation loss decreased (inf --> 0.061775).  Saving model ...
Fine Tuning Epoch: 2 cost time: 5.986239910125732
Fine Tuning VALI: Epoch: 2, Steps: 66 | Train Loss: 0.0180057  Vali Loss: 0.0616076 Vali Accuracy: 0.9776119  Vali weighted F1: 0.9778161  Vali macro F1 0.9710128 
new best score!!!!
Validation loss decreased (0.061775 --> 0.061608).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 5.983632802963257
Fine Tuning VALI: Epoch: 3, Steps: 66 | Train Loss: 0.0167477  Vali Loss: 0.0620851 Vali Accuracy: 0.9765458  Vali weighted F1: 0.9767156  Vali macro F1 0.9693569 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 5.991238355636597
Fine Tuning VALI: Epoch: 4, Steps: 66 | Train Loss: 0.0158600  Vali Loss: 0.0570701 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9814547  Vali macro F1 0.9758980 
new best score!!!!
Validation loss decreased (0.061608 --> 0.057070).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 5.997176647186279
Fine Tuning VALI: Epoch: 5, Steps: 66 | Train Loss: 0.0162384  Vali Loss: 0.0567233 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9797671  Vali macro F1 0.9745602 
new best score!!!!
Validation loss decreased (0.057070 --> 0.056723).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.007740497589111
Fine Tuning VALI: Epoch: 6, Steps: 66 | Train Loss: 0.0150952  Vali Loss: 0.0582733 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9814336  Vali macro F1 0.9751958 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 5.98103928565979
Fine Tuning VALI: Epoch: 7, Steps: 66 | Train Loss: 0.0135527  Vali Loss: 0.0585196 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9809175  Vali macro F1 0.9749867 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 5.994974136352539
Fine Tuning VALI: Epoch: 8, Steps: 66 | Train Loss: 0.0133424  Vali Loss: 0.0595550 Vali Accuracy: 0.9786780  Vali weighted F1: 0.9788246  Vali macro F1 0.9722175 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 5.995777130126953
Fine Tuning VALI: Epoch: 9, Steps: 66 | Train Loss: 0.0147226  Vali Loss: 0.0642954 Vali Accuracy: 0.9781450  Vali weighted F1: 0.9783256  Vali macro F1 0.9717031 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 5.994671583175659
Fine Tuning VALI: Epoch: 10, Steps: 66 | Train Loss: 0.0139962  Vali Loss: 0.0584815 Vali Accuracy: 0.9792111  Vali weighted F1: 0.9792743  Vali macro F1 0.9737032 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 11 cost time: 6.002614974975586
Fine Tuning VALI: Epoch: 11, Steps: 66 | Train Loss: 0.0133625  Vali Loss: 0.0567398 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9809126  Vali macro F1 0.9760373 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.001129150390625
Fine Tuning VALI: Epoch: 12, Steps: 66 | Train Loss: 0.0129395  Vali Loss: 0.0578392 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9814603  Vali macro F1 0.9746890 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.003619432449341
Fine Tuning VALI: Epoch: 13, Steps: 66 | Train Loss: 0.0129173  Vali Loss: 0.0625345 Vali Accuracy: 0.9802772  Vali weighted F1: 0.9804418  Vali macro F1 0.9742141 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.017243385314941
Fine Tuning VALI: Epoch: 14, Steps: 66 | Train Loss: 0.0122112  Vali Loss: 0.0632498 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9799261  Vali macro F1 0.9724738 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.02089524269104
Fine Tuning VALI: Epoch: 15, Steps: 66 | Train Loss: 0.0112624  Vali Loss: 0.0600630 Vali Accuracy: 0.9802772  Vali weighted F1: 0.9803655  Vali macro F1 0.9746883 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 16 cost time: 5.991074800491333
Fine Tuning VALI: Epoch: 16, Steps: 66 | Train Loss: 0.0102717  Vali Loss: 0.0589875 Vali Accuracy: 0.9802772  Vali weighted F1: 0.9803532  Vali macro F1 0.9751377 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 6.013940334320068
Fine Tuning VALI: Epoch: 17, Steps: 66 | Train Loss: 0.0108308  Vali Loss: 0.0602412 Vali Accuracy: 0.9792111  Vali weighted F1: 0.9793271  Vali macro F1 0.9734396 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 6.000382423400879
Fine Tuning VALI: Epoch: 18, Steps: 66 | Train Loss: 0.0105103  Vali Loss: 0.0609326 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9799040  Vali macro F1 0.9736720 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 5.996370077133179
Fine Tuning VALI: Epoch: 19, Steps: 66 | Train Loss: 0.0107404  Vali Loss: 0.0589669 Vali Accuracy: 0.9802772  Vali weighted F1: 0.9803612  Vali macro F1 0.9755307 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 5.997597694396973
Fine Tuning VALI: Epoch: 20, Steps: 66 | Train Loss: 0.0094287  Vali Loss: 0.0589252 Vali Accuracy: 0.9786780  Vali weighted F1: 0.9787769  Vali macro F1 0.9728080 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9269699  Test weighted F1: 0.9276560  Test macro F1 0.8919530 
================ the 5 th CV Experiment ================ 
Leave one Out Experiment : The 6 Part as the test
[-] Target sampling weights:  [0.0001428  0.00018382 0.00096525 0.00125628 0.00053135 0.00063412]
Train data number :  17734
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1971
Test data number :  10878
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.393905878067017
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.0157226  Vali Loss: 0.6471694 Vali Accuracy: 0.7458143  Vali weighted F1: 0.7002500  Vali macro F1 0.4791892 
Validation loss decreased (inf --> 0.647169).  Saving model ...
Epoch: 2 cost time: 6.301961660385132
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.4967034  Vali Loss: 0.3751920 Vali Accuracy: 0.8609843  Vali weighted F1: 0.8494537  Vali macro F1 0.7949363 
new best score!!!!
Validation loss decreased (0.647169 --> 0.375192).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.307218551635742
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.3231667  Vali Loss: 0.2801830 Vali Accuracy: 0.8954845  Vali weighted F1: 0.8909704  Vali macro F1 0.8484480 
new best score!!!!
Validation loss decreased (0.375192 --> 0.280183).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.297349691390991
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.2418279  Vali Loss: 0.2136142 Vali Accuracy: 0.9223744  Vali weighted F1: 0.9212564  Vali macro F1 0.8807571 
new best score!!!!
Validation loss decreased (0.280183 --> 0.213614).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.307276487350464
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.1913626  Vali Loss: 0.1826401 Vali Accuracy: 0.9289701  Vali weighted F1: 0.9259813  Vali macro F1 0.8970149 
new best score!!!!
Validation loss decreased (0.213614 --> 0.182640).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.311735391616821
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.1676467  Vali Loss: 0.2003755 Vali Accuracy: 0.9279554  Vali weighted F1: 0.9257649  Vali macro F1 0.8936918 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 7 cost time: 6.302281141281128
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.1490223  Vali Loss: 0.1234660 Vali Accuracy: 0.9533232  Vali weighted F1: 0.9533812  Vali macro F1 0.9324445 
new best score!!!!
Validation loss decreased (0.182640 --> 0.123466).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.312103509902954
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1220370  Vali Loss: 0.1220954 Vali Accuracy: 0.9573820  Vali weighted F1: 0.9572674  Vali macro F1 0.9349825 
new best score!!!!
Validation loss decreased (0.123466 --> 0.122095).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.303682565689087
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1136195  Vali Loss: 0.1213700 Vali Accuracy: 0.9563673  Vali weighted F1: 0.9567052  Vali macro F1 0.9336579 
new best score!!!!
Validation loss decreased (0.122095 --> 0.121370).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.329425573348999
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1061668  Vali Loss: 0.0996784 Vali Accuracy: 0.9639777  Vali weighted F1: 0.9641952  Vali macro F1 0.9467293 
new best score!!!!
Validation loss decreased (0.121370 --> 0.099678).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.335667610168457
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1043306  Vali Loss: 0.1054326 Vali Accuracy: 0.9604262  Vali weighted F1: 0.9603682  Vali macro F1 0.9392181 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 6.313116073608398
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0986940  Vali Loss: 0.0969349 Vali Accuracy: 0.9695586  Vali weighted F1: 0.9696687  Vali macro F1 0.9571976 
new best score!!!!
Validation loss decreased (0.099678 --> 0.096935).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.309548377990723
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0806344  Vali Loss: 0.0964988 Vali Accuracy: 0.9680365  Vali weighted F1: 0.9680287  Vali macro F1 0.9532197 
new best score!!!!
Validation loss decreased (0.096935 --> 0.096499).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.3142478466033936
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0774064  Vali Loss: 0.0870609 Vali Accuracy: 0.9705733  Vali weighted F1: 0.9707155  Vali macro F1 0.9591262 
new best score!!!!
Validation loss decreased (0.096499 --> 0.087061).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.3009984493255615
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0720144  Vali Loss: 0.0845737 Vali Accuracy: 0.9700660  Vali weighted F1: 0.9703064  Vali macro F1 0.9591930 
new best score!!!!
Validation loss decreased (0.087061 --> 0.084574).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.317920446395874
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0668367  Vali Loss: 0.0716048 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802394  Vali macro F1 0.9737247 
new best score!!!!
Validation loss decreased (0.084574 --> 0.071605).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.31333327293396
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0608110  Vali Loss: 0.0729266 Vali Accuracy: 0.9751395  Vali weighted F1: 0.9749637  Vali macro F1 0.9639043 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 6.3031227588653564
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0598996  Vali Loss: 0.0726056 Vali Accuracy: 0.9731101  Vali weighted F1: 0.9733011  Vali macro F1 0.9611543 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 6.318821907043457
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0755624  Vali Loss: 0.0876308 Vali Accuracy: 0.9700660  Vali weighted F1: 0.9699818  Vali macro F1 0.9585173 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 20 cost time: 6.326413154602051
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0543809  Vali Loss: 0.0594462 Vali Accuracy: 0.9756469  Vali weighted F1: 0.9756762  Vali macro F1 0.9661226 
new best score!!!!
Validation loss decreased (0.071605 --> 0.059446).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.306152105331421
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0471419  Vali Loss: 0.0682796 Vali Accuracy: 0.9761542  Vali weighted F1: 0.9765280  Vali macro F1 0.9660874 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 6.294886589050293
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0536840  Vali Loss: 0.0721185 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9773114  Vali macro F1 0.9698955 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 6.331719875335693
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0419661  Vali Loss: 0.0645617 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9787488  Vali macro F1 0.9700461 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 24 cost time: 6.309753179550171
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0418711  Vali Loss: 0.0707061 Vali Accuracy: 0.9766616  Vali weighted F1: 0.9769365  Vali macro F1 0.9678654 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 25 cost time: 6.316937446594238
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0434458  Vali Loss: 0.0871442 Vali Accuracy: 0.9746322  Vali weighted F1: 0.9748703  Vali macro F1 0.9643424 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 26 cost time: 6.311570882797241
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0292615  Vali Loss: 0.0507162 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9813003  Vali macro F1 0.9732634 
new best score!!!!
Validation loss decreased (0.059446 --> 0.050716).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.3104407787323
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0238919  Vali Loss: 0.0488171 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9838431  Vali macro F1 0.9765076 
new best score!!!!
Validation loss decreased (0.050716 --> 0.048817).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.334154844284058
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0218484  Vali Loss: 0.0483660 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9843526  Vali macro F1 0.9771494 
new best score!!!!
Validation loss decreased (0.048817 --> 0.048366).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.322553634643555
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0223565  Vali Loss: 0.0480595 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9828123  Vali macro F1 0.9750848 
new best score!!!!
Validation loss decreased (0.048366 --> 0.048060).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.316323518753052
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0223798  Vali Loss: 0.0465014 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9838140  Vali macro F1 0.9764457 
new best score!!!!
Validation loss decreased (0.048060 --> 0.046501).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.312865972518921
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0215921  Vali Loss: 0.0448541 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853223  Vali macro F1 0.9790898 
new best score!!!!
Validation loss decreased (0.046501 --> 0.044854).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.311018943786621
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0210283  Vali Loss: 0.0441784 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9843167  Vali macro F1 0.9773263 
new best score!!!!
Validation loss decreased (0.044854 --> 0.044178).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.302241086959839
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0211689  Vali Loss: 0.0454457 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9843237  Vali macro F1 0.9777444 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 6.304545640945435
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0194488  Vali Loss: 0.0439250 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853295  Vali macro F1 0.9795082 
new best score!!!!
Validation loss decreased (0.044178 --> 0.043925).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 6.294860124588013
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0181445  Vali Loss: 0.0429173 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853374  Vali macro F1 0.9792717 
new best score!!!!
Validation loss decreased (0.043925 --> 0.042917).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.321992874145508
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0191648  Vali Loss: 0.0443789 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853338  Vali macro F1 0.9788707 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 6.309441566467285
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0190142  Vali Loss: 0.0439917 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9863417  Vali macro F1 0.9805278 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 6.330531120300293
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0177964  Vali Loss: 0.0443068 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9868660  Vali macro F1 0.9808450 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 6.319603204727173
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0181806  Vali Loss: 0.0433563 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9868898  Vali macro F1 0.9808058 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 40 cost time: 6.3287951946258545
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0182077  Vali Loss: 0.0472703 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9858309  Vali macro F1 0.9804324 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 41 cost time: 6.316809892654419
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0177405  Vali Loss: 0.0449150 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9858516  Vali macro F1 0.9796884 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 6.311900854110718
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0172276  Vali Loss: 0.0452055 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9858516  Vali macro F1 0.9796884 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 8.28763747215271
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0165303  Vali Loss: 0.0449620 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9863711  Vali macro F1 0.9802480 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 6.313120365142822
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0172110  Vali Loss: 0.0449622 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9863711  Vali macro F1 0.9802480 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 45 cost time: 6.316393136978149
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0162924  Vali Loss: 0.0443003 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9863711  Vali macro F1 0.9802480 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 46 cost time: 6.276376724243164
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0161136  Vali Loss: 0.0443297 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9863711  Vali macro F1 0.9802480 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 6.266716957092285
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0162622  Vali Loss: 0.0443059 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9863711  Vali macro F1 0.9802480 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 48 cost time: 6.244866371154785
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0165595  Vali Loss: 0.0443294 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9863711  Vali macro F1 0.9802480 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 49 cost time: 6.253374814987183
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0160534  Vali Loss: 0.0443212 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9863711  Vali macro F1 0.9802480 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 50 cost time: 6.250801086425781
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0159647  Vali Loss: 0.0442669 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9863711  Vali macro F1 0.9802480 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9353741  Test weighted F1: 0.9338632  Test macro F1 0.9324215 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 240495
pruned model Parameter : 244174
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.269919157028198
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0194795  Vali Loss: 0.0462645 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9858272  Vali macro F1 0.9804834 
Validation loss decreased (inf --> 0.046265).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.24914026260376
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0194638  Vali Loss: 0.0447303 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9858517  Vali macro F1 0.9798117 
new best score!!!!
Validation loss decreased (0.046265 --> 0.044730).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.246431350708008
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0182245  Vali Loss: 0.0474314 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9858575  Vali macro F1 0.9800595 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.237119674682617
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0170446  Vali Loss: 0.0457837 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9843547  Vali macro F1 0.9773913 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.270679473876953
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0188225  Vali Loss: 0.0448774 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853433  Vali macro F1 0.9788299 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 6.266586542129517
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0186953  Vali Loss: 0.0456434 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9868480  Vali macro F1 0.9815128 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 6.260680198669434
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0160032  Vali Loss: 0.0441318 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9863641  Vali macro F1 0.9805524 
new best score!!!!
Validation loss decreased (0.044730 --> 0.044132).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 6.264960289001465
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0157282  Vali Loss: 0.0407931 Vali Accuracy: 0.9883308  Vali weighted F1: 0.9883726  Vali macro F1 0.9836947 
new best score!!!!
Validation loss decreased (0.044132 --> 0.040793).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.2586987018585205
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0151668  Vali Loss: 0.0397231 Vali Accuracy: 0.9878234  Vali weighted F1: 0.9878455  Vali macro F1 0.9829291 
new best score!!!!
Validation loss decreased (0.040793 --> 0.039723).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 6.254343748092651
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0155536  Vali Loss: 0.0456051 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9858363  Vali macro F1 0.9800669 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 6.276205778121948
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0154318  Vali Loss: 0.0435589 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853271  Vali macro F1 0.9790019 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 6.254175186157227
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0144408  Vali Loss: 0.0435881 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9863863  Vali macro F1 0.9807132 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 6.2571423053741455
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0145865  Vali Loss: 0.0418835 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9863641  Vali macro F1 0.9800856 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 14 cost time: 6.269525527954102
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0148386  Vali Loss: 0.0450355 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9858584  Vali macro F1 0.9801615 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 15 cost time: 6.2540459632873535
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0150589  Vali Loss: 0.0439224 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853545  Vali macro F1 0.9795387 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.2670629024505615
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0135399  Vali Loss: 0.0480521 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9863587  Vali macro F1 0.9814780 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 6.248423099517822
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0132191  Vali Loss: 0.0454682 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9848413  Vali macro F1 0.9783887 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 6.243626832962036
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0133648  Vali Loss: 0.0411805 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9868417  Vali macro F1 0.9818627 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 6.247065782546997
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0133426  Vali Loss: 0.0396531 Vali Accuracy: 0.9873161  Vali weighted F1: 0.9873404  Vali macro F1 0.9822579 
new best score!!!!
Validation loss decreased (0.039723 --> 0.039653).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 20 cost time: 6.247062921524048
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0115701  Vali Loss: 0.0404299 Vali Accuracy: 0.9888382  Vali weighted F1: 0.9888802  Vali macro F1 0.9847053 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 6.241010665893555
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0124960  Vali Loss: 0.0419589 Vali Accuracy: 0.9873161  Vali weighted F1: 0.9873500  Vali macro F1 0.9823948 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 6.242082595825195
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0116433  Vali Loss: 0.0418445 Vali Accuracy: 0.9873161  Vali weighted F1: 0.9873493  Vali macro F1 0.9822826 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 6.259768724441528
Fine Tuning VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0132710  Vali Loss: 0.0424590 Vali Accuracy: 0.9878234  Vali weighted F1: 0.9878532  Vali macro F1 0.9834702 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 6.247123718261719
Fine Tuning VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0113947  Vali Loss: 0.0439102 Vali Accuracy: 0.9873161  Vali weighted F1: 0.9873440  Vali macro F1 0.9823753 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 25 cost time: 6.246609687805176
Fine Tuning VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0104559  Vali Loss: 0.0433922 Vali Accuracy: 0.9878234  Vali weighted F1: 0.9878580  Vali macro F1 0.9828834 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 6.237624168395996
Fine Tuning VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0105182  Vali Loss: 0.0432894 Vali Accuracy: 0.9873161  Vali weighted F1: 0.9873494  Vali macro F1 0.9819797 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 27 cost time: 6.235876798629761
Fine Tuning VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0095234  Vali Loss: 0.0436521 Vali Accuracy: 0.9873161  Vali weighted F1: 0.9873494  Vali macro F1 0.9819797 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 28 cost time: 6.245075225830078
Fine Tuning VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0096022  Vali Loss: 0.0436589 Vali Accuracy: 0.9878234  Vali weighted F1: 0.9878580  Vali macro F1 0.9828834 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 29 cost time: 6.246934175491333
Fine Tuning VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0100920  Vali Loss: 0.0427353 Vali Accuracy: 0.9883308  Vali weighted F1: 0.9883662  Vali macro F1 0.9837857 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 30 cost time: 6.259718656539917
Fine Tuning VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0106280  Vali Loss: 0.0427385 Vali Accuracy: 0.9883308  Vali weighted F1: 0.9883662  Vali macro F1 0.9837857 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 31 cost time: 6.27927827835083
Fine Tuning VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0096264  Vali Loss: 0.0427583 Vali Accuracy: 0.9888382  Vali weighted F1: 0.9888739  Vali macro F1 0.9846868 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 32 cost time: 6.265879392623901
Fine Tuning VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0098356  Vali Loss: 0.0427416 Vali Accuracy: 0.9883308  Vali weighted F1: 0.9883662  Vali macro F1 0.9837857 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 33 cost time: 6.254516124725342
Fine Tuning VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0097804  Vali Loss: 0.0427147 Vali Accuracy: 0.9883308  Vali weighted F1: 0.9883662  Vali macro F1 0.9837857 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 34 cost time: 6.238295316696167
Fine Tuning VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0093166  Vali Loss: 0.0426859 Vali Accuracy: 0.9888382  Vali weighted F1: 0.9888739  Vali macro F1 0.9846868 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9330759  Test weighted F1: 0.9313527  Test macro F1 0.9316549 
================ the 6 th CV Experiment ================ 
Leave one Out Experiment : The 7 Part as the test
[-] Target sampling weights:  [0.00014223 0.00017892 0.00098039 0.00120192 0.00047619 0.00059916]
Train data number :  18241
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2027
Test data number :  8061
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.426357269287109
VALI: Epoch: 1, Steps: 72 | Train Loss: 0.9964033  Vali Loss: 0.5974452 Vali Accuracy: 0.7705969  Vali weighted F1: 0.7485941  Vali macro F1 0.5547779 
Validation loss decreased (inf --> 0.597445).  Saving model ...
Epoch: 2 cost time: 6.433499097824097
VALI: Epoch: 2, Steps: 72 | Train Loss: 0.4741957  Vali Loss: 0.3379671 Vali Accuracy: 0.8796251  Vali weighted F1: 0.8693431  Vali macro F1 0.8223574 
new best score!!!!
Validation loss decreased (0.597445 --> 0.337967).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.416910886764526
VALI: Epoch: 3, Steps: 72 | Train Loss: 0.3172715  Vali Loss: 0.2882055 Vali Accuracy: 0.9052787  Vali weighted F1: 0.9033323  Vali macro F1 0.8752128 
new best score!!!!
Validation loss decreased (0.337967 --> 0.288206).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.410652160644531
VALI: Epoch: 4, Steps: 72 | Train Loss: 0.2379780  Vali Loss: 0.2033469 Vali Accuracy: 0.9294524  Vali weighted F1: 0.9279069  Vali macro F1 0.9057205 
new best score!!!!
Validation loss decreased (0.288206 --> 0.203347).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.426422119140625
VALI: Epoch: 5, Steps: 72 | Train Loss: 0.1937708  Vali Loss: 0.1516920 Vali Accuracy: 0.9462259  Vali weighted F1: 0.9450857  Vali macro F1 0.9291419 
new best score!!!!
Validation loss decreased (0.203347 --> 0.151692).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.4493088722229
VALI: Epoch: 6, Steps: 72 | Train Loss: 0.1621400  Vali Loss: 0.1318648 Vali Accuracy: 0.9551061  Vali weighted F1: 0.9547266  Vali macro F1 0.9380470 
new best score!!!!
Validation loss decreased (0.151692 --> 0.131865).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.450358629226685
VALI: Epoch: 7, Steps: 72 | Train Loss: 0.1480535  Vali Loss: 0.1145703 Vali Accuracy: 0.9615195  Vali weighted F1: 0.9610885  Vali macro F1 0.9489204 
new best score!!!!
Validation loss decreased (0.131865 --> 0.114570).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.430068492889404
VALI: Epoch: 8, Steps: 72 | Train Loss: 0.1459934  Vali Loss: 0.1006298 Vali Accuracy: 0.9654662  Vali weighted F1: 0.9658659  Vali macro F1 0.9550420 
new best score!!!!
Validation loss decreased (0.114570 --> 0.100630).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.426397800445557
VALI: Epoch: 9, Steps: 72 | Train Loss: 0.1197232  Vali Loss: 0.1005235 Vali Accuracy: 0.9629995  Vali weighted F1: 0.9631501  Vali macro F1 0.9513156 
new best score!!!!
Validation loss decreased (0.100630 --> 0.100523).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.425046920776367
VALI: Epoch: 10, Steps: 72 | Train Loss: 0.1230392  Vali Loss: 0.0936285 Vali Accuracy: 0.9679329  Vali weighted F1: 0.9681861  Vali macro F1 0.9579451 
new best score!!!!
Validation loss decreased (0.100523 --> 0.093629).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.422839164733887
VALI: Epoch: 11, Steps: 72 | Train Loss: 0.1017723  Vali Loss: 0.0861412 Vali Accuracy: 0.9718796  Vali weighted F1: 0.9717400  Vali macro F1 0.9613032 
new best score!!!!
Validation loss decreased (0.093629 --> 0.086141).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.4171226024627686
VALI: Epoch: 12, Steps: 72 | Train Loss: 0.0976276  Vali Loss: 0.1030925 Vali Accuracy: 0.9644795  Vali weighted F1: 0.9650647  Vali macro F1 0.9534952 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 6.418303728103638
VALI: Epoch: 13, Steps: 72 | Train Loss: 0.0936087  Vali Loss: 0.0802979 Vali Accuracy: 0.9728663  Vali weighted F1: 0.9728304  Vali macro F1 0.9637938 
new best score!!!!
Validation loss decreased (0.086141 --> 0.080298).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.42420768737793
VALI: Epoch: 14, Steps: 72 | Train Loss: 0.0853892  Vali Loss: 0.0777591 Vali Accuracy: 0.9748397  Vali weighted F1: 0.9751562  Vali macro F1 0.9681401 
new best score!!!!
Validation loss decreased (0.080298 --> 0.077759).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.449609994888306
VALI: Epoch: 15, Steps: 72 | Train Loss: 0.0844375  Vali Loss: 0.0679250 Vali Accuracy: 0.9792797  Vali weighted F1: 0.9792977  Vali macro F1 0.9728102 
new best score!!!!
Validation loss decreased (0.077759 --> 0.067925).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.446732759475708
VALI: Epoch: 16, Steps: 72 | Train Loss: 0.0699975  Vali Loss: 0.0880608 Vali Accuracy: 0.9708929  Vali weighted F1: 0.9705862  Vali macro F1 0.9607491 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 6.447610378265381
VALI: Epoch: 17, Steps: 72 | Train Loss: 0.0760803  Vali Loss: 0.0741924 Vali Accuracy: 0.9703996  Vali weighted F1: 0.9705989  Vali macro F1 0.9609484 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 6.431731462478638
VALI: Epoch: 18, Steps: 72 | Train Loss: 0.0643277  Vali Loss: 0.0670772 Vali Accuracy: 0.9782930  Vali weighted F1: 0.9782928  Vali macro F1 0.9711948 
new best score!!!!
Validation loss decreased (0.067925 --> 0.067077).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.439959764480591
VALI: Epoch: 19, Steps: 72 | Train Loss: 0.0612018  Vali Loss: 0.0587142 Vali Accuracy: 0.9777997  Vali weighted F1: 0.9778128  Vali macro F1 0.9696691 
new best score!!!!
Validation loss decreased (0.067077 --> 0.058714).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.4406418800354
VALI: Epoch: 20, Steps: 72 | Train Loss: 0.0626793  Vali Loss: 0.0670995 Vali Accuracy: 0.9782930  Vali weighted F1: 0.9782797  Vali macro F1 0.9716582 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.441359996795654
VALI: Epoch: 21, Steps: 72 | Train Loss: 0.0641427  Vali Loss: 0.0759448 Vali Accuracy: 0.9738530  Vali weighted F1: 0.9737038  Vali macro F1 0.9656303 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 6.452182054519653
VALI: Epoch: 22, Steps: 72 | Train Loss: 0.0540511  Vali Loss: 0.0629716 Vali Accuracy: 0.9787864  Vali weighted F1: 0.9787612  Vali macro F1 0.9718935 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 23 cost time: 6.442976713180542
VALI: Epoch: 23, Steps: 72 | Train Loss: 0.0465270  Vali Loss: 0.0686515 Vali Accuracy: 0.9817464  Vali weighted F1: 0.9817439  Vali macro F1 0.9763833 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 24 cost time: 6.46356201171875
VALI: Epoch: 24, Steps: 72 | Train Loss: 0.0470124  Vali Loss: 0.0860983 Vali Accuracy: 0.9699063  Vali weighted F1: 0.9704698  Vali macro F1 0.9615358 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 25 cost time: 6.430904150009155
VALI: Epoch: 25, Steps: 72 | Train Loss: 0.0357546  Vali Loss: 0.0508341 Vali Accuracy: 0.9832264  Vali weighted F1: 0.9832641  Vali macro F1 0.9776137 
new best score!!!!
Validation loss decreased (0.058714 --> 0.050834).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.4293060302734375
VALI: Epoch: 26, Steps: 72 | Train Loss: 0.0302139  Vali Loss: 0.0514250 Vali Accuracy: 0.9837198  Vali weighted F1: 0.9837578  Vali macro F1 0.9785015 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 6.420751333236694
VALI: Epoch: 27, Steps: 72 | Train Loss: 0.0287463  Vali Loss: 0.0516402 Vali Accuracy: 0.9851998  Vali weighted F1: 0.9852219  Vali macro F1 0.9809174 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 6.433437824249268
VALI: Epoch: 28, Steps: 72 | Train Loss: 0.0277547  Vali Loss: 0.0513391 Vali Accuracy: 0.9832264  Vali weighted F1: 0.9832697  Vali macro F1 0.9781486 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 29 cost time: 6.434668064117432
VALI: Epoch: 29, Steps: 72 | Train Loss: 0.0277038  Vali Loss: 0.0527598 Vali Accuracy: 0.9847065  Vali weighted F1: 0.9847397  Vali macro F1 0.9801243 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 30 cost time: 6.42797327041626
VALI: Epoch: 30, Steps: 72 | Train Loss: 0.0260985  Vali Loss: 0.0537943 Vali Accuracy: 0.9817464  Vali weighted F1: 0.9817328  Vali macro F1 0.9766299 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 31 cost time: 6.437311887741089
VALI: Epoch: 31, Steps: 72 | Train Loss: 0.0253480  Vali Loss: 0.0513860 Vali Accuracy: 0.9842131  Vali weighted F1: 0.9842382  Vali macro F1 0.9792407 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 6.424806594848633
VALI: Epoch: 32, Steps: 72 | Train Loss: 0.0253589  Vali Loss: 0.0513356 Vali Accuracy: 0.9842131  Vali weighted F1: 0.9842382  Vali macro F1 0.9792407 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 6.4330034255981445
VALI: Epoch: 33, Steps: 72 | Train Loss: 0.0264789  Vali Loss: 0.0516097 Vali Accuracy: 0.9842131  Vali weighted F1: 0.9842382  Vali macro F1 0.9792407 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 34 cost time: 6.4406280517578125
VALI: Epoch: 34, Steps: 72 | Train Loss: 0.0234729  Vali Loss: 0.0512166 Vali Accuracy: 0.9842131  Vali weighted F1: 0.9842382  Vali macro F1 0.9792407 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 35 cost time: 6.448652744293213
VALI: Epoch: 35, Steps: 72 | Train Loss: 0.0253722  Vali Loss: 0.0514643 Vali Accuracy: 0.9832264  Vali weighted F1: 0.9832700  Vali macro F1 0.9782583 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 36 cost time: 6.428662300109863
VALI: Epoch: 36, Steps: 72 | Train Loss: 0.0250824  Vali Loss: 0.0514536 Vali Accuracy: 0.9832264  Vali weighted F1: 0.9832700  Vali macro F1 0.9782583 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 6.434942007064819
VALI: Epoch: 37, Steps: 72 | Train Loss: 0.0251123  Vali Loss: 0.0513749 Vali Accuracy: 0.9832264  Vali weighted F1: 0.9832700  Vali macro F1 0.9782583 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 6.422324895858765
VALI: Epoch: 38, Steps: 72 | Train Loss: 0.0251348  Vali Loss: 0.0514235 Vali Accuracy: 0.9832264  Vali weighted F1: 0.9832700  Vali macro F1 0.9782583 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 6.43091607093811
VALI: Epoch: 39, Steps: 72 | Train Loss: 0.0261301  Vali Loss: 0.0514302 Vali Accuracy: 0.9832264  Vali weighted F1: 0.9832700  Vali macro F1 0.9782583 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 40 cost time: 6.420160293579102
VALI: Epoch: 40, Steps: 72 | Train Loss: 0.0246547  Vali Loss: 0.0514720 Vali Accuracy: 0.9832264  Vali weighted F1: 0.9832700  Vali macro F1 0.9782583 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9006327  Test weighted F1: 0.8881957  Test macro F1 0.6755633 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 240495
pruned model Parameter : 244174
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.453537225723267
Fine Tuning VALI: Epoch: 1, Steps: 72 | Train Loss: 0.0321276  Vali Loss: 0.0520403 Vali Accuracy: 0.9842131  Vali weighted F1: 0.9842725  Vali macro F1 0.9793716 
Validation loss decreased (inf --> 0.052040).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.446928262710571
Fine Tuning VALI: Epoch: 2, Steps: 72 | Train Loss: 0.0294196  Vali Loss: 0.0559915 Vali Accuracy: 0.9827331  Vali weighted F1: 0.9827886  Vali macro F1 0.9779248 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.430471181869507
Fine Tuning VALI: Epoch: 3, Steps: 72 | Train Loss: 0.0289664  Vali Loss: 0.0526930 Vali Accuracy: 0.9822398  Vali weighted F1: 0.9822335  Vali macro F1 0.9771962 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.441396713256836
Fine Tuning VALI: Epoch: 4, Steps: 72 | Train Loss: 0.0270614  Vali Loss: 0.0523231 Vali Accuracy: 0.9827331  Vali weighted F1: 0.9827349  Vali macro F1 0.9772902 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.440083742141724
Fine Tuning VALI: Epoch: 5, Steps: 72 | Train Loss: 0.0257721  Vali Loss: 0.0512178 Vali Accuracy: 0.9842131  Vali weighted F1: 0.9842481  Vali macro F1 0.9795027 
new best score!!!!
Validation loss decreased (0.052040 --> 0.051218).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.435532569885254
Fine Tuning VALI: Epoch: 6, Steps: 72 | Train Loss: 0.0259767  Vali Loss: 0.0539645 Vali Accuracy: 0.9827331  Vali weighted F1: 0.9827887  Vali macro F1 0.9773362 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.432582139968872
Fine Tuning VALI: Epoch: 7, Steps: 72 | Train Loss: 0.0239375  Vali Loss: 0.0511339 Vali Accuracy: 0.9837198  Vali weighted F1: 0.9837330  Vali macro F1 0.9786050 
new best score!!!!
Validation loss decreased (0.051218 --> 0.051134).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 6.436994791030884
Fine Tuning VALI: Epoch: 8, Steps: 72 | Train Loss: 0.0246410  Vali Loss: 0.0502940 Vali Accuracy: 0.9837198  Vali weighted F1: 0.9837635  Vali macro F1 0.9784963 
new best score!!!!
Validation loss decreased (0.051134 --> 0.050294).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.43749475479126
Fine Tuning VALI: Epoch: 9, Steps: 72 | Train Loss: 0.0235572  Vali Loss: 0.0508463 Vali Accuracy: 0.9842131  Vali weighted F1: 0.9842559  Vali macro F1 0.9795273 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.429954767227173
Fine Tuning VALI: Epoch: 10, Steps: 72 | Train Loss: 0.0241668  Vali Loss: 0.0526151 Vali Accuracy: 0.9856931  Vali weighted F1: 0.9857288  Vali macro F1 0.9815653 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 6.4446587562561035
Fine Tuning VALI: Epoch: 11, Steps: 72 | Train Loss: 0.0226737  Vali Loss: 0.0569182 Vali Accuracy: 0.9812531  Vali weighted F1: 0.9812915  Vali macro F1 0.9759443 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 6.450124025344849
Fine Tuning VALI: Epoch: 12, Steps: 72 | Train Loss: 0.0213847  Vali Loss: 0.0492995 Vali Accuracy: 0.9832264  Vali weighted F1: 0.9832577  Vali macro F1 0.9778865 
new best score!!!!
Validation loss decreased (0.050294 --> 0.049300).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 6.46537184715271
Fine Tuning VALI: Epoch: 13, Steps: 72 | Train Loss: 0.0197883  Vali Loss: 0.0493379 Vali Accuracy: 0.9851998  Vali weighted F1: 0.9852901  Vali macro F1 0.9806084 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.444384336471558
Fine Tuning VALI: Epoch: 14, Steps: 72 | Train Loss: 0.0219928  Vali Loss: 0.0556445 Vali Accuracy: 0.9802664  Vali weighted F1: 0.9803162  Vali macro F1 0.9739181 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.43609356880188
Fine Tuning VALI: Epoch: 15, Steps: 72 | Train Loss: 0.0213197  Vali Loss: 0.0513666 Vali Accuracy: 0.9827331  Vali weighted F1: 0.9828379  Vali macro F1 0.9771112 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.427367687225342
Fine Tuning VALI: Epoch: 16, Steps: 72 | Train Loss: 0.0197878  Vali Loss: 0.0542836 Vali Accuracy: 0.9837198  Vali weighted F1: 0.9837190  Vali macro F1 0.9796038 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 6.42301344871521
Fine Tuning VALI: Epoch: 17, Steps: 72 | Train Loss: 0.0187835  Vali Loss: 0.0530764 Vali Accuracy: 0.9837198  Vali weighted F1: 0.9838089  Vali macro F1 0.9790486 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 18 cost time: 6.42800760269165
Fine Tuning VALI: Epoch: 18, Steps: 72 | Train Loss: 0.0185825  Vali Loss: 0.0531318 Vali Accuracy: 0.9822398  Vali weighted F1: 0.9822533  Vali macro F1 0.9779731 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 6.431396961212158
Fine Tuning VALI: Epoch: 19, Steps: 72 | Train Loss: 0.0180096  Vali Loss: 0.0519930 Vali Accuracy: 0.9832264  Vali weighted F1: 0.9832831  Vali macro F1 0.9791238 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 6.444919586181641
Fine Tuning VALI: Epoch: 20, Steps: 72 | Train Loss: 0.0190074  Vali Loss: 0.0518101 Vali Accuracy: 0.9812531  Vali weighted F1: 0.9812437  Vali macro F1 0.9768124 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 6.455710172653198
Fine Tuning VALI: Epoch: 21, Steps: 72 | Train Loss: 0.0169071  Vali Loss: 0.0524788 Vali Accuracy: 0.9827331  Vali weighted F1: 0.9827968  Vali macro F1 0.9783500 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 6.435612678527832
Fine Tuning VALI: Epoch: 22, Steps: 72 | Train Loss: 0.0174124  Vali Loss: 0.0534819 Vali Accuracy: 0.9822398  Vali weighted F1: 0.9822696  Vali macro F1 0.9778088 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 23 cost time: 6.4271228313446045
Fine Tuning VALI: Epoch: 23, Steps: 72 | Train Loss: 0.0166077  Vali Loss: 0.0514985 Vali Accuracy: 0.9827331  Vali weighted F1: 0.9828014  Vali macro F1 0.9780509 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 6.429577827453613
Fine Tuning VALI: Epoch: 24, Steps: 72 | Train Loss: 0.0161638  Vali Loss: 0.0511557 Vali Accuracy: 0.9827331  Vali weighted F1: 0.9827919  Vali macro F1 0.9778541 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 6.431881427764893
Fine Tuning VALI: Epoch: 25, Steps: 72 | Train Loss: 0.0146874  Vali Loss: 0.0514703 Vali Accuracy: 0.9832264  Vali weighted F1: 0.9832948  Vali macro F1 0.9784604 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 6.449747085571289
Fine Tuning VALI: Epoch: 26, Steps: 72 | Train Loss: 0.0151125  Vali Loss: 0.0516388 Vali Accuracy: 0.9822398  Vali weighted F1: 0.9822869  Vali macro F1 0.9773524 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 6.429114818572998
Fine Tuning VALI: Epoch: 27, Steps: 72 | Train Loss: 0.0147316  Vali Loss: 0.0506042 Vali Accuracy: 0.9832264  Vali weighted F1: 0.9832856  Vali macro F1 0.9785416 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8981516  Test weighted F1: 0.8867243  Test macro F1 0.6763336 
================ the 7 th CV Experiment ================ 
Leave one Out Experiment : The 8 Part as the test
[-] Target sampling weights:  [0.00014451 0.00016909 0.00099108 0.00134953 0.00049579 0.00063694]
Train data number :  18171
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2019
Test data number :  8450
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.426645278930664
VALI: Epoch: 1, Steps: 71 | Train Loss: 0.9671457  Vali Loss: 0.5752879 Vali Accuracy: 0.7756315  Vali weighted F1: 0.7403983  Vali macro F1 0.5298114 
Validation loss decreased (inf --> 0.575288).  Saving model ...
Epoch: 2 cost time: 6.39406156539917
VALI: Epoch: 2, Steps: 71 | Train Loss: 0.4539875  Vali Loss: 0.3327174 Vali Accuracy: 0.8751857  Vali weighted F1: 0.8652385  Vali macro F1 0.8218065 
new best score!!!!
Validation loss decreased (0.575288 --> 0.332717).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.396411895751953
VALI: Epoch: 3, Steps: 71 | Train Loss: 0.2870051  Vali Loss: 0.2282045 Vali Accuracy: 0.9257058  Vali weighted F1: 0.9251915  Vali macro F1 0.8991870 
new best score!!!!
Validation loss decreased (0.332717 --> 0.228204).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.389715194702148
VALI: Epoch: 4, Steps: 71 | Train Loss: 0.2144659  Vali Loss: 0.2294153 Vali Accuracy: 0.9217434  Vali weighted F1: 0.9202653  Vali macro F1 0.8865139 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 5 cost time: 6.400507688522339
VALI: Epoch: 5, Steps: 71 | Train Loss: 0.1683505  Vali Loss: 0.1767753 Vali Accuracy: 0.9380882  Vali weighted F1: 0.9374518  Vali macro F1 0.9110345 
new best score!!!!
Validation loss decreased (0.228204 --> 0.176775).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.4112937450408936
VALI: Epoch: 6, Steps: 71 | Train Loss: 0.1526247  Vali Loss: 0.1618051 Vali Accuracy: 0.9425458  Vali weighted F1: 0.9424741  Vali macro F1 0.9170444 
new best score!!!!
Validation loss decreased (0.176775 --> 0.161805).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.3961029052734375
VALI: Epoch: 7, Steps: 71 | Train Loss: 0.1336735  Vali Loss: 0.1602021 Vali Accuracy: 0.9479941  Vali weighted F1: 0.9466142  Vali macro F1 0.9315199 
new best score!!!!
Validation loss decreased (0.161805 --> 0.160202).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.3954620361328125
VALI: Epoch: 8, Steps: 71 | Train Loss: 0.1235852  Vali Loss: 0.1325259 Vali Accuracy: 0.9618623  Vali weighted F1: 0.9621202  Vali macro F1 0.9503941 
new best score!!!!
Validation loss decreased (0.160202 --> 0.132526).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.421281814575195
VALI: Epoch: 9, Steps: 71 | Train Loss: 0.1197362  Vali Loss: 0.1499739 Vali Accuracy: 0.9504705  Vali weighted F1: 0.9495298  Vali macro F1 0.9345947 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 6.415221214294434
VALI: Epoch: 10, Steps: 71 | Train Loss: 0.1049619  Vali Loss: 0.1144136 Vali Accuracy: 0.9628529  Vali weighted F1: 0.9629388  Vali macro F1 0.9515880 
new best score!!!!
Validation loss decreased (0.132526 --> 0.114414).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.404626369476318
VALI: Epoch: 11, Steps: 71 | Train Loss: 0.0956938  Vali Loss: 0.1134734 Vali Accuracy: 0.9598811  Vali weighted F1: 0.9597586  Vali macro F1 0.9459711 
new best score!!!!
Validation loss decreased (0.114414 --> 0.113473).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.394871711730957
VALI: Epoch: 12, Steps: 71 | Train Loss: 0.0963349  Vali Loss: 0.1211508 Vali Accuracy: 0.9633482  Vali weighted F1: 0.9638724  Vali macro F1 0.9540592 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 6.394219160079956
VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0802956  Vali Loss: 0.1006824 Vali Accuracy: 0.9668153  Vali weighted F1: 0.9672794  Vali macro F1 0.9572354 
new best score!!!!
Validation loss decreased (0.113473 --> 0.100682).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.396238327026367
VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0797102  Vali Loss: 0.0904140 Vali Accuracy: 0.9717682  Vali weighted F1: 0.9719873  Vali macro F1 0.9617356 
new best score!!!!
Validation loss decreased (0.100682 --> 0.090414).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.39358115196228
VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0754968  Vali Loss: 0.0811688 Vali Accuracy: 0.9722635  Vali weighted F1: 0.9724280  Vali macro F1 0.9619184 
new best score!!!!
Validation loss decreased (0.090414 --> 0.081169).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.391621112823486
VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0631054  Vali Loss: 0.0838216 Vali Accuracy: 0.9737494  Vali weighted F1: 0.9737101  Vali macro F1 0.9642970 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 6.41150164604187
VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0608516  Vali Loss: 0.0728214 Vali Accuracy: 0.9752353  Vali weighted F1: 0.9754048  Vali macro F1 0.9669004 
new best score!!!!
Validation loss decreased (0.081169 --> 0.072821).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.417705059051514
VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0520852  Vali Loss: 0.0738369 Vali Accuracy: 0.9796929  Vali weighted F1: 0.9798325  Vali macro F1 0.9723116 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.401812314987183
VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0472840  Vali Loss: 0.0587186 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9802371  Vali macro F1 0.9729815 
new best score!!!!
Validation loss decreased (0.072821 --> 0.058719).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.417633533477783
VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0442346  Vali Loss: 0.0650872 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9802202  Vali macro F1 0.9723305 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.399744033813477
VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0476804  Vali Loss: 0.0631002 Vali Accuracy: 0.9772164  Vali weighted F1: 0.9771913  Vali macro F1 0.9657872 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 6.393060922622681
VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0433985  Vali Loss: 0.1081760 Vali Accuracy: 0.9663200  Vali weighted F1: 0.9669566  Vali macro F1 0.9562743 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 23 cost time: 6.399553537368774
VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0425112  Vali Loss: 0.0607443 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9807545  Vali macro F1 0.9744214 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 24 cost time: 6.40816593170166
VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0317580  Vali Loss: 0.0576189 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9827641  Vali macro F1 0.9756929 
new best score!!!!
Validation loss decreased (0.058719 --> 0.057619).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.437500715255737
VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0348535  Vali Loss: 0.0515231 Vali Accuracy: 0.9846459  Vali weighted F1: 0.9847095  Vali macro F1 0.9782141 
new best score!!!!
Validation loss decreased (0.057619 --> 0.051523).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.435588359832764
VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0295272  Vali Loss: 0.0553916 Vali Accuracy: 0.9846459  Vali weighted F1: 0.9847661  Vali macro F1 0.9789785 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 6.4100611209869385
VALI: Epoch: 27, Steps: 71 | Train Loss: 0.0292391  Vali Loss: 0.0561058 Vali Accuracy: 0.9821694  Vali weighted F1: 0.9823676  Vali macro F1 0.9757022 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 6.413136720657349
VALI: Epoch: 28, Steps: 71 | Train Loss: 0.0275781  Vali Loss: 0.0635599 Vali Accuracy: 0.9772164  Vali weighted F1: 0.9772240  Vali macro F1 0.9681336 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 29 cost time: 6.416215658187866
VALI: Epoch: 29, Steps: 71 | Train Loss: 0.0267142  Vali Loss: 0.0570478 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9836973  Vali macro F1 0.9767787 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 30 cost time: 6.421713590621948
VALI: Epoch: 30, Steps: 71 | Train Loss: 0.0244341  Vali Loss: 0.0600926 Vali Accuracy: 0.9821694  Vali weighted F1: 0.9821381  Vali macro F1 0.9747579 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 31 cost time: 6.414965867996216
VALI: Epoch: 31, Steps: 71 | Train Loss: 0.0169638  Vali Loss: 0.0532568 Vali Accuracy: 0.9831600  Vali weighted F1: 0.9832082  Vali macro F1 0.9762504 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 6.413222789764404
VALI: Epoch: 32, Steps: 71 | Train Loss: 0.0135929  Vali Loss: 0.0517232 Vali Accuracy: 0.9846459  Vali weighted F1: 0.9846913  Vali macro F1 0.9781348 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 6.420928478240967
VALI: Epoch: 33, Steps: 71 | Train Loss: 0.0131011  Vali Loss: 0.0543693 Vali Accuracy: 0.9831600  Vali weighted F1: 0.9832447  Vali macro F1 0.9763550 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 34 cost time: 6.435129404067993
VALI: Epoch: 34, Steps: 71 | Train Loss: 0.0119914  Vali Loss: 0.0534385 Vali Accuracy: 0.9831600  Vali weighted F1: 0.9832232  Vali macro F1 0.9756700 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 35 cost time: 6.4104905128479
VALI: Epoch: 35, Steps: 71 | Train Loss: 0.0114233  Vali Loss: 0.0567097 Vali Accuracy: 0.9831600  Vali weighted F1: 0.9832447  Vali macro F1 0.9763550 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 36 cost time: 6.400501251220703
VALI: Epoch: 36, Steps: 71 | Train Loss: 0.0118040  Vali Loss: 0.0555089 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9837231  Vali macro F1 0.9768395 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 6.411936044692993
VALI: Epoch: 37, Steps: 71 | Train Loss: 0.0106196  Vali Loss: 0.0552775 Vali Accuracy: 0.9841506  Vali weighted F1: 0.9842023  Vali macro F1 0.9773257 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 6.4103922843933105
VALI: Epoch: 38, Steps: 71 | Train Loss: 0.0110788  Vali Loss: 0.0556925 Vali Accuracy: 0.9841506  Vali weighted F1: 0.9842023  Vali macro F1 0.9773257 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 6.412016153335571
VALI: Epoch: 39, Steps: 71 | Train Loss: 0.0111926  Vali Loss: 0.0551232 Vali Accuracy: 0.9841506  Vali weighted F1: 0.9842023  Vali macro F1 0.9773257 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 40 cost time: 6.392803192138672
VALI: Epoch: 40, Steps: 71 | Train Loss: 0.0109894  Vali Loss: 0.0556344 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9837231  Vali macro F1 0.9768395 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.7734911  Test weighted F1: 0.7790499  Test macro F1 0.7854774 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 240495
pruned model Parameter : 244174
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.444856643676758
Fine Tuning VALI: Epoch: 1, Steps: 71 | Train Loss: 0.0231158  Vali Loss: 0.0515636 Vali Accuracy: 0.9861317  Vali weighted F1: 0.9861487  Vali macro F1 0.9802859 
Validation loss decreased (inf --> 0.051564).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.403600454330444
Fine Tuning VALI: Epoch: 2, Steps: 71 | Train Loss: 0.0202682  Vali Loss: 0.0503348 Vali Accuracy: 0.9861317  Vali weighted F1: 0.9861893  Vali macro F1 0.9810673 
new best score!!!!
Validation loss decreased (0.051564 --> 0.050335).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.399211883544922
Fine Tuning VALI: Epoch: 3, Steps: 71 | Train Loss: 0.0193434  Vali Loss: 0.0516064 Vali Accuracy: 0.9861317  Vali weighted F1: 0.9861563  Vali macro F1 0.9806156 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.399073123931885
Fine Tuning VALI: Epoch: 4, Steps: 71 | Train Loss: 0.0181682  Vali Loss: 0.0530395 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9836639  Vali macro F1 0.9770030 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.40973424911499
Fine Tuning VALI: Epoch: 5, Steps: 71 | Train Loss: 0.0190330  Vali Loss: 0.0572839 Vali Accuracy: 0.9831600  Vali weighted F1: 0.9832195  Vali macro F1 0.9768848 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 6.411906480789185
Fine Tuning VALI: Epoch: 6, Steps: 71 | Train Loss: 0.0172728  Vali Loss: 0.0561522 Vali Accuracy: 0.9866270  Vali weighted F1: 0.9866978  Vali macro F1 0.9812396 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 6.407894134521484
Fine Tuning VALI: Epoch: 7, Steps: 71 | Train Loss: 0.0167869  Vali Loss: 0.0520222 Vali Accuracy: 0.9846459  Vali weighted F1: 0.9847394  Vali macro F1 0.9788726 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 8 cost time: 6.403987646102905
Fine Tuning VALI: Epoch: 8, Steps: 71 | Train Loss: 0.0165145  Vali Loss: 0.0547647 Vali Accuracy: 0.9831600  Vali weighted F1: 0.9831733  Vali macro F1 0.9764584 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.428407192230225
Fine Tuning VALI: Epoch: 9, Steps: 71 | Train Loss: 0.0159425  Vali Loss: 0.0602150 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9808325  Vali macro F1 0.9743416 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 6.441537141799927
Fine Tuning VALI: Epoch: 10, Steps: 71 | Train Loss: 0.0166551  Vali Loss: 0.0516729 Vali Accuracy: 0.9831600  Vali weighted F1: 0.9832603  Vali macro F1 0.9760793 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 6.407409191131592
Fine Tuning VALI: Epoch: 11, Steps: 71 | Train Loss: 0.0143379  Vali Loss: 0.0526011 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9837058  Vali macro F1 0.9771082 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 6.411215543746948
Fine Tuning VALI: Epoch: 12, Steps: 71 | Train Loss: 0.0144401  Vali Loss: 0.0492335 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9836884  Vali macro F1 0.9767565 
new best score!!!!
Validation loss decreased (0.050335 --> 0.049234).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 6.416309833526611
Fine Tuning VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0131568  Vali Loss: 0.0518025 Vali Accuracy: 0.9846459  Vali weighted F1: 0.9846609  Vali macro F1 0.9783856 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.415071725845337
Fine Tuning VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0146122  Vali Loss: 0.0516601 Vali Accuracy: 0.9841506  Vali weighted F1: 0.9842661  Vali macro F1 0.9785774 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.4130778312683105
Fine Tuning VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0130143  Vali Loss: 0.0565693 Vali Accuracy: 0.9841506  Vali weighted F1: 0.9842043  Vali macro F1 0.9779298 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.4026477336883545
Fine Tuning VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0131461  Vali Loss: 0.0588979 Vali Accuracy: 0.9841506  Vali weighted F1: 0.9841794  Vali macro F1 0.9778956 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 6.422405242919922
Fine Tuning VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0115427  Vali Loss: 0.0541545 Vali Accuracy: 0.9841506  Vali weighted F1: 0.9842387  Vali macro F1 0.9778838 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 18 cost time: 6.435469388961792
Fine Tuning VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0107865  Vali Loss: 0.0540816 Vali Accuracy: 0.9851412  Vali weighted F1: 0.9852064  Vali macro F1 0.9792143 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 6.412820339202881
Fine Tuning VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0112915  Vali Loss: 0.0558785 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9837364  Vali macro F1 0.9779389 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 6.411256313323975
Fine Tuning VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0119834  Vali Loss: 0.0537828 Vali Accuracy: 0.9846459  Vali weighted F1: 0.9846943  Vali macro F1 0.9789464 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 6.428216934204102
Fine Tuning VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0103830  Vali Loss: 0.0543881 Vali Accuracy: 0.9841506  Vali weighted F1: 0.9842009  Vali macro F1 0.9779178 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 6.40861439704895
Fine Tuning VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0116353  Vali Loss: 0.0548578 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9837364  Vali macro F1 0.9779571 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 23 cost time: 6.428998231887817
Fine Tuning VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0116644  Vali Loss: 0.0548056 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9837213  Vali macro F1 0.9774313 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 6.4119603633880615
Fine Tuning VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0109571  Vali Loss: 0.0547285 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9837364  Vali macro F1 0.9779571 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 6.440667390823364
Fine Tuning VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0114563  Vali Loss: 0.0548046 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9837213  Vali macro F1 0.9774313 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 6.447910308837891
Fine Tuning VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0106878  Vali Loss: 0.0546481 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9837364  Vali macro F1 0.9779571 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 6.434472322463989
Fine Tuning VALI: Epoch: 27, Steps: 71 | Train Loss: 0.0114556  Vali Loss: 0.0546764 Vali Accuracy: 0.9841506  Vali weighted F1: 0.9842006  Vali macro F1 0.9779358 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.7831953  Test weighted F1: 0.7873526  Test macro F1 0.7519110 
================ the 8 th CV Experiment ================ 
Leave one Out Experiment : The 9 Part as the test
[-] Target sampling weights:  [0.00014601 0.00017819 0.00109529 0.00133156 0.00049603 0.00062735]
Train data number :  17735
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1971
Test data number :  10867
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.249593257904053
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.0086865  Vali Loss: 0.6585421 Vali Accuracy: 0.7615424  Vali weighted F1: 0.6941927  Vali macro F1 0.4799952 
Validation loss decreased (inf --> 0.658542).  Saving model ...
Epoch: 2 cost time: 6.234098672866821
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.5412640  Vali Loss: 0.4268937 Vali Accuracy: 0.8457636  Vali weighted F1: 0.8164363  Vali macro F1 0.7672890 
new best score!!!!
Validation loss decreased (0.658542 --> 0.426894).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.23044753074646
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.4018710  Vali Loss: 0.3426173 Vali Accuracy: 0.8741755  Vali weighted F1: 0.8600525  Vali macro F1 0.8226050 
new best score!!!!
Validation loss decreased (0.426894 --> 0.342617).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.2359442710876465
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.3124694  Vali Loss: 0.2634694 Vali Accuracy: 0.9107052  Vali weighted F1: 0.9102321  Vali macro F1 0.8885098 
new best score!!!!
Validation loss decreased (0.342617 --> 0.263469).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.245100498199463
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.2342498  Vali Loss: 0.2283328 Vali Accuracy: 0.9223744  Vali weighted F1: 0.9187373  Vali macro F1 0.9016448 
new best score!!!!
Validation loss decreased (0.263469 --> 0.228333).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.271617889404297
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.1934926  Vali Loss: 0.1875019 Vali Accuracy: 0.9436834  Vali weighted F1: 0.9430124  Vali macro F1 0.9274488 
new best score!!!!
Validation loss decreased (0.228333 --> 0.187502).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.2570178508758545
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.1612847  Vali Loss: 0.1768182 Vali Accuracy: 0.9441908  Vali weighted F1: 0.9445350  Vali macro F1 0.9306766 
new best score!!!!
Validation loss decreased (0.187502 --> 0.176818).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.246882915496826
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1438367  Vali Loss: 0.1492504 Vali Accuracy: 0.9568747  Vali weighted F1: 0.9567970  Vali macro F1 0.9411657 
new best score!!!!
Validation loss decreased (0.176818 --> 0.149250).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.253712892532349
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1275496  Vali Loss: 0.2081083 Vali Accuracy: 0.9330289  Vali weighted F1: 0.9316244  Vali macro F1 0.9127717 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 6.2436041831970215
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1302721  Vali Loss: 0.1238139 Vali Accuracy: 0.9599188  Vali weighted F1: 0.9597225  Vali macro F1 0.9458501 
new best score!!!!
Validation loss decreased (0.149250 --> 0.123814).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.24933123588562
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1171632  Vali Loss: 0.1164405 Vali Accuracy: 0.9665145  Vali weighted F1: 0.9665973  Vali macro F1 0.9563589 
new best score!!!!
Validation loss decreased (0.123814 --> 0.116441).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.245570182800293
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0940092  Vali Loss: 0.1191351 Vali Accuracy: 0.9654997  Vali weighted F1: 0.9656225  Vali macro F1 0.9546867 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 6.2502121925354
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0928643  Vali Loss: 0.1080063 Vali Accuracy: 0.9654997  Vali weighted F1: 0.9654215  Vali macro F1 0.9527266 
new best score!!!!
Validation loss decreased (0.116441 --> 0.108006).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.2487874031066895
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0840058  Vali Loss: 0.1043681 Vali Accuracy: 0.9680365  Vali weighted F1: 0.9678879  Vali macro F1 0.9561629 
new best score!!!!
Validation loss decreased (0.108006 --> 0.104368).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.253619194030762
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0724306  Vali Loss: 0.0873075 Vali Accuracy: 0.9720954  Vali weighted F1: 0.9723068  Vali macro F1 0.9608027 
new best score!!!!
Validation loss decreased (0.104368 --> 0.087307).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.2691826820373535
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0678405  Vali Loss: 0.0871741 Vali Accuracy: 0.9720954  Vali weighted F1: 0.9721313  Vali macro F1 0.9640407 
new best score!!!!
Validation loss decreased (0.087307 --> 0.087174).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.248903036117554
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0601456  Vali Loss: 0.0851023 Vali Accuracy: 0.9751395  Vali weighted F1: 0.9753289  Vali macro F1 0.9704427 
new best score!!!!
Validation loss decreased (0.087174 --> 0.085102).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.253873348236084
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0610483  Vali Loss: 0.0762706 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9771165  Vali macro F1 0.9709626 
new best score!!!!
Validation loss decreased (0.085102 --> 0.076271).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.251463890075684
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0561295  Vali Loss: 0.0706850 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9777510  Vali macro F1 0.9714573 
new best score!!!!
Validation loss decreased (0.076271 --> 0.070685).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.256138324737549
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0465891  Vali Loss: 0.0747047 Vali Accuracy: 0.9761542  Vali weighted F1: 0.9761479  Vali macro F1 0.9684573 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.248929738998413
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0439513  Vali Loss: 0.0982752 Vali Accuracy: 0.9685439  Vali weighted F1: 0.9682592  Vali macro F1 0.9590446 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 6.262587308883667
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0433209  Vali Loss: 0.0794602 Vali Accuracy: 0.9751395  Vali weighted F1: 0.9751933  Vali macro F1 0.9678150 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 23 cost time: 6.28478479385376
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0438014  Vali Loss: 0.0771645 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9775978  Vali macro F1 0.9729037 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 24 cost time: 6.266561508178711
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0418905  Vali Loss: 0.0618444 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9801904  Vali macro F1 0.9763709 
new best score!!!!
Validation loss decreased (0.070685 --> 0.061844).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.258337020874023
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0402188  Vali Loss: 0.0688728 Vali Accuracy: 0.9761542  Vali weighted F1: 0.9760432  Vali macro F1 0.9709430 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 6.246990442276001
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0413573  Vali Loss: 0.0640291 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9803669  Vali macro F1 0.9747537 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 6.247379779815674
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0340772  Vali Loss: 0.0642108 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9819194  Vali macro F1 0.9770020 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 28 cost time: 6.254550457000732
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0292285  Vali Loss: 0.0742992 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9783503  Vali macro F1 0.9710265 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 29 cost time: 6.253093481063843
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0288828  Vali Loss: 0.0779908 Vali Accuracy: 0.9756469  Vali weighted F1: 0.9754777  Vali macro F1 0.9691096 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 30 cost time: 6.253826856613159
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0201566  Vali Loss: 0.0598703 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9823209  Vali macro F1 0.9765404 
new best score!!!!
Validation loss decreased (0.061844 --> 0.059870).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.249183654785156
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0147474  Vali Loss: 0.0580632 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832984  Vali macro F1 0.9780993 
new best score!!!!
Validation loss decreased (0.059870 --> 0.058063).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.2440831661224365
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0146771  Vali Loss: 0.0593660 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802483  Vali macro F1 0.9740618 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 6.275460720062256
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0140894  Vali Loss: 0.0591420 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9823031  Vali macro F1 0.9767206 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 6.261437892913818
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0132355  Vali Loss: 0.0577630 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9818561  Vali macro F1 0.9755010 
new best score!!!!
Validation loss decreased (0.058063 --> 0.057763).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 6.251878976821899
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0134559  Vali Loss: 0.0577798 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9828555  Vali macro F1 0.9768468 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 6.258676290512085
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0129893  Vali Loss: 0.0574042 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9833333  Vali macro F1 0.9774655 
new best score!!!!
Validation loss decreased (0.057763 --> 0.057404).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.2507452964782715
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0116806  Vali Loss: 0.0576714 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9833629  Vali macro F1 0.9774267 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 6.255618572235107
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0115499  Vali Loss: 0.0564428 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9833324  Vali macro F1 0.9775098 
new best score!!!!
Validation loss decreased (0.057404 --> 0.056443).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 6.246630907058716
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0115479  Vali Loss: 0.0564222 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9818112  Vali macro F1 0.9757694 
new best score!!!!
Validation loss decreased (0.056443 --> 0.056422).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 6.247705936431885
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0117379  Vali Loss: 0.0594802 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9817421  Vali macro F1 0.9764477 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 6.256466388702393
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0112641  Vali Loss: 0.0573704 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9818173  Vali macro F1 0.9757572 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 6.2709972858428955
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0109410  Vali Loss: 0.0555345 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9828363  Vali macro F1 0.9770810 
new best score!!!!
Validation loss decreased (0.056422 --> 0.055535).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 6.256404399871826
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0110386  Vali Loss: 0.0580775 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9843665  Vali macro F1 0.9794454 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 6.259117126464844
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0101199  Vali Loss: 0.0570697 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9823227  Vali macro F1 0.9765531 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 6.252353191375732
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0098057  Vali Loss: 0.0572705 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832902  Vali macro F1 0.9782631 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 46 cost time: 6.2458014488220215
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0101305  Vali Loss: 0.0555225 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9833203  Vali macro F1 0.9778416 
new best score!!!!
Validation loss decreased (0.055535 --> 0.055522).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 6.245956182479858
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0093543  Vali Loss: 0.0571240 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9823029  Vali macro F1 0.9767876 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 6.249495506286621
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0093859  Vali Loss: 0.0553887 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9838470  Vali macro F1 0.9787019 
new best score!!!!
Validation loss decreased (0.055522 --> 0.055389).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 6.248589992523193
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0090612  Vali Loss: 0.0557215 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9817593  Vali macro F1 0.9767352 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 6.258870840072632
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0093783  Vali Loss: 0.0570096 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9823018  Vali macro F1 0.9767946 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 6.274871587753296
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0081554  Vali Loss: 0.0597689 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832752  Vali macro F1 0.9788708 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 6.263272285461426
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0085155  Vali Loss: 0.0579715 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9818483  Vali macro F1 0.9751258 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 6.278361082077026
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0086298  Vali Loss: 0.0582333 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827889  Vali macro F1 0.9770816 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 54 cost time: 6.251340627670288
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0075041  Vali Loss: 0.0584482 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9812511  Vali macro F1 0.9755170 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 6.248756408691406
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0081716  Vali Loss: 0.0578101 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9822935  Vali macro F1 0.9765360 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 56 cost time: 6.2562010288238525
VALI: Epoch: 56, Steps: 70 | Train Loss: 0.0075098  Vali Loss: 0.0576467 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9812786  Vali macro F1 0.9754937 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 57 cost time: 6.249518156051636
VALI: Epoch: 57, Steps: 70 | Train Loss: 0.0077622  Vali Loss: 0.0583752 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9812781  Vali macro F1 0.9754743 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 58 cost time: 6.255275249481201
VALI: Epoch: 58, Steps: 70 | Train Loss: 0.0072634  Vali Loss: 0.0586220 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9812812  Vali macro F1 0.9754681 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 59 cost time: 6.251516819000244
VALI: Epoch: 59, Steps: 70 | Train Loss: 0.0087717  Vali Loss: 0.0586387 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9812781  Vali macro F1 0.9754743 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 60 cost time: 6.26564359664917
VALI: Epoch: 60, Steps: 70 | Train Loss: 0.0077193  Vali Loss: 0.0585514 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9812781  Vali macro F1 0.9754743 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 61 cost time: 6.260591506958008
VALI: Epoch: 61, Steps: 70 | Train Loss: 0.0075584  Vali Loss: 0.0584832 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9812781  Vali macro F1 0.9754743 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 62 cost time: 6.241948366165161
VALI: Epoch: 62, Steps: 70 | Train Loss: 0.0080281  Vali Loss: 0.0585314 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9807749  Vali macro F1 0.9746520 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 63 cost time: 6.245406627655029
VALI: Epoch: 63, Steps: 70 | Train Loss: 0.0069340  Vali Loss: 0.0585562 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9807749  Vali macro F1 0.9746520 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9365970  Test weighted F1: 0.9369692  Test macro F1 0.8889610 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 240495
pruned model Parameter : 244174
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.282084941864014
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0098630  Vali Loss: 0.0575507 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9843601  Vali macro F1 0.9791307 
Validation loss decreased (inf --> 0.057551).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.261713743209839
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0094755  Vali Loss: 0.0588073 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9822971  Vali macro F1 0.9769029 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.2602763175964355
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0090998  Vali Loss: 0.0590099 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9833181  Vali macro F1 0.9778295 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.256485939025879
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0090235  Vali Loss: 0.0594686 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9838287  Vali macro F1 0.9789258 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.271935701370239
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0092895  Vali Loss: 0.0580964 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9828330  Vali macro F1 0.9761354 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.29688024520874
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0085858  Vali Loss: 0.0603317 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9822322  Vali macro F1 0.9766418 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.28467583656311
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0076979  Vali Loss: 0.0605978 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9838185  Vali macro F1 0.9792223 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.271021604537964
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0114846  Vali Loss: 0.0611712 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9838512  Vali macro F1 0.9773413 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.2634053230285645
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0082150  Vali Loss: 0.0567468 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853717  Vali macro F1 0.9810957 
new best score!!!!
Validation loss decreased (0.057551 --> 0.056747).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 6.263510227203369
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0073664  Vali Loss: 0.0575673 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9833467  Vali macro F1 0.9772420 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 6.261260509490967
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0067068  Vali Loss: 0.0599467 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853235  Vali macro F1 0.9806590 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 6.2616167068481445
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0068826  Vali Loss: 0.0593214 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9812796  Vali macro F1 0.9738465 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 6.267624616622925
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0069837  Vali Loss: 0.0575992 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9848639  Vali macro F1 0.9797301 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 14 cost time: 6.2677061557769775
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0064512  Vali Loss: 0.0598428 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9838278  Vali macro F1 0.9779521 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 15 cost time: 6.277338027954102
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0059833  Vali Loss: 0.0598146 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9833207  Vali macro F1 0.9772109 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.288895606994629
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0058085  Vali Loss: 0.0590076 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9833561  Vali macro F1 0.9775875 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 6.281490087509155
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0056549  Vali Loss: 0.0606976 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9822815  Vali macro F1 0.9760812 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 6.281982660293579
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0059597  Vali Loss: 0.0610691 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9822660  Vali macro F1 0.9764073 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 6.297651529312134
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0057170  Vali Loss: 0.0601380 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9833157  Vali macro F1 0.9777871 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 20 cost time: 6.281796455383301
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0054568  Vali Loss: 0.0601267 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9833304  Vali macro F1 0.9775673 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 6.277674913406372
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0056919  Vali Loss: 0.0602058 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9838347  Vali macro F1 0.9783809 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 6.288127660751343
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0056665  Vali Loss: 0.0603067 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9833207  Vali macro F1 0.9772109 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 6.284798622131348
Fine Tuning VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0058615  Vali Loss: 0.0602454 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9833207  Vali macro F1 0.9772109 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 6.300556421279907
Fine Tuning VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0056389  Vali Loss: 0.0601091 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9838480  Vali macro F1 0.9780615 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9357688  Test weighted F1: 0.9362422  Test macro F1 0.8883398 
================ the 9 th CV Experiment ================ 
Leave one Out Experiment : The 10 Part as the test
[-] Target sampling weights:  [0.00014029 0.00018169 0.00103093 0.00130208 0.00049358 0.00059809]
Train data number :  18068
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2008
Test data number :  9022
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.366853475570679
VALI: Epoch: 1, Steps: 71 | Train Loss: 0.9962232  Vali Loss: 0.6238888 Vali Accuracy: 0.7694223  Vali weighted F1: 0.7168308  Vali macro F1 0.5172296 
Validation loss decreased (inf --> 0.623889).  Saving model ...
Epoch: 2 cost time: 6.372064590454102
VALI: Epoch: 2, Steps: 71 | Train Loss: 0.4987436  Vali Loss: 0.4845716 Vali Accuracy: 0.8356574  Vali weighted F1: 0.8159518  Vali macro F1 0.7656778 
new best score!!!!
Validation loss decreased (0.623889 --> 0.484572).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.365365505218506
VALI: Epoch: 3, Steps: 71 | Train Loss: 0.3349160  Vali Loss: 0.2742903 Vali Accuracy: 0.9028884  Vali weighted F1: 0.8982095  Vali macro F1 0.8662762 
new best score!!!!
Validation loss decreased (0.484572 --> 0.274290).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.358811140060425
VALI: Epoch: 4, Steps: 71 | Train Loss: 0.2314202  Vali Loss: 0.2096814 Vali Accuracy: 0.9252988  Vali weighted F1: 0.9236181  Vali macro F1 0.8970143 
new best score!!!!
Validation loss decreased (0.274290 --> 0.209681).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.370917797088623
VALI: Epoch: 5, Steps: 71 | Train Loss: 0.1863177  Vali Loss: 0.1641659 Vali Accuracy: 0.9447211  Vali weighted F1: 0.9446416  Vali macro F1 0.9265173 
new best score!!!!
Validation loss decreased (0.209681 --> 0.164166).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.366734027862549
VALI: Epoch: 6, Steps: 71 | Train Loss: 0.1648824  Vali Loss: 0.1432487 Vali Accuracy: 0.9551793  Vali weighted F1: 0.9549313  Vali macro F1 0.9411674 
new best score!!!!
Validation loss decreased (0.164166 --> 0.143249).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.38137674331665
VALI: Epoch: 7, Steps: 71 | Train Loss: 0.1376282  Vali Loss: 0.1343301 Vali Accuracy: 0.9621514  Vali weighted F1: 0.9626514  Vali macro F1 0.9539761 
new best score!!!!
Validation loss decreased (0.143249 --> 0.134330).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.385657787322998
VALI: Epoch: 8, Steps: 71 | Train Loss: 0.1158088  Vali Loss: 0.1305438 Vali Accuracy: 0.9606574  Vali weighted F1: 0.9605337  Vali macro F1 0.9427285 
new best score!!!!
Validation loss decreased (0.134330 --> 0.130544).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.408560514450073
VALI: Epoch: 9, Steps: 71 | Train Loss: 0.1129747  Vali Loss: 0.1408848 Vali Accuracy: 0.9616534  Vali weighted F1: 0.9614503  Vali macro F1 0.9516323 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 6.383733510971069
VALI: Epoch: 10, Steps: 71 | Train Loss: 0.1029270  Vali Loss: 0.1115161 Vali Accuracy: 0.9671315  Vali weighted F1: 0.9670226  Vali macro F1 0.9572956 
new best score!!!!
Validation loss decreased (0.130544 --> 0.111516).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.3854405879974365
VALI: Epoch: 11, Steps: 71 | Train Loss: 0.0929950  Vali Loss: 0.1174898 Vali Accuracy: 0.9656375  Vali weighted F1: 0.9652517  Vali macro F1 0.9550430 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 6.386680841445923
VALI: Epoch: 12, Steps: 71 | Train Loss: 0.0841178  Vali Loss: 0.0977592 Vali Accuracy: 0.9656375  Vali weighted F1: 0.9653144  Vali macro F1 0.9557480 
new best score!!!!
Validation loss decreased (0.111516 --> 0.097759).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.377991437911987
VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0746730  Vali Loss: 0.0949916 Vali Accuracy: 0.9746016  Vali weighted F1: 0.9745357  Vali macro F1 0.9664873 
new best score!!!!
Validation loss decreased (0.097759 --> 0.094992).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.377019643783569
VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0745084  Vali Loss: 0.1030972 Vali Accuracy: 0.9686255  Vali weighted F1: 0.9683393  Vali macro F1 0.9574064 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.395984411239624
VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0647408  Vali Loss: 0.0890520 Vali Accuracy: 0.9750996  Vali weighted F1: 0.9750190  Vali macro F1 0.9674450 
new best score!!!!
Validation loss decreased (0.094992 --> 0.089052).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.378010988235474
VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0607007  Vali Loss: 0.0869276 Vali Accuracy: 0.9746016  Vali weighted F1: 0.9745648  Vali macro F1 0.9667556 
new best score!!!!
Validation loss decreased (0.089052 --> 0.086928).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.406987905502319
VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0651929  Vali Loss: 0.0804537 Vali Accuracy: 0.9721116  Vali weighted F1: 0.9720862  Vali macro F1 0.9630742 
new best score!!!!
Validation loss decreased (0.086928 --> 0.080454).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.386565923690796
VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0606165  Vali Loss: 0.0819242 Vali Accuracy: 0.9765936  Vali weighted F1: 0.9766959  Vali macro F1 0.9703914 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.382583856582642
VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0561377  Vali Loss: 0.0771178 Vali Accuracy: 0.9750996  Vali weighted F1: 0.9753304  Vali macro F1 0.9682246 
new best score!!!!
Validation loss decreased (0.080454 --> 0.077118).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.386611223220825
VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0471858  Vali Loss: 0.0717753 Vali Accuracy: 0.9775896  Vali weighted F1: 0.9775727  Vali macro F1 0.9712195 
new best score!!!!
Validation loss decreased (0.077118 --> 0.071775).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.374122142791748
VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0431841  Vali Loss: 0.0638959 Vali Accuracy: 0.9795817  Vali weighted F1: 0.9797089  Vali macro F1 0.9717966 
new best score!!!!
Validation loss decreased (0.071775 --> 0.063896).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.377764463424683
VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0436872  Vali Loss: 0.0803029 Vali Accuracy: 0.9765936  Vali weighted F1: 0.9766315  Vali macro F1 0.9689459 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.3676207065582275
VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0457233  Vali Loss: 0.0834091 Vali Accuracy: 0.9726096  Vali weighted F1: 0.9723105  Vali macro F1 0.9644333 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 6.379583120346069
VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0343550  Vali Loss: 0.0774063 Vali Accuracy: 0.9785857  Vali weighted F1: 0.9785750  Vali macro F1 0.9715738 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 25 cost time: 6.379093885421753
VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0356946  Vali Loss: 0.0826268 Vali Accuracy: 0.9760956  Vali weighted F1: 0.9758835  Vali macro F1 0.9692638 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 26 cost time: 6.3726441860198975
VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0328587  Vali Loss: 0.0627823 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9811865  Vali macro F1 0.9752874 
new best score!!!!
Validation loss decreased (0.063896 --> 0.062782).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.389109134674072
VALI: Epoch: 27, Steps: 71 | Train Loss: 0.0302269  Vali Loss: 0.0686704 Vali Accuracy: 0.9795817  Vali weighted F1: 0.9795416  Vali macro F1 0.9747855 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.391652584075928
VALI: Epoch: 28, Steps: 71 | Train Loss: 0.0339677  Vali Loss: 0.0734986 Vali Accuracy: 0.9775896  Vali weighted F1: 0.9775215  Vali macro F1 0.9703400 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 6.370270252227783
VALI: Epoch: 29, Steps: 71 | Train Loss: 0.0277073  Vali Loss: 0.0647094 Vali Accuracy: 0.9800797  Vali weighted F1: 0.9801530  Vali macro F1 0.9726764 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 6.37619423866272
VALI: Epoch: 30, Steps: 71 | Train Loss: 0.0244710  Vali Loss: 0.0703360 Vali Accuracy: 0.9795817  Vali weighted F1: 0.9795586  Vali macro F1 0.9727481 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 31 cost time: 6.380099534988403
VALI: Epoch: 31, Steps: 71 | Train Loss: 0.0242753  Vali Loss: 0.0668328 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9821734  Vali macro F1 0.9754763 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 32 cost time: 6.383201599121094
VALI: Epoch: 32, Steps: 71 | Train Loss: 0.0153555  Vali Loss: 0.0587746 Vali Accuracy: 0.9845618  Vali weighted F1: 0.9845654  Vali macro F1 0.9796190 
new best score!!!!
Validation loss decreased (0.062782 --> 0.058775).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.384659290313721
VALI: Epoch: 33, Steps: 71 | Train Loss: 0.0130234  Vali Loss: 0.0568489 Vali Accuracy: 0.9850598  Vali weighted F1: 0.9851303  Vali macro F1 0.9799722 
new best score!!!!
Validation loss decreased (0.058775 --> 0.056849).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.367026329040527
VALI: Epoch: 34, Steps: 71 | Train Loss: 0.0120023  Vali Loss: 0.0603334 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9835728  Vali macro F1 0.9783695 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 6.37035346031189
VALI: Epoch: 35, Steps: 71 | Train Loss: 0.0110817  Vali Loss: 0.0599096 Vali Accuracy: 0.9845618  Vali weighted F1: 0.9845767  Vali macro F1 0.9796365 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 6.385892391204834
VALI: Epoch: 36, Steps: 71 | Train Loss: 0.0108623  Vali Loss: 0.0580405 Vali Accuracy: 0.9860558  Vali weighted F1: 0.9860640  Vali macro F1 0.9811528 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 6.393157482147217
VALI: Epoch: 37, Steps: 71 | Train Loss: 0.0106692  Vali Loss: 0.0570414 Vali Accuracy: 0.9860558  Vali weighted F1: 0.9861011  Vali macro F1 0.9808903 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 6.386761903762817
VALI: Epoch: 38, Steps: 71 | Train Loss: 0.0118103  Vali Loss: 0.0600080 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9826003  Vali macro F1 0.9754313 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 39 cost time: 6.390204429626465
VALI: Epoch: 39, Steps: 71 | Train Loss: 0.0106729  Vali Loss: 0.0584335 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9835858  Vali macro F1 0.9766695 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 6.37286376953125
VALI: Epoch: 40, Steps: 71 | Train Loss: 0.0103271  Vali Loss: 0.0580849 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9835858  Vali macro F1 0.9766695 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 6.378138065338135
VALI: Epoch: 41, Steps: 71 | Train Loss: 0.0093379  Vali Loss: 0.0579471 Vali Accuracy: 0.9845618  Vali weighted F1: 0.9845892  Vali macro F1 0.9788264 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 6.376532793045044
VALI: Epoch: 42, Steps: 71 | Train Loss: 0.0091241  Vali Loss: 0.0578321 Vali Accuracy: 0.9840637  Vali weighted F1: 0.9840937  Vali macro F1 0.9780204 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 6.381776332855225
VALI: Epoch: 43, Steps: 71 | Train Loss: 0.0101763  Vali Loss: 0.0575965 Vali Accuracy: 0.9855578  Vali weighted F1: 0.9855814  Vali macro F1 0.9804107 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 44 cost time: 6.382161378860474
VALI: Epoch: 44, Steps: 71 | Train Loss: 0.0105300  Vali Loss: 0.0576412 Vali Accuracy: 0.9855578  Vali weighted F1: 0.9855814  Vali macro F1 0.9804107 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 6.394018888473511
VALI: Epoch: 45, Steps: 71 | Train Loss: 0.0093207  Vali Loss: 0.0576425 Vali Accuracy: 0.9855578  Vali weighted F1: 0.9855814  Vali macro F1 0.9804107 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 6.3809661865234375
VALI: Epoch: 46, Steps: 71 | Train Loss: 0.0102502  Vali Loss: 0.0576724 Vali Accuracy: 0.9850598  Vali weighted F1: 0.9850852  Vali macro F1 0.9796130 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 6.37542724609375
VALI: Epoch: 47, Steps: 71 | Train Loss: 0.0100028  Vali Loss: 0.0577056 Vali Accuracy: 0.9850598  Vali weighted F1: 0.9850852  Vali macro F1 0.9796130 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 6.366809368133545
VALI: Epoch: 48, Steps: 71 | Train Loss: 0.0097872  Vali Loss: 0.0577204 Vali Accuracy: 0.9850598  Vali weighted F1: 0.9850852  Vali macro F1 0.9796130 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9302815  Test weighted F1: 0.9281240  Test macro F1 0.8714938 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 240495
pruned model Parameter : 244174
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.362505912780762
Fine Tuning VALI: Epoch: 1, Steps: 71 | Train Loss: 0.0123826  Vali Loss: 0.0633761 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9815387  Vali macro F1 0.9755488 
Validation loss decreased (inf --> 0.063376).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.358656406402588
Fine Tuning VALI: Epoch: 2, Steps: 71 | Train Loss: 0.0118081  Vali Loss: 0.0648008 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9821020  Vali macro F1 0.9767698 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.3558032512664795
Fine Tuning VALI: Epoch: 3, Steps: 71 | Train Loss: 0.0117125  Vali Loss: 0.0615167 Vali Accuracy: 0.9840637  Vali weighted F1: 0.9840867  Vali macro F1 0.9794170 
new best score!!!!
Validation loss decreased (0.063376 --> 0.061517).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.35847020149231
Fine Tuning VALI: Epoch: 4, Steps: 71 | Train Loss: 0.0105347  Vali Loss: 0.0592287 Vali Accuracy: 0.9845618  Vali weighted F1: 0.9845606  Vali macro F1 0.9797974 
new best score!!!!
Validation loss decreased (0.061517 --> 0.059229).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.374098539352417
Fine Tuning VALI: Epoch: 5, Steps: 71 | Train Loss: 0.0116968  Vali Loss: 0.0578644 Vali Accuracy: 0.9840637  Vali weighted F1: 0.9840862  Vali macro F1 0.9793469 
new best score!!!!
Validation loss decreased (0.059229 --> 0.057864).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.374930143356323
Fine Tuning VALI: Epoch: 6, Steps: 71 | Train Loss: 0.0098504  Vali Loss: 0.0605510 Vali Accuracy: 0.9840637  Vali weighted F1: 0.9840468  Vali macro F1 0.9794084 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.381688356399536
Fine Tuning VALI: Epoch: 7, Steps: 71 | Train Loss: 0.0109503  Vali Loss: 0.0595328 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9835878  Vali macro F1 0.9785793 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.382880449295044
Fine Tuning VALI: Epoch: 8, Steps: 71 | Train Loss: 0.0090755  Vali Loss: 0.0571547 Vali Accuracy: 0.9855578  Vali weighted F1: 0.9855621  Vali macro F1 0.9805428 
new best score!!!!
Validation loss decreased (0.057864 --> 0.057155).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.3792197704315186
Fine Tuning VALI: Epoch: 9, Steps: 71 | Train Loss: 0.0095505  Vali Loss: 0.0619051 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9825591  Vali macro F1 0.9768860 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.3710877895355225
Fine Tuning VALI: Epoch: 10, Steps: 71 | Train Loss: 0.0093696  Vali Loss: 0.0586197 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9835721  Vali macro F1 0.9778174 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 6.383857727050781
Fine Tuning VALI: Epoch: 11, Steps: 71 | Train Loss: 0.0076626  Vali Loss: 0.0573143 Vali Accuracy: 0.9845618  Vali weighted F1: 0.9845803  Vali macro F1 0.9789894 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 6.367998123168945
Fine Tuning VALI: Epoch: 12, Steps: 71 | Train Loss: 0.0080647  Vali Loss: 0.0587875 Vali Accuracy: 0.9845618  Vali weighted F1: 0.9845820  Vali macro F1 0.9790723 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 6.368454933166504
Fine Tuning VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0068551  Vali Loss: 0.0571154 Vali Accuracy: 0.9845618  Vali weighted F1: 0.9845988  Vali macro F1 0.9790992 
new best score!!!!
Validation loss decreased (0.057155 --> 0.057115).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 6.3749284744262695
Fine Tuning VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0091320  Vali Loss: 0.0599312 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9835947  Vali macro F1 0.9783841 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 6.378398418426514
Fine Tuning VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0071737  Vali Loss: 0.0566206 Vali Accuracy: 0.9855578  Vali weighted F1: 0.9855728  Vali macro F1 0.9812642 
new best score!!!!
Validation loss decreased (0.057115 --> 0.056621).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 6.385202884674072
Fine Tuning VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0074052  Vali Loss: 0.0667464 Vali Accuracy: 0.9845618  Vali weighted F1: 0.9845514  Vali macro F1 0.9794810 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 6.370000839233398
Fine Tuning VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0072165  Vali Loss: 0.0565881 Vali Accuracy: 0.9860558  Vali weighted F1: 0.9860882  Vali macro F1 0.9800219 
new best score!!!!
Validation loss decreased (0.056621 --> 0.056588).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 18 cost time: 6.377032041549683
Fine Tuning VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0067975  Vali Loss: 0.0616588 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9830687  Vali macro F1 0.9778608 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 6.3644118309021
Fine Tuning VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0067289  Vali Loss: 0.0583133 Vali Accuracy: 0.9870518  Vali weighted F1: 0.9870779  Vali macro F1 0.9814799 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 6.3684539794921875
Fine Tuning VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0079979  Vali Loss: 0.0605275 Vali Accuracy: 0.9865538  Vali weighted F1: 0.9866082  Vali macro F1 0.9812601 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 6.370348691940308
Fine Tuning VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0064718  Vali Loss: 0.0584924 Vali Accuracy: 0.9875498  Vali weighted F1: 0.9875904  Vali macro F1 0.9826259 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 6.365417003631592
Fine Tuning VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0063212  Vali Loss: 0.0587120 Vali Accuracy: 0.9850598  Vali weighted F1: 0.9850510  Vali macro F1 0.9788556 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 23 cost time: 6.374924898147583
Fine Tuning VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0051788  Vali Loss: 0.0588651 Vali Accuracy: 0.9850598  Vali weighted F1: 0.9850624  Vali macro F1 0.9789604 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 6.389585256576538
Fine Tuning VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0058537  Vali Loss: 0.0577180 Vali Accuracy: 0.9855578  Vali weighted F1: 0.9856066  Vali macro F1 0.9800848 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 6.387712001800537
Fine Tuning VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0071265  Vali Loss: 0.0587538 Vali Accuracy: 0.9840637  Vali weighted F1: 0.9840643  Vali macro F1 0.9781172 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 6.396991729736328
Fine Tuning VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0073920  Vali Loss: 0.0561902 Vali Accuracy: 0.9860558  Vali weighted F1: 0.9860630  Vali macro F1 0.9811598 
new best score!!!!
Validation loss decreased (0.056588 --> 0.056190).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 27 cost time: 6.370492935180664
Fine Tuning VALI: Epoch: 27, Steps: 71 | Train Loss: 0.0057261  Vali Loss: 0.0581506 Vali Accuracy: 0.9850598  Vali weighted F1: 0.9850714  Vali macro F1 0.9807325 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 28 cost time: 6.361373662948608
Fine Tuning VALI: Epoch: 28, Steps: 71 | Train Loss: 0.0055994  Vali Loss: 0.0583243 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9835873  Vali macro F1 0.9780063 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 29 cost time: 6.367832660675049
Fine Tuning VALI: Epoch: 29, Steps: 71 | Train Loss: 0.0055003  Vali Loss: 0.0534288 Vali Accuracy: 0.9885458  Vali weighted F1: 0.9885483  Vali macro F1 0.9841752 
new best score!!!!
Validation loss decreased (0.056190 --> 0.053429).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 30 cost time: 6.370732545852661
Fine Tuning VALI: Epoch: 30, Steps: 71 | Train Loss: 0.0046392  Vali Loss: 0.0571504 Vali Accuracy: 0.9860558  Vali weighted F1: 0.9860405  Vali macro F1 0.9808671 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 31 cost time: 6.37046217918396
Fine Tuning VALI: Epoch: 31, Steps: 71 | Train Loss: 0.0050038  Vali Loss: 0.0591709 Vali Accuracy: 0.9855578  Vali weighted F1: 0.9855407  Vali macro F1 0.9794034 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 32 cost time: 6.37743878364563
Fine Tuning VALI: Epoch: 32, Steps: 71 | Train Loss: 0.0061992  Vali Loss: 0.0532692 Vali Accuracy: 0.9875498  Vali weighted F1: 0.9875678  Vali macro F1 0.9831717 
new best score!!!!
Validation loss decreased (0.053429 --> 0.053269).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 33 cost time: 6.376804351806641
Fine Tuning VALI: Epoch: 33, Steps: 71 | Train Loss: 0.0057518  Vali Loss: 0.0637237 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9830642  Vali macro F1 0.9763945 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 34 cost time: 6.399636745452881
Fine Tuning VALI: Epoch: 34, Steps: 71 | Train Loss: 0.0057303  Vali Loss: 0.0572636 Vali Accuracy: 0.9870518  Vali weighted F1: 0.9870661  Vali macro F1 0.9812034 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 35 cost time: 6.381041765213013
Fine Tuning VALI: Epoch: 35, Steps: 71 | Train Loss: 0.0052341  Vali Loss: 0.0548868 Vali Accuracy: 0.9870518  Vali weighted F1: 0.9870811  Vali macro F1 0.9817982 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 36 cost time: 6.377550363540649
Fine Tuning VALI: Epoch: 36, Steps: 71 | Train Loss: 0.0047552  Vali Loss: 0.0586154 Vali Accuracy: 0.9865538  Vali weighted F1: 0.9865478  Vali macro F1 0.9812970 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 37 cost time: 6.3780763149261475
Fine Tuning VALI: Epoch: 37, Steps: 71 | Train Loss: 0.0045019  Vali Loss: 0.0607089 Vali Accuracy: 0.9840637  Vali weighted F1: 0.9840234  Vali macro F1 0.9787275 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 38 cost time: 6.380625486373901
Fine Tuning VALI: Epoch: 38, Steps: 71 | Train Loss: 0.0036129  Vali Loss: 0.0587985 Vali Accuracy: 0.9850598  Vali weighted F1: 0.9850334  Vali macro F1 0.9800379 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 39 cost time: 6.375110626220703
Fine Tuning VALI: Epoch: 39, Steps: 71 | Train Loss: 0.0038128  Vali Loss: 0.0581862 Vali Accuracy: 0.9850598  Vali weighted F1: 0.9850500  Vali macro F1 0.9800639 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 40 cost time: 6.371669292449951
Fine Tuning VALI: Epoch: 40, Steps: 71 | Train Loss: 0.0037942  Vali Loss: 0.0574825 Vali Accuracy: 0.9860558  Vali weighted F1: 0.9860522  Vali macro F1 0.9814985 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 41 cost time: 6.363840818405151
Fine Tuning VALI: Epoch: 41, Steps: 71 | Train Loss: 0.0040950  Vali Loss: 0.0561074 Vali Accuracy: 0.9860558  Vali weighted F1: 0.9860620  Vali macro F1 0.9811930 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 42 cost time: 6.37055230140686
Fine Tuning VALI: Epoch: 42, Steps: 71 | Train Loss: 0.0033271  Vali Loss: 0.0578246 Vali Accuracy: 0.9850598  Vali weighted F1: 0.9850492  Vali macro F1 0.9801899 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 43 cost time: 6.386579751968384
Fine Tuning VALI: Epoch: 43, Steps: 71 | Train Loss: 0.0034912  Vali Loss: 0.0575631 Vali Accuracy: 0.9850598  Vali weighted F1: 0.9850492  Vali macro F1 0.9801899 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 44 cost time: 6.397639513015747
Fine Tuning VALI: Epoch: 44, Steps: 71 | Train Loss: 0.0035377  Vali Loss: 0.0573181 Vali Accuracy: 0.9855578  Vali weighted F1: 0.9855560  Vali macro F1 0.9806921 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 45 cost time: 6.376797437667847
Fine Tuning VALI: Epoch: 45, Steps: 71 | Train Loss: 0.0039772  Vali Loss: 0.0574225 Vali Accuracy: 0.9855578  Vali weighted F1: 0.9855560  Vali macro F1 0.9806921 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 46 cost time: 6.37389612197876
Fine Tuning VALI: Epoch: 46, Steps: 71 | Train Loss: 0.0034175  Vali Loss: 0.0575003 Vali Accuracy: 0.9855578  Vali weighted F1: 0.9855560  Vali macro F1 0.9806921 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 47 cost time: 6.374229192733765
Fine Tuning VALI: Epoch: 47, Steps: 71 | Train Loss: 0.0037257  Vali Loss: 0.0573666 Vali Accuracy: 0.9855578  Vali weighted F1: 0.9855560  Vali macro F1 0.9806921 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9301707  Test weighted F1: 0.9277586  Test macro F1 0.8686881 
Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 240495
Set the seed as :  3
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
-----------------------Sliding file are generated -----------------------
================ LOCV Mode ====================
================ 10 CV ======================
================ the 0 th CV Experiment ================ 
Leave one Out Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.00014616 0.00018232 0.00096154 0.001221   0.00048263 0.00060864]
Train data number :  17901
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1989
Test data number :  9947
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.345163583755493
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.0263827  Vali Loss: 0.7399973 Vali Accuracy: 0.7043741  Vali weighted F1: 0.6697199  Vali macro F1 0.4503823 
Validation loss decreased (inf --> 0.739997).  Saving model ...
Epoch: 2 cost time: 6.33758020401001
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.4924847  Vali Loss: 0.4149205 Vali Accuracy: 0.8536953  Vali weighted F1: 0.8405090  Vali macro F1 0.7922725 
new best score!!!!
Validation loss decreased (0.739997 --> 0.414921).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.357227802276611
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.3344217  Vali Loss: 0.2529469 Vali Accuracy: 0.9140271  Vali weighted F1: 0.9116706  Vali macro F1 0.8845033 
new best score!!!!
Validation loss decreased (0.414921 --> 0.252947).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.367279291152954
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.2524351  Vali Loss: 0.1953030 Vali Accuracy: 0.9351433  Vali weighted F1: 0.9342138  Vali macro F1 0.9134309 
new best score!!!!
Validation loss decreased (0.252947 --> 0.195303).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.3623433113098145
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.2151183  Vali Loss: 0.1875772 Vali Accuracy: 0.9321267  Vali weighted F1: 0.9309856  Vali macro F1 0.9032355 
new best score!!!!
Validation loss decreased (0.195303 --> 0.187577).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.346065998077393
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.1670777  Vali Loss: 0.1407422 Vali Accuracy: 0.9492207  Vali weighted F1: 0.9492483  Vali macro F1 0.9301190 
new best score!!!!
Validation loss decreased (0.187577 --> 0.140742).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.347597599029541
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.1515078  Vali Loss: 0.1241017 Vali Accuracy: 0.9512318  Vali weighted F1: 0.9511774  Vali macro F1 0.9276526 
new best score!!!!
Validation loss decreased (0.140742 --> 0.124102).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.338431358337402
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1343910  Vali Loss: 0.1052190 Vali Accuracy: 0.9557567  Vali weighted F1: 0.9552727  Vali macro F1 0.9321309 
new best score!!!!
Validation loss decreased (0.124102 --> 0.105219).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.350573539733887
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1262077  Vali Loss: 0.0938416 Vali Accuracy: 0.9683258  Vali weighted F1: 0.9682753  Vali macro F1 0.9591346 
new best score!!!!
Validation loss decreased (0.105219 --> 0.093842).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.350765943527222
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1126609  Vali Loss: 0.1131468 Vali Accuracy: 0.9643037  Vali weighted F1: 0.9634360  Vali macro F1 0.9567482 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.348826885223389
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1101273  Vali Loss: 0.0822841 Vali Accuracy: 0.9723479  Vali weighted F1: 0.9723770  Vali macro F1 0.9655177 
new best score!!!!
Validation loss decreased (0.093842 --> 0.082284).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.367272615432739
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0980272  Vali Loss: 0.0693406 Vali Accuracy: 0.9753645  Vali weighted F1: 0.9756282  Vali macro F1 0.9672144 
new best score!!!!
Validation loss decreased (0.082284 --> 0.069341).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.375297784805298
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0926257  Vali Loss: 0.0617201 Vali Accuracy: 0.9808949  Vali weighted F1: 0.9809780  Vali macro F1 0.9751273 
new best score!!!!
Validation loss decreased (0.069341 --> 0.061720).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.356422662734985
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0811101  Vali Loss: 0.0595124 Vali Accuracy: 0.9824032  Vali weighted F1: 0.9823665  Vali macro F1 0.9755309 
new best score!!!!
Validation loss decreased (0.061720 --> 0.059512).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.360723495483398
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0842251  Vali Loss: 0.0810033 Vali Accuracy: 0.9713424  Vali weighted F1: 0.9710301  Vali macro F1 0.9620905 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.350924730300903
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0678133  Vali Loss: 0.0529319 Vali Accuracy: 0.9813977  Vali weighted F1: 0.9814558  Vali macro F1 0.9738032 
new best score!!!!
Validation loss decreased (0.059512 --> 0.052932).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.357179164886475
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0603430  Vali Loss: 0.0541983 Vali Accuracy: 0.9803922  Vali weighted F1: 0.9803589  Vali macro F1 0.9724312 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 6.35544490814209
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0612846  Vali Loss: 0.0666147 Vali Accuracy: 0.9723479  Vali weighted F1: 0.9723947  Vali macro F1 0.9576193 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 6.359150409698486
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0563984  Vali Loss: 0.0616127 Vali Accuracy: 0.9783811  Vali weighted F1: 0.9783252  Vali macro F1 0.9704615 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 20 cost time: 6.3549439907073975
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0583541  Vali Loss: 0.0506538 Vali Accuracy: 0.9813977  Vali weighted F1: 0.9815505  Vali macro F1 0.9739138 
new best score!!!!
Validation loss decreased (0.052932 --> 0.050654).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.361029386520386
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0517603  Vali Loss: 0.0443213 Vali Accuracy: 0.9834087  Vali weighted F1: 0.9835080  Vali macro F1 0.9763146 
new best score!!!!
Validation loss decreased (0.050654 --> 0.044321).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.358759164810181
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0459835  Vali Loss: 0.0496049 Vali Accuracy: 0.9808949  Vali weighted F1: 0.9810957  Vali macro F1 0.9740122 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.376356840133667
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0530402  Vali Loss: 0.0805929 Vali Accuracy: 0.9723479  Vali weighted F1: 0.9729987  Vali macro F1 0.9666799 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 6.375551700592041
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0419428  Vali Loss: 0.0412157 Vali Accuracy: 0.9824032  Vali weighted F1: 0.9824378  Vali macro F1 0.9755962 
new best score!!!!
Validation loss decreased (0.044321 --> 0.041216).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.371335744857788
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0372223  Vali Loss: 0.0672304 Vali Accuracy: 0.9728507  Vali weighted F1: 0.9729444  Vali macro F1 0.9543192 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 6.364264965057373
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0388174  Vali Loss: 0.0379433 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9870161  Vali macro F1 0.9802692 
new best score!!!!
Validation loss decreased (0.041216 --> 0.037943).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.362048387527466
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0287652  Vali Loss: 0.0421756 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9858675  Vali macro F1 0.9813819 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.3641064167022705
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0321046  Vali Loss: 0.0388020 Vali Accuracy: 0.9834087  Vali weighted F1: 0.9834829  Vali macro F1 0.9766186 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 6.366219997406006
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0347929  Vali Loss: 0.0541850 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9818400  Vali macro F1 0.9754912 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 6.3799238204956055
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0355406  Vali Loss: 0.0592938 Vali Accuracy: 0.9798894  Vali weighted F1: 0.9797422  Vali macro F1 0.9730628 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 31 cost time: 6.3696043491363525
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0297661  Vali Loss: 0.0393745 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9849334  Vali macro F1 0.9789705 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 32 cost time: 6.356725215911865
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0203161  Vali Loss: 0.0352964 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869793  Vali macro F1 0.9811774 
new best score!!!!
Validation loss decreased (0.037943 --> 0.035296).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.359737157821655
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0149255  Vali Loss: 0.0340370 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874200  Vali macro F1 0.9816437 
new best score!!!!
Validation loss decreased (0.035296 --> 0.034037).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.3522021770477295
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0147704  Vali Loss: 0.0343204 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874643  Vali macro F1 0.9817873 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 6.35110068321228
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0142506  Vali Loss: 0.0337709 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869166  Vali macro F1 0.9808281 
new best score!!!!
Validation loss decreased (0.034037 --> 0.033771).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.352842569351196
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0132096  Vali Loss: 0.0332762 Vali Accuracy: 0.9884364  Vali weighted F1: 0.9884480  Vali macro F1 0.9827198 
new best score!!!!
Validation loss decreased (0.033771 --> 0.033276).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.358673095703125
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0136238  Vali Loss: 0.0339131 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869506  Vali macro F1 0.9812196 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 6.39008641242981
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0125403  Vali Loss: 0.0338855 Vali Accuracy: 0.9884364  Vali weighted F1: 0.9884557  Vali macro F1 0.9830625 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 6.388824462890625
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0121406  Vali Loss: 0.0331699 Vali Accuracy: 0.9879336  Vali weighted F1: 0.9879319  Vali macro F1 0.9828033 
new best score!!!!
Validation loss decreased (0.033276 --> 0.033170).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 6.354344367980957
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0125108  Vali Loss: 0.0327003 Vali Accuracy: 0.9879336  Vali weighted F1: 0.9879538  Vali macro F1 0.9828299 
new best score!!!!
Validation loss decreased (0.033170 --> 0.032700).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 6.345840215682983
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0126533  Vali Loss: 0.0318155 Vali Accuracy: 0.9879336  Vali weighted F1: 0.9879327  Vali macro F1 0.9833728 
new best score!!!!
Validation loss decreased (0.032700 --> 0.031816).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 6.349475383758545
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0111310  Vali Loss: 0.0333474 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869164  Vali macro F1 0.9820658 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 6.3532397747039795
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0115116  Vali Loss: 0.0320841 Vali Accuracy: 0.9889392  Vali weighted F1: 0.9889578  Vali macro F1 0.9843730 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 6.356999397277832
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0106866  Vali Loss: 0.0330574 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9859085  Vali macro F1 0.9804485 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 6.3513712882995605
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0113238  Vali Loss: 0.0326222 Vali Accuracy: 0.9884364  Vali weighted F1: 0.9884650  Vali macro F1 0.9839712 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 46 cost time: 6.368177175521851
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0109415  Vali Loss: 0.0332049 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874205  Vali macro F1 0.9828753 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 47 cost time: 6.379065275192261
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0110262  Vali Loss: 0.0332085 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874186  Vali macro F1 0.9828792 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 6.353774547576904
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0101110  Vali Loss: 0.0328432 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874277  Vali macro F1 0.9826386 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 6.358801603317261
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0106134  Vali Loss: 0.0328165 Vali Accuracy: 0.9879336  Vali weighted F1: 0.9879285  Vali macro F1 0.9834496 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 50 cost time: 6.355820894241333
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0110163  Vali Loss: 0.0328983 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874205  Vali macro F1 0.9828753 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 51 cost time: 6.37710428237915
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0091390  Vali Loss: 0.0331303 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874277  Vali macro F1 0.9826386 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 52 cost time: 8.125632762908936
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0098040  Vali Loss: 0.0330957 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874277  Vali macro F1 0.9826386 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 6.346307039260864
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0097544  Vali Loss: 0.0330958 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874277  Vali macro F1 0.9826386 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 6.342717170715332
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0097308  Vali Loss: 0.0330261 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869164  Vali macro F1 0.9820658 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 55 cost time: 6.3542397022247314
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0103568  Vali Loss: 0.0330068 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869164  Vali macro F1 0.9820658 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 56 cost time: 6.351741552352905
VALI: Epoch: 56, Steps: 70 | Train Loss: 0.0098037  Vali Loss: 0.0329862 Vali Accuracy: 0.9864253  Vali weighted F1: 0.9864124  Vali macro F1 0.9812569 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8787574  Test weighted F1: 0.8790136  Test macro F1 0.8320121 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 240495
pruned model Parameter : 244174
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.356877326965332
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0117221  Vali Loss: 0.0332483 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9859462  Vali macro F1 0.9801668 
Validation loss decreased (inf --> 0.033248).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.330138683319092
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0113331  Vali Loss: 0.0358700 Vali Accuracy: 0.9884364  Vali weighted F1: 0.9883736  Vali macro F1 0.9838679 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.329211473464966
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0116162  Vali Loss: 0.0362283 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874204  Vali macro F1 0.9826415 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.444815397262573
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0104825  Vali Loss: 0.0358791 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9848838  Vali macro F1 0.9794756 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.393329381942749
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0108918  Vali Loss: 0.0337947 Vali Accuracy: 0.9879336  Vali weighted F1: 0.9879531  Vali macro F1 0.9828423 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.4239890575408936
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0092599  Vali Loss: 0.0332069 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869381  Vali macro F1 0.9815131 
new best score!!!!
Validation loss decreased (0.033248 --> 0.033207).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.355266571044922
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0099502  Vali Loss: 0.0351024 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869389  Vali macro F1 0.9813636 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 6.346370458602905
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0096972  Vali Loss: 0.0336984 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874667  Vali macro F1 0.9817225 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 6.33057713508606
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0096377  Vali Loss: 0.0340973 Vali Accuracy: 0.9889392  Vali weighted F1: 0.9889541  Vali macro F1 0.9843539 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 6.329968214035034
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0095267  Vali Loss: 0.0371267 Vali Accuracy: 0.9864253  Vali weighted F1: 0.9864394  Vali macro F1 0.9806274 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 11 cost time: 6.331859827041626
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0085913  Vali Loss: 0.0364008 Vali Accuracy: 0.9874309  Vali weighted F1: 0.9874684  Vali macro F1 0.9822184 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 12 cost time: 6.321415662765503
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0085536  Vali Loss: 0.0357540 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869538  Vali macro F1 0.9817067 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 6.3345301151275635
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0083310  Vali Loss: 0.0352496 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9869538  Vali macro F1 0.9817067 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 6.343692779541016
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0082801  Vali Loss: 0.0349637 Vali Accuracy: 0.9879336  Vali weighted F1: 0.9879572  Vali macro F1 0.9827478 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 6.349029541015625
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0068831  Vali Loss: 0.0344280 Vali Accuracy: 0.9879336  Vali weighted F1: 0.9879572  Vali macro F1 0.9827478 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 6.359297275543213
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0081149  Vali Loss: 0.0339062 Vali Accuracy: 0.9879336  Vali weighted F1: 0.9879572  Vali macro F1 0.9827478 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 17 cost time: 6.356281995773315
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0074659  Vali Loss: 0.0339042 Vali Accuracy: 0.9879336  Vali weighted F1: 0.9879572  Vali macro F1 0.9827478 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 6.345165967941284
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0076811  Vali Loss: 0.0339053 Vali Accuracy: 0.9879336  Vali weighted F1: 0.9879572  Vali macro F1 0.9827478 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 6.34792685508728
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0079923  Vali Loss: 0.0338786 Vali Accuracy: 0.9879336  Vali weighted F1: 0.9879572  Vali macro F1 0.9827478 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 6.368440628051758
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0073659  Vali Loss: 0.0338412 Vali Accuracy: 0.9879336  Vali weighted F1: 0.9879572  Vali macro F1 0.9827478 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 6.339827060699463
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0081842  Vali Loss: 0.0337560 Vali Accuracy: 0.9879336  Vali weighted F1: 0.9879572  Vali macro F1 0.9827478 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8757414  Test weighted F1: 0.8762228  Test macro F1 0.8264202 
================ the 1 th CV Experiment ================ 
Leave one Out Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00014914 0.00018315 0.00110742 0.00140252 0.00050633 0.00062617]
Train data number :  17353
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1929
Test data number :  12988
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.130098581314087
VALI: Epoch: 1, Steps: 68 | Train Loss: 1.0458200  Vali Loss: 0.6827761 Vali Accuracy: 0.7573872  Vali weighted F1: 0.7087489  Vali macro F1 0.5090179 
Validation loss decreased (inf --> 0.682776).  Saving model ...
Epoch: 2 cost time: 6.151165008544922
VALI: Epoch: 2, Steps: 68 | Train Loss: 0.5453993  Vali Loss: 0.4368256 Vali Accuracy: 0.8506998  Vali weighted F1: 0.8379368  Vali macro F1 0.7939348 
new best score!!!!
Validation loss decreased (0.682776 --> 0.436826).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.141613721847534
VALI: Epoch: 3, Steps: 68 | Train Loss: 0.3570132  Vali Loss: 0.2521221 Vali Accuracy: 0.9180923  Vali weighted F1: 0.9178069  Vali macro F1 0.8930095 
new best score!!!!
Validation loss decreased (0.436826 --> 0.252122).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.133190155029297
VALI: Epoch: 4, Steps: 68 | Train Loss: 0.2519210  Vali Loss: 0.2114632 Vali Accuracy: 0.9201659  Vali weighted F1: 0.9162169  Vali macro F1 0.8848536 
new best score!!!!
Validation loss decreased (0.252122 --> 0.211463).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.139938116073608
VALI: Epoch: 5, Steps: 68 | Train Loss: 0.2080427  Vali Loss: 0.2269803 Vali Accuracy: 0.9263867  Vali weighted F1: 0.9226479  Vali macro F1 0.9007573 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 6 cost time: 6.1313416957855225
VALI: Epoch: 6, Steps: 68 | Train Loss: 0.1779208  Vali Loss: 0.1492203 Vali Accuracy: 0.9440124  Vali weighted F1: 0.9438426  Vali macro F1 0.9201700 
new best score!!!!
Validation loss decreased (0.211463 --> 0.149220).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.133034706115723
VALI: Epoch: 7, Steps: 68 | Train Loss: 0.1509999  Vali Loss: 0.1380701 Vali Accuracy: 0.9450492  Vali weighted F1: 0.9443380  Vali macro F1 0.9224605 
new best score!!!!
Validation loss decreased (0.149220 --> 0.138070).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.148380756378174
VALI: Epoch: 8, Steps: 68 | Train Loss: 0.1459930  Vali Loss: 0.1340225 Vali Accuracy: 0.9497149  Vali weighted F1: 0.9495426  Vali macro F1 0.9312966 
new best score!!!!
Validation loss decreased (0.138070 --> 0.134023).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.136011600494385
VALI: Epoch: 9, Steps: 68 | Train Loss: 0.1235890  Vali Loss: 0.1109097 Vali Accuracy: 0.9564541  Vali weighted F1: 0.9564130  Vali macro F1 0.9413769 
new best score!!!!
Validation loss decreased (0.134023 --> 0.110910).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.14249849319458
VALI: Epoch: 10, Steps: 68 | Train Loss: 0.1076224  Vali Loss: 0.1046467 Vali Accuracy: 0.9606013  Vali weighted F1: 0.9603719  Vali macro F1 0.9477240 
new best score!!!!
Validation loss decreased (0.110910 --> 0.104647).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.145676851272583
VALI: Epoch: 11, Steps: 68 | Train Loss: 0.1063612  Vali Loss: 0.0999393 Vali Accuracy: 0.9637118  Vali weighted F1: 0.9639928  Vali macro F1 0.9508840 
new best score!!!!
Validation loss decreased (0.104647 --> 0.099939).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.142073154449463
VALI: Epoch: 12, Steps: 68 | Train Loss: 0.0998849  Vali Loss: 0.1170663 Vali Accuracy: 0.9595645  Vali weighted F1: 0.9588908  Vali macro F1 0.9466734 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 6.13151216506958
VALI: Epoch: 13, Steps: 68 | Train Loss: 0.0881427  Vali Loss: 0.0812245 Vali Accuracy: 0.9735614  Vali weighted F1: 0.9733755  Vali macro F1 0.9659612 
new best score!!!!
Validation loss decreased (0.099939 --> 0.081225).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.162444114685059
VALI: Epoch: 14, Steps: 68 | Train Loss: 0.0784192  Vali Loss: 0.0909874 Vali Accuracy: 0.9663038  Vali weighted F1: 0.9662945  Vali macro F1 0.9548450 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.137969970703125
VALI: Epoch: 15, Steps: 68 | Train Loss: 0.0818595  Vali Loss: 0.0812046 Vali Accuracy: 0.9751166  Vali weighted F1: 0.9748326  Vali macro F1 0.9670612 
new best score!!!!
Validation loss decreased (0.081225 --> 0.081205).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.1435465812683105
VALI: Epoch: 16, Steps: 68 | Train Loss: 0.0676825  Vali Loss: 0.0769215 Vali Accuracy: 0.9740798  Vali weighted F1: 0.9738946  Vali macro F1 0.9657571 
new best score!!!!
Validation loss decreased (0.081205 --> 0.076922).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.147584676742554
VALI: Epoch: 17, Steps: 68 | Train Loss: 0.0652154  Vali Loss: 0.0890493 Vali Accuracy: 0.9704510  Vali weighted F1: 0.9699488  Vali macro F1 0.9596402 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 6.136576890945435
VALI: Epoch: 18, Steps: 68 | Train Loss: 0.0552822  Vali Loss: 0.0630311 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9812353  Vali macro F1 0.9742881 
new best score!!!!
Validation loss decreased (0.076922 --> 0.063031).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.152195930480957
VALI: Epoch: 19, Steps: 68 | Train Loss: 0.0565559  Vali Loss: 0.0652045 Vali Accuracy: 0.9777087  Vali weighted F1: 0.9774381  Vali macro F1 0.9698838 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 6.137486219406128
VALI: Epoch: 20, Steps: 68 | Train Loss: 0.0477628  Vali Loss: 0.0520627 Vali Accuracy: 0.9823743  Vali weighted F1: 0.9823531  Vali macro F1 0.9769339 
new best score!!!!
Validation loss decreased (0.063031 --> 0.052063).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.148272275924683
VALI: Epoch: 21, Steps: 68 | Train Loss: 0.0436428  Vali Loss: 0.0621540 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9817001  Vali macro F1 0.9753566 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 6.150922060012817
VALI: Epoch: 22, Steps: 68 | Train Loss: 0.0499756  Vali Loss: 0.0569099 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9813141  Vali macro F1 0.9744460 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 6.158809185028076
VALI: Epoch: 23, Steps: 68 | Train Loss: 0.0473576  Vali Loss: 0.0589005 Vali Accuracy: 0.9792639  Vali weighted F1: 0.9793141  Vali macro F1 0.9709352 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 24 cost time: 6.137349843978882
VALI: Epoch: 24, Steps: 68 | Train Loss: 0.0394062  Vali Loss: 0.0618559 Vali Accuracy: 0.9797823  Vali weighted F1: 0.9795254  Vali macro F1 0.9739744 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 25 cost time: 6.1460325717926025
VALI: Epoch: 25, Steps: 68 | Train Loss: 0.0361253  Vali Loss: 0.0621457 Vali Accuracy: 0.9797823  Vali weighted F1: 0.9794904  Vali macro F1 0.9733826 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 26 cost time: 6.145428657531738
VALI: Epoch: 26, Steps: 68 | Train Loss: 0.0229400  Vali Loss: 0.0441399 Vali Accuracy: 0.9860031  Vali weighted F1: 0.9859516  Vali macro F1 0.9807830 
new best score!!!!
Validation loss decreased (0.052063 --> 0.044140).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.137674808502197
VALI: Epoch: 27, Steps: 68 | Train Loss: 0.0210504  Vali Loss: 0.0453176 Vali Accuracy: 0.9854847  Vali weighted F1: 0.9854182  Vali macro F1 0.9801976 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.137848138809204
VALI: Epoch: 28, Steps: 68 | Train Loss: 0.0209473  Vali Loss: 0.0448205 Vali Accuracy: 0.9854847  Vali weighted F1: 0.9854227  Vali macro F1 0.9805382 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 6.138650417327881
VALI: Epoch: 29, Steps: 68 | Train Loss: 0.0193109  Vali Loss: 0.0417626 Vali Accuracy: 0.9854847  Vali weighted F1: 0.9854328  Vali macro F1 0.9805481 
new best score!!!!
Validation loss decreased (0.044140 --> 0.041763).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.155590057373047
VALI: Epoch: 30, Steps: 68 | Train Loss: 0.0183648  Vali Loss: 0.0429843 Vali Accuracy: 0.9865215  Vali weighted F1: 0.9864635  Vali macro F1 0.9821892 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 6.173360586166382
VALI: Epoch: 31, Steps: 68 | Train Loss: 0.0175492  Vali Loss: 0.0437602 Vali Accuracy: 0.9870399  Vali weighted F1: 0.9869822  Vali macro F1 0.9812941 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 6.163788080215454
VALI: Epoch: 32, Steps: 68 | Train Loss: 0.0175639  Vali Loss: 0.0454164 Vali Accuracy: 0.9844479  Vali weighted F1: 0.9843844  Vali macro F1 0.9791916 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 6.1532487869262695
VALI: Epoch: 33, Steps: 68 | Train Loss: 0.0169706  Vali Loss: 0.0448180 Vali Accuracy: 0.9860031  Vali weighted F1: 0.9859523  Vali macro F1 0.9810362 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 34 cost time: 6.152390956878662
VALI: Epoch: 34, Steps: 68 | Train Loss: 0.0167394  Vali Loss: 0.0475636 Vali Accuracy: 0.9849663  Vali weighted F1: 0.9848942  Vali macro F1 0.9796702 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 35 cost time: 6.144098520278931
VALI: Epoch: 35, Steps: 68 | Train Loss: 0.0157628  Vali Loss: 0.0458199 Vali Accuracy: 0.9849663  Vali weighted F1: 0.9849014  Vali macro F1 0.9793744 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 6.145946741104126
VALI: Epoch: 36, Steps: 68 | Train Loss: 0.0170367  Vali Loss: 0.0453512 Vali Accuracy: 0.9844479  Vali weighted F1: 0.9843761  Vali macro F1 0.9785442 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 6.152766942977905
VALI: Epoch: 37, Steps: 68 | Train Loss: 0.0158549  Vali Loss: 0.0451043 Vali Accuracy: 0.9860031  Vali weighted F1: 0.9859523  Vali macro F1 0.9810362 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 6.1438891887664795
VALI: Epoch: 38, Steps: 68 | Train Loss: 0.0155742  Vali Loss: 0.0451980 Vali Accuracy: 0.9849663  Vali weighted F1: 0.9849014  Vali macro F1 0.9793744 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 6.145174741744995
VALI: Epoch: 39, Steps: 68 | Train Loss: 0.0168023  Vali Loss: 0.0452814 Vali Accuracy: 0.9854847  Vali weighted F1: 0.9854268  Vali macro F1 0.9802051 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 40 cost time: 6.141593933105469
VALI: Epoch: 40, Steps: 68 | Train Loss: 0.0155015  Vali Loss: 0.0453197 Vali Accuracy: 0.9844479  Vali weighted F1: 0.9843761  Vali macro F1 0.9785442 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 6.152045726776123
VALI: Epoch: 41, Steps: 68 | Train Loss: 0.0160725  Vali Loss: 0.0451334 Vali Accuracy: 0.9854847  Vali weighted F1: 0.9854268  Vali macro F1 0.9802051 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 6.12952184677124
VALI: Epoch: 42, Steps: 68 | Train Loss: 0.0163522  Vali Loss: 0.0451382 Vali Accuracy: 0.9854847  Vali weighted F1: 0.9854268  Vali macro F1 0.9802051 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 6.126883506774902
VALI: Epoch: 43, Steps: 68 | Train Loss: 0.0161755  Vali Loss: 0.0450072 Vali Accuracy: 0.9854847  Vali weighted F1: 0.9854268  Vali macro F1 0.9802051 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 44 cost time: 6.133554697036743
VALI: Epoch: 44, Steps: 68 | Train Loss: 0.0162576  Vali Loss: 0.0448084 Vali Accuracy: 0.9854847  Vali weighted F1: 0.9854268  Vali macro F1 0.9802051 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9514167  Test weighted F1: 0.9519501  Test macro F1 0.9274513 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 240495
pruned model Parameter : 244174
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.146204710006714
Fine Tuning VALI: Epoch: 1, Steps: 68 | Train Loss: 0.0200326  Vali Loss: 0.0436829 Vali Accuracy: 0.9844479  Vali weighted F1: 0.9844191  Vali macro F1 0.9790086 
Validation loss decreased (inf --> 0.043683).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.141308784484863
Fine Tuning VALI: Epoch: 2, Steps: 68 | Train Loss: 0.0182072  Vali Loss: 0.0465339 Vali Accuracy: 0.9849663  Vali weighted F1: 0.9849170  Vali macro F1 0.9797264 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.109870910644531
Fine Tuning VALI: Epoch: 3, Steps: 68 | Train Loss: 0.0191793  Vali Loss: 0.0448110 Vali Accuracy: 0.9854847  Vali weighted F1: 0.9854358  Vali macro F1 0.9799613 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.1209516525268555
Fine Tuning VALI: Epoch: 4, Steps: 68 | Train Loss: 0.0172950  Vali Loss: 0.0434738 Vali Accuracy: 0.9854847  Vali weighted F1: 0.9854677  Vali macro F1 0.9804352 
new best score!!!!
Validation loss decreased (0.043683 --> 0.043474).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.141367673873901
Fine Tuning VALI: Epoch: 5, Steps: 68 | Train Loss: 0.0159996  Vali Loss: 0.0411178 Vali Accuracy: 0.9860031  Vali weighted F1: 0.9860128  Vali macro F1 0.9794888 
new best score!!!!
Validation loss decreased (0.043474 --> 0.041118).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.140662431716919
Fine Tuning VALI: Epoch: 6, Steps: 68 | Train Loss: 0.0178618  Vali Loss: 0.0481675 Vali Accuracy: 0.9854847  Vali weighted F1: 0.9853977  Vali macro F1 0.9810567 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.12288236618042
Fine Tuning VALI: Epoch: 7, Steps: 68 | Train Loss: 0.0155143  Vali Loss: 0.0408397 Vali Accuracy: 0.9844479  Vali weighted F1: 0.9844097  Vali macro F1 0.9789110 
new best score!!!!
Validation loss decreased (0.041118 --> 0.040840).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 6.120882034301758
Fine Tuning VALI: Epoch: 8, Steps: 68 | Train Loss: 0.0148778  Vali Loss: 0.0447145 Vali Accuracy: 0.9860031  Vali weighted F1: 0.9859605  Vali macro F1 0.9810433 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.117638826370239
Fine Tuning VALI: Epoch: 9, Steps: 68 | Train Loss: 0.0144539  Vali Loss: 0.0401051 Vali Accuracy: 0.9875583  Vali weighted F1: 0.9875240  Vali macro F1 0.9818364 
new best score!!!!
Validation loss decreased (0.040840 --> 0.040105).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 6.122564077377319
Fine Tuning VALI: Epoch: 10, Steps: 68 | Train Loss: 0.0148843  Vali Loss: 0.0436130 Vali Accuracy: 0.9860031  Vali weighted F1: 0.9859370  Vali macro F1 0.9806771 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 6.119528532028198
Fine Tuning VALI: Epoch: 11, Steps: 68 | Train Loss: 0.0151347  Vali Loss: 0.0442621 Vali Accuracy: 0.9854847  Vali weighted F1: 0.9854280  Vali macro F1 0.9804382 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 6.132192850112915
Fine Tuning VALI: Epoch: 12, Steps: 68 | Train Loss: 0.0140766  Vali Loss: 0.0446880 Vali Accuracy: 0.9854847  Vali weighted F1: 0.9854280  Vali macro F1 0.9804382 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 6.142406940460205
Fine Tuning VALI: Epoch: 13, Steps: 68 | Train Loss: 0.0137796  Vali Loss: 0.0458844 Vali Accuracy: 0.9844479  Vali weighted F1: 0.9844077  Vali macro F1 0.9791391 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 14 cost time: 6.122000217437744
Fine Tuning VALI: Epoch: 14, Steps: 68 | Train Loss: 0.0131813  Vali Loss: 0.0478909 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9838201  Vali macro F1 0.9793835 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 15 cost time: 6.122161865234375
Fine Tuning VALI: Epoch: 15, Steps: 68 | Train Loss: 0.0136270  Vali Loss: 0.0422747 Vali Accuracy: 0.9865215  Vali weighted F1: 0.9864867  Vali macro F1 0.9816239 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.119928598403931
Fine Tuning VALI: Epoch: 16, Steps: 68 | Train Loss: 0.0122843  Vali Loss: 0.0417677 Vali Accuracy: 0.9860031  Vali weighted F1: 0.9859658  Vali macro F1 0.9811532 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 6.114990711212158
Fine Tuning VALI: Epoch: 17, Steps: 68 | Train Loss: 0.0130810  Vali Loss: 0.0409200 Vali Accuracy: 0.9849663  Vali weighted F1: 0.9849455  Vali macro F1 0.9791787 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 6.1221959590911865
Fine Tuning VALI: Epoch: 18, Steps: 68 | Train Loss: 0.0119495  Vali Loss: 0.0406865 Vali Accuracy: 0.9865215  Vali weighted F1: 0.9864633  Vali macro F1 0.9812516 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 6.120253324508667
Fine Tuning VALI: Epoch: 19, Steps: 68 | Train Loss: 0.0122578  Vali Loss: 0.0414561 Vali Accuracy: 0.9860031  Vali weighted F1: 0.9859779  Vali macro F1 0.9811467 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 20 cost time: 6.109418630599976
Fine Tuning VALI: Epoch: 20, Steps: 68 | Train Loss: 0.0117404  Vali Loss: 0.0417839 Vali Accuracy: 0.9860031  Vali weighted F1: 0.9859680  Vali macro F1 0.9813890 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 6.120598316192627
Fine Tuning VALI: Epoch: 21, Steps: 68 | Train Loss: 0.0108436  Vali Loss: 0.0409407 Vali Accuracy: 0.9865215  Vali weighted F1: 0.9864913  Vali macro F1 0.9819848 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 6.131810903549194
Fine Tuning VALI: Epoch: 22, Steps: 68 | Train Loss: 0.0104028  Vali Loss: 0.0417779 Vali Accuracy: 0.9860031  Vali weighted F1: 0.9859680  Vali macro F1 0.9813890 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 6.140199184417725
Fine Tuning VALI: Epoch: 23, Steps: 68 | Train Loss: 0.0104194  Vali Loss: 0.0415523 Vali Accuracy: 0.9860031  Vali weighted F1: 0.9859680  Vali macro F1 0.9813890 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 6.128225326538086
Fine Tuning VALI: Epoch: 24, Steps: 68 | Train Loss: 0.0100621  Vali Loss: 0.0417051 Vali Accuracy: 0.9854847  Vali weighted F1: 0.9854424  Vali macro F1 0.9805574 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9458731  Test weighted F1: 0.9465407  Test macro F1 0.9217187 
================ the 2 th CV Experiment ================ 
Leave one Out Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.0001478  0.00018292 0.00097371 0.00126422 0.00049579 0.00061881]
Train data number :  17684
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1965
Test data number :  11154
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.257749795913696
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.0307495  Vali Loss: 0.8301979 Vali Accuracy: 0.6676845  Vali weighted F1: 0.6482707  Vali macro F1 0.4770765 
Validation loss decreased (inf --> 0.830198).  Saving model ...
Epoch: 2 cost time: 6.254983901977539
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.4922536  Vali Loss: 0.3547298 Vali Accuracy: 0.8732824  Vali weighted F1: 0.8653828  Vali macro F1 0.8241720 
new best score!!!!
Validation loss decreased (0.830198 --> 0.354730).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.2469892501831055
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.3241123  Vali Loss: 0.2348066 Vali Accuracy: 0.9231552  Vali weighted F1: 0.9235267  Vali macro F1 0.8963930 
new best score!!!!
Validation loss decreased (0.354730 --> 0.234807).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.24492073059082
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.2251638  Vali Loss: 0.1701396 Vali Accuracy: 0.9470738  Vali weighted F1: 0.9462461  Vali macro F1 0.9280636 
new best score!!!!
Validation loss decreased (0.234807 --> 0.170140).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.25620436668396
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.1773521  Vali Loss: 0.1449685 Vali Accuracy: 0.9511450  Vali weighted F1: 0.9503303  Vali macro F1 0.9308418 
new best score!!!!
Validation loss decreased (0.170140 --> 0.144968).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.255952835083008
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.1589622  Vali Loss: 0.1409492 Vali Accuracy: 0.9465649  Vali weighted F1: 0.9470852  Vali macro F1 0.9292956 
new best score!!!!
Validation loss decreased (0.144968 --> 0.140949).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.25611138343811
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.1409017  Vali Loss: 0.1181230 Vali Accuracy: 0.9572519  Vali weighted F1: 0.9566695  Vali macro F1 0.9427476 
new best score!!!!
Validation loss decreased (0.140949 --> 0.118123).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.260941028594971
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1252787  Vali Loss: 0.1056919 Vali Accuracy: 0.9597964  Vali weighted F1: 0.9597756  Vali macro F1 0.9465294 
new best score!!!!
Validation loss decreased (0.118123 --> 0.105692).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.270533800125122
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1184814  Vali Loss: 0.0972973 Vali Accuracy: 0.9659033  Vali weighted F1: 0.9656243  Vali macro F1 0.9538522 
new best score!!!!
Validation loss decreased (0.105692 --> 0.097297).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.2699432373046875
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1059043  Vali Loss: 0.1067204 Vali Accuracy: 0.9633588  Vali weighted F1: 0.9639693  Vali macro F1 0.9526868 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.241767168045044
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0999415  Vali Loss: 0.0903452 Vali Accuracy: 0.9689567  Vali weighted F1: 0.9683935  Vali macro F1 0.9589473 
new best score!!!!
Validation loss decreased (0.097297 --> 0.090345).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.260391712188721
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0887330  Vali Loss: 0.0884090 Vali Accuracy: 0.9699746  Vali weighted F1: 0.9701018  Vali macro F1 0.9578346 
new best score!!!!
Validation loss decreased (0.090345 --> 0.088409).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.261036157608032
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0797340  Vali Loss: 0.0813392 Vali Accuracy: 0.9735369  Vali weighted F1: 0.9732599  Vali macro F1 0.9657194 
new best score!!!!
Validation loss decreased (0.088409 --> 0.081339).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.277513027191162
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0733222  Vali Loss: 0.0747670 Vali Accuracy: 0.9776081  Vali weighted F1: 0.9775439  Vali macro F1 0.9693117 
new best score!!!!
Validation loss decreased (0.081339 --> 0.074767).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.271448612213135
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0690662  Vali Loss: 0.1020187 Vali Accuracy: 0.9653944  Vali weighted F1: 0.9658278  Vali macro F1 0.9539343 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.271974325180054
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0671781  Vali Loss: 0.0881879 Vali Accuracy: 0.9720102  Vali weighted F1: 0.9718662  Vali macro F1 0.9640417 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 17 cost time: 6.275452136993408
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0667517  Vali Loss: 0.0686179 Vali Accuracy: 0.9745547  Vali weighted F1: 0.9745594  Vali macro F1 0.9656739 
new best score!!!!
Validation loss decreased (0.074767 --> 0.068618).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.279423236846924
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0611454  Vali Loss: 0.0649073 Vali Accuracy: 0.9755725  Vali weighted F1: 0.9755428  Vali macro F1 0.9666110 
new best score!!!!
Validation loss decreased (0.068618 --> 0.064907).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.254180908203125
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0517725  Vali Loss: 0.0670793 Vali Accuracy: 0.9796438  Vali weighted F1: 0.9797216  Vali macro F1 0.9735874 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 6.249675512313843
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0524856  Vali Loss: 0.0638686 Vali Accuracy: 0.9781170  Vali weighted F1: 0.9778737  Vali macro F1 0.9719349 
new best score!!!!
Validation loss decreased (0.064907 --> 0.063869).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.2508440017700195
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0481929  Vali Loss: 0.0641447 Vali Accuracy: 0.9776081  Vali weighted F1: 0.9774878  Vali macro F1 0.9705287 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 6.257421255111694
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0440560  Vali Loss: 0.0626075 Vali Accuracy: 0.9811705  Vali weighted F1: 0.9810416  Vali macro F1 0.9766560 
new best score!!!!
Validation loss decreased (0.063869 --> 0.062608).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.253714323043823
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0505803  Vali Loss: 0.0694745 Vali Accuracy: 0.9776081  Vali weighted F1: 0.9777444  Vali macro F1 0.9708671 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 6.2642199993133545
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0429038  Vali Loss: 0.0599587 Vali Accuracy: 0.9781170  Vali weighted F1: 0.9779948  Vali macro F1 0.9729620 
new best score!!!!
Validation loss decreased (0.062608 --> 0.059959).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.249449729919434
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0390688  Vali Loss: 0.0586350 Vali Accuracy: 0.9801527  Vali weighted F1: 0.9801390  Vali macro F1 0.9736550 
new best score!!!!
Validation loss decreased (0.059959 --> 0.058635).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.255993366241455
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0327255  Vali Loss: 0.0648025 Vali Accuracy: 0.9796438  Vali weighted F1: 0.9794861  Vali macro F1 0.9739903 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 6.28133487701416
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0333570  Vali Loss: 0.0639300 Vali Accuracy: 0.9801527  Vali weighted F1: 0.9802330  Vali macro F1 0.9747163 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 6.251282691955566
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0338499  Vali Loss: 0.0541219 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9846660  Vali macro F1 0.9806633 
new best score!!!!
Validation loss decreased (0.058635 --> 0.054122).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.255051374435425
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0269334  Vali Loss: 0.0571236 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9852607  Vali macro F1 0.9795768 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 6.256533622741699
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0300265  Vali Loss: 0.0656964 Vali Accuracy: 0.9816794  Vali weighted F1: 0.9818602  Vali macro F1 0.9756713 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 6.2376320362091064
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0285572  Vali Loss: 0.0509638 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9846859  Vali macro F1 0.9794563 
new best score!!!!
Validation loss decreased (0.054122 --> 0.050964).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.2562644481658936
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0275843  Vali Loss: 0.0518594 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9872621  Vali macro F1 0.9844814 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 6.251809120178223
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0271818  Vali Loss: 0.0567449 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9846445  Vali macro F1 0.9799977 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 6.2490880489349365
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0185525  Vali Loss: 0.0600407 Vali Accuracy: 0.9816794  Vali weighted F1: 0.9815817  Vali macro F1 0.9765181 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 35 cost time: 6.264687776565552
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0254578  Vali Loss: 0.0496348 Vali Accuracy: 0.9867684  Vali weighted F1: 0.9867806  Vali macro F1 0.9816174 
new best score!!!!
Validation loss decreased (0.050964 --> 0.049635).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.275623798370361
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0231986  Vali Loss: 0.0564962 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9838343  Vali macro F1 0.9770600 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 6.280222654342651
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0232296  Vali Loss: 0.0698095 Vali Accuracy: 0.9806616  Vali weighted F1: 0.9808507  Vali macro F1 0.9742970 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 6.249296426773071
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0178420  Vali Loss: 0.0469243 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9878159  Vali macro F1 0.9844036 
new best score!!!!
Validation loss decreased (0.049635 --> 0.046924).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 6.26186990737915
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0152066  Vali Loss: 0.0503796 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9847430  Vali macro F1 0.9814246 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 6.252316951751709
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0231553  Vali Loss: 0.0637558 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9835529  Vali macro F1 0.9798702 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 6.256100654602051
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0239009  Vali Loss: 0.0662269 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9837852  Vali macro F1 0.9786165 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 6.269533395767212
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0230637  Vali Loss: 0.0592018 Vali Accuracy: 0.9832061  Vali weighted F1: 0.9832663  Vali macro F1 0.9785564 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 6.262690544128418
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0187541  Vali Loss: 0.0431618 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9847884  Vali macro F1 0.9804770 
new best score!!!!
Validation loss decreased (0.046924 --> 0.043162).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 6.274574041366577
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0185747  Vali Loss: 0.0636410 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9835394  Vali macro F1 0.9783057 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 6.290624380111694
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0197312  Vali Loss: 0.0578442 Vali Accuracy: 0.9832061  Vali weighted F1: 0.9830788  Vali macro F1 0.9765559 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 6.268470287322998
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0115848  Vali Loss: 0.0550312 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9857227  Vali macro F1 0.9806146 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 6.26737904548645
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0111855  Vali Loss: 0.0731051 Vali Accuracy: 0.9811705  Vali weighted F1: 0.9809443  Vali macro F1 0.9721512 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 6.260339736938477
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0163090  Vali Loss: 0.0470661 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9872579  Vali macro F1 0.9829793 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 49 cost time: 6.265262126922607
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0078097  Vali Loss: 0.0431683 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9883051  Vali macro F1 0.9845297 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 6.263591051101685
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0062871  Vali Loss: 0.0444530 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9877895  Vali macro F1 0.9834239 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 6.262439489364624
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0053141  Vali Loss: 0.0427478 Vali Accuracy: 0.9898219  Vali weighted F1: 0.9898205  Vali macro F1 0.9867623 
new best score!!!!
Validation loss decreased (0.043162 --> 0.042748).  Saving model ...
new best score!!!!
Epoch: 52 cost time: 6.254448413848877
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0055708  Vali Loss: 0.0438222 Vali Accuracy: 0.9893130  Vali weighted F1: 0.9892992  Vali macro F1 0.9859015 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 7.2712273597717285
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0048594  Vali Loss: 0.0429479 Vali Accuracy: 0.9898219  Vali weighted F1: 0.9898283  Vali macro F1 0.9864479 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 6.268666505813599
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0042686  Vali Loss: 0.0456876 Vali Accuracy: 0.9893130  Vali weighted F1: 0.9892964  Vali macro F1 0.9859005 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 55 cost time: 6.2859625816345215
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0044379  Vali Loss: 0.0482169 Vali Accuracy: 0.9893130  Vali weighted F1: 0.9893059  Vali macro F1 0.9855850 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 56 cost time: 6.287887334823608
VALI: Epoch: 56, Steps: 70 | Train Loss: 0.0046714  Vali Loss: 0.0457177 Vali Accuracy: 0.9898219  Vali weighted F1: 0.9897986  Vali macro F1 0.9863941 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 57 cost time: 6.272889852523804
VALI: Epoch: 57, Steps: 70 | Train Loss: 0.0042538  Vali Loss: 0.0460687 Vali Accuracy: 0.9898219  Vali weighted F1: 0.9897986  Vali macro F1 0.9863941 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 58 cost time: 6.273233890533447
VALI: Epoch: 58, Steps: 70 | Train Loss: 0.0049071  Vali Loss: 0.0460618 Vali Accuracy: 0.9903308  Vali weighted F1: 0.9903103  Vali macro F1 0.9872314 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 59 cost time: 6.2602622509002686
VALI: Epoch: 59, Steps: 70 | Train Loss: 0.0042137  Vali Loss: 0.0460168 Vali Accuracy: 0.9903308  Vali weighted F1: 0.9903103  Vali macro F1 0.9872314 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 60 cost time: 6.245630264282227
VALI: Epoch: 60, Steps: 70 | Train Loss: 0.0040997  Vali Loss: 0.0464076 Vali Accuracy: 0.9903308  Vali weighted F1: 0.9903250  Vali macro F1 0.9872563 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 61 cost time: 6.257226943969727
VALI: Epoch: 61, Steps: 70 | Train Loss: 0.0042312  Vali Loss: 0.0464755 Vali Accuracy: 0.9898219  Vali weighted F1: 0.9898162  Vali macro F1 0.9864201 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 62 cost time: 6.280945062637329
VALI: Epoch: 62, Steps: 70 | Train Loss: 0.0044628  Vali Loss: 0.0465013 Vali Accuracy: 0.9898219  Vali weighted F1: 0.9898162  Vali macro F1 0.9864201 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 63 cost time: 6.2589991092681885
VALI: Epoch: 63, Steps: 70 | Train Loss: 0.0042694  Vali Loss: 0.0464879 Vali Accuracy: 0.9898219  Vali weighted F1: 0.9898162  Vali macro F1 0.9864201 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 64 cost time: 6.255845785140991
VALI: Epoch: 64, Steps: 70 | Train Loss: 0.0043612  Vali Loss: 0.0465008 Vali Accuracy: 0.9898219  Vali weighted F1: 0.9898162  Vali macro F1 0.9864201 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 65 cost time: 6.260769367218018
VALI: Epoch: 65, Steps: 70 | Train Loss: 0.0041769  Vali Loss: 0.0464899 Vali Accuracy: 0.9898219  Vali weighted F1: 0.9898162  Vali macro F1 0.9864201 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 66 cost time: 6.255280256271362
VALI: Epoch: 66, Steps: 70 | Train Loss: 0.0044856  Vali Loss: 0.0464404 Vali Accuracy: 0.9898219  Vali weighted F1: 0.9898162  Vali macro F1 0.9864201 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8342299  Test weighted F1: 0.8425351  Test macro F1 0.8367118 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 240495
pruned model Parameter : 244174
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.250979900360107
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0055913  Vali Loss: 0.0463860 Vali Accuracy: 0.9893130  Vali weighted F1: 0.9892778  Vali macro F1 0.9851726 
Validation loss decreased (inf --> 0.046386).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.268339395523071
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0063581  Vali Loss: 0.0464380 Vali Accuracy: 0.9908397  Vali weighted F1: 0.9908326  Vali macro F1 0.9874483 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.273741960525513
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0046074  Vali Loss: 0.0486985 Vali Accuracy: 0.9898219  Vali weighted F1: 0.9898223  Vali macro F1 0.9861193 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.274141311645508
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0041867  Vali Loss: 0.0476990 Vali Accuracy: 0.9908397  Vali weighted F1: 0.9908334  Vali macro F1 0.9874529 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.260969400405884
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0036943  Vali Loss: 0.0471235 Vali Accuracy: 0.9898219  Vali weighted F1: 0.9898204  Vali macro F1 0.9867154 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.271098613739014
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0039285  Vali Loss: 0.0487797 Vali Accuracy: 0.9888041  Vali weighted F1: 0.9887883  Vali macro F1 0.9849868 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.263360023498535
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0036752  Vali Loss: 0.0455712 Vali Accuracy: 0.9903308  Vali weighted F1: 0.9903239  Vali macro F1 0.9872008 
new best score!!!!
Validation loss decreased (0.046386 --> 0.045571).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 6.266633033752441
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0036748  Vali Loss: 0.0488640 Vali Accuracy: 0.9893130  Vali weighted F1: 0.9892810  Vali macro F1 0.9866930 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.272494077682495
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0034088  Vali Loss: 0.0578742 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9877877  Vali macro F1 0.9834584 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 6.249983072280884
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0040467  Vali Loss: 0.0498330 Vali Accuracy: 0.9888041  Vali weighted F1: 0.9887911  Vali macro F1 0.9850455 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 6.2704479694366455
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0032478  Vali Loss: 0.0478400 Vali Accuracy: 0.9888041  Vali weighted F1: 0.9887848  Vali macro F1 0.9850636 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 6.271214723587036
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0034975  Vali Loss: 0.0459344 Vali Accuracy: 0.9893130  Vali weighted F1: 0.9892857  Vali macro F1 0.9863922 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 13 cost time: 6.2824084758758545
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0031257  Vali Loss: 0.0447214 Vali Accuracy: 0.9893130  Vali weighted F1: 0.9892910  Vali macro F1 0.9860703 
new best score!!!!
Validation loss decreased (0.045571 --> 0.044721).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 6.272607326507568
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0033892  Vali Loss: 0.0445484 Vali Accuracy: 0.9893130  Vali weighted F1: 0.9892884  Vali macro F1 0.9854771 
new best score!!!!
Validation loss decreased (0.044721 --> 0.044548).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 6.259244680404663
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0030635  Vali Loss: 0.0446753 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9882891  Vali macro F1 0.9844981 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.258684873580933
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0029291  Vali Loss: 0.0460939 Vali Accuracy: 0.9893130  Vali weighted F1: 0.9892884  Vali macro F1 0.9854771 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 6.27283239364624
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0029635  Vali Loss: 0.0459586 Vali Accuracy: 0.9893130  Vali weighted F1: 0.9892966  Vali macro F1 0.9852341 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 6.26729416847229
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0030892  Vali Loss: 0.0453519 Vali Accuracy: 0.9893130  Vali weighted F1: 0.9892966  Vali macro F1 0.9852341 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 6.257054328918457
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0027287  Vali Loss: 0.0462071 Vali Accuracy: 0.9893130  Vali weighted F1: 0.9892884  Vali macro F1 0.9854771 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 20 cost time: 6.271361351013184
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0025404  Vali Loss: 0.0462725 Vali Accuracy: 0.9893130  Vali weighted F1: 0.9892884  Vali macro F1 0.9854771 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 6.7434186935424805
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0026766  Vali Loss: 0.0463268 Vali Accuracy: 0.9893130  Vali weighted F1: 0.9892884  Vali macro F1 0.9854771 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 6.263303279876709
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0027736  Vali Loss: 0.0463608 Vali Accuracy: 0.9898219  Vali weighted F1: 0.9898000  Vali macro F1 0.9863182 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 6.249472141265869
Fine Tuning VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0028364  Vali Loss: 0.0464317 Vali Accuracy: 0.9898219  Vali weighted F1: 0.9898000  Vali macro F1 0.9863182 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 6.265429735183716
Fine Tuning VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0030870  Vali Loss: 0.0461520 Vali Accuracy: 0.9898219  Vali weighted F1: 0.9898000  Vali macro F1 0.9863182 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Fine Tuning Epoch: 25 cost time: 6.262979507446289
Fine Tuning VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0024005  Vali Loss: 0.0461594 Vali Accuracy: 0.9898219  Vali weighted F1: 0.9898000  Vali macro F1 0.9863182 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 6.260785341262817
Fine Tuning VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0023564  Vali Loss: 0.0461577 Vali Accuracy: 0.9898219  Vali weighted F1: 0.9898000  Vali macro F1 0.9863182 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 27 cost time: 6.2597715854644775
Fine Tuning VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0028146  Vali Loss: 0.0461510 Vali Accuracy: 0.9898219  Vali weighted F1: 0.9898000  Vali macro F1 0.9863182 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 28 cost time: 6.25626802444458
Fine Tuning VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0028076  Vali Loss: 0.0461521 Vali Accuracy: 0.9898219  Vali weighted F1: 0.9898000  Vali macro F1 0.9863182 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 29 cost time: 6.2702412605285645
Fine Tuning VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0028602  Vali Loss: 0.0461471 Vali Accuracy: 0.9898219  Vali weighted F1: 0.9898000  Vali macro F1 0.9863182 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8326161  Test weighted F1: 0.8408133  Test macro F1 0.8397822 
================ the 3 th CV Experiment ================ 
Leave one Out Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00014943 0.00018335 0.00100705 0.00123609 0.00051813 0.00062696]
Train data number :  17473
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1942
Test data number :  12314
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.187839031219482
VALI: Epoch: 1, Steps: 69 | Train Loss: 1.0393869  Vali Loss: 0.6472438 Vali Accuracy: 0.7615860  Vali weighted F1: 0.7286319  Vali macro F1 0.5350766 
Validation loss decreased (inf --> 0.647244).  Saving model ...
Epoch: 2 cost time: 6.163615465164185
VALI: Epoch: 2, Steps: 69 | Train Loss: 0.4853945  Vali Loss: 0.3627500 Vali Accuracy: 0.8630278  Vali weighted F1: 0.8514113  Vali macro F1 0.7937705 
new best score!!!!
Validation loss decreased (0.647244 --> 0.362750).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.159763813018799
VALI: Epoch: 3, Steps: 69 | Train Loss: 0.3346216  Vali Loss: 0.2399504 Vali Accuracy: 0.9170958  Vali weighted F1: 0.9158944  Vali macro F1 0.8683052 
new best score!!!!
Validation loss decreased (0.362750 --> 0.239950).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.160981178283691
VALI: Epoch: 4, Steps: 69 | Train Loss: 0.2358250  Vali Loss: 0.1813814 Vali Accuracy: 0.9320288  Vali weighted F1: 0.9303647  Vali macro F1 0.8900553 
new best score!!!!
Validation loss decreased (0.239950 --> 0.181381).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.172990798950195
VALI: Epoch: 5, Steps: 69 | Train Loss: 0.1949888  Vali Loss: 0.1633446 Vali Accuracy: 0.9397528  Vali weighted F1: 0.9390079  Vali macro F1 0.9044345 
new best score!!!!
Validation loss decreased (0.181381 --> 0.163345).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.242349863052368
VALI: Epoch: 6, Steps: 69 | Train Loss: 0.1663542  Vali Loss: 0.1322724 Vali Accuracy: 0.9526262  Vali weighted F1: 0.9527063  Vali macro F1 0.9255551 
new best score!!!!
Validation loss decreased (0.163345 --> 0.132272).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.171093940734863
VALI: Epoch: 7, Steps: 69 | Train Loss: 0.1517345  Vali Loss: 0.1442672 Vali Accuracy: 0.9505664  Vali weighted F1: 0.9506262  Vali macro F1 0.9205175 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 8 cost time: 6.170249938964844
VALI: Epoch: 8, Steps: 69 | Train Loss: 0.1394736  Vali Loss: 0.1158688 Vali Accuracy: 0.9598352  Vali weighted F1: 0.9600347  Vali macro F1 0.9390154 
new best score!!!!
Validation loss decreased (0.132272 --> 0.115869).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.181658029556274
VALI: Epoch: 9, Steps: 69 | Train Loss: 0.1249395  Vali Loss: 0.0996568 Vali Accuracy: 0.9644696  Vali weighted F1: 0.9643644  Vali macro F1 0.9429159 
new best score!!!!
Validation loss decreased (0.115869 --> 0.099657).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.192443132400513
VALI: Epoch: 10, Steps: 69 | Train Loss: 0.1213317  Vali Loss: 0.0902532 Vali Accuracy: 0.9665294  Vali weighted F1: 0.9660081  Vali macro F1 0.9455868 
new best score!!!!
Validation loss decreased (0.099657 --> 0.090253).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.178463697433472
VALI: Epoch: 11, Steps: 69 | Train Loss: 0.1051316  Vali Loss: 0.0970378 Vali Accuracy: 0.9639547  Vali weighted F1: 0.9639227  Vali macro F1 0.9404136 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 6.170466661453247
VALI: Epoch: 12, Steps: 69 | Train Loss: 0.0981332  Vali Loss: 0.0962798 Vali Accuracy: 0.9618950  Vali weighted F1: 0.9617254  Vali macro F1 0.9377508 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 13 cost time: 6.172398567199707
VALI: Epoch: 13, Steps: 69 | Train Loss: 0.0955644  Vali Loss: 0.0849409 Vali Accuracy: 0.9716787  Vali weighted F1: 0.9715722  Vali macro F1 0.9509506 
new best score!!!!
Validation loss decreased (0.090253 --> 0.084941).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.164446830749512
VALI: Epoch: 14, Steps: 69 | Train Loss: 0.0796414  Vali Loss: 0.1025040 Vali Accuracy: 0.9608651  Vali weighted F1: 0.9606476  Vali macro F1 0.9360920 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.165058374404907
VALI: Epoch: 15, Steps: 69 | Train Loss: 0.0746992  Vali Loss: 0.0712566 Vali Accuracy: 0.9696189  Vali weighted F1: 0.9698725  Vali macro F1 0.9472585 
new best score!!!!
Validation loss decreased (0.084941 --> 0.071257).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.180790185928345
VALI: Epoch: 16, Steps: 69 | Train Loss: 0.0721160  Vali Loss: 0.0609426 Vali Accuracy: 0.9773429  Vali weighted F1: 0.9773037  Vali macro F1 0.9573091 
new best score!!!!
Validation loss decreased (0.071257 --> 0.060943).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.174307107925415
VALI: Epoch: 17, Steps: 69 | Train Loss: 0.0616292  Vali Loss: 0.0619748 Vali Accuracy: 0.9783728  Vali weighted F1: 0.9785784  Vali macro F1 0.9622746 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 6.185475587844849
VALI: Epoch: 18, Steps: 69 | Train Loss: 0.0678710  Vali Loss: 0.0650769 Vali Accuracy: 0.9799176  Vali weighted F1: 0.9798925  Vali macro F1 0.9697988 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 6.165681838989258
VALI: Epoch: 19, Steps: 69 | Train Loss: 0.0599597  Vali Loss: 0.0657659 Vali Accuracy: 0.9747683  Vali weighted F1: 0.9747642  Vali macro F1 0.9633065 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 20 cost time: 6.18600869178772
VALI: Epoch: 20, Steps: 69 | Train Loss: 0.0523409  Vali Loss: 0.0685376 Vali Accuracy: 0.9763131  Vali weighted F1: 0.9766066  Vali macro F1 0.9647988 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 21 cost time: 6.174297332763672
VALI: Epoch: 21, Steps: 69 | Train Loss: 0.0413893  Vali Loss: 0.0727286 Vali Accuracy: 0.9752832  Vali weighted F1: 0.9754698  Vali macro F1 0.9640114 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 22 cost time: 6.164093732833862
VALI: Epoch: 22, Steps: 69 | Train Loss: 0.0352466  Vali Loss: 0.0500812 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9824941  Vali macro F1 0.9731145 
new best score!!!!
Validation loss decreased (0.060943 --> 0.050081).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.178262948989868
VALI: Epoch: 23, Steps: 69 | Train Loss: 0.0308010  Vali Loss: 0.0511414 Vali Accuracy: 0.9819773  Vali weighted F1: 0.9820473  Vali macro F1 0.9720647 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 6.165587663650513
VALI: Epoch: 24, Steps: 69 | Train Loss: 0.0288227  Vali Loss: 0.0504069 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9814776  Vali macro F1 0.9710752 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 6.161479949951172
VALI: Epoch: 25, Steps: 69 | Train Loss: 0.0282745  Vali Loss: 0.0494490 Vali Accuracy: 0.9830072  Vali weighted F1: 0.9830107  Vali macro F1 0.9733592 
new best score!!!!
Validation loss decreased (0.050081 --> 0.049449).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.177896499633789
VALI: Epoch: 26, Steps: 69 | Train Loss: 0.0287081  Vali Loss: 0.0498857 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9825412  Vali macro F1 0.9728549 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 6.176233768463135
VALI: Epoch: 27, Steps: 69 | Train Loss: 0.0263265  Vali Loss: 0.0488765 Vali Accuracy: 0.9835221  Vali weighted F1: 0.9835013  Vali macro F1 0.9738296 
new best score!!!!
Validation loss decreased (0.049449 --> 0.048876).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.193809986114502
VALI: Epoch: 28, Steps: 69 | Train Loss: 0.0269266  Vali Loss: 0.0494568 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9824656  Vali macro F1 0.9726863 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 6.19436502456665
VALI: Epoch: 29, Steps: 69 | Train Loss: 0.0255099  Vali Loss: 0.0488463 Vali Accuracy: 0.9830072  Vali weighted F1: 0.9830237  Vali macro F1 0.9730425 
new best score!!!!
Validation loss decreased (0.048876 --> 0.048846).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.167818069458008
VALI: Epoch: 30, Steps: 69 | Train Loss: 0.0258346  Vali Loss: 0.0481629 Vali Accuracy: 0.9830072  Vali weighted F1: 0.9830547  Vali macro F1 0.9742911 
new best score!!!!
Validation loss decreased (0.048846 --> 0.048163).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.1689348220825195
VALI: Epoch: 31, Steps: 69 | Train Loss: 0.0246520  Vali Loss: 0.0480804 Vali Accuracy: 0.9835221  Vali weighted F1: 0.9835365  Vali macro F1 0.9750659 
new best score!!!!
Validation loss decreased (0.048163 --> 0.048080).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.1734089851379395
VALI: Epoch: 32, Steps: 69 | Train Loss: 0.0256666  Vali Loss: 0.0497196 Vali Accuracy: 0.9835221  Vali weighted F1: 0.9835389  Vali macro F1 0.9739241 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 6.162963390350342
VALI: Epoch: 33, Steps: 69 | Train Loss: 0.0225650  Vali Loss: 0.0473447 Vali Accuracy: 0.9830072  Vali weighted F1: 0.9830040  Vali macro F1 0.9738957 
new best score!!!!
Validation loss decreased (0.048080 --> 0.047345).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.162709712982178
VALI: Epoch: 34, Steps: 69 | Train Loss: 0.0248148  Vali Loss: 0.0503140 Vali Accuracy: 0.9835221  Vali weighted F1: 0.9835688  Vali macro F1 0.9745595 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 6.165421724319458
VALI: Epoch: 35, Steps: 69 | Train Loss: 0.0235664  Vali Loss: 0.0481063 Vali Accuracy: 0.9830072  Vali weighted F1: 0.9829917  Vali macro F1 0.9736057 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 6.171103477478027
VALI: Epoch: 36, Steps: 69 | Train Loss: 0.0238466  Vali Loss: 0.0472696 Vali Accuracy: 0.9835221  Vali weighted F1: 0.9835174  Vali macro F1 0.9747465 
new best score!!!!
Validation loss decreased (0.047345 --> 0.047270).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.176696300506592
VALI: Epoch: 37, Steps: 69 | Train Loss: 0.0232332  Vali Loss: 0.0517837 Vali Accuracy: 0.9835221  Vali weighted F1: 0.9835902  Vali macro F1 0.9742985 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 6.1733903884887695
VALI: Epoch: 38, Steps: 69 | Train Loss: 0.0230267  Vali Loss: 0.0465859 Vali Accuracy: 0.9840371  Vali weighted F1: 0.9840410  Vali macro F1 0.9756047 
new best score!!!!
Validation loss decreased (0.047270 --> 0.046586).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 6.174992322921753
VALI: Epoch: 39, Steps: 69 | Train Loss: 0.0210890  Vali Loss: 0.0468587 Vali Accuracy: 0.9845520  Vali weighted F1: 0.9846118  Vali macro F1 0.9759679 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 6.1601035594940186
VALI: Epoch: 40, Steps: 69 | Train Loss: 0.0222192  Vali Loss: 0.0502366 Vali Accuracy: 0.9835221  Vali weighted F1: 0.9835699  Vali macro F1 0.9745658 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 6.162560701370239
VALI: Epoch: 41, Steps: 69 | Train Loss: 0.0205379  Vali Loss: 0.0482445 Vali Accuracy: 0.9819773  Vali weighted F1: 0.9819676  Vali macro F1 0.9719257 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 6.1696765422821045
VALI: Epoch: 42, Steps: 69 | Train Loss: 0.0220103  Vali Loss: 0.0461919 Vali Accuracy: 0.9835221  Vali weighted F1: 0.9835376  Vali macro F1 0.9745161 
new best score!!!!
Validation loss decreased (0.046586 --> 0.046192).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 6.179950714111328
VALI: Epoch: 43, Steps: 69 | Train Loss: 0.0203516  Vali Loss: 0.0478146 Vali Accuracy: 0.9840371  Vali weighted F1: 0.9840062  Vali macro F1 0.9750228 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 6.166311502456665
VALI: Epoch: 44, Steps: 69 | Train Loss: 0.0197711  Vali Loss: 0.0480278 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9824583  Vali macro F1 0.9730122 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 6.177708387374878
VALI: Epoch: 45, Steps: 69 | Train Loss: 0.0200926  Vali Loss: 0.0487418 Vali Accuracy: 0.9835221  Vali weighted F1: 0.9835566  Vali macro F1 0.9748507 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 46 cost time: 6.174142599105835
VALI: Epoch: 46, Steps: 69 | Train Loss: 0.0203738  Vali Loss: 0.0496099 Vali Accuracy: 0.9835221  Vali weighted F1: 0.9835486  Vali macro F1 0.9742144 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 47 cost time: 6.155748605728149
VALI: Epoch: 47, Steps: 69 | Train Loss: 0.0194361  Vali Loss: 0.0474017 Vali Accuracy: 0.9850669  Vali weighted F1: 0.9850669  Vali macro F1 0.9767502 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 48 cost time: 6.185064077377319
VALI: Epoch: 48, Steps: 69 | Train Loss: 0.0177461  Vali Loss: 0.0470277 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9855949  Vali macro F1 0.9773192 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 6.160646438598633
VALI: Epoch: 49, Steps: 69 | Train Loss: 0.0176783  Vali Loss: 0.0473948 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9855931  Vali macro F1 0.9773125 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 6.176813840866089
VALI: Epoch: 50, Steps: 69 | Train Loss: 0.0181393  Vali Loss: 0.0470211 Vali Accuracy: 0.9845520  Vali weighted F1: 0.9845518  Vali macro F1 0.9758916 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 6.168997049331665
VALI: Epoch: 51, Steps: 69 | Train Loss: 0.0172737  Vali Loss: 0.0466388 Vali Accuracy: 0.9835221  Vali weighted F1: 0.9835217  Vali macro F1 0.9741785 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 52 cost time: 6.167682409286499
VALI: Epoch: 52, Steps: 69 | Train Loss: 0.0178810  Vali Loss: 0.0473509 Vali Accuracy: 0.9845520  Vali weighted F1: 0.9845513  Vali macro F1 0.9753015 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 53 cost time: 6.15972900390625
VALI: Epoch: 53, Steps: 69 | Train Loss: 0.0177577  Vali Loss: 0.0473356 Vali Accuracy: 0.9845520  Vali weighted F1: 0.9845513  Vali macro F1 0.9753015 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 6.157558441162109
VALI: Epoch: 54, Steps: 69 | Train Loss: 0.0167569  Vali Loss: 0.0473227 Vali Accuracy: 0.9850669  Vali weighted F1: 0.9850672  Vali macro F1 0.9761618 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 6.1682891845703125
VALI: Epoch: 55, Steps: 69 | Train Loss: 0.0173203  Vali Loss: 0.0472513 Vali Accuracy: 0.9850669  Vali weighted F1: 0.9850672  Vali macro F1 0.9761618 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 56 cost time: 6.18108344078064
VALI: Epoch: 56, Steps: 69 | Train Loss: 0.0178228  Vali Loss: 0.0472349 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9855828  Vali macro F1 0.9770214 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 57 cost time: 6.194694519042969
VALI: Epoch: 57, Steps: 69 | Train Loss: 0.0176553  Vali Loss: 0.0472631 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9855828  Vali macro F1 0.9770214 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9581777  Test weighted F1: 0.9580196  Test macro F1 0.9487188 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 240495
pruned model Parameter : 244174
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.1617066860198975
Fine Tuning VALI: Epoch: 1, Steps: 69 | Train Loss: 0.0202326  Vali Loss: 0.0472650 Vali Accuracy: 0.9840371  Vali weighted F1: 0.9840835  Vali macro F1 0.9748128 
Validation loss decreased (inf --> 0.047265).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.149510145187378
Fine Tuning VALI: Epoch: 2, Steps: 69 | Train Loss: 0.0201015  Vali Loss: 0.0495206 Vali Accuracy: 0.9830072  Vali weighted F1: 0.9830214  Vali macro F1 0.9742263 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.151549339294434
Fine Tuning VALI: Epoch: 3, Steps: 69 | Train Loss: 0.0180303  Vali Loss: 0.0519763 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9825283  Vali macro F1 0.9725447 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.154144525527954
Fine Tuning VALI: Epoch: 4, Steps: 69 | Train Loss: 0.0200429  Vali Loss: 0.0492894 Vali Accuracy: 0.9845520  Vali weighted F1: 0.9845519  Vali macro F1 0.9758851 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.146390914916992
Fine Tuning VALI: Epoch: 5, Steps: 69 | Train Loss: 0.0193956  Vali Loss: 0.0500800 Vali Accuracy: 0.9835221  Vali weighted F1: 0.9835814  Vali macro F1 0.9750607 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.163434028625488
Fine Tuning VALI: Epoch: 6, Steps: 69 | Train Loss: 0.0191385  Vali Loss: 0.0483408 Vali Accuracy: 0.9840371  Vali weighted F1: 0.9840819  Vali macro F1 0.9754424 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.176832914352417
Fine Tuning VALI: Epoch: 7, Steps: 69 | Train Loss: 0.0181934  Vali Loss: 0.0475159 Vali Accuracy: 0.9830072  Vali weighted F1: 0.9829741  Vali macro F1 0.9738678 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.157415866851807
Fine Tuning VALI: Epoch: 8, Steps: 69 | Train Loss: 0.0177538  Vali Loss: 0.0473342 Vali Accuracy: 0.9850669  Vali weighted F1: 0.9850045  Vali macro F1 0.9770023 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.1542253494262695
Fine Tuning VALI: Epoch: 9, Steps: 69 | Train Loss: 0.0171498  Vali Loss: 0.0515165 Vali Accuracy: 0.9850669  Vali weighted F1: 0.9851298  Vali macro F1 0.9779372 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.145645380020142
Fine Tuning VALI: Epoch: 10, Steps: 69 | Train Loss: 0.0181469  Vali Loss: 0.0451975 Vali Accuracy: 0.9881565  Vali weighted F1: 0.9881535  Vali macro F1 0.9812347 
new best score!!!!
Validation loss decreased (0.047265 --> 0.045197).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 6.162696361541748
Fine Tuning VALI: Epoch: 11, Steps: 69 | Train Loss: 0.0167482  Vali Loss: 0.0471674 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9856075  Vali macro F1 0.9770319 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.152507781982422
Fine Tuning VALI: Epoch: 12, Steps: 69 | Train Loss: 0.0162876  Vali Loss: 0.0478940 Vali Accuracy: 0.9850669  Vali weighted F1: 0.9851097  Vali macro F1 0.9765130 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.152997732162476
Fine Tuning VALI: Epoch: 13, Steps: 69 | Train Loss: 0.0152903  Vali Loss: 0.0469804 Vali Accuracy: 0.9850669  Vali weighted F1: 0.9850781  Vali macro F1 0.9764812 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.1784515380859375
Fine Tuning VALI: Epoch: 14, Steps: 69 | Train Loss: 0.0156324  Vali Loss: 0.0493612 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9856359  Vali macro F1 0.9787603 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.157735109329224
Fine Tuning VALI: Epoch: 15, Steps: 69 | Train Loss: 0.0144086  Vali Loss: 0.0448378 Vali Accuracy: 0.9871267  Vali weighted F1: 0.9871282  Vali macro F1 0.9795934 
new best score!!!!
Validation loss decreased (0.045197 --> 0.044838).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 6.168014764785767
Fine Tuning VALI: Epoch: 16, Steps: 69 | Train Loss: 0.0154290  Vali Loss: 0.0442281 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9855958  Vali macro F1 0.9779375 
new best score!!!!
Validation loss decreased (0.044838 --> 0.044228).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 6.176513433456421
Fine Tuning VALI: Epoch: 17, Steps: 69 | Train Loss: 0.0151774  Vali Loss: 0.0457428 Vali Accuracy: 0.9860968  Vali weighted F1: 0.9861073  Vali macro F1 0.9781931 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 6.159681558609009
Fine Tuning VALI: Epoch: 18, Steps: 69 | Train Loss: 0.0146700  Vali Loss: 0.0461041 Vali Accuracy: 0.9866117  Vali weighted F1: 0.9865738  Vali macro F1 0.9789588 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 6.15266227722168
Fine Tuning VALI: Epoch: 19, Steps: 69 | Train Loss: 0.0152528  Vali Loss: 0.0469467 Vali Accuracy: 0.9860968  Vali weighted F1: 0.9861102  Vali macro F1 0.9782423 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 6.171255826950073
Fine Tuning VALI: Epoch: 20, Steps: 69 | Train Loss: 0.0147412  Vali Loss: 0.0499272 Vali Accuracy: 0.9835221  Vali weighted F1: 0.9836066  Vali macro F1 0.9746562 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 6.1552348136901855
Fine Tuning VALI: Epoch: 21, Steps: 69 | Train Loss: 0.0141856  Vali Loss: 0.0493949 Vali Accuracy: 0.9850669  Vali weighted F1: 0.9851339  Vali macro F1 0.9765285 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 22 cost time: 6.1643006801605225
Fine Tuning VALI: Epoch: 22, Steps: 69 | Train Loss: 0.0122306  Vali Loss: 0.0447811 Vali Accuracy: 0.9866117  Vali weighted F1: 0.9866453  Vali macro F1 0.9790335 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 6.211719036102295
Fine Tuning VALI: Epoch: 23, Steps: 69 | Train Loss: 0.0121702  Vali Loss: 0.0455564 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9856185  Vali macro F1 0.9779710 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 6.154143333435059
Fine Tuning VALI: Epoch: 24, Steps: 69 | Train Loss: 0.0121868  Vali Loss: 0.0447738 Vali Accuracy: 0.9860968  Vali weighted F1: 0.9861209  Vali macro F1 0.9784970 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 6.165921211242676
Fine Tuning VALI: Epoch: 25, Steps: 69 | Train Loss: 0.0119931  Vali Loss: 0.0467559 Vali Accuracy: 0.9850669  Vali weighted F1: 0.9851047  Vali macro F1 0.9771146 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 6.190872430801392
Fine Tuning VALI: Epoch: 26, Steps: 69 | Train Loss: 0.0108437  Vali Loss: 0.0451546 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9856059  Vali macro F1 0.9776388 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 27 cost time: 6.157987594604492
Fine Tuning VALI: Epoch: 27, Steps: 69 | Train Loss: 0.0115665  Vali Loss: 0.0451045 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9856059  Vali macro F1 0.9776388 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 28 cost time: 6.181324243545532
Fine Tuning VALI: Epoch: 28, Steps: 69 | Train Loss: 0.0122647  Vali Loss: 0.0453491 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9856059  Vali macro F1 0.9776388 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 29 cost time: 6.152241945266724
Fine Tuning VALI: Epoch: 29, Steps: 69 | Train Loss: 0.0116002  Vali Loss: 0.0457182 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9856059  Vali macro F1 0.9776388 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 30 cost time: 6.16408896446228
Fine Tuning VALI: Epoch: 30, Steps: 69 | Train Loss: 0.0113078  Vali Loss: 0.0453666 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9856059  Vali macro F1 0.9776388 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 31 cost time: 6.173230886459351
Fine Tuning VALI: Epoch: 31, Steps: 69 | Train Loss: 0.0114601  Vali Loss: 0.0454507 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9856059  Vali macro F1 0.9776388 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9634562  Test weighted F1: 0.9629885  Test macro F1 0.9535666 
================ the 4 th CV Experiment ================ 
Leave one Out Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.00014941 0.00018685 0.00139276 0.00148368 0.00052743 0.00064599]
Train data number :  16881
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1876
Test data number :  15610
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.9522011280059814
VALI: Epoch: 1, Steps: 66 | Train Loss: 1.0564236  Vali Loss: 0.6867471 Vali Accuracy: 0.7446695  Vali weighted F1: 0.6750499  Vali macro F1 0.4551973 
Validation loss decreased (inf --> 0.686747).  Saving model ...
Epoch: 2 cost time: 5.964792966842651
VALI: Epoch: 2, Steps: 66 | Train Loss: 0.5543552  Vali Loss: 0.4567310 Vali Accuracy: 0.8368870  Vali weighted F1: 0.8099135  Vali macro F1 0.7652035 
new best score!!!!
Validation loss decreased (0.686747 --> 0.456731).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.961745738983154
VALI: Epoch: 3, Steps: 66 | Train Loss: 0.4156422  Vali Loss: 0.3699522 Vali Accuracy: 0.8608742  Vali weighted F1: 0.8428951  Vali macro F1 0.7958416 
new best score!!!!
Validation loss decreased (0.456731 --> 0.369952).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.966498851776123
VALI: Epoch: 4, Steps: 66 | Train Loss: 0.3278566  Vali Loss: 0.2941566 Vali Accuracy: 0.8944563  Vali weighted F1: 0.8878440  Vali macro F1 0.8586397 
new best score!!!!
Validation loss decreased (0.369952 --> 0.294157).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.974576950073242
VALI: Epoch: 5, Steps: 66 | Train Loss: 0.2549038  Vali Loss: 0.2435594 Vali Accuracy: 0.9125800  Vali weighted F1: 0.9089735  Vali macro F1 0.8841016 
new best score!!!!
Validation loss decreased (0.294157 --> 0.243559).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.960963726043701
VALI: Epoch: 6, Steps: 66 | Train Loss: 0.2069106  Vali Loss: 0.1756712 Vali Accuracy: 0.9360341  Vali weighted F1: 0.9348626  Vali macro F1 0.9169566 
new best score!!!!
Validation loss decreased (0.243559 --> 0.175671).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.959457874298096
VALI: Epoch: 7, Steps: 66 | Train Loss: 0.1782697  Vali Loss: 0.1628630 Vali Accuracy: 0.9381663  Vali weighted F1: 0.9375538  Vali macro F1 0.9141074 
new best score!!!!
Validation loss decreased (0.175671 --> 0.162863).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.952022314071655
VALI: Epoch: 8, Steps: 66 | Train Loss: 0.1581001  Vali Loss: 0.1341993 Vali Accuracy: 0.9488273  Vali weighted F1: 0.9488926  Vali macro F1 0.9316443 
new best score!!!!
Validation loss decreased (0.162863 --> 0.134199).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.968236684799194
VALI: Epoch: 9, Steps: 66 | Train Loss: 0.1472714  Vali Loss: 0.1343259 Vali Accuracy: 0.9488273  Vali weighted F1: 0.9494379  Vali macro F1 0.9340685 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 5.943787574768066
VALI: Epoch: 10, Steps: 66 | Train Loss: 0.1267329  Vali Loss: 0.1185021 Vali Accuracy: 0.9562900  Vali weighted F1: 0.9563340  Vali macro F1 0.9402669 
new best score!!!!
Validation loss decreased (0.134199 --> 0.118502).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.963357210159302
VALI: Epoch: 11, Steps: 66 | Train Loss: 0.1116526  Vali Loss: 0.1069653 Vali Accuracy: 0.9637527  Vali weighted F1: 0.9636305  Vali macro F1 0.9511364 
new best score!!!!
Validation loss decreased (0.118502 --> 0.106965).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 5.960576057434082
VALI: Epoch: 12, Steps: 66 | Train Loss: 0.1064778  Vali Loss: 0.1037348 Vali Accuracy: 0.9600213  Vali weighted F1: 0.9598008  Vali macro F1 0.9453589 
new best score!!!!
Validation loss decreased (0.106965 --> 0.103735).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.9720139503479
VALI: Epoch: 13, Steps: 66 | Train Loss: 0.0939742  Vali Loss: 0.0948940 Vali Accuracy: 0.9669510  Vali weighted F1: 0.9667493  Vali macro F1 0.9552053 
new best score!!!!
Validation loss decreased (0.103735 --> 0.094894).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 5.972130060195923
VALI: Epoch: 14, Steps: 66 | Train Loss: 0.0933920  Vali Loss: 0.1108037 Vali Accuracy: 0.9632196  Vali weighted F1: 0.9630750  Vali macro F1 0.9497172 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 5.969066143035889
VALI: Epoch: 15, Steps: 66 | Train Loss: 0.0854355  Vali Loss: 0.0831538 Vali Accuracy: 0.9690832  Vali weighted F1: 0.9691840  Vali macro F1 0.9572788 
new best score!!!!
Validation loss decreased (0.094894 --> 0.083154).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 5.975274324417114
VALI: Epoch: 16, Steps: 66 | Train Loss: 0.0792854  Vali Loss: 0.0834850 Vali Accuracy: 0.9706823  Vali weighted F1: 0.9705915  Vali macro F1 0.9625897 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 5.9735283851623535
VALI: Epoch: 17, Steps: 66 | Train Loss: 0.0738281  Vali Loss: 0.0771526 Vali Accuracy: 0.9760128  Vali weighted F1: 0.9762066  Vali macro F1 0.9683147 
new best score!!!!
Validation loss decreased (0.083154 --> 0.077153).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 5.967777490615845
VALI: Epoch: 18, Steps: 66 | Train Loss: 0.0717985  Vali Loss: 0.0825667 Vali Accuracy: 0.9728145  Vali weighted F1: 0.9728508  Vali macro F1 0.9663350 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 5.974376678466797
VALI: Epoch: 19, Steps: 66 | Train Loss: 0.0663439  Vali Loss: 0.0785374 Vali Accuracy: 0.9738806  Vali weighted F1: 0.9737549  Vali macro F1 0.9661099 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 5.955645799636841
VALI: Epoch: 20, Steps: 66 | Train Loss: 0.0625151  Vali Loss: 0.0728628 Vali Accuracy: 0.9765458  Vali weighted F1: 0.9766898  Vali macro F1 0.9713189 
new best score!!!!
Validation loss decreased (0.077153 --> 0.072863).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 5.958851337432861
VALI: Epoch: 21, Steps: 66 | Train Loss: 0.0528416  Vali Loss: 0.0647619 Vali Accuracy: 0.9802772  Vali weighted F1: 0.9802515  Vali macro F1 0.9766650 
new best score!!!!
Validation loss decreased (0.072863 --> 0.064762).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 5.96402907371521
VALI: Epoch: 22, Steps: 66 | Train Loss: 0.0509635  Vali Loss: 0.0608532 Vali Accuracy: 0.9786780  Vali weighted F1: 0.9786780  Vali macro F1 0.9738913 
new best score!!!!
Validation loss decreased (0.064762 --> 0.060853).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 5.983883619308472
VALI: Epoch: 23, Steps: 66 | Train Loss: 0.0460895  Vali Loss: 0.0596800 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9808912  Vali macro F1 0.9758532 
new best score!!!!
Validation loss decreased (0.060853 --> 0.059680).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 5.981043577194214
VALI: Epoch: 24, Steps: 66 | Train Loss: 0.0545959  Vali Loss: 0.1329510 Vali Accuracy: 0.9594883  Vali weighted F1: 0.9581489  Vali macro F1 0.9477571 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 5.97179913520813
VALI: Epoch: 25, Steps: 66 | Train Loss: 0.0652342  Vali Loss: 0.0601755 Vali Accuracy: 0.9829424  Vali weighted F1: 0.9830781  Vali macro F1 0.9791661 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 5.959070205688477
VALI: Epoch: 26, Steps: 66 | Train Loss: 0.0417019  Vali Loss: 0.0628415 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9814938  Vali macro F1 0.9782032 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 27 cost time: 5.962822198867798
VALI: Epoch: 27, Steps: 66 | Train Loss: 0.0396840  Vali Loss: 0.0590890 Vali Accuracy: 0.9781450  Vali weighted F1: 0.9781171  Vali macro F1 0.9723378 
new best score!!!!
Validation loss decreased (0.059680 --> 0.059089).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 5.968409061431885
VALI: Epoch: 28, Steps: 66 | Train Loss: 0.0343368  Vali Loss: 0.0635245 Vali Accuracy: 0.9818763  Vali weighted F1: 0.9820292  Vali macro F1 0.9778421 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 5.957592487335205
VALI: Epoch: 29, Steps: 66 | Train Loss: 0.0292958  Vali Loss: 0.0732820 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9796637  Vali macro F1 0.9754815 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 5.973277807235718
VALI: Epoch: 30, Steps: 66 | Train Loss: 0.0347778  Vali Loss: 0.0570848 Vali Accuracy: 0.9824094  Vali weighted F1: 0.9824733  Vali macro F1 0.9758592 
new best score!!!!
Validation loss decreased (0.059089 --> 0.057085).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 5.969555616378784
VALI: Epoch: 31, Steps: 66 | Train Loss: 0.0311584  Vali Loss: 0.0727626 Vali Accuracy: 0.9781450  Vali weighted F1: 0.9782998  Vali macro F1 0.9737809 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 5.97281289100647
VALI: Epoch: 32, Steps: 66 | Train Loss: 0.0336672  Vali Loss: 0.0633121 Vali Accuracy: 0.9802772  Vali weighted F1: 0.9802618  Vali macro F1 0.9756718 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 5.974179983139038
VALI: Epoch: 33, Steps: 66 | Train Loss: 0.0274376  Vali Loss: 0.0581859 Vali Accuracy: 0.9802772  Vali weighted F1: 0.9802195  Vali macro F1 0.9749953 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 34 cost time: 5.964533567428589
VALI: Epoch: 34, Steps: 66 | Train Loss: 0.0263845  Vali Loss: 0.0551643 Vali Accuracy: 0.9802772  Vali weighted F1: 0.9804636  Vali macro F1 0.9742653 
new best score!!!!
Validation loss decreased (0.057085 --> 0.055164).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 5.960190057754517
VALI: Epoch: 35, Steps: 66 | Train Loss: 0.0226158  Vali Loss: 0.0474264 Vali Accuracy: 0.9861407  Vali weighted F1: 0.9861716  Vali macro F1 0.9830235 
new best score!!!!
Validation loss decreased (0.055164 --> 0.047426).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 5.954938888549805
VALI: Epoch: 36, Steps: 66 | Train Loss: 0.0252968  Vali Loss: 0.0520986 Vali Accuracy: 0.9829424  Vali weighted F1: 0.9828870  Vali macro F1 0.9791496 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 5.96857476234436
VALI: Epoch: 37, Steps: 66 | Train Loss: 0.0221099  Vali Loss: 0.0553276 Vali Accuracy: 0.9818763  Vali weighted F1: 0.9819806  Vali macro F1 0.9775235 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 5.955951929092407
VALI: Epoch: 38, Steps: 66 | Train Loss: 0.0178342  Vali Loss: 0.0488756 Vali Accuracy: 0.9861407  Vali weighted F1: 0.9862020  Vali macro F1 0.9827019 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 5.954616546630859
VALI: Epoch: 39, Steps: 66 | Train Loss: 0.0150594  Vali Loss: 0.0473671 Vali Accuracy: 0.9877399  Vali weighted F1: 0.9878735  Vali macro F1 0.9848427 
new best score!!!!
Validation loss decreased (0.047426 --> 0.047367).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 5.959592580795288
VALI: Epoch: 40, Steps: 66 | Train Loss: 0.0165784  Vali Loss: 0.0787523 Vali Accuracy: 0.9765458  Vali weighted F1: 0.9767788  Vali macro F1 0.9715944 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 5.977254867553711
VALI: Epoch: 41, Steps: 66 | Train Loss: 0.0198092  Vali Loss: 0.0675894 Vali Accuracy: 0.9818763  Vali weighted F1: 0.9820684  Vali macro F1 0.9781143 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 5.973550796508789
VALI: Epoch: 42, Steps: 66 | Train Loss: 0.0201128  Vali Loss: 0.0508688 Vali Accuracy: 0.9845416  Vali weighted F1: 0.9845646  Vali macro F1 0.9807641 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 5.960600137710571
VALI: Epoch: 43, Steps: 66 | Train Loss: 0.0160687  Vali Loss: 0.0497504 Vali Accuracy: 0.9845416  Vali weighted F1: 0.9845396  Vali macro F1 0.9812649 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 44 cost time: 5.960194110870361
VALI: Epoch: 44, Steps: 66 | Train Loss: 0.0164478  Vali Loss: 0.0643977 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9809263  Vali macro F1 0.9743445 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 45 cost time: 6.121213912963867
VALI: Epoch: 45, Steps: 66 | Train Loss: 0.0106997  Vali Loss: 0.0428853 Vali Accuracy: 0.9877399  Vali weighted F1: 0.9878032  Vali macro F1 0.9849909 
new best score!!!!
Validation loss decreased (0.047367 --> 0.042885).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 5.97085428237915
VALI: Epoch: 46, Steps: 66 | Train Loss: 0.0084603  Vali Loss: 0.0415511 Vali Accuracy: 0.9861407  Vali weighted F1: 0.9862130  Vali macro F1 0.9829417 
new best score!!!!
Validation loss decreased (0.042885 --> 0.041551).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 5.9681556224823
VALI: Epoch: 47, Steps: 66 | Train Loss: 0.0071302  Vali Loss: 0.0417495 Vali Accuracy: 0.9877399  Vali weighted F1: 0.9877987  Vali macro F1 0.9848606 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 5.958223342895508
VALI: Epoch: 48, Steps: 66 | Train Loss: 0.0064543  Vali Loss: 0.0414049 Vali Accuracy: 0.9877399  Vali weighted F1: 0.9877892  Vali macro F1 0.9845319 
new best score!!!!
Validation loss decreased (0.041551 --> 0.041405).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 5.970227241516113
VALI: Epoch: 49, Steps: 66 | Train Loss: 0.0059816  Vali Loss: 0.0418857 Vali Accuracy: 0.9872068  Vali weighted F1: 0.9872502  Vali macro F1 0.9839970 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 5.985675811767578
VALI: Epoch: 50, Steps: 66 | Train Loss: 0.0055393  Vali Loss: 0.0423390 Vali Accuracy: 0.9872068  Vali weighted F1: 0.9872732  Vali macro F1 0.9840169 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 5.968641996383667
VALI: Epoch: 51, Steps: 66 | Train Loss: 0.0060809  Vali Loss: 0.0437846 Vali Accuracy: 0.9866738  Vali weighted F1: 0.9867221  Vali macro F1 0.9832325 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 5.9658730030059814
VALI: Epoch: 52, Steps: 66 | Train Loss: 0.0053662  Vali Loss: 0.0416685 Vali Accuracy: 0.9866738  Vali weighted F1: 0.9867229  Vali macro F1 0.9837582 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 5.956910610198975
VALI: Epoch: 53, Steps: 66 | Train Loss: 0.0050687  Vali Loss: 0.0416145 Vali Accuracy: 0.9872068  Vali weighted F1: 0.9872433  Vali macro F1 0.9843472 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 54 cost time: 5.9505720138549805
VALI: Epoch: 54, Steps: 66 | Train Loss: 0.0046776  Vali Loss: 0.0415889 Vali Accuracy: 0.9877399  Vali weighted F1: 0.9877836  Vali macro F1 0.9848839 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 5.953701496124268
VALI: Epoch: 55, Steps: 66 | Train Loss: 0.0048128  Vali Loss: 0.0417321 Vali Accuracy: 0.9877399  Vali weighted F1: 0.9877848  Vali macro F1 0.9849530 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 56 cost time: 5.965392827987671
VALI: Epoch: 56, Steps: 66 | Train Loss: 0.0047615  Vali Loss: 0.0416099 Vali Accuracy: 0.9877399  Vali weighted F1: 0.9877848  Vali macro F1 0.9849530 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 57 cost time: 5.960638523101807
VALI: Epoch: 57, Steps: 66 | Train Loss: 0.0045425  Vali Loss: 0.0416998 Vali Accuracy: 0.9877399  Vali weighted F1: 0.9877848  Vali macro F1 0.9849530 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 58 cost time: 5.967363357543945
VALI: Epoch: 58, Steps: 66 | Train Loss: 0.0045003  Vali Loss: 0.0419167 Vali Accuracy: 0.9877399  Vali weighted F1: 0.9877848  Vali macro F1 0.9849530 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 59 cost time: 5.9733569622039795
VALI: Epoch: 59, Steps: 66 | Train Loss: 0.0048816  Vali Loss: 0.0419106 Vali Accuracy: 0.9877399  Vali weighted F1: 0.9877848  Vali macro F1 0.9849530 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 60 cost time: 5.982501268386841
VALI: Epoch: 60, Steps: 66 | Train Loss: 0.0048565  Vali Loss: 0.0419031 Vali Accuracy: 0.9877399  Vali weighted F1: 0.9877848  Vali macro F1 0.9849530 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 61 cost time: 5.962464094161987
VALI: Epoch: 61, Steps: 66 | Train Loss: 0.0047703  Vali Loss: 0.0419392 Vali Accuracy: 0.9877399  Vali weighted F1: 0.9877848  Vali macro F1 0.9849530 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 62 cost time: 5.961686849594116
VALI: Epoch: 62, Steps: 66 | Train Loss: 0.0042534  Vali Loss: 0.0419149 Vali Accuracy: 0.9877399  Vali weighted F1: 0.9877848  Vali macro F1 0.9849530 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 63 cost time: 5.953096151351929
VALI: Epoch: 63, Steps: 66 | Train Loss: 0.0049849  Vali Loss: 0.0419061 Vali Accuracy: 0.9877399  Vali weighted F1: 0.9877848  Vali macro F1 0.9849530 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9139654  Test weighted F1: 0.9167890  Test macro F1 0.8851998 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 240495
pruned model Parameter : 244174
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 5.9687299728393555
Fine Tuning VALI: Epoch: 1, Steps: 66 | Train Loss: 0.0075592  Vali Loss: 0.0426042 Vali Accuracy: 0.9882729  Vali weighted F1: 0.9883364  Vali macro F1 0.9853936 
Validation loss decreased (inf --> 0.042604).  Saving model ...
Fine Tuning Epoch: 2 cost time: 5.939453840255737
Fine Tuning VALI: Epoch: 2, Steps: 66 | Train Loss: 0.0069158  Vali Loss: 0.0438227 Vali Accuracy: 0.9877399  Vali weighted F1: 0.9877958  Vali macro F1 0.9847059 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 5.950619697570801
Fine Tuning VALI: Epoch: 3, Steps: 66 | Train Loss: 0.0056907  Vali Loss: 0.0458305 Vali Accuracy: 0.9866738  Vali weighted F1: 0.9866989  Vali macro F1 0.9831288 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 5.969915390014648
Fine Tuning VALI: Epoch: 4, Steps: 66 | Train Loss: 0.0048705  Vali Loss: 0.0465355 Vali Accuracy: 0.9872068  Vali weighted F1: 0.9872385  Vali macro F1 0.9836411 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 5.974952936172485
Fine Tuning VALI: Epoch: 5, Steps: 66 | Train Loss: 0.0051578  Vali Loss: 0.0446999 Vali Accuracy: 0.9861407  Vali weighted F1: 0.9861560  Vali macro F1 0.9830018 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 5.952457666397095
Fine Tuning VALI: Epoch: 6, Steps: 66 | Train Loss: 0.0050692  Vali Loss: 0.0470096 Vali Accuracy: 0.9872068  Vali weighted F1: 0.9872649  Vali macro F1 0.9838982 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 5.9566333293914795
Fine Tuning VALI: Epoch: 7, Steps: 66 | Train Loss: 0.0057665  Vali Loss: 0.0473458 Vali Accuracy: 0.9845416  Vali weighted F1: 0.9845816  Vali macro F1 0.9802794 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 5.96262788772583
Fine Tuning VALI: Epoch: 8, Steps: 66 | Train Loss: 0.0043554  Vali Loss: 0.0446738 Vali Accuracy: 0.9872068  Vali weighted F1: 0.9872324  Vali macro F1 0.9842315 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 5.9574854373931885
Fine Tuning VALI: Epoch: 9, Steps: 66 | Train Loss: 0.0049868  Vali Loss: 0.0512386 Vali Accuracy: 0.9872068  Vali weighted F1: 0.9872437  Vali macro F1 0.9837163 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 5.954059839248657
Fine Tuning VALI: Epoch: 10, Steps: 66 | Train Loss: 0.0046605  Vali Loss: 0.0437648 Vali Accuracy: 0.9861407  Vali weighted F1: 0.9862008  Vali macro F1 0.9828814 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 11 cost time: 5.970112562179565
Fine Tuning VALI: Epoch: 11, Steps: 66 | Train Loss: 0.0038213  Vali Loss: 0.0434652 Vali Accuracy: 0.9856077  Vali weighted F1: 0.9856633  Vali macro F1 0.9816800 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 5.97533106803894
Fine Tuning VALI: Epoch: 12, Steps: 66 | Train Loss: 0.0040386  Vali Loss: 0.0447879 Vali Accuracy: 0.9856077  Vali weighted F1: 0.9856543  Vali macro F1 0.9816570 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 5.9684739112854
Fine Tuning VALI: Epoch: 13, Steps: 66 | Train Loss: 0.0035152  Vali Loss: 0.0446380 Vali Accuracy: 0.9861407  Vali weighted F1: 0.9861884  Vali macro F1 0.9825231 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 5.96499490737915
Fine Tuning VALI: Epoch: 14, Steps: 66 | Train Loss: 0.0038308  Vali Loss: 0.0438595 Vali Accuracy: 0.9866738  Vali weighted F1: 0.9867221  Vali macro F1 0.9833880 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 5.953462362289429
Fine Tuning VALI: Epoch: 15, Steps: 66 | Train Loss: 0.0038134  Vali Loss: 0.0436384 Vali Accuracy: 0.9861407  Vali weighted F1: 0.9861884  Vali macro F1 0.9825231 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 16 cost time: 5.9514381885528564
Fine Tuning VALI: Epoch: 16, Steps: 66 | Train Loss: 0.0040271  Vali Loss: 0.0437421 Vali Accuracy: 0.9861407  Vali weighted F1: 0.9861884  Vali macro F1 0.9825231 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9067265  Test weighted F1: 0.9102857  Test macro F1 0.8779755 
================ the 5 th CV Experiment ================ 
Leave one Out Experiment : The 6 Part as the test
[-] Target sampling weights:  [0.0001418  0.00018584 0.00096061 0.00123305 0.00052826 0.00064267]
Train data number :  17734
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1971
Test data number :  10878
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.254943370819092
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.0547949  Vali Loss: 0.6176739 Vali Accuracy: 0.7737189  Vali weighted F1: 0.7250663  Vali macro F1 0.5077710 
Validation loss decreased (inf --> 0.617674).  Saving model ...
Epoch: 2 cost time: 6.255527496337891
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.5012501  Vali Loss: 0.3967926 Vali Accuracy: 0.8523592  Vali weighted F1: 0.8376520  Vali macro F1 0.7773703 
new best score!!!!
Validation loss decreased (0.617674 --> 0.396793).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.241580009460449
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.3491303  Vali Loss: 0.2659477 Vali Accuracy: 0.9051243  Vali weighted F1: 0.9007660  Vali macro F1 0.8557282 
new best score!!!!
Validation loss decreased (0.396793 --> 0.265948).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.2551939487457275
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.2455863  Vali Loss: 0.1814204 Vali Accuracy: 0.9375951  Vali weighted F1: 0.9369721  Vali macro F1 0.9024888 
new best score!!!!
Validation loss decreased (0.265948 --> 0.181420).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.267426490783691
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.1953079  Vali Loss: 0.1462222 Vali Accuracy: 0.9497717  Vali weighted F1: 0.9485877  Vali macro F1 0.9187858 
new best score!!!!
Validation loss decreased (0.181420 --> 0.146222).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.2900002002716064
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.1597052  Vali Loss: 0.1099455 Vali Accuracy: 0.9563673  Vali weighted F1: 0.9558957  Vali macro F1 0.9244448 
new best score!!!!
Validation loss decreased (0.146222 --> 0.109946).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.254722595214844
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.1454098  Vali Loss: 0.1035006 Vali Accuracy: 0.9624556  Vali weighted F1: 0.9620686  Vali macro F1 0.9371256 
new best score!!!!
Validation loss decreased (0.109946 --> 0.103501).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.257133722305298
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1342562  Vali Loss: 0.1026063 Vali Accuracy: 0.9604262  Vali weighted F1: 0.9601789  Vali macro F1 0.9340786 
new best score!!!!
Validation loss decreased (0.103501 --> 0.102606).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.260420322418213
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1306472  Vali Loss: 0.0847866 Vali Accuracy: 0.9675292  Vali weighted F1: 0.9674540  Vali macro F1 0.9488797 
new best score!!!!
Validation loss decreased (0.102606 --> 0.084787).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.257182836532593
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1096575  Vali Loss: 0.0957487 Vali Accuracy: 0.9634703  Vali weighted F1: 0.9627786  Vali macro F1 0.9423668 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.249980211257935
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1071539  Vali Loss: 0.0758189 Vali Accuracy: 0.9690512  Vali weighted F1: 0.9689443  Vali macro F1 0.9452523 
new best score!!!!
Validation loss decreased (0.084787 --> 0.075819).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.268701076507568
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0950359  Vali Loss: 0.0652298 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9776007  Vali macro F1 0.9638854 
new best score!!!!
Validation loss decreased (0.075819 --> 0.065230).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.2712671756744385
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0850739  Vali Loss: 0.1148626 Vali Accuracy: 0.9578894  Vali weighted F1: 0.9574667  Vali macro F1 0.9404874 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 6.265774726867676
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0824044  Vali Loss: 0.0659798 Vali Accuracy: 0.9761542  Vali weighted F1: 0.9760589  Vali macro F1 0.9631094 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 15 cost time: 6.248671054840088
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0776678  Vali Loss: 0.0568437 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9806770  Vali macro F1 0.9703376 
new best score!!!!
Validation loss decreased (0.065230 --> 0.056844).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.260207176208496
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0747046  Vali Loss: 0.0598726 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802393  Vali macro F1 0.9727983 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 6.248125076293945
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0610174  Vali Loss: 0.0466034 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852408  Vali macro F1 0.9776976 
new best score!!!!
Validation loss decreased (0.056844 --> 0.046603).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.263975620269775
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0590826  Vali Loss: 0.0447337 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852654  Vali macro F1 0.9806475 
new best score!!!!
Validation loss decreased (0.046603 --> 0.044734).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.244241952896118
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0564208  Vali Loss: 0.0428460 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9854024  Vali macro F1 0.9809714 
new best score!!!!
Validation loss decreased (0.044734 --> 0.042846).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.268153667449951
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0513935  Vali Loss: 0.0409121 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9862522  Vali macro F1 0.9810736 
new best score!!!!
Validation loss decreased (0.042846 --> 0.040912).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.25829005241394
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0463523  Vali Loss: 0.0497838 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9822489  Vali macro F1 0.9707657 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 6.24220085144043
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0459879  Vali Loss: 0.0502896 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842216  Vali macro F1 0.9791518 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 6.264375448226929
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0453364  Vali Loss: 0.0468980 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9833137  Vali macro F1 0.9785420 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 24 cost time: 6.271285772323608
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0447098  Vali Loss: 0.0441727 Vali Accuracy: 0.9873161  Vali weighted F1: 0.9873297  Vali macro F1 0.9790881 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 25 cost time: 6.259045600891113
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0361398  Vali Loss: 0.0416465 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9851626  Vali macro F1 0.9794990 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 26 cost time: 6.2641143798828125
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0251276  Vali Loss: 0.0283309 Vali Accuracy: 0.9898529  Vali weighted F1: 0.9898280  Vali macro F1 0.9861816 
new best score!!!!
Validation loss decreased (0.040912 --> 0.028331).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.2677929401397705
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0217416  Vali Loss: 0.0278290 Vali Accuracy: 0.9903602  Vali weighted F1: 0.9903394  Vali macro F1 0.9867122 
new best score!!!!
Validation loss decreased (0.028331 --> 0.027829).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.272239685058594
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0219596  Vali Loss: 0.0287767 Vali Accuracy: 0.9898529  Vali weighted F1: 0.9898253  Vali macro F1 0.9861748 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 6.258125066757202
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0205250  Vali Loss: 0.0287051 Vali Accuracy: 0.9903602  Vali weighted F1: 0.9903333  Vali macro F1 0.9870372 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 6.252829074859619
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0200045  Vali Loss: 0.0279663 Vali Accuracy: 0.9898529  Vali weighted F1: 0.9898349  Vali macro F1 0.9858859 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 31 cost time: 6.253628969192505
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0192801  Vali Loss: 0.0286742 Vali Accuracy: 0.9898529  Vali weighted F1: 0.9898201  Vali macro F1 0.9864817 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 32 cost time: 6.287081480026245
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0191509  Vali Loss: 0.0292532 Vali Accuracy: 0.9913749  Vali weighted F1: 0.9913579  Vali macro F1 0.9878265 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 33 cost time: 6.273195505142212
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0175290  Vali Loss: 0.0288636 Vali Accuracy: 0.9903602  Vali weighted F1: 0.9903276  Vali macro F1 0.9867266 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 6.270132541656494
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0164370  Vali Loss: 0.0286865 Vali Accuracy: 0.9908676  Vali weighted F1: 0.9908435  Vali macro F1 0.9872908 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 6.257725954055786
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0169167  Vali Loss: 0.0286860 Vali Accuracy: 0.9903602  Vali weighted F1: 0.9903200  Vali macro F1 0.9870291 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 36 cost time: 6.2552454471588135
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0168853  Vali Loss: 0.0283999 Vali Accuracy: 0.9913749  Vali weighted F1: 0.9913592  Vali macro F1 0.9878307 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 37 cost time: 6.265694618225098
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0171302  Vali Loss: 0.0285473 Vali Accuracy: 0.9918823  Vali weighted F1: 0.9918673  Vali macro F1 0.9886934 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 38 cost time: 6.2701029777526855
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0167969  Vali Loss: 0.0285861 Vali Accuracy: 0.9913749  Vali weighted F1: 0.9913527  Vali macro F1 0.9881332 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 6.2700865268707275
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0167498  Vali Loss: 0.0285816 Vali Accuracy: 0.9913749  Vali weighted F1: 0.9913527  Vali macro F1 0.9881332 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 6.254295825958252
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0170727  Vali Loss: 0.0286315 Vali Accuracy: 0.9903602  Vali weighted F1: 0.9903200  Vali macro F1 0.9870291 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 6.278119802474976
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0175421  Vali Loss: 0.0286098 Vali Accuracy: 0.9903602  Vali weighted F1: 0.9903200  Vali macro F1 0.9870291 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 42 cost time: 6.262472629547119
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0174731  Vali Loss: 0.0285876 Vali Accuracy: 0.9903602  Vali weighted F1: 0.9903200  Vali macro F1 0.9870291 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9373047  Test weighted F1: 0.9357236  Test macro F1 0.9388169 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 240495
pruned model Parameter : 244174
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.275418043136597
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0217322  Vali Loss: 0.0292903 Vali Accuracy: 0.9903602  Vali weighted F1: 0.9903385  Vali macro F1 0.9870502 
Validation loss decreased (inf --> 0.029290).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.244209289550781
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0213523  Vali Loss: 0.0275406 Vali Accuracy: 0.9908676  Vali weighted F1: 0.9908599  Vali macro F1 0.9872923 
new best score!!!!
Validation loss decreased (0.029290 --> 0.027541).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.249419927597046
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0185707  Vali Loss: 0.0265414 Vali Accuracy: 0.9908676  Vali weighted F1: 0.9908431  Vali macro F1 0.9872922 
new best score!!!!
Validation loss decreased (0.027541 --> 0.026541).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.2456159591674805
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0201268  Vali Loss: 0.0338630 Vali Accuracy: 0.9888382  Vali weighted F1: 0.9887878  Vali macro F1 0.9844130 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.250949144363403
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0179130  Vali Loss: 0.0292290 Vali Accuracy: 0.9903602  Vali weighted F1: 0.9903339  Vali macro F1 0.9864215 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 6.245373249053955
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0167938  Vali Loss: 0.0274305 Vali Accuracy: 0.9893455  Vali weighted F1: 0.9893174  Vali macro F1 0.9853234 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 6.246980667114258
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0165206  Vali Loss: 0.0283892 Vali Accuracy: 0.9903602  Vali weighted F1: 0.9903342  Vali macro F1 0.9864242 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 8 cost time: 6.2686522006988525
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0166023  Vali Loss: 0.0293458 Vali Accuracy: 0.9893455  Vali weighted F1: 0.9893139  Vali macro F1 0.9852824 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 9 cost time: 6.241759538650513
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0156565  Vali Loss: 0.0271229 Vali Accuracy: 0.9903602  Vali weighted F1: 0.9903448  Vali macro F1 0.9867336 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.269177675247192
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0174390  Vali Loss: 0.0318187 Vali Accuracy: 0.9893455  Vali weighted F1: 0.9892910  Vali macro F1 0.9859551 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 6.294966220855713
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0153007  Vali Loss: 0.0304810 Vali Accuracy: 0.9903602  Vali weighted F1: 0.9903339  Vali macro F1 0.9864215 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 6.245486497879028
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0146541  Vali Loss: 0.0292077 Vali Accuracy: 0.9903602  Vali weighted F1: 0.9903339  Vali macro F1 0.9864215 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 6.243693590164185
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0153195  Vali Loss: 0.0298036 Vali Accuracy: 0.9898529  Vali weighted F1: 0.9898042  Vali macro F1 0.9864358 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 14 cost time: 6.235673189163208
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0143479  Vali Loss: 0.0275101 Vali Accuracy: 0.9903602  Vali weighted F1: 0.9903446  Vali macro F1 0.9867570 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 6.2329323291778564
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0132845  Vali Loss: 0.0270522 Vali Accuracy: 0.9913749  Vali weighted F1: 0.9913527  Vali macro F1 0.9881332 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 6.245015382766724
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0139466  Vali Loss: 0.0275534 Vali Accuracy: 0.9908676  Vali weighted F1: 0.9908369  Vali macro F1 0.9875933 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 6.253676176071167
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0131708  Vali Loss: 0.0272280 Vali Accuracy: 0.9903602  Vali weighted F1: 0.9903262  Vali macro F1 0.9867263 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 6.26619815826416
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0128678  Vali Loss: 0.0271035 Vali Accuracy: 0.9908676  Vali weighted F1: 0.9908353  Vali macro F1 0.9875925 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9342710  Test weighted F1: 0.9320741  Test macro F1 0.9355301 
================ the 6 th CV Experiment ================ 
Leave one Out Experiment : The 7 Part as the test
[-] Target sampling weights:  [0.00014192 0.00017857 0.00096712 0.00121803 0.00047893 0.00060533]
Train data number :  18241
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2027
Test data number :  8061
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.412147283554077
VALI: Epoch: 1, Steps: 72 | Train Loss: 1.0282303  Vali Loss: 0.6765779 Vali Accuracy: 0.7271830  Vali weighted F1: 0.7014859  Vali macro F1 0.5121956 
Validation loss decreased (inf --> 0.676578).  Saving model ...
Epoch: 2 cost time: 6.412466287612915
VALI: Epoch: 2, Steps: 72 | Train Loss: 0.4744182  Vali Loss: 0.3124037 Vali Accuracy: 0.9008387  Vali weighted F1: 0.8986522  Vali macro F1 0.8765595 
new best score!!!!
Validation loss decreased (0.676578 --> 0.312404).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.400500059127808
VALI: Epoch: 3, Steps: 72 | Train Loss: 0.2749344  Vali Loss: 0.2211104 Vali Accuracy: 0.9314258  Vali weighted F1: 0.9293282  Vali macro F1 0.9148253 
new best score!!!!
Validation loss decreased (0.312404 --> 0.221110).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.408233165740967
VALI: Epoch: 4, Steps: 72 | Train Loss: 0.2019913  Vali Loss: 0.1542263 Vali Accuracy: 0.9481993  Vali weighted F1: 0.9483230  Vali macro F1 0.9342747 
new best score!!!!
Validation loss decreased (0.221110 --> 0.154226).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.41933536529541
VALI: Epoch: 5, Steps: 72 | Train Loss: 0.1628649  Vali Loss: 0.1338928 Vali Accuracy: 0.9526394  Vali weighted F1: 0.9528138  Vali macro F1 0.9394484 
new best score!!!!
Validation loss decreased (0.154226 --> 0.133893).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.433618068695068
VALI: Epoch: 6, Steps: 72 | Train Loss: 0.1401764  Vali Loss: 0.1214570 Vali Accuracy: 0.9620128  Vali weighted F1: 0.9616702  Vali macro F1 0.9525223 
new best score!!!!
Validation loss decreased (0.133893 --> 0.121457).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.433615684509277
VALI: Epoch: 7, Steps: 72 | Train Loss: 0.1269566  Vali Loss: 0.1154337 Vali Accuracy: 0.9605328  Vali weighted F1: 0.9603368  Vali macro F1 0.9506306 
new best score!!!!
Validation loss decreased (0.121457 --> 0.115434).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.441061019897461
VALI: Epoch: 8, Steps: 72 | Train Loss: 0.1180217  Vali Loss: 0.0843669 Vali Accuracy: 0.9738530  Vali weighted F1: 0.9739218  Vali macro F1 0.9659171 
new best score!!!!
Validation loss decreased (0.115434 --> 0.084367).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.43974757194519
VALI: Epoch: 9, Steps: 72 | Train Loss: 0.0963371  Vali Loss: 0.0776833 Vali Accuracy: 0.9753330  Vali weighted F1: 0.9755718  Vali macro F1 0.9676260 
new best score!!!!
Validation loss decreased (0.084367 --> 0.077683).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.414043426513672
VALI: Epoch: 10, Steps: 72 | Train Loss: 0.0901703  Vali Loss: 0.0866811 Vali Accuracy: 0.9708929  Vali weighted F1: 0.9705360  Vali macro F1 0.9632449 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.410436153411865
VALI: Epoch: 11, Steps: 72 | Train Loss: 0.0962186  Vali Loss: 0.0951383 Vali Accuracy: 0.9699063  Vali weighted F1: 0.9693754  Vali macro F1 0.9624313 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 12 cost time: 6.412590026855469
VALI: Epoch: 12, Steps: 72 | Train Loss: 0.0808064  Vali Loss: 0.0958521 Vali Accuracy: 0.9703996  Vali weighted F1: 0.9699304  Vali macro F1 0.9631968 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 13 cost time: 6.4141576290130615
VALI: Epoch: 13, Steps: 72 | Train Loss: 0.0721595  Vali Loss: 0.0662908 Vali Accuracy: 0.9787864  Vali weighted F1: 0.9788734  Vali macro F1 0.9727620 
new best score!!!!
Validation loss decreased (0.077683 --> 0.066291).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.455237865447998
VALI: Epoch: 14, Steps: 72 | Train Loss: 0.0680476  Vali Loss: 0.0666035 Vali Accuracy: 0.9782930  Vali weighted F1: 0.9783436  Vali macro F1 0.9716685 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.447468996047974
VALI: Epoch: 15, Steps: 72 | Train Loss: 0.0633904  Vali Loss: 0.1014472 Vali Accuracy: 0.9659595  Vali weighted F1: 0.9653248  Vali macro F1 0.9578075 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 16 cost time: 6.466655969619751
VALI: Epoch: 16, Steps: 72 | Train Loss: 0.0610989  Vali Loss: 0.0568885 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808330  Vali macro F1 0.9736957 
new best score!!!!
Validation loss decreased (0.066291 --> 0.056889).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.464261054992676
VALI: Epoch: 17, Steps: 72 | Train Loss: 0.0544763  Vali Loss: 0.0652505 Vali Accuracy: 0.9792797  Vali weighted F1: 0.9794584  Vali macro F1 0.9725080 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 6.461000680923462
VALI: Epoch: 18, Steps: 72 | Train Loss: 0.0561715  Vali Loss: 0.1160298 Vali Accuracy: 0.9674396  Vali weighted F1: 0.9667149  Vali macro F1 0.9611997 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 6.460971355438232
VALI: Epoch: 19, Steps: 72 | Train Loss: 0.0537563  Vali Loss: 0.0462277 Vali Accuracy: 0.9851998  Vali weighted F1: 0.9852523  Vali macro F1 0.9805549 
new best score!!!!
Validation loss decreased (0.056889 --> 0.046228).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.447657346725464
VALI: Epoch: 20, Steps: 72 | Train Loss: 0.0454490  Vali Loss: 0.0508775 Vali Accuracy: 0.9847065  Vali weighted F1: 0.9848104  Vali macro F1 0.9793919 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.44819188117981
VALI: Epoch: 21, Steps: 72 | Train Loss: 0.0401151  Vali Loss: 0.0461113 Vali Accuracy: 0.9847065  Vali weighted F1: 0.9847267  Vali macro F1 0.9795585 
new best score!!!!
Validation loss decreased (0.046228 --> 0.046111).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.451154947280884
VALI: Epoch: 22, Steps: 72 | Train Loss: 0.0410966  Vali Loss: 0.0700660 Vali Accuracy: 0.9787864  Vali weighted F1: 0.9786224  Vali macro F1 0.9718241 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.451813220977783
VALI: Epoch: 23, Steps: 72 | Train Loss: 0.0430697  Vali Loss: 0.0559975 Vali Accuracy: 0.9817464  Vali weighted F1: 0.9816896  Vali macro F1 0.9758028 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 6.4511518478393555
VALI: Epoch: 24, Steps: 72 | Train Loss: 0.0404777  Vali Loss: 0.0461661 Vali Accuracy: 0.9856931  Vali weighted F1: 0.9857006  Vali macro F1 0.9803378 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 25 cost time: 6.441306114196777
VALI: Epoch: 25, Steps: 72 | Train Loss: 0.0308759  Vali Loss: 0.0673674 Vali Accuracy: 0.9773064  Vali weighted F1: 0.9770982  Vali macro F1 0.9702335 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 26 cost time: 6.480168581008911
VALI: Epoch: 26, Steps: 72 | Train Loss: 0.0320045  Vali Loss: 0.0453325 Vali Accuracy: 0.9861865  Vali weighted F1: 0.9862646  Vali macro F1 0.9807281 
new best score!!!!
Validation loss decreased (0.046111 --> 0.045332).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.4704461097717285
VALI: Epoch: 27, Steps: 72 | Train Loss: 0.0338877  Vali Loss: 0.0409608 Vali Accuracy: 0.9871732  Vali weighted F1: 0.9872022  Vali macro F1 0.9822129 
new best score!!!!
Validation loss decreased (0.045332 --> 0.040961).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.455754518508911
VALI: Epoch: 28, Steps: 72 | Train Loss: 0.0285075  Vali Loss: 0.0389955 Vali Accuracy: 0.9886532  Vali weighted F1: 0.9886862  Vali macro F1 0.9845875 
new best score!!!!
Validation loss decreased (0.040961 --> 0.038995).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.459461688995361
VALI: Epoch: 29, Steps: 72 | Train Loss: 0.0302168  Vali Loss: 0.0417024 Vali Accuracy: 0.9871732  Vali weighted F1: 0.9872175  Vali macro F1 0.9822943 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 6.439220190048218
VALI: Epoch: 30, Steps: 72 | Train Loss: 0.0315059  Vali Loss: 0.0405387 Vali Accuracy: 0.9876665  Vali weighted F1: 0.9876861  Vali macro F1 0.9833409 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 6.4426984786987305
VALI: Epoch: 31, Steps: 72 | Train Loss: 0.0244258  Vali Loss: 0.0368824 Vali Accuracy: 0.9891465  Vali weighted F1: 0.9891556  Vali macro F1 0.9853487 
new best score!!!!
Validation loss decreased (0.038995 --> 0.036882).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.4693825244903564
VALI: Epoch: 32, Steps: 72 | Train Loss: 0.0200090  Vali Loss: 0.0429954 Vali Accuracy: 0.9871732  Vali weighted F1: 0.9872322  Vali macro F1 0.9829505 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 6.4595887660980225
VALI: Epoch: 33, Steps: 72 | Train Loss: 0.0236524  Vali Loss: 0.0454029 Vali Accuracy: 0.9856931  Vali weighted F1: 0.9857133  Vali macro F1 0.9799039 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 6.481516361236572
VALI: Epoch: 34, Steps: 72 | Train Loss: 0.0195296  Vali Loss: 0.0478060 Vali Accuracy: 0.9851998  Vali weighted F1: 0.9851760  Vali macro F1 0.9808247 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 35 cost time: 6.480491399765015
VALI: Epoch: 35, Steps: 72 | Train Loss: 0.0166300  Vali Loss: 0.0392987 Vali Accuracy: 0.9871732  Vali weighted F1: 0.9872360  Vali macro F1 0.9831653 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 36 cost time: 6.457289218902588
VALI: Epoch: 36, Steps: 72 | Train Loss: 0.0182188  Vali Loss: 0.0401127 Vali Accuracy: 0.9881598  Vali weighted F1: 0.9882050  Vali macro F1 0.9840992 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 37 cost time: 6.462645769119263
VALI: Epoch: 37, Steps: 72 | Train Loss: 0.0127167  Vali Loss: 0.0303419 Vali Accuracy: 0.9916132  Vali weighted F1: 0.9916192  Vali macro F1 0.9886293 
new best score!!!!
Validation loss decreased (0.036882 --> 0.030342).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 6.465107679367065
VALI: Epoch: 38, Steps: 72 | Train Loss: 0.0109273  Vali Loss: 0.0296962 Vali Accuracy: 0.9906265  Vali weighted F1: 0.9906606  Vali macro F1 0.9867914 
new best score!!!!
Validation loss decreased (0.030342 --> 0.029696).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 6.45677375793457
VALI: Epoch: 39, Steps: 72 | Train Loss: 0.0091377  Vali Loss: 0.0303875 Vali Accuracy: 0.9906265  Vali weighted F1: 0.9906459  Vali macro F1 0.9875741 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 6.4614996910095215
VALI: Epoch: 40, Steps: 72 | Train Loss: 0.0079666  Vali Loss: 0.0331129 Vali Accuracy: 0.9906265  Vali weighted F1: 0.9906544  Vali macro F1 0.9872834 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 6.463023900985718
VALI: Epoch: 41, Steps: 72 | Train Loss: 0.0089221  Vali Loss: 0.0308372 Vali Accuracy: 0.9906265  Vali weighted F1: 0.9906435  Vali macro F1 0.9865352 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 6.491518259048462
VALI: Epoch: 42, Steps: 72 | Train Loss: 0.0077198  Vali Loss: 0.0313631 Vali Accuracy: 0.9906265  Vali weighted F1: 0.9906625  Vali macro F1 0.9870476 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 6.478546857833862
VALI: Epoch: 43, Steps: 72 | Train Loss: 0.0082191  Vali Loss: 0.0310563 Vali Accuracy: 0.9921066  Vali weighted F1: 0.9921359  Vali macro F1 0.9887855 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 44 cost time: 6.463393449783325
VALI: Epoch: 44, Steps: 72 | Train Loss: 0.0071630  Vali Loss: 0.0308024 Vali Accuracy: 0.9916132  Vali weighted F1: 0.9916383  Vali macro F1 0.9883149 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 6.4680869579315186
VALI: Epoch: 45, Steps: 72 | Train Loss: 0.0076879  Vali Loss: 0.0307858 Vali Accuracy: 0.9916132  Vali weighted F1: 0.9916383  Vali macro F1 0.9883149 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 6.456976890563965
VALI: Epoch: 46, Steps: 72 | Train Loss: 0.0070170  Vali Loss: 0.0304813 Vali Accuracy: 0.9916132  Vali weighted F1: 0.9916383  Vali macro F1 0.9883149 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 6.465338468551636
VALI: Epoch: 47, Steps: 72 | Train Loss: 0.0084786  Vali Loss: 0.0305882 Vali Accuracy: 0.9916132  Vali weighted F1: 0.9916383  Vali macro F1 0.9883149 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 6.465260028839111
VALI: Epoch: 48, Steps: 72 | Train Loss: 0.0081555  Vali Loss: 0.0305912 Vali Accuracy: 0.9916132  Vali weighted F1: 0.9916383  Vali macro F1 0.9883149 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 49 cost time: 6.4661219120025635
VALI: Epoch: 49, Steps: 72 | Train Loss: 0.0071139  Vali Loss: 0.0305667 Vali Accuracy: 0.9916132  Vali weighted F1: 0.9916383  Vali macro F1 0.9883149 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 6.484265565872192
VALI: Epoch: 50, Steps: 72 | Train Loss: 0.0073439  Vali Loss: 0.0305502 Vali Accuracy: 0.9916132  Vali weighted F1: 0.9916383  Vali macro F1 0.9883149 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 6.475258827209473
VALI: Epoch: 51, Steps: 72 | Train Loss: 0.0066618  Vali Loss: 0.0305339 Vali Accuracy: 0.9916132  Vali weighted F1: 0.9916383  Vali macro F1 0.9883149 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 6.462830305099487
VALI: Epoch: 52, Steps: 72 | Train Loss: 0.0068689  Vali Loss: 0.0304923 Vali Accuracy: 0.9916132  Vali weighted F1: 0.9916383  Vali macro F1 0.9883149 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 6.467833757400513
VALI: Epoch: 53, Steps: 72 | Train Loss: 0.0082991  Vali Loss: 0.0305185 Vali Accuracy: 0.9916132  Vali weighted F1: 0.9916383  Vali macro F1 0.9883149 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8716040  Test weighted F1: 0.8638204  Test macro F1 0.6602321 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 240495
pruned model Parameter : 244174
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.540973663330078
Fine Tuning VALI: Epoch: 1, Steps: 72 | Train Loss: 0.0103954  Vali Loss: 0.0319905 Vali Accuracy: 0.9891465  Vali weighted F1: 0.9891831  Vali macro F1 0.9849736 
Validation loss decreased (inf --> 0.031991).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.528263807296753
Fine Tuning VALI: Epoch: 2, Steps: 72 | Train Loss: 0.0091528  Vali Loss: 0.0300983 Vali Accuracy: 0.9901332  Vali weighted F1: 0.9901564  Vali macro F1 0.9860292 
new best score!!!!
Validation loss decreased (0.031991 --> 0.030098).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.519582986831665
Fine Tuning VALI: Epoch: 3, Steps: 72 | Train Loss: 0.0079475  Vali Loss: 0.0303031 Vali Accuracy: 0.9911199  Vali weighted F1: 0.9911515  Vali macro F1 0.9878090 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.521328449249268
Fine Tuning VALI: Epoch: 4, Steps: 72 | Train Loss: 0.0073745  Vali Loss: 0.0316815 Vali Accuracy: 0.9906265  Vali weighted F1: 0.9906452  Vali macro F1 0.9871692 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.550755023956299
Fine Tuning VALI: Epoch: 5, Steps: 72 | Train Loss: 0.0064421  Vali Loss: 0.0295332 Vali Accuracy: 0.9896399  Vali weighted F1: 0.9896897  Vali macro F1 0.9850278 
new best score!!!!
Validation loss decreased (0.030098 --> 0.029533).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.514503002166748
Fine Tuning VALI: Epoch: 6, Steps: 72 | Train Loss: 0.0068432  Vali Loss: 0.0295896 Vali Accuracy: 0.9896399  Vali weighted F1: 0.9896646  Vali macro F1 0.9851030 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.489020109176636
Fine Tuning VALI: Epoch: 7, Steps: 72 | Train Loss: 0.0074362  Vali Loss: 0.0321469 Vali Accuracy: 0.9906265  Vali weighted F1: 0.9906503  Vali macro F1 0.9861894 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.511398077011108
Fine Tuning VALI: Epoch: 8, Steps: 72 | Train Loss: 0.0066377  Vali Loss: 0.0330767 Vali Accuracy: 0.9906265  Vali weighted F1: 0.9906316  Vali macro F1 0.9874407 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.51036262512207
Fine Tuning VALI: Epoch: 9, Steps: 72 | Train Loss: 0.0062556  Vali Loss: 0.0328663 Vali Accuracy: 0.9921066  Vali weighted F1: 0.9921315  Vali macro F1 0.9890106 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.517559051513672
Fine Tuning VALI: Epoch: 10, Steps: 72 | Train Loss: 0.0059075  Vali Loss: 0.0320155 Vali Accuracy: 0.9896399  Vali weighted F1: 0.9896897  Vali macro F1 0.9850278 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 11 cost time: 6.53220534324646
Fine Tuning VALI: Epoch: 11, Steps: 72 | Train Loss: 0.0059128  Vali Loss: 0.0322345 Vali Accuracy: 0.9886532  Vali weighted F1: 0.9886706  Vali macro F1 0.9845565 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.5301103591918945
Fine Tuning VALI: Epoch: 12, Steps: 72 | Train Loss: 0.0081213  Vali Loss: 0.0305078 Vali Accuracy: 0.9906265  Vali weighted F1: 0.9906542  Vali macro F1 0.9865007 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.5402445793151855
Fine Tuning VALI: Epoch: 13, Steps: 72 | Train Loss: 0.0059569  Vali Loss: 0.0312984 Vali Accuracy: 0.9921066  Vali weighted F1: 0.9921213  Vali macro F1 0.9883502 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.536778450012207
Fine Tuning VALI: Epoch: 14, Steps: 72 | Train Loss: 0.0060204  Vali Loss: 0.0320407 Vali Accuracy: 0.9911199  Vali weighted F1: 0.9911548  Vali macro F1 0.9871019 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.53027606010437
Fine Tuning VALI: Epoch: 15, Steps: 72 | Train Loss: 0.0054179  Vali Loss: 0.0341562 Vali Accuracy: 0.9916132  Vali weighted F1: 0.9916485  Vali macro F1 0.9879012 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 16 cost time: 6.533136606216431
Fine Tuning VALI: Epoch: 16, Steps: 72 | Train Loss: 0.0051221  Vali Loss: 0.0330468 Vali Accuracy: 0.9906265  Vali weighted F1: 0.9906554  Vali macro F1 0.9864506 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 6.525284051895142
Fine Tuning VALI: Epoch: 17, Steps: 72 | Train Loss: 0.0044459  Vali Loss: 0.0327903 Vali Accuracy: 0.9911199  Vali weighted F1: 0.9911415  Vali macro F1 0.9869807 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 6.526052713394165
Fine Tuning VALI: Epoch: 18, Steps: 72 | Train Loss: 0.0047665  Vali Loss: 0.0324267 Vali Accuracy: 0.9916132  Vali weighted F1: 0.9916389  Vali macro F1 0.9875326 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 6.538456916809082
Fine Tuning VALI: Epoch: 19, Steps: 72 | Train Loss: 0.0044260  Vali Loss: 0.0320947 Vali Accuracy: 0.9911199  Vali weighted F1: 0.9911415  Vali macro F1 0.9869807 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 6.531546115875244
Fine Tuning VALI: Epoch: 20, Steps: 72 | Train Loss: 0.0045292  Vali Loss: 0.0324691 Vali Accuracy: 0.9916132  Vali weighted F1: 0.9916389  Vali macro F1 0.9875326 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8701154  Test weighted F1: 0.8619337  Test macro F1 0.6578145 
================ the 7 th CV Experiment ================ 
Leave one Out Experiment : The 8 Part as the test
[-] Target sampling weights:  [0.00014422 0.00016992 0.000999   0.00131579 0.00050025 0.00062814]
Train data number :  18171
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2019
Test data number :  8450
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.444092750549316
VALI: Epoch: 1, Steps: 71 | Train Loss: 0.9823191  Vali Loss: 0.5146545 Vali Accuracy: 0.8162457  Vali weighted F1: 0.7910506  Vali macro F1 0.6743541 
Validation loss decreased (inf --> 0.514655).  Saving model ...
Epoch: 2 cost time: 6.439014434814453
VALI: Epoch: 2, Steps: 71 | Train Loss: 0.4497691  Vali Loss: 0.3478517 Vali Accuracy: 0.8727093  Vali weighted F1: 0.8661203  Vali macro F1 0.8188236 
new best score!!!!
Validation loss decreased (0.514655 --> 0.347852).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.421347379684448
VALI: Epoch: 3, Steps: 71 | Train Loss: 0.2928758  Vali Loss: 0.2231595 Vali Accuracy: 0.9172858  Vali weighted F1: 0.9138905  Vali macro F1 0.8803447 
new best score!!!!
Validation loss decreased (0.347852 --> 0.223160).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.407411575317383
VALI: Epoch: 4, Steps: 71 | Train Loss: 0.2172835  Vali Loss: 0.1764050 Vali Accuracy: 0.9430411  Vali weighted F1: 0.9432396  Vali macro F1 0.9129773 
new best score!!!!
Validation loss decreased (0.223160 --> 0.176405).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.419304609298706
VALI: Epoch: 5, Steps: 71 | Train Loss: 0.1853088  Vali Loss: 0.1369221 Vali Accuracy: 0.9524517  Vali weighted F1: 0.9512626  Vali macro F1 0.9274362 
new best score!!!!
Validation loss decreased (0.176405 --> 0.136922).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.411571502685547
VALI: Epoch: 6, Steps: 71 | Train Loss: 0.1552533  Vali Loss: 0.1359968 Vali Accuracy: 0.9524517  Vali weighted F1: 0.9529317  Vali macro F1 0.9294297 
new best score!!!!
Validation loss decreased (0.136922 --> 0.135997).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.423628807067871
VALI: Epoch: 7, Steps: 71 | Train Loss: 0.1341810  Vali Loss: 0.1251558 Vali Accuracy: 0.9544329  Vali weighted F1: 0.9534383  Vali macro F1 0.9311028 
new best score!!!!
Validation loss decreased (0.135997 --> 0.125156).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.420958042144775
VALI: Epoch: 8, Steps: 71 | Train Loss: 0.1299027  Vali Loss: 0.1107701 Vali Accuracy: 0.9598811  Vali weighted F1: 0.9595615  Vali macro F1 0.9433948 
new best score!!!!
Validation loss decreased (0.125156 --> 0.110770).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.420289754867554
VALI: Epoch: 9, Steps: 71 | Train Loss: 0.1165243  Vali Loss: 0.0945025 Vali Accuracy: 0.9653294  Vali weighted F1: 0.9653876  Vali macro F1 0.9520136 
new best score!!!!
Validation loss decreased (0.110770 --> 0.094502).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.436010837554932
VALI: Epoch: 10, Steps: 71 | Train Loss: 0.1067863  Vali Loss: 0.0969953 Vali Accuracy: 0.9653294  Vali weighted F1: 0.9655269  Vali macro F1 0.9480607 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.43792986869812
VALI: Epoch: 11, Steps: 71 | Train Loss: 0.0970065  Vali Loss: 0.0937639 Vali Accuracy: 0.9668153  Vali weighted F1: 0.9664000  Vali macro F1 0.9526103 
new best score!!!!
Validation loss decreased (0.094502 --> 0.093764).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.434102296829224
VALI: Epoch: 12, Steps: 71 | Train Loss: 0.0888816  Vali Loss: 0.0739928 Vali Accuracy: 0.9742447  Vali weighted F1: 0.9738263  Vali macro F1 0.9630054 
new best score!!!!
Validation loss decreased (0.093764 --> 0.073993).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.419822454452515
VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0909971  Vali Loss: 0.0720983 Vali Accuracy: 0.9717682  Vali weighted F1: 0.9717494  Vali macro F1 0.9571469 
new best score!!!!
Validation loss decreased (0.073993 --> 0.072098).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.432040452957153
VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0729086  Vali Loss: 0.0594855 Vali Accuracy: 0.9796929  Vali weighted F1: 0.9796998  Vali macro F1 0.9698241 
new best score!!!!
Validation loss decreased (0.072098 --> 0.059485).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.419068336486816
VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0659382  Vali Loss: 0.0622257 Vali Accuracy: 0.9791976  Vali weighted F1: 0.9791732  Vali macro F1 0.9689221 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.431727170944214
VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0720122  Vali Loss: 0.0613279 Vali Accuracy: 0.9772164  Vali weighted F1: 0.9771012  Vali macro F1 0.9655138 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 17 cost time: 6.422420263290405
VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0628949  Vali Loss: 0.0666719 Vali Accuracy: 0.9767211  Vali weighted F1: 0.9765082  Vali macro F1 0.9668742 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 18 cost time: 6.44174599647522
VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0554296  Vali Loss: 0.0592263 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9808236  Vali macro F1 0.9730306 
new best score!!!!
Validation loss decreased (0.059485 --> 0.059226).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.450630187988281
VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0508734  Vali Loss: 0.0522710 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9826807  Vali macro F1 0.9744131 
new best score!!!!
Validation loss decreased (0.059226 --> 0.052271).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.41510272026062
VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0471595  Vali Loss: 0.0576506 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9802627  Vali macro F1 0.9708258 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.412791013717651
VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0579201  Vali Loss: 0.0535609 Vali Accuracy: 0.9816741  Vali weighted F1: 0.9816831  Vali macro F1 0.9719822 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 6.414861679077148
VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0428843  Vali Loss: 0.0467652 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9837237  Vali macro F1 0.9755529 
new best score!!!!
Validation loss decreased (0.052271 --> 0.046765).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.418453931808472
VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0391904  Vali Loss: 0.0463799 Vali Accuracy: 0.9816741  Vali weighted F1: 0.9817636  Vali macro F1 0.9740110 
new best score!!!!
Validation loss decreased (0.046765 --> 0.046380).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.416553020477295
VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0354353  Vali Loss: 0.0391911 Vali Accuracy: 0.9856365  Vali weighted F1: 0.9856016  Vali macro F1 0.9791116 
new best score!!!!
Validation loss decreased (0.046380 --> 0.039191).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.420147180557251
VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0340002  Vali Loss: 0.0495900 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9807083  Vali macro F1 0.9727031 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 6.447819232940674
VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0378963  Vali Loss: 0.0444176 Vali Accuracy: 0.9856365  Vali weighted F1: 0.9856684  Vali macro F1 0.9773773 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 6.434036731719971
VALI: Epoch: 27, Steps: 71 | Train Loss: 0.0321387  Vali Loss: 0.0447196 Vali Accuracy: 0.9841506  Vali weighted F1: 0.9842319  Vali macro F1 0.9765021 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 28 cost time: 6.4219701290130615
VALI: Epoch: 28, Steps: 71 | Train Loss: 0.0261119  Vali Loss: 0.0406885 Vali Accuracy: 0.9891035  Vali weighted F1: 0.9891291  Vali macro F1 0.9838609 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 29 cost time: 6.427942276000977
VALI: Epoch: 29, Steps: 71 | Train Loss: 0.0247043  Vali Loss: 0.0815659 Vali Accuracy: 0.9747400  Vali weighted F1: 0.9747017  Vali macro F1 0.9658121 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 30 cost time: 6.427507400512695
VALI: Epoch: 30, Steps: 71 | Train Loss: 0.0209842  Vali Loss: 0.0375670 Vali Accuracy: 0.9886082  Vali weighted F1: 0.9885931  Vali macro F1 0.9830808 
new best score!!!!
Validation loss decreased (0.039191 --> 0.037567).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.409935235977173
VALI: Epoch: 31, Steps: 71 | Train Loss: 0.0160309  Vali Loss: 0.0369161 Vali Accuracy: 0.9881129  Vali weighted F1: 0.9881421  Vali macro F1 0.9826787 
new best score!!!!
Validation loss decreased (0.037567 --> 0.036916).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.416392803192139
VALI: Epoch: 32, Steps: 71 | Train Loss: 0.0144820  Vali Loss: 0.0367238 Vali Accuracy: 0.9881129  Vali weighted F1: 0.9881059  Vali macro F1 0.9819674 
new best score!!!!
Validation loss decreased (0.036916 --> 0.036724).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.4140849113464355
VALI: Epoch: 33, Steps: 71 | Train Loss: 0.0143995  Vali Loss: 0.0358510 Vali Accuracy: 0.9891035  Vali weighted F1: 0.9890855  Vali macro F1 0.9834131 
new best score!!!!
Validation loss decreased (0.036724 --> 0.035851).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.440149784088135
VALI: Epoch: 34, Steps: 71 | Train Loss: 0.0135499  Vali Loss: 0.0364080 Vali Accuracy: 0.9881129  Vali weighted F1: 0.9881001  Vali macro F1 0.9820940 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 6.434623718261719
VALI: Epoch: 35, Steps: 71 | Train Loss: 0.0133558  Vali Loss: 0.0370146 Vali Accuracy: 0.9891035  Vali weighted F1: 0.9890855  Vali macro F1 0.9834131 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 6.434551000595093
VALI: Epoch: 36, Steps: 71 | Train Loss: 0.0137882  Vali Loss: 0.0376728 Vali Accuracy: 0.9886082  Vali weighted F1: 0.9886022  Vali macro F1 0.9828516 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 6.4243879318237305
VALI: Epoch: 37, Steps: 71 | Train Loss: 0.0120845  Vali Loss: 0.0376970 Vali Accuracy: 0.9891035  Vali weighted F1: 0.9890899  Vali macro F1 0.9833253 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 6.4291229248046875
VALI: Epoch: 38, Steps: 71 | Train Loss: 0.0128430  Vali Loss: 0.0377389 Vali Accuracy: 0.9866270  Vali weighted F1: 0.9866655  Vali macro F1 0.9801607 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 39 cost time: 6.424353122711182
VALI: Epoch: 39, Steps: 71 | Train Loss: 0.0114047  Vali Loss: 0.0373817 Vali Accuracy: 0.9876176  Vali weighted F1: 0.9876447  Vali macro F1 0.9819492 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 6.433792591094971
VALI: Epoch: 40, Steps: 71 | Train Loss: 0.0119059  Vali Loss: 0.0372655 Vali Accuracy: 0.9891035  Vali weighted F1: 0.9891096  Vali macro F1 0.9833659 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 6.429567575454712
VALI: Epoch: 41, Steps: 71 | Train Loss: 0.0117735  Vali Loss: 0.0373293 Vali Accuracy: 0.9886082  Vali weighted F1: 0.9886160  Vali macro F1 0.9825167 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 6.448380708694458
VALI: Epoch: 42, Steps: 71 | Train Loss: 0.0111573  Vali Loss: 0.0373551 Vali Accuracy: 0.9891035  Vali weighted F1: 0.9891096  Vali macro F1 0.9833659 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 6.449721336364746
VALI: Epoch: 43, Steps: 71 | Train Loss: 0.0123408  Vali Loss: 0.0373194 Vali Accuracy: 0.9891035  Vali weighted F1: 0.9891096  Vali macro F1 0.9833659 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 44 cost time: 6.4298341274261475
VALI: Epoch: 44, Steps: 71 | Train Loss: 0.0119404  Vali Loss: 0.0372894 Vali Accuracy: 0.9891035  Vali weighted F1: 0.9891096  Vali macro F1 0.9833659 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 6.434202194213867
VALI: Epoch: 45, Steps: 71 | Train Loss: 0.0113087  Vali Loss: 0.0372636 Vali Accuracy: 0.9891035  Vali weighted F1: 0.9891096  Vali macro F1 0.9833659 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 6.424343585968018
VALI: Epoch: 46, Steps: 71 | Train Loss: 0.0118312  Vali Loss: 0.0372522 Vali Accuracy: 0.9891035  Vali weighted F1: 0.9891096  Vali macro F1 0.9833659 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 6.437407970428467
VALI: Epoch: 47, Steps: 71 | Train Loss: 0.0116739  Vali Loss: 0.0372647 Vali Accuracy: 0.9891035  Vali weighted F1: 0.9891096  Vali macro F1 0.9833659 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 6.432581424713135
VALI: Epoch: 48, Steps: 71 | Train Loss: 0.0120307  Vali Loss: 0.0372509 Vali Accuracy: 0.9891035  Vali weighted F1: 0.9891096  Vali macro F1 0.9833659 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8402367  Test weighted F1: 0.8405682  Test macro F1 0.8097656 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 240495
pruned model Parameter : 244174
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.467783689498901
Fine Tuning VALI: Epoch: 1, Steps: 71 | Train Loss: 0.0148241  Vali Loss: 0.0377466 Vali Accuracy: 0.9861317  Vali weighted F1: 0.9861546  Vali macro F1 0.9796074 
Validation loss decreased (inf --> 0.037747).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.468810796737671
Fine Tuning VALI: Epoch: 2, Steps: 71 | Train Loss: 0.0141191  Vali Loss: 0.0379355 Vali Accuracy: 0.9891035  Vali weighted F1: 0.9891474  Vali macro F1 0.9837764 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 8.095700740814209
Fine Tuning VALI: Epoch: 3, Steps: 71 | Train Loss: 0.0126603  Vali Loss: 0.0394630 Vali Accuracy: 0.9866270  Vali weighted F1: 0.9866389  Vali macro F1 0.9810096 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.465786695480347
Fine Tuning VALI: Epoch: 4, Steps: 71 | Train Loss: 0.0123828  Vali Loss: 0.0387536 Vali Accuracy: 0.9871223  Vali weighted F1: 0.9871425  Vali macro F1 0.9813386 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.461781740188599
Fine Tuning VALI: Epoch: 5, Steps: 71 | Train Loss: 0.0113982  Vali Loss: 0.0384825 Vali Accuracy: 0.9871223  Vali weighted F1: 0.9871776  Vali macro F1 0.9816070 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.449545860290527
Fine Tuning VALI: Epoch: 6, Steps: 71 | Train Loss: 0.0118502  Vali Loss: 0.0418629 Vali Accuracy: 0.9871223  Vali weighted F1: 0.9872138  Vali macro F1 0.9811791 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.4616382122039795
Fine Tuning VALI: Epoch: 7, Steps: 71 | Train Loss: 0.0121949  Vali Loss: 0.0335335 Vali Accuracy: 0.9900941  Vali weighted F1: 0.9900990  Vali macro F1 0.9844479 
new best score!!!!
Validation loss decreased (0.037747 --> 0.033533).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 6.467106580734253
Fine Tuning VALI: Epoch: 8, Steps: 71 | Train Loss: 0.0117242  Vali Loss: 0.0351039 Vali Accuracy: 0.9876176  Vali weighted F1: 0.9875935  Vali macro F1 0.9815713 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.46695351600647
Fine Tuning VALI: Epoch: 9, Steps: 71 | Train Loss: 0.0114116  Vali Loss: 0.0357516 Vali Accuracy: 0.9886082  Vali weighted F1: 0.9886019  Vali macro F1 0.9828308 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 6.470098495483398
Fine Tuning VALI: Epoch: 10, Steps: 71 | Train Loss: 0.0110471  Vali Loss: 0.0360726 Vali Accuracy: 0.9891035  Vali weighted F1: 0.9891762  Vali macro F1 0.9844137 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 6.480780124664307
Fine Tuning VALI: Epoch: 11, Steps: 71 | Train Loss: 0.0102724  Vali Loss: 0.0337858 Vali Accuracy: 0.9900941  Vali weighted F1: 0.9901361  Vali macro F1 0.9848664 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 6.480011224746704
Fine Tuning VALI: Epoch: 12, Steps: 71 | Train Loss: 0.0100640  Vali Loss: 0.0344817 Vali Accuracy: 0.9895988  Vali weighted F1: 0.9896115  Vali macro F1 0.9844492 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 13 cost time: 6.466249942779541
Fine Tuning VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0099854  Vali Loss: 0.0346950 Vali Accuracy: 0.9886082  Vali weighted F1: 0.9886090  Vali macro F1 0.9830825 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.463110685348511
Fine Tuning VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0097053  Vali Loss: 0.0353248 Vali Accuracy: 0.9891035  Vali weighted F1: 0.9891485  Vali macro F1 0.9832905 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.521399259567261
Fine Tuning VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0095508  Vali Loss: 0.0349255 Vali Accuracy: 0.9886082  Vali weighted F1: 0.9886215  Vali macro F1 0.9827450 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.455175399780273
Fine Tuning VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0091306  Vali Loss: 0.0351916 Vali Accuracy: 0.9881129  Vali weighted F1: 0.9881295  Vali macro F1 0.9818891 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 6.468965291976929
Fine Tuning VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0086766  Vali Loss: 0.0352650 Vali Accuracy: 0.9881129  Vali weighted F1: 0.9880999  Vali macro F1 0.9820940 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 18 cost time: 6.458200931549072
Fine Tuning VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0090366  Vali Loss: 0.0352564 Vali Accuracy: 0.9891035  Vali weighted F1: 0.9891088  Vali macro F1 0.9832273 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 6.470177412033081
Fine Tuning VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0085382  Vali Loss: 0.0352073 Vali Accuracy: 0.9891035  Vali weighted F1: 0.9891088  Vali macro F1 0.9832273 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 6.470911502838135
Fine Tuning VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0085061  Vali Loss: 0.0352273 Vali Accuracy: 0.9886082  Vali weighted F1: 0.9886215  Vali macro F1 0.9827450 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 6.474954605102539
Fine Tuning VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0082907  Vali Loss: 0.0352123 Vali Accuracy: 0.9886082  Vali weighted F1: 0.9886215  Vali macro F1 0.9827450 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 6.454280614852905
Fine Tuning VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0085256  Vali Loss: 0.0352283 Vali Accuracy: 0.9886082  Vali weighted F1: 0.9886215  Vali macro F1 0.9827450 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8453254  Test weighted F1: 0.8448497  Test macro F1 0.8105589 
================ the 8 th CV Experiment ================ 
Leave one Out Experiment : The 9 Part as the test
[-] Target sampling weights:  [0.00014641 0.00017768 0.00108108 0.00133156 0.0005     0.00062461]
Train data number :  17735
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1971
Test data number :  10867
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.318403244018555
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.0605390  Vali Loss: 0.6829906 Vali Accuracy: 0.7513952  Vali weighted F1: 0.6899830  Vali macro F1 0.4675161 
Validation loss decreased (inf --> 0.682991).  Saving model ...
Epoch: 2 cost time: 6.273927688598633
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.5188311  Vali Loss: 0.3965283 Vali Accuracy: 0.8650431  Vali weighted F1: 0.8558017  Vali macro F1 0.8204625 
new best score!!!!
Validation loss decreased (0.682991 --> 0.396528).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.288539409637451
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.3672092  Vali Loss: 0.3112553 Vali Accuracy: 0.8959919  Vali weighted F1: 0.8879908  Vali macro F1 0.8630105 
new best score!!!!
Validation loss decreased (0.396528 --> 0.311255).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.283246278762817
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.2614981  Vali Loss: 0.2158750 Vali Accuracy: 0.9269406  Vali weighted F1: 0.9245819  Vali macro F1 0.9069709 
new best score!!!!
Validation loss decreased (0.311255 --> 0.215875).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.3141398429870605
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.2041318  Vali Loss: 0.1884515 Vali Accuracy: 0.9401319  Vali weighted F1: 0.9377997  Vali macro F1 0.9273311 
new best score!!!!
Validation loss decreased (0.215875 --> 0.188451).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.308958053588867
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.1665678  Vali Loss: 0.1554740 Vali Accuracy: 0.9497717  Vali weighted F1: 0.9486862  Vali macro F1 0.9348126 
new best score!!!!
Validation loss decreased (0.188451 --> 0.155474).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.291648626327515
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.1535649  Vali Loss: 0.1253813 Vali Accuracy: 0.9553526  Vali weighted F1: 0.9544041  Vali macro F1 0.9474325 
new best score!!!!
Validation loss decreased (0.155474 --> 0.125381).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.306621313095093
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1279050  Vali Loss: 0.1081409 Vali Accuracy: 0.9670218  Vali weighted F1: 0.9666213  Vali macro F1 0.9616591 
new best score!!!!
Validation loss decreased (0.125381 --> 0.108141).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.3166844844818115
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1177377  Vali Loss: 0.1137045 Vali Accuracy: 0.9634703  Vali weighted F1: 0.9634379  Vali macro F1 0.9558784 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 6.307378530502319
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1161559  Vali Loss: 0.0961631 Vali Accuracy: 0.9670218  Vali weighted F1: 0.9667531  Vali macro F1 0.9627694 
new best score!!!!
Validation loss decreased (0.108141 --> 0.096163).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.308278560638428
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0999787  Vali Loss: 0.0928364 Vali Accuracy: 0.9680365  Vali weighted F1: 0.9679673  Vali macro F1 0.9617048 
new best score!!!!
Validation loss decreased (0.096163 --> 0.092836).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.349909543991089
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0972458  Vali Loss: 0.0929009 Vali Accuracy: 0.9720954  Vali weighted F1: 0.9720139  Vali macro F1 0.9674371 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 6.300992012023926
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0880555  Vali Loss: 0.0777057 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9782972  Vali macro F1 0.9740476 
new best score!!!!
Validation loss decreased (0.092836 --> 0.077706).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.297155380249023
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0917315  Vali Loss: 0.0808626 Vali Accuracy: 0.9731101  Vali weighted F1: 0.9732502  Vali macro F1 0.9677491 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.308085680007935
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0715327  Vali Loss: 0.0775461 Vali Accuracy: 0.9766616  Vali weighted F1: 0.9764336  Vali macro F1 0.9722817 
new best score!!!!
Validation loss decreased (0.077706 --> 0.077546).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.312723875045776
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0645559  Vali Loss: 0.0663518 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9806731  Vali macro F1 0.9778985 
new best score!!!!
Validation loss decreased (0.077546 --> 0.066352).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.298627138137817
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0679240  Vali Loss: 0.0661161 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9801953  Vali macro F1 0.9747978 
new best score!!!!
Validation loss decreased (0.066352 --> 0.066116).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.329946041107178
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0611075  Vali Loss: 0.0590242 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9817119  Vali macro F1 0.9792072 
new best score!!!!
Validation loss decreased (0.066116 --> 0.059024).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.285499572753906
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0635353  Vali Loss: 0.0607980 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9803002  Vali macro F1 0.9731910 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 6.298698663711548
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0499647  Vali Loss: 0.0620386 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9831904  Vali macro F1 0.9769502 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 6.289430856704712
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0545334  Vali Loss: 0.0997704 Vali Accuracy: 0.9705733  Vali weighted F1: 0.9702333  Vali macro F1 0.9659524 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 22 cost time: 6.302248477935791
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0587044  Vali Loss: 0.0520457 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9823910  Vali macro F1 0.9768045 
new best score!!!!
Validation loss decreased (0.059024 --> 0.052046).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.30668568611145
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0432819  Vali Loss: 0.0501222 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9858702  Vali macro F1 0.9816216 
new best score!!!!
Validation loss decreased (0.052046 --> 0.050122).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.327516555786133
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0419719  Vali Loss: 0.0557934 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9812551  Vali macro F1 0.9783037 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 6.323790073394775
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0403364  Vali Loss: 0.0859600 Vali Accuracy: 0.9746322  Vali weighted F1: 0.9740946  Vali macro F1 0.9702775 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 6.295949220657349
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0434691  Vali Loss: 0.0472312 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852778  Vali macro F1 0.9832139 
new best score!!!!
Validation loss decreased (0.050122 --> 0.047231).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.288551330566406
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0405433  Vali Loss: 0.0574558 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9815908  Vali macro F1 0.9788645 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.2924323081970215
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0360942  Vali Loss: 0.0475336 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9863280  Vali macro F1 0.9820876 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 6.289472579956055
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0318086  Vali Loss: 0.0474705 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9843132  Vali macro F1 0.9801227 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 6.293630838394165
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0360560  Vali Loss: 0.0492160 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847118  Vali macro F1 0.9825720 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 31 cost time: 6.29506516456604
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0256393  Vali Loss: 0.0664816 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9788636  Vali macro F1 0.9770118 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 32 cost time: 6.32623028755188
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0198223  Vali Loss: 0.0364297 Vali Accuracy: 0.9873161  Vali weighted F1: 0.9873082  Vali macro F1 0.9853105 
new best score!!!!
Validation loss decreased (0.047231 --> 0.036430).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.322439432144165
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0163645  Vali Loss: 0.0367132 Vali Accuracy: 0.9883308  Vali weighted F1: 0.9883066  Vali macro F1 0.9864824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 6.307925462722778
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0158797  Vali Loss: 0.0359779 Vali Accuracy: 0.9893455  Vali weighted F1: 0.9893332  Vali macro F1 0.9876604 
new best score!!!!
Validation loss decreased (0.036430 --> 0.035978).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 6.296273708343506
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0145382  Vali Loss: 0.0369410 Vali Accuracy: 0.9873161  Vali weighted F1: 0.9873308  Vali macro F1 0.9851491 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 6.281501293182373
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0153009  Vali Loss: 0.0367981 Vali Accuracy: 0.9883308  Vali weighted F1: 0.9883302  Vali macro F1 0.9867503 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 6.286483526229858
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0136433  Vali Loss: 0.0368383 Vali Accuracy: 0.9883308  Vali weighted F1: 0.9883232  Vali macro F1 0.9864039 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 6.29425835609436
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0145484  Vali Loss: 0.0368169 Vali Accuracy: 0.9883308  Vali weighted F1: 0.9883321  Vali macro F1 0.9860567 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 6.283890247344971
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0128967  Vali Loss: 0.0383449 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9867829  Vali macro F1 0.9845994 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 40 cost time: 6.29540228843689
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0129757  Vali Loss: 0.0372853 Vali Accuracy: 0.9873161  Vali weighted F1: 0.9872993  Vali macro F1 0.9851947 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 6.321968078613281
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0126580  Vali Loss: 0.0373287 Vali Accuracy: 0.9883308  Vali weighted F1: 0.9883168  Vali macro F1 0.9860235 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 6.302981853485107
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0127239  Vali Loss: 0.0378452 Vali Accuracy: 0.9878234  Vali weighted F1: 0.9878007  Vali macro F1 0.9855328 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 6.294526100158691
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0130547  Vali Loss: 0.0375775 Vali Accuracy: 0.9878234  Vali weighted F1: 0.9878007  Vali macro F1 0.9855328 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 44 cost time: 7.811736822128296
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0128233  Vali Loss: 0.0376686 Vali Accuracy: 0.9878234  Vali weighted F1: 0.9878007  Vali macro F1 0.9855328 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 45 cost time: 6.316796064376831
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0120770  Vali Loss: 0.0376631 Vali Accuracy: 0.9878234  Vali weighted F1: 0.9878007  Vali macro F1 0.9855328 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 6.281934499740601
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0121942  Vali Loss: 0.0376426 Vali Accuracy: 0.9873161  Vali weighted F1: 0.9872838  Vali macro F1 0.9850408 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 6.289812803268433
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0134003  Vali Loss: 0.0376021 Vali Accuracy: 0.9878234  Vali weighted F1: 0.9878007  Vali macro F1 0.9855328 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 6.298641204833984
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0133360  Vali Loss: 0.0377139 Vali Accuracy: 0.9873161  Vali weighted F1: 0.9872838  Vali macro F1 0.9850408 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 6.318213939666748
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0128329  Vali Loss: 0.0376875 Vali Accuracy: 0.9873161  Vali weighted F1: 0.9872838  Vali macro F1 0.9850408 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9290513  Test weighted F1: 0.9294169  Test macro F1 0.8789686 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 240495
pruned model Parameter : 244174
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.367027282714844
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0163011  Vali Loss: 0.0392950 Vali Accuracy: 0.9873161  Vali weighted F1: 0.9872894  Vali macro F1 0.9846836 
Validation loss decreased (inf --> 0.039295).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.2987706661224365
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0154348  Vali Loss: 0.0378866 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9867920  Vali macro F1 0.9842423 
new best score!!!!
Validation loss decreased (0.039295 --> 0.037887).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.3069188594818115
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0151077  Vali Loss: 0.0411578 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9867894  Vali macro F1 0.9849541 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.288867473602295
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0147737  Vali Loss: 0.0388520 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9863079  Vali macro F1 0.9837262 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.297110080718994
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0148682  Vali Loss: 0.0369970 Vali Accuracy: 0.9888382  Vali weighted F1: 0.9888387  Vali macro F1 0.9868934 
new best score!!!!
Validation loss decreased (0.037887 --> 0.036997).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.294700622558594
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0138751  Vali Loss: 0.0410582 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9867829  Vali macro F1 0.9845994 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.309382677078247
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0126674  Vali Loss: 0.0400705 Vali Accuracy: 0.9878234  Vali weighted F1: 0.9878115  Vali macro F1 0.9858740 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.300361633300781
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0121891  Vali Loss: 0.0396489 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9868267  Vali macro F1 0.9847800 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.314705848693848
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0113392  Vali Loss: 0.0414231 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9862683  Vali macro F1 0.9839863 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.298821210861206
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0122456  Vali Loss: 0.0367335 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9868090  Vali macro F1 0.9848454 
new best score!!!!
Validation loss decreased (0.036997 --> 0.036734).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 6.3088061809539795
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0109282  Vali Loss: 0.0407266 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9868052  Vali macro F1 0.9844270 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.2944653034210205
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0116353  Vali Loss: 0.0437409 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9858311  Vali macro F1 0.9820412 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.274054288864136
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0116103  Vali Loss: 0.0350358 Vali Accuracy: 0.9898529  Vali weighted F1: 0.9898517  Vali macro F1 0.9867246 
new best score!!!!
Validation loss decreased (0.036734 --> 0.035036).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 6.321460008621216
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0107653  Vali Loss: 0.0389307 Vali Accuracy: 0.9878234  Vali weighted F1: 0.9878180  Vali macro F1 0.9860223 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 6.271202325820923
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0107746  Vali Loss: 0.0410032 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9862826  Vali macro F1 0.9846162 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 6.296376705169678
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0108315  Vali Loss: 0.0366973 Vali Accuracy: 0.9888382  Vali weighted F1: 0.9888445  Vali macro F1 0.9863921 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 6.300004720687866
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0097866  Vali Loss: 0.0388351 Vali Accuracy: 0.9873161  Vali weighted F1: 0.9872933  Vali macro F1 0.9853129 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 6.2950758934021
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0106856  Vali Loss: 0.0392438 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9867986  Vali macro F1 0.9839860 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 19 cost time: 6.27665114402771
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0128446  Vali Loss: 0.0391845 Vali Accuracy: 0.9873161  Vali weighted F1: 0.9872989  Vali macro F1 0.9850999 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 6.272489309310913
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0100950  Vali Loss: 0.0364478 Vali Accuracy: 0.9878234  Vali weighted F1: 0.9877966  Vali macro F1 0.9863408 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 6.263446807861328
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0095253  Vali Loss: 0.0359293 Vali Accuracy: 0.9873161  Vali weighted F1: 0.9873015  Vali macro F1 0.9850736 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 6.264838695526123
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0088471  Vali Loss: 0.0350034 Vali Accuracy: 0.9888382  Vali weighted F1: 0.9888447  Vali macro F1 0.9870996 
new best score!!!!
Validation loss decreased (0.035036 --> 0.035003).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 23 cost time: 6.276043176651001
Fine Tuning VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0086239  Vali Loss: 0.0369299 Vali Accuracy: 0.9883308  Vali weighted F1: 0.9883231  Vali macro F1 0.9862550 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 6.282618045806885
Fine Tuning VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0090506  Vali Loss: 0.0384355 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9858133  Vali macro F1 0.9831118 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 6.280254602432251
Fine Tuning VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0078501  Vali Loss: 0.0363710 Vali Accuracy: 0.9888382  Vali weighted F1: 0.9888207  Vali macro F1 0.9865771 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 6.288827657699585
Fine Tuning VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0080580  Vali Loss: 0.0400495 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9863111  Vali macro F1 0.9838570 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 6.3007895946502686
Fine Tuning VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0078362  Vali Loss: 0.0391120 Vali Accuracy: 0.9873161  Vali weighted F1: 0.9872668  Vali macro F1 0.9850315 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 28 cost time: 6.301379919052124
Fine Tuning VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0068994  Vali Loss: 0.0382699 Vali Accuracy: 0.9873161  Vali weighted F1: 0.9872929  Vali macro F1 0.9853380 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 29 cost time: 6.269005298614502
Fine Tuning VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0075746  Vali Loss: 0.0378600 Vali Accuracy: 0.9888382  Vali weighted F1: 0.9888270  Vali macro F1 0.9867360 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 30 cost time: 6.276470422744751
Fine Tuning VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0070011  Vali Loss: 0.0377774 Vali Accuracy: 0.9873161  Vali weighted F1: 0.9872854  Vali macro F1 0.9849296 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 31 cost time: 6.278088569641113
Fine Tuning VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0077193  Vali Loss: 0.0394187 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9867840  Vali macro F1 0.9846171 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 32 cost time: 6.267375230789185
Fine Tuning VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0067586  Vali Loss: 0.0367246 Vali Accuracy: 0.9873161  Vali weighted F1: 0.9873006  Vali macro F1 0.9849789 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 33 cost time: 6.268783807754517
Fine Tuning VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0067540  Vali Loss: 0.0366224 Vali Accuracy: 0.9878234  Vali weighted F1: 0.9878164  Vali macro F1 0.9854431 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 34 cost time: 6.2716405391693115
Fine Tuning VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0064615  Vali Loss: 0.0366245 Vali Accuracy: 0.9878234  Vali weighted F1: 0.9878164  Vali macro F1 0.9854431 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 35 cost time: 6.28783917427063
Fine Tuning VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0071149  Vali Loss: 0.0366916 Vali Accuracy: 0.9873161  Vali weighted F1: 0.9873006  Vali macro F1 0.9849789 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 36 cost time: 6.289556264877319
Fine Tuning VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0072434  Vali Loss: 0.0366746 Vali Accuracy: 0.9873161  Vali weighted F1: 0.9873006  Vali macro F1 0.9849789 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 37 cost time: 6.282312631607056
Fine Tuning VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0065392  Vali Loss: 0.0368443 Vali Accuracy: 0.9873161  Vali weighted F1: 0.9873006  Vali macro F1 0.9849789 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9296034  Test weighted F1: 0.9298006  Test macro F1 0.8784173 
================ the 9 th CV Experiment ================ 
Leave one Out Experiment : The 10 Part as the test
[-] Target sampling weights:  [0.00013949 0.00018396 0.00103413 0.00129702 0.00048591 0.00059988]
Train data number :  18068
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2008
Test data number :  9022
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.40863823890686
VALI: Epoch: 1, Steps: 71 | Train Loss: 1.0183787  Vali Loss: 0.5670175 Vali Accuracy: 0.7664343  Vali weighted F1: 0.7310624  Vali macro F1 0.5217446 
Validation loss decreased (inf --> 0.567017).  Saving model ...
Epoch: 2 cost time: 6.435498237609863
VALI: Epoch: 2, Steps: 71 | Train Loss: 0.4697559  Vali Loss: 0.3552662 Vali Accuracy: 0.8730080  Vali weighted F1: 0.8681240  Vali macro F1 0.8183014 
new best score!!!!
Validation loss decreased (0.567017 --> 0.355266).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.4204583168029785
VALI: Epoch: 3, Steps: 71 | Train Loss: 0.3360320  Vali Loss: 0.2620529 Vali Accuracy: 0.9033865  Vali weighted F1: 0.8999356  Vali macro F1 0.8529200 
new best score!!!!
Validation loss decreased (0.355266 --> 0.262053).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.426457166671753
VALI: Epoch: 4, Steps: 71 | Train Loss: 0.2415805  Vali Loss: 0.2290692 Vali Accuracy: 0.9257968  Vali weighted F1: 0.9241974  Vali macro F1 0.8930193 
new best score!!!!
Validation loss decreased (0.262053 --> 0.229069).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.442402601242065
VALI: Epoch: 5, Steps: 71 | Train Loss: 0.1942338  Vali Loss: 0.1647398 Vali Accuracy: 0.9462151  Vali weighted F1: 0.9455117  Vali macro F1 0.9159918 
new best score!!!!
Validation loss decreased (0.229069 --> 0.164740).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.463472366333008
VALI: Epoch: 6, Steps: 71 | Train Loss: 0.1795633  Vali Loss: 0.1563435 Vali Accuracy: 0.9531873  Vali weighted F1: 0.9538513  Vali macro F1 0.9295256 
new best score!!!!
Validation loss decreased (0.164740 --> 0.156343).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.4451212882995605
VALI: Epoch: 7, Steps: 71 | Train Loss: 0.1480135  Vali Loss: 0.1423881 Vali Accuracy: 0.9541833  Vali weighted F1: 0.9549004  Vali macro F1 0.9374362 
new best score!!!!
Validation loss decreased (0.156343 --> 0.142388).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.4291832447052
VALI: Epoch: 8, Steps: 71 | Train Loss: 0.1335819  Vali Loss: 0.1326014 Vali Accuracy: 0.9596614  Vali weighted F1: 0.9589622  Vali macro F1 0.9414046 
new best score!!!!
Validation loss decreased (0.142388 --> 0.132601).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.4203832149505615
VALI: Epoch: 9, Steps: 71 | Train Loss: 0.1246123  Vali Loss: 0.1127555 Vali Accuracy: 0.9696215  Vali weighted F1: 0.9696518  Vali macro F1 0.9543827 
new best score!!!!
Validation loss decreased (0.132601 --> 0.112755).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.42231559753418
VALI: Epoch: 10, Steps: 71 | Train Loss: 0.1092526  Vali Loss: 0.1101336 Vali Accuracy: 0.9696215  Vali weighted F1: 0.9692709  Vali macro F1 0.9536714 
new best score!!!!
Validation loss decreased (0.112755 --> 0.110134).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.42571759223938
VALI: Epoch: 11, Steps: 71 | Train Loss: 0.1126362  Vali Loss: 0.1138717 Vali Accuracy: 0.9641434  Vali weighted F1: 0.9637272  Vali macro F1 0.9482458 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 6.428682088851929
VALI: Epoch: 12, Steps: 71 | Train Loss: 0.0912316  Vali Loss: 0.0924360 Vali Accuracy: 0.9731076  Vali weighted F1: 0.9730505  Vali macro F1 0.9581295 
new best score!!!!
Validation loss decreased (0.110134 --> 0.092436).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.430970907211304
VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0950120  Vali Loss: 0.0956883 Vali Accuracy: 0.9716135  Vali weighted F1: 0.9716234  Vali macro F1 0.9567412 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 6.440690755844116
VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0805987  Vali Loss: 0.0930762 Vali Accuracy: 0.9726096  Vali weighted F1: 0.9726898  Vali macro F1 0.9581733 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 15 cost time: 6.4418885707855225
VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0725854  Vali Loss: 0.0994296 Vali Accuracy: 0.9721116  Vali weighted F1: 0.9717671  Vali macro F1 0.9585191 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 16 cost time: 6.451286792755127
VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0645419  Vali Loss: 0.0868578 Vali Accuracy: 0.9755976  Vali weighted F1: 0.9754734  Vali macro F1 0.9639150 
new best score!!!!
Validation loss decreased (0.092436 --> 0.086858).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.4417030811309814
VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0610135  Vali Loss: 0.0750972 Vali Accuracy: 0.9795817  Vali weighted F1: 0.9796431  Vali macro F1 0.9682536 
new best score!!!!
Validation loss decreased (0.086858 --> 0.075097).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.414316177368164
VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0571117  Vali Loss: 0.1034955 Vali Accuracy: 0.9701195  Vali weighted F1: 0.9706065  Vali macro F1 0.9589509 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.418295860290527
VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0542384  Vali Loss: 0.0793784 Vali Accuracy: 0.9755976  Vali weighted F1: 0.9754939  Vali macro F1 0.9637514 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 6.427300453186035
VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0573985  Vali Loss: 0.0768855 Vali Accuracy: 0.9750996  Vali weighted F1: 0.9752021  Vali macro F1 0.9634094 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 21 cost time: 6.423937797546387
VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0434202  Vali Loss: 0.0727000 Vali Accuracy: 0.9765936  Vali weighted F1: 0.9765763  Vali macro F1 0.9640309 
new best score!!!!
Validation loss decreased (0.075097 --> 0.072700).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.438112497329712
VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0438906  Vali Loss: 0.0732604 Vali Accuracy: 0.9790837  Vali weighted F1: 0.9790562  Vali macro F1 0.9674332 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.435603380203247
VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0391798  Vali Loss: 0.0667966 Vali Accuracy: 0.9805777  Vali weighted F1: 0.9806253  Vali macro F1 0.9705409 
new best score!!!!
Validation loss decreased (0.072700 --> 0.066797).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.4306416511535645
VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0389913  Vali Loss: 0.0713385 Vali Accuracy: 0.9775896  Vali weighted F1: 0.9776584  Vali macro F1 0.9669219 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 6.4211602210998535
VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0366303  Vali Loss: 0.0725038 Vali Accuracy: 0.9790837  Vali weighted F1: 0.9791289  Vali macro F1 0.9694741 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 6.439105987548828
VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0334249  Vali Loss: 0.0689515 Vali Accuracy: 0.9790837  Vali weighted F1: 0.9790539  Vali macro F1 0.9682681 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 27 cost time: 6.4246602058410645
VALI: Epoch: 27, Steps: 71 | Train Loss: 0.0352850  Vali Loss: 0.0792912 Vali Accuracy: 0.9755976  Vali weighted F1: 0.9755874  Vali macro F1 0.9631103 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 28 cost time: 6.423704385757446
VALI: Epoch: 28, Steps: 71 | Train Loss: 0.0277735  Vali Loss: 0.0705282 Vali Accuracy: 0.9795817  Vali weighted F1: 0.9795909  Vali macro F1 0.9701205 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 29 cost time: 6.416171312332153
VALI: Epoch: 29, Steps: 71 | Train Loss: 0.0182013  Vali Loss: 0.0661343 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9816016  Vali macro F1 0.9735377 
new best score!!!!
Validation loss decreased (0.066797 --> 0.066134).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.41534423828125
VALI: Epoch: 30, Steps: 71 | Train Loss: 0.0153965  Vali Loss: 0.0666214 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810774  Vali macro F1 0.9718177 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 6.422921419143677
VALI: Epoch: 31, Steps: 71 | Train Loss: 0.0151569  Vali Loss: 0.0678416 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9815861  Vali macro F1 0.9723639 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 6.413846015930176
VALI: Epoch: 32, Steps: 71 | Train Loss: 0.0139848  Vali Loss: 0.0693658 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9830310  Vali macro F1 0.9736041 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 6.4221813678741455
VALI: Epoch: 33, Steps: 71 | Train Loss: 0.0145089  Vali Loss: 0.0659103 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9825319  Vali macro F1 0.9734148 
new best score!!!!
Validation loss decreased (0.066134 --> 0.065910).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.443032264709473
VALI: Epoch: 34, Steps: 71 | Train Loss: 0.0141082  Vali Loss: 0.0681706 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9825420  Vali macro F1 0.9731474 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 6.442905902862549
VALI: Epoch: 35, Steps: 71 | Train Loss: 0.0134751  Vali Loss: 0.0671808 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9820190  Vali macro F1 0.9722302 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 6.429357290267944
VALI: Epoch: 36, Steps: 71 | Train Loss: 0.0131555  Vali Loss: 0.0680087 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9825319  Vali macro F1 0.9734148 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 6.429132699966431
VALI: Epoch: 37, Steps: 71 | Train Loss: 0.0137782  Vali Loss: 0.0653168 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9815371  Vali macro F1 0.9723287 
new best score!!!!
Validation loss decreased (0.065910 --> 0.065317).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 6.424490213394165
VALI: Epoch: 38, Steps: 71 | Train Loss: 0.0120485  Vali Loss: 0.0673211 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9825441  Vali macro F1 0.9730923 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 6.427272319793701
VALI: Epoch: 39, Steps: 71 | Train Loss: 0.0123199  Vali Loss: 0.0684110 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9825805  Vali macro F1 0.9728242 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 6.419325590133667
VALI: Epoch: 40, Steps: 71 | Train Loss: 0.0111324  Vali Loss: 0.0674147 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9825730  Vali macro F1 0.9740038 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 6.431694030761719
VALI: Epoch: 41, Steps: 71 | Train Loss: 0.0121862  Vali Loss: 0.0685011 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9825692  Vali macro F1 0.9731893 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 42 cost time: 6.437694311141968
VALI: Epoch: 42, Steps: 71 | Train Loss: 0.0120592  Vali Loss: 0.0673769 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9835304  Vali macro F1 0.9753311 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 43 cost time: 6.460808038711548
VALI: Epoch: 43, Steps: 71 | Train Loss: 0.0114163  Vali Loss: 0.0674234 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9830284  Vali macro F1 0.9736523 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 6.4286322593688965
VALI: Epoch: 44, Steps: 71 | Train Loss: 0.0111841  Vali Loss: 0.0669629 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9830284  Vali macro F1 0.9736523 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 6.428303956985474
VALI: Epoch: 45, Steps: 71 | Train Loss: 0.0111879  Vali Loss: 0.0671995 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9830284  Vali macro F1 0.9736523 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 46 cost time: 6.427377700805664
VALI: Epoch: 46, Steps: 71 | Train Loss: 0.0110883  Vali Loss: 0.0673862 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9830440  Vali macro F1 0.9748261 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 47 cost time: 6.419158220291138
VALI: Epoch: 47, Steps: 71 | Train Loss: 0.0106762  Vali Loss: 0.0669237 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9825420  Vali macro F1 0.9731474 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 48 cost time: 6.4419825077056885
VALI: Epoch: 48, Steps: 71 | Train Loss: 0.0092679  Vali Loss: 0.0670157 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9825420  Vali macro F1 0.9731474 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 6.425510406494141
VALI: Epoch: 49, Steps: 71 | Train Loss: 0.0110068  Vali Loss: 0.0671109 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9830284  Vali macro F1 0.9736523 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 6.442670822143555
VALI: Epoch: 50, Steps: 71 | Train Loss: 0.0100167  Vali Loss: 0.0671150 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9830284  Vali macro F1 0.9736523 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 6.451429128646851
VALI: Epoch: 51, Steps: 71 | Train Loss: 0.0101071  Vali Loss: 0.0670735 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9830284  Vali macro F1 0.9736523 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 52 cost time: 6.441787958145142
VALI: Epoch: 52, Steps: 71 | Train Loss: 0.0101905  Vali Loss: 0.0671769 Vali Accuracy: 0.9830677  Vali weighted F1: 0.9830284  Vali macro F1 0.9736523 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9043449  Test weighted F1: 0.9042849  Test macro F1 0.8455327 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 240495
pruned model Parameter : 244174
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.506253957748413
Fine Tuning VALI: Epoch: 1, Steps: 71 | Train Loss: 0.0128295  Vali Loss: 0.0671895 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9835318  Vali macro F1 0.9759414 
Validation loss decreased (inf --> 0.067190).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.574378967285156
Fine Tuning VALI: Epoch: 2, Steps: 71 | Train Loss: 0.0130246  Vali Loss: 0.0679100 Vali Accuracy: 0.9835657  Vali weighted F1: 0.9835556  Vali macro F1 0.9753084 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.45706844329834
Fine Tuning VALI: Epoch: 3, Steps: 71 | Train Loss: 0.0123076  Vali Loss: 0.0661625 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9820693  Vali macro F1 0.9729530 
new best score!!!!
Validation loss decreased (0.067190 --> 0.066163).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.467519521713257
Fine Tuning VALI: Epoch: 4, Steps: 71 | Train Loss: 0.0107563  Vali Loss: 0.0724910 Vali Accuracy: 0.9800797  Vali weighted F1: 0.9801051  Vali macro F1 0.9707836 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.474214792251587
Fine Tuning VALI: Epoch: 5, Steps: 71 | Train Loss: 0.0120866  Vali Loss: 0.0679299 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9825337  Vali macro F1 0.9734120 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 6.465465307235718
Fine Tuning VALI: Epoch: 6, Steps: 71 | Train Loss: 0.0116465  Vali Loss: 0.0672261 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9825378  Vali macro F1 0.9739215 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 6.477615118026733
Fine Tuning VALI: Epoch: 7, Steps: 71 | Train Loss: 0.0111587  Vali Loss: 0.0662828 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9825323  Vali macro F1 0.9733728 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 8 cost time: 6.507913827896118
Fine Tuning VALI: Epoch: 8, Steps: 71 | Train Loss: 0.0116896  Vali Loss: 0.0710472 Vali Accuracy: 0.9805777  Vali weighted F1: 0.9806256  Vali macro F1 0.9712465 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 9 cost time: 6.48292350769043
Fine Tuning VALI: Epoch: 9, Steps: 71 | Train Loss: 0.0093272  Vali Loss: 0.0693415 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9820537  Vali macro F1 0.9733836 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.487593173980713
Fine Tuning VALI: Epoch: 10, Steps: 71 | Train Loss: 0.0107254  Vali Loss: 0.0697189 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9825114  Vali macro F1 0.9733406 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 6.487030029296875
Fine Tuning VALI: Epoch: 11, Steps: 71 | Train Loss: 0.0098855  Vali Loss: 0.0699244 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9815845  Vali macro F1 0.9718112 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 6.481363534927368
Fine Tuning VALI: Epoch: 12, Steps: 71 | Train Loss: 0.0105276  Vali Loss: 0.0705083 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9825440  Vali macro F1 0.9737280 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 6.481498956680298
Fine Tuning VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0092243  Vali Loss: 0.0667749 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810608  Vali macro F1 0.9709391 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 14 cost time: 6.475476026535034
Fine Tuning VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0081504  Vali Loss: 0.0681650 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9815238  Vali macro F1 0.9719883 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 6.483960390090942
Fine Tuning VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0087545  Vali Loss: 0.0689580 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9825319  Vali macro F1 0.9734148 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 6.4955902099609375
Fine Tuning VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0075693  Vali Loss: 0.0681366 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9825319  Vali macro F1 0.9734148 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 6.498579025268555
Fine Tuning VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0083531  Vali Loss: 0.0679322 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9820317  Vali macro F1 0.9725691 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 6.500550746917725
Fine Tuning VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0085207  Vali Loss: 0.0673854 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9825319  Vali macro F1 0.9734148 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8965861  Test weighted F1: 0.8963597  Test macro F1 0.8308206 
Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 240495
Set the seed as :  4
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
-----------------------Sliding file are generated -----------------------
================ LOCV Mode ====================
================ 10 CV ======================
================ the 0 th CV Experiment ================ 
Leave one Out Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.00014618 0.00018175 0.00097182 0.00121655 0.00048263 0.00061162]
Train data number :  17901
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1989
Test data number :  9947
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.425391912460327
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.0243220  Vali Loss: 0.6107525 Vali Accuracy: 0.7732529  Vali weighted F1: 0.7288924  Vali macro F1 0.5220390 
Validation loss decreased (inf --> 0.610753).  Saving model ...
Epoch: 2 cost time: 6.422279119491577
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.4951442  Vali Loss: 0.4236552 Vali Accuracy: 0.8526898  Vali weighted F1: 0.8357258  Vali macro F1 0.7860944 
new best score!!!!
Validation loss decreased (0.610753 --> 0.423655).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.410951137542725
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.3560352  Vali Loss: 0.2832089 Vali Accuracy: 0.8969331  Vali weighted F1: 0.8962265  Vali macro F1 0.8618440 
new best score!!!!
Validation loss decreased (0.423655 --> 0.283209).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.420489072799683
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.2596685  Vali Loss: 0.2116951 Vali Accuracy: 0.9220714  Vali weighted F1: 0.9208665  Vali macro F1 0.8923330 
new best score!!!!
Validation loss decreased (0.283209 --> 0.211695).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.438577651977539
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.2026439  Vali Loss: 0.1678308 Vali Accuracy: 0.9411765  Vali weighted F1: 0.9408938  Vali macro F1 0.9142027 
new best score!!!!
Validation loss decreased (0.211695 --> 0.167831).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.469924211502075
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.1677095  Vali Loss: 0.1442665 Vali Accuracy: 0.9492207  Vali weighted F1: 0.9489714  Vali macro F1 0.9246026 
new best score!!!!
Validation loss decreased (0.167831 --> 0.144267).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.441705226898193
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.1540749  Vali Loss: 0.1531956 Vali Accuracy: 0.9472097  Vali weighted F1: 0.9460694  Vali macro F1 0.9263267 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 8 cost time: 6.415544748306274
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1326490  Vali Loss: 0.1497573 Vali Accuracy: 0.9477124  Vali weighted F1: 0.9479756  Vali macro F1 0.9252101 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 9 cost time: 6.420024394989014
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1277366  Vali Loss: 0.1181604 Vali Accuracy: 0.9622926  Vali weighted F1: 0.9628555  Vali macro F1 0.9432723 
new best score!!!!
Validation loss decreased (0.144267 --> 0.118160).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.427646160125732
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1195768  Vali Loss: 0.0968703 Vali Accuracy: 0.9688286  Vali weighted F1: 0.9687730  Vali macro F1 0.9564817 
new best score!!!!
Validation loss decreased (0.118160 --> 0.096870).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.42574667930603
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1027938  Vali Loss: 0.1072037 Vali Accuracy: 0.9602815  Vali weighted F1: 0.9602702  Vali macro F1 0.9359232 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 6.425367593765259
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0928801  Vali Loss: 0.1077461 Vali Accuracy: 0.9658120  Vali weighted F1: 0.9654328  Vali macro F1 0.9436679 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 13 cost time: 6.427417516708374
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0940184  Vali Loss: 0.1014809 Vali Accuracy: 0.9622926  Vali weighted F1: 0.9624686  Vali macro F1 0.9392582 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 14 cost time: 6.435832738876343
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0863491  Vali Loss: 0.1048565 Vali Accuracy: 0.9643037  Vali weighted F1: 0.9643990  Vali macro F1 0.9440595 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 15 cost time: 6.446641683578491
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0815672  Vali Loss: 0.0946937 Vali Accuracy: 0.9653092  Vali weighted F1: 0.9649843  Vali macro F1 0.9428778 
new best score!!!!
Validation loss decreased (0.096870 --> 0.094694).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.423735618591309
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0858032  Vali Loss: 0.0932844 Vali Accuracy: 0.9698341  Vali weighted F1: 0.9697281  Vali macro F1 0.9551010 
new best score!!!!
Validation loss decreased (0.094694 --> 0.093284).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.43043065071106
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0739612  Vali Loss: 0.0922099 Vali Accuracy: 0.9698341  Vali weighted F1: 0.9700286  Vali macro F1 0.9549508 
new best score!!!!
Validation loss decreased (0.093284 --> 0.092210).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.431694030761719
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0623060  Vali Loss: 0.0803289 Vali Accuracy: 0.9738562  Vali weighted F1: 0.9736453  Vali macro F1 0.9605309 
new best score!!!!
Validation loss decreased (0.092210 --> 0.080329).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.429400444030762
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0603682  Vali Loss: 0.1051625 Vali Accuracy: 0.9653092  Vali weighted F1: 0.9645864  Vali macro F1 0.9521303 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 6.428697824478149
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0598731  Vali Loss: 0.0810343 Vali Accuracy: 0.9723479  Vali weighted F1: 0.9723075  Vali macro F1 0.9596455 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 6.430521726608276
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0490393  Vali Loss: 0.0888604 Vali Accuracy: 0.9698341  Vali weighted F1: 0.9693075  Vali macro F1 0.9577935 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 22 cost time: 6.4288270473480225
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0491854  Vali Loss: 0.0609227 Vali Accuracy: 0.9803922  Vali weighted F1: 0.9804843  Vali macro F1 0.9733470 
new best score!!!!
Validation loss decreased (0.080329 --> 0.060923).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.4507341384887695
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0575732  Vali Loss: 0.1190366 Vali Accuracy: 0.9668175  Vali weighted F1: 0.9664016  Vali macro F1 0.9558478 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 6.4229896068573
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0551678  Vali Loss: 0.0863527 Vali Accuracy: 0.9658120  Vali weighted F1: 0.9654151  Vali macro F1 0.9537040 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 6.429974794387817
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0406010  Vali Loss: 0.0778306 Vali Accuracy: 0.9773756  Vali weighted F1: 0.9774692  Vali macro F1 0.9685590 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 26 cost time: 6.427995204925537
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0390487  Vali Loss: 0.0608725 Vali Accuracy: 0.9803922  Vali weighted F1: 0.9804068  Vali macro F1 0.9726296 
new best score!!!!
Validation loss decreased (0.060923 --> 0.060872).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.425606727600098
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0374369  Vali Loss: 0.0692486 Vali Accuracy: 0.9788839  Vali weighted F1: 0.9787752  Vali macro F1 0.9687822 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.433156251907349
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0358421  Vali Loss: 0.0569862 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9819514  Vali macro F1 0.9771886 
new best score!!!!
Validation loss decreased (0.060872 --> 0.056986).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.435190200805664
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0354482  Vali Loss: 0.0574828 Vali Accuracy: 0.9783811  Vali weighted F1: 0.9784978  Vali macro F1 0.9697082 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 6.438647985458374
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0280340  Vali Loss: 0.0576288 Vali Accuracy: 0.9824032  Vali weighted F1: 0.9823923  Vali macro F1 0.9756743 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 6.462725877761841
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0267785  Vali Loss: 0.0621837 Vali Accuracy: 0.9798894  Vali weighted F1: 0.9800213  Vali macro F1 0.9729539 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 32 cost time: 6.444363117218018
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0325322  Vali Loss: 0.0586974 Vali Accuracy: 0.9824032  Vali weighted F1: 0.9824398  Vali macro F1 0.9731803 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 33 cost time: 6.435588836669922
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0247527  Vali Loss: 0.0681897 Vali Accuracy: 0.9788839  Vali weighted F1: 0.9788811  Vali macro F1 0.9716314 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 34 cost time: 6.443728685379028
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0170879  Vali Loss: 0.0613775 Vali Accuracy: 0.9813977  Vali weighted F1: 0.9813577  Vali macro F1 0.9749181 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 6.442685842514038
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0137973  Vali Loss: 0.0593568 Vali Accuracy: 0.9813977  Vali weighted F1: 0.9813709  Vali macro F1 0.9747056 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 6.43712043762207
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0123093  Vali Loss: 0.0578230 Vali Accuracy: 0.9824032  Vali weighted F1: 0.9823992  Vali macro F1 0.9763583 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 6.43955659866333
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0122052  Vali Loss: 0.0581957 Vali Accuracy: 0.9824032  Vali weighted F1: 0.9823948  Vali macro F1 0.9760882 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 6.434630632400513
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0117502  Vali Loss: 0.0589686 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9818966  Vali macro F1 0.9755410 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 39 cost time: 6.454959154129028
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0108375  Vali Loss: 0.0589720 Vali Accuracy: 0.9829060  Vali weighted F1: 0.9828844  Vali macro F1 0.9767250 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 6.452895879745483
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0116378  Vali Loss: 0.0587735 Vali Accuracy: 0.9824032  Vali weighted F1: 0.9823989  Vali macro F1 0.9763368 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 6.434258460998535
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0107923  Vali Loss: 0.0590634 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9818966  Vali macro F1 0.9755410 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 6.420966386795044
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0101354  Vali Loss: 0.0586196 Vali Accuracy: 0.9824032  Vali weighted F1: 0.9823989  Vali macro F1 0.9763368 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 6.434518814086914
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0103686  Vali Loss: 0.0584073 Vali Accuracy: 0.9819005  Vali weighted F1: 0.9818966  Vali macro F1 0.9755410 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.7989344  Test weighted F1: 0.8118000  Test macro F1 0.7075467 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 240495
pruned model Parameter : 244174
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.427361965179443
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0237684  Vali Loss: 0.0556517 Vali Accuracy: 0.9813977  Vali weighted F1: 0.9814305  Vali macro F1 0.9751748 
Validation loss decreased (inf --> 0.055652).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.4027259349823
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0198335  Vali Loss: 0.0567692 Vali Accuracy: 0.9829060  Vali weighted F1: 0.9829020  Vali macro F1 0.9765569 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.4163782596588135
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0199662  Vali Loss: 0.0614137 Vali Accuracy: 0.9829060  Vali weighted F1: 0.9828764  Vali macro F1 0.9752830 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.433124542236328
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0184054  Vali Loss: 0.0603394 Vali Accuracy: 0.9829060  Vali weighted F1: 0.9829020  Vali macro F1 0.9765569 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.445461988449097
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0169344  Vali Loss: 0.0600326 Vali Accuracy: 0.9824032  Vali weighted F1: 0.9824074  Vali macro F1 0.9760303 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.4187397956848145
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0175428  Vali Loss: 0.0588876 Vali Accuracy: 0.9829060  Vali weighted F1: 0.9828902  Vali macro F1 0.9767707 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.426849842071533
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0162712  Vali Loss: 0.0591347 Vali Accuracy: 0.9844143  Vali weighted F1: 0.9843947  Vali macro F1 0.9785612 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.4356749057769775
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0161731  Vali Loss: 0.0618493 Vali Accuracy: 0.9813977  Vali weighted F1: 0.9814080  Vali macro F1 0.9733222 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.426710367202759
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0148957  Vali Loss: 0.0560784 Vali Accuracy: 0.9844143  Vali weighted F1: 0.9844374  Vali macro F1 0.9787344 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.4327428340911865
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0139950  Vali Loss: 0.0589427 Vali Accuracy: 0.9839115  Vali weighted F1: 0.9839014  Vali macro F1 0.9780803 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 11 cost time: 6.411991357803345
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0128110  Vali Loss: 0.0594889 Vali Accuracy: 0.9839115  Vali weighted F1: 0.9839055  Vali macro F1 0.9781460 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.425405740737915
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0135350  Vali Loss: 0.0598871 Vali Accuracy: 0.9839115  Vali weighted F1: 0.9839055  Vali macro F1 0.9781460 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.455867767333984
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0125113  Vali Loss: 0.0597660 Vali Accuracy: 0.9839115  Vali weighted F1: 0.9839055  Vali macro F1 0.9781460 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.431368350982666
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0139459  Vali Loss: 0.0597518 Vali Accuracy: 0.9839115  Vali weighted F1: 0.9839055  Vali macro F1 0.9781460 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.422046899795532
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0131894  Vali Loss: 0.0593985 Vali Accuracy: 0.9834087  Vali weighted F1: 0.9833924  Vali macro F1 0.9775885 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 16 cost time: 6.4187047481536865
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0127252  Vali Loss: 0.0593340 Vali Accuracy: 0.9839115  Vali weighted F1: 0.9839055  Vali macro F1 0.9781460 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8079823  Test weighted F1: 0.8196496  Test macro F1 0.7168396 
================ the 1 th CV Experiment ================ 
Leave one Out Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00015017 0.00018275 0.0010846  0.0013947  0.00050201 0.00062854]
Train data number :  17353
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1929
Test data number :  12988
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.222400426864624
VALI: Epoch: 1, Steps: 68 | Train Loss: 1.0085588  Vali Loss: 0.6235295 Vali Accuracy: 0.7796786  Vali weighted F1: 0.7358729  Vali macro F1 0.5312363 
Validation loss decreased (inf --> 0.623529).  Saving model ...
Epoch: 2 cost time: 6.21544885635376
VALI: Epoch: 2, Steps: 68 | Train Loss: 0.5014145  Vali Loss: 0.3753109 Vali Accuracy: 0.8672888  Vali weighted F1: 0.8552957  Vali macro F1 0.8088823 
new best score!!!!
Validation loss decreased (0.623529 --> 0.375311).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.215848445892334
VALI: Epoch: 3, Steps: 68 | Train Loss: 0.3266615  Vali Loss: 0.3097862 Vali Accuracy: 0.9004666  Vali weighted F1: 0.8971542  Vali macro F1 0.8692073 
new best score!!!!
Validation loss decreased (0.375311 --> 0.309786).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.207388401031494
VALI: Epoch: 4, Steps: 68 | Train Loss: 0.2516562  Vali Loss: 0.1950547 Vali Accuracy: 0.9336444  Vali weighted F1: 0.9331299  Vali macro F1 0.9098277 
new best score!!!!
Validation loss decreased (0.309786 --> 0.195055).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.238497018814087
VALI: Epoch: 5, Steps: 68 | Train Loss: 0.1972430  Vali Loss: 0.1755496 Vali Accuracy: 0.9377916  Vali weighted F1: 0.9387899  Vali macro F1 0.9168955 
new best score!!!!
Validation loss decreased (0.195055 --> 0.175550).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.236940860748291
VALI: Epoch: 6, Steps: 68 | Train Loss: 0.1731407  Vali Loss: 0.1626905 Vali Accuracy: 0.9372732  Vali weighted F1: 0.9363044  Vali macro F1 0.9108708 
new best score!!!!
Validation loss decreased (0.175550 --> 0.162691).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.232110977172852
VALI: Epoch: 7, Steps: 68 | Train Loss: 0.1649427  Vali Loss: 0.1417370 Vali Accuracy: 0.9450492  Vali weighted F1: 0.9443937  Vali macro F1 0.9216382 
new best score!!!!
Validation loss decreased (0.162691 --> 0.141737).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.242788314819336
VALI: Epoch: 8, Steps: 68 | Train Loss: 0.1428798  Vali Loss: 0.1161743 Vali Accuracy: 0.9564541  Vali weighted F1: 0.9564138  Vali macro F1 0.9380335 
new best score!!!!
Validation loss decreased (0.141737 --> 0.116174).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.220734596252441
VALI: Epoch: 9, Steps: 68 | Train Loss: 0.1247839  Vali Loss: 0.1355066 Vali Accuracy: 0.9486781  Vali weighted F1: 0.9485537  Vali macro F1 0.9267326 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 6.22170090675354
VALI: Epoch: 10, Steps: 68 | Train Loss: 0.1239121  Vali Loss: 0.1612376 Vali Accuracy: 0.9429756  Vali weighted F1: 0.9450688  Vali macro F1 0.9220774 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 11 cost time: 6.216079473495483
VALI: Epoch: 11, Steps: 68 | Train Loss: 0.1101854  Vali Loss: 0.1026573 Vali Accuracy: 0.9673406  Vali weighted F1: 0.9677840  Vali macro F1 0.9510470 
new best score!!!!
Validation loss decreased (0.116174 --> 0.102657).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.212478160858154
VALI: Epoch: 12, Steps: 68 | Train Loss: 0.0941874  Vali Loss: 0.0842536 Vali Accuracy: 0.9699326  Vali weighted F1: 0.9699867  Vali macro F1 0.9537359 
new best score!!!!
Validation loss decreased (0.102657 --> 0.084254).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.193267345428467
VALI: Epoch: 13, Steps: 68 | Train Loss: 0.0901768  Vali Loss: 0.0756402 Vali Accuracy: 0.9735614  Vali weighted F1: 0.9735561  Vali macro F1 0.9570742 
new best score!!!!
Validation loss decreased (0.084254 --> 0.075640).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.221773862838745
VALI: Epoch: 14, Steps: 68 | Train Loss: 0.0810355  Vali Loss: 0.0745794 Vali Accuracy: 0.9766719  Vali weighted F1: 0.9767753  Vali macro F1 0.9675738 
new best score!!!!
Validation loss decreased (0.075640 --> 0.074579).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.21454119682312
VALI: Epoch: 15, Steps: 68 | Train Loss: 0.0707865  Vali Loss: 0.0645091 Vali Accuracy: 0.9782271  Vali weighted F1: 0.9782091  Vali macro F1 0.9657318 
new best score!!!!
Validation loss decreased (0.074579 --> 0.064509).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.215158939361572
VALI: Epoch: 16, Steps: 68 | Train Loss: 0.0735083  Vali Loss: 0.0715224 Vali Accuracy: 0.9792639  Vali weighted F1: 0.9792237  Vali macro F1 0.9717484 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 7.572131395339966
VALI: Epoch: 17, Steps: 68 | Train Loss: 0.0680980  Vali Loss: 0.0736065 Vali Accuracy: 0.9771903  Vali weighted F1: 0.9776320  Vali macro F1 0.9689526 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 6.201466798782349
VALI: Epoch: 18, Steps: 68 | Train Loss: 0.0535117  Vali Loss: 0.0597583 Vali Accuracy: 0.9803007  Vali weighted F1: 0.9802305  Vali macro F1 0.9712050 
new best score!!!!
Validation loss decreased (0.064509 --> 0.059758).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.18939471244812
VALI: Epoch: 19, Steps: 68 | Train Loss: 0.0517142  Vali Loss: 0.0561241 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9814969  Vali macro F1 0.9709784 
new best score!!!!
Validation loss decreased (0.059758 --> 0.056124).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.194981575012207
VALI: Epoch: 20, Steps: 68 | Train Loss: 0.0544009  Vali Loss: 0.0565345 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9840673  Vali macro F1 0.9761882 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.1894371509552
VALI: Epoch: 21, Steps: 68 | Train Loss: 0.0516398  Vali Loss: 0.0562188 Vali Accuracy: 0.9813375  Vali weighted F1: 0.9813962  Vali macro F1 0.9715824 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 6.195323705673218
VALI: Epoch: 22, Steps: 68 | Train Loss: 0.0435157  Vali Loss: 0.0593642 Vali Accuracy: 0.9803007  Vali weighted F1: 0.9805306  Vali macro F1 0.9702732 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 23 cost time: 6.1962807178497314
VALI: Epoch: 23, Steps: 68 | Train Loss: 0.0382638  Vali Loss: 0.0560946 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9829735  Vali macro F1 0.9749603 
new best score!!!!
Validation loss decreased (0.056124 --> 0.056095).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.215486288070679
VALI: Epoch: 24, Steps: 68 | Train Loss: 0.0422323  Vali Loss: 0.0583265 Vali Accuracy: 0.9792639  Vali weighted F1: 0.9791296  Vali macro F1 0.9693925 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 6.204812288284302
VALI: Epoch: 25, Steps: 68 | Train Loss: 0.0454493  Vali Loss: 0.0538575 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9830418  Vali macro F1 0.9745526 
new best score!!!!
Validation loss decreased (0.056095 --> 0.053858).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.178106784820557
VALI: Epoch: 26, Steps: 68 | Train Loss: 0.0381686  Vali Loss: 0.0475336 Vali Accuracy: 0.9849663  Vali weighted F1: 0.9850300  Vali macro F1 0.9780776 
new best score!!!!
Validation loss decreased (0.053858 --> 0.047534).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.200082540512085
VALI: Epoch: 27, Steps: 68 | Train Loss: 0.0293681  Vali Loss: 0.0601643 Vali Accuracy: 0.9808191  Vali weighted F1: 0.9810077  Vali macro F1 0.9713263 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.1981422901153564
VALI: Epoch: 28, Steps: 68 | Train Loss: 0.0251756  Vali Loss: 0.0522937 Vali Accuracy: 0.9844479  Vali weighted F1: 0.9844776  Vali macro F1 0.9765541 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 6.1801087856292725
VALI: Epoch: 29, Steps: 68 | Train Loss: 0.0225394  Vali Loss: 0.0563531 Vali Accuracy: 0.9818559  Vali weighted F1: 0.9818899  Vali macro F1 0.9744536 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 6.190835952758789
VALI: Epoch: 30, Steps: 68 | Train Loss: 0.0320030  Vali Loss: 0.0541818 Vali Accuracy: 0.9823743  Vali weighted F1: 0.9824774  Vali macro F1 0.9734677 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 31 cost time: 6.190497875213623
VALI: Epoch: 31, Steps: 68 | Train Loss: 0.0329142  Vali Loss: 0.0517787 Vali Accuracy: 0.9823743  Vali weighted F1: 0.9825408  Vali macro F1 0.9747395 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 32 cost time: 6.210423707962036
VALI: Epoch: 32, Steps: 68 | Train Loss: 0.0155493  Vali Loss: 0.0446993 Vali Accuracy: 0.9844479  Vali weighted F1: 0.9845765  Vali macro F1 0.9774281 
new best score!!!!
Validation loss decreased (0.047534 --> 0.044699).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.189009428024292
VALI: Epoch: 33, Steps: 68 | Train Loss: 0.0132137  Vali Loss: 0.0439469 Vali Accuracy: 0.9849663  Vali weighted F1: 0.9850965  Vali macro F1 0.9779503 
new best score!!!!
Validation loss decreased (0.044699 --> 0.043947).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.188129186630249
VALI: Epoch: 34, Steps: 68 | Train Loss: 0.0122699  Vali Loss: 0.0433488 Vali Accuracy: 0.9865215  Vali weighted F1: 0.9865961  Vali macro F1 0.9800556 
new best score!!!!
Validation loss decreased (0.043947 --> 0.043349).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 6.18952488899231
VALI: Epoch: 35, Steps: 68 | Train Loss: 0.0116404  Vali Loss: 0.0433232 Vali Accuracy: 0.9860031  Vali weighted F1: 0.9860490  Vali macro F1 0.9788403 
new best score!!!!
Validation loss decreased (0.043349 --> 0.043323).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.18619966506958
VALI: Epoch: 36, Steps: 68 | Train Loss: 0.0110007  Vali Loss: 0.0431180 Vali Accuracy: 0.9849663  Vali weighted F1: 0.9850172  Vali macro F1 0.9778177 
new best score!!!!
Validation loss decreased (0.043323 --> 0.043118).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.17903733253479
VALI: Epoch: 37, Steps: 68 | Train Loss: 0.0112254  Vali Loss: 0.0432254 Vali Accuracy: 0.9875583  Vali weighted F1: 0.9876235  Vali macro F1 0.9810724 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 6.18287992477417
VALI: Epoch: 38, Steps: 68 | Train Loss: 0.0106044  Vali Loss: 0.0429058 Vali Accuracy: 0.9860031  Vali weighted F1: 0.9860708  Vali macro F1 0.9788491 
new best score!!!!
Validation loss decreased (0.043118 --> 0.042906).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 6.174999713897705
VALI: Epoch: 39, Steps: 68 | Train Loss: 0.0105621  Vali Loss: 0.0420649 Vali Accuracy: 0.9865215  Vali weighted F1: 0.9865931  Vali macro F1 0.9800261 
new best score!!!!
Validation loss decreased (0.042906 --> 0.042065).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 6.188700437545776
VALI: Epoch: 40, Steps: 68 | Train Loss: 0.0106964  Vali Loss: 0.0442038 Vali Accuracy: 0.9854847  Vali weighted F1: 0.9855463  Vali macro F1 0.9782906 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 6.186458349227905
VALI: Epoch: 41, Steps: 68 | Train Loss: 0.0100629  Vali Loss: 0.0422933 Vali Accuracy: 0.9885951  Vali weighted F1: 0.9886368  Vali macro F1 0.9827182 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 6.192614555358887
VALI: Epoch: 42, Steps: 68 | Train Loss: 0.0099392  Vali Loss: 0.0422338 Vali Accuracy: 0.9880767  Vali weighted F1: 0.9881223  Vali macro F1 0.9818828 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 6.172147989273071
VALI: Epoch: 43, Steps: 68 | Train Loss: 0.0091324  Vali Loss: 0.0453624 Vali Accuracy: 0.9849663  Vali weighted F1: 0.9850441  Vali macro F1 0.9778309 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 44 cost time: 6.175029754638672
VALI: Epoch: 44, Steps: 68 | Train Loss: 0.0091553  Vali Loss: 0.0463692 Vali Accuracy: 0.9854847  Vali weighted F1: 0.9855511  Vali macro F1 0.9786247 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 45 cost time: 6.173989295959473
VALI: Epoch: 45, Steps: 68 | Train Loss: 0.0088224  Vali Loss: 0.0443407 Vali Accuracy: 0.9865215  Vali weighted F1: 0.9865648  Vali macro F1 0.9796475 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 6.167142868041992
VALI: Epoch: 46, Steps: 68 | Train Loss: 0.0080258  Vali Loss: 0.0441963 Vali Accuracy: 0.9865215  Vali weighted F1: 0.9865648  Vali macro F1 0.9796475 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 6.166836500167847
VALI: Epoch: 47, Steps: 68 | Train Loss: 0.0099276  Vali Loss: 0.0445450 Vali Accuracy: 0.9865215  Vali weighted F1: 0.9865648  Vali macro F1 0.9796475 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 6.1616740226745605
VALI: Epoch: 48, Steps: 68 | Train Loss: 0.0082638  Vali Loss: 0.0442607 Vali Accuracy: 0.9865215  Vali weighted F1: 0.9865759  Vali macro F1 0.9799923 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 6.197885513305664
VALI: Epoch: 49, Steps: 68 | Train Loss: 0.0083341  Vali Loss: 0.0446012 Vali Accuracy: 0.9860031  Vali weighted F1: 0.9860611  Vali macro F1 0.9791559 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 50 cost time: 6.18441104888916
VALI: Epoch: 50, Steps: 68 | Train Loss: 0.0085875  Vali Loss: 0.0446438 Vali Accuracy: 0.9860031  Vali weighted F1: 0.9860611  Vali macro F1 0.9791559 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 6.1720781326293945
VALI: Epoch: 51, Steps: 68 | Train Loss: 0.0085419  Vali Loss: 0.0446791 Vali Accuracy: 0.9860031  Vali weighted F1: 0.9860611  Vali macro F1 0.9791559 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 6.163093328475952
VALI: Epoch: 52, Steps: 68 | Train Loss: 0.0085026  Vali Loss: 0.0445852 Vali Accuracy: 0.9860031  Vali weighted F1: 0.9860611  Vali macro F1 0.9791559 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 53 cost time: 6.169508934020996
VALI: Epoch: 53, Steps: 68 | Train Loss: 0.0089442  Vali Loss: 0.0445032 Vali Accuracy: 0.9865215  Vali weighted F1: 0.9865648  Vali macro F1 0.9796475 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 54 cost time: 6.177790880203247
VALI: Epoch: 54, Steps: 68 | Train Loss: 0.0083018  Vali Loss: 0.0443855 Vali Accuracy: 0.9870399  Vali weighted F1: 0.9870808  Vali macro F1 0.9804857 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9564983  Test weighted F1: 0.9571905  Test macro F1 0.9319716 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 240495
pruned model Parameter : 244174
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.197197675704956
Fine Tuning VALI: Epoch: 1, Steps: 68 | Train Loss: 0.0114077  Vali Loss: 0.0463332 Vali Accuracy: 0.9854847  Vali weighted F1: 0.9855996  Vali macro F1 0.9784674 
Validation loss decreased (inf --> 0.046333).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.1546220779418945
Fine Tuning VALI: Epoch: 2, Steps: 68 | Train Loss: 0.0109493  Vali Loss: 0.0443319 Vali Accuracy: 0.9854847  Vali weighted F1: 0.9855201  Vali macro F1 0.9789000 
new best score!!!!
Validation loss decreased (0.046333 --> 0.044332).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.189606666564941
Fine Tuning VALI: Epoch: 3, Steps: 68 | Train Loss: 0.0109410  Vali Loss: 0.0441369 Vali Accuracy: 0.9854847  Vali weighted F1: 0.9855452  Vali macro F1 0.9783229 
new best score!!!!
Validation loss decreased (0.044332 --> 0.044137).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.156393051147461
Fine Tuning VALI: Epoch: 4, Steps: 68 | Train Loss: 0.0096306  Vali Loss: 0.0452317 Vali Accuracy: 0.9880767  Vali weighted F1: 0.9881140  Vali macro F1 0.9824931 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.162025451660156
Fine Tuning VALI: Epoch: 5, Steps: 68 | Train Loss: 0.0088201  Vali Loss: 0.0426781 Vali Accuracy: 0.9875583  Vali weighted F1: 0.9875954  Vali macro F1 0.9816517 
new best score!!!!
Validation loss decreased (0.044137 --> 0.042678).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.165663480758667
Fine Tuning VALI: Epoch: 6, Steps: 68 | Train Loss: 0.0095944  Vali Loss: 0.0458395 Vali Accuracy: 0.9860031  Vali weighted F1: 0.9860734  Vali macro F1 0.9788555 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.16679573059082
Fine Tuning VALI: Epoch: 7, Steps: 68 | Train Loss: 0.0096153  Vali Loss: 0.0462195 Vali Accuracy: 0.9854847  Vali weighted F1: 0.9855353  Vali macro F1 0.9783122 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.165999889373779
Fine Tuning VALI: Epoch: 8, Steps: 68 | Train Loss: 0.0086100  Vali Loss: 0.0475765 Vali Accuracy: 0.9849663  Vali weighted F1: 0.9850711  Vali macro F1 0.9771146 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.164670944213867
Fine Tuning VALI: Epoch: 9, Steps: 68 | Train Loss: 0.0085109  Vali Loss: 0.0473299 Vali Accuracy: 0.9870399  Vali weighted F1: 0.9871134  Vali macro F1 0.9802479 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.158369064331055
Fine Tuning VALI: Epoch: 10, Steps: 68 | Train Loss: 0.0073966  Vali Loss: 0.0452130 Vali Accuracy: 0.9880767  Vali weighted F1: 0.9881097  Vali macro F1 0.9821887 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 11 cost time: 6.1643760204315186
Fine Tuning VALI: Epoch: 11, Steps: 68 | Train Loss: 0.0090602  Vali Loss: 0.0476900 Vali Accuracy: 0.9880767  Vali weighted F1: 0.9881369  Vali macro F1 0.9808140 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.182254076004028
Fine Tuning VALI: Epoch: 12, Steps: 68 | Train Loss: 0.0071370  Vali Loss: 0.0502157 Vali Accuracy: 0.9849663  Vali weighted F1: 0.9850208  Vali macro F1 0.9777622 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.174571752548218
Fine Tuning VALI: Epoch: 13, Steps: 68 | Train Loss: 0.0072687  Vali Loss: 0.0465028 Vali Accuracy: 0.9870399  Vali weighted F1: 0.9870865  Vali macro F1 0.9797295 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.165466547012329
Fine Tuning VALI: Epoch: 14, Steps: 68 | Train Loss: 0.0066981  Vali Loss: 0.0448114 Vali Accuracy: 0.9860031  Vali weighted F1: 0.9860562  Vali macro F1 0.9780589 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.174798011779785
Fine Tuning VALI: Epoch: 15, Steps: 68 | Train Loss: 0.0067940  Vali Loss: 0.0475985 Vali Accuracy: 0.9875583  Vali weighted F1: 0.9876235  Vali macro F1 0.9800094 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 16 cost time: 6.176909923553467
Fine Tuning VALI: Epoch: 16, Steps: 68 | Train Loss: 0.0058883  Vali Loss: 0.0473516 Vali Accuracy: 0.9870399  Vali weighted F1: 0.9871085  Vali macro F1 0.9791753 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 6.172974586486816
Fine Tuning VALI: Epoch: 17, Steps: 68 | Train Loss: 0.0060144  Vali Loss: 0.0476219 Vali Accuracy: 0.9875583  Vali weighted F1: 0.9876235  Vali macro F1 0.9800094 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 6.178383111953735
Fine Tuning VALI: Epoch: 18, Steps: 68 | Train Loss: 0.0059897  Vali Loss: 0.0469260 Vali Accuracy: 0.9875583  Vali weighted F1: 0.9876146  Vali macro F1 0.9796706 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 6.169372320175171
Fine Tuning VALI: Epoch: 19, Steps: 68 | Train Loss: 0.0056121  Vali Loss: 0.0464754 Vali Accuracy: 0.9875583  Vali weighted F1: 0.9876146  Vali macro F1 0.9796706 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 6.174304008483887
Fine Tuning VALI: Epoch: 20, Steps: 68 | Train Loss: 0.0060216  Vali Loss: 0.0471827 Vali Accuracy: 0.9875583  Vali weighted F1: 0.9876235  Vali macro F1 0.9800094 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9555744  Test weighted F1: 0.9561745  Test macro F1 0.9309157 
================ the 2 th CV Experiment ================ 
Leave one Out Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.00014843 0.00018235 0.00095238 0.00126904 0.00049925 0.00061652]
Train data number :  17684
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1965
Test data number :  11154
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.33800482749939
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.0375263  Vali Loss: 0.5957550 Vali Accuracy: 0.7674300  Vali weighted F1: 0.7325556  Vali macro F1 0.5207984 
Validation loss decreased (inf --> 0.595755).  Saving model ...
Epoch: 2 cost time: 6.259808540344238
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.4850135  Vali Loss: 0.3948934 Vali Accuracy: 0.8595420  Vali weighted F1: 0.8504936  Vali macro F1 0.8096234 
new best score!!!!
Validation loss decreased (0.595755 --> 0.394893).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.25675368309021
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.3644393  Vali Loss: 0.3213033 Vali Accuracy: 0.8854962  Vali weighted F1: 0.8760777  Vali macro F1 0.8376045 
new best score!!!!
Validation loss decreased (0.394893 --> 0.321303).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.244602680206299
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.2762184  Vali Loss: 0.2063911 Vali Accuracy: 0.9307888  Vali weighted F1: 0.9296971  Vali macro F1 0.9068229 
new best score!!!!
Validation loss decreased (0.321303 --> 0.206391).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.257684230804443
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.2166938  Vali Loss: 0.1724041 Vali Accuracy: 0.9404580  Vali weighted F1: 0.9408896  Vali macro F1 0.9199497 
new best score!!!!
Validation loss decreased (0.206391 --> 0.172404).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.253415822982788
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.1807883  Vali Loss: 0.1440226 Vali Accuracy: 0.9501272  Vali weighted F1: 0.9501222  Vali macro F1 0.9303232 
new best score!!!!
Validation loss decreased (0.172404 --> 0.144023).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.262491226196289
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.1556583  Vali Loss: 0.1844286 Vali Accuracy: 0.9302799  Vali weighted F1: 0.9266881  Vali macro F1 0.9047542 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 8 cost time: 6.277872562408447
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1455542  Vali Loss: 0.1173541 Vali Accuracy: 0.9613232  Vali weighted F1: 0.9616262  Vali macro F1 0.9465486 
new best score!!!!
Validation loss decreased (0.144023 --> 0.117354).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.279670238494873
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1274019  Vali Loss: 0.1088407 Vali Accuracy: 0.9613232  Vali weighted F1: 0.9616365  Vali macro F1 0.9452097 
new best score!!!!
Validation loss decreased (0.117354 --> 0.108841).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.295389175415039
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1258030  Vali Loss: 0.1294495 Vali Accuracy: 0.9582697  Vali weighted F1: 0.9588876  Vali macro F1 0.9431598 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.256363391876221
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1045934  Vali Loss: 0.1016151 Vali Accuracy: 0.9648855  Vali weighted F1: 0.9652089  Vali macro F1 0.9508909 
new best score!!!!
Validation loss decreased (0.108841 --> 0.101615).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.261713027954102
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.1008732  Vali Loss: 0.1068959 Vali Accuracy: 0.9603053  Vali weighted F1: 0.9607941  Vali macro F1 0.9440890 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 6.263212442398071
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0923008  Vali Loss: 0.1039571 Vali Accuracy: 0.9659033  Vali weighted F1: 0.9658637  Vali macro F1 0.9522322 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 14 cost time: 6.263261318206787
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0872854  Vali Loss: 0.1031958 Vali Accuracy: 0.9648855  Vali weighted F1: 0.9640939  Vali macro F1 0.9504469 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 15 cost time: 6.2674994468688965
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0798130  Vali Loss: 0.0729670 Vali Accuracy: 0.9786260  Vali weighted F1: 0.9787954  Vali macro F1 0.9730254 
new best score!!!!
Validation loss decreased (0.101615 --> 0.072967).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.279897689819336
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0688042  Vali Loss: 0.0759728 Vali Accuracy: 0.9770992  Vali weighted F1: 0.9772384  Vali macro F1 0.9705742 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 6.287181377410889
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0652927  Vali Loss: 0.0687283 Vali Accuracy: 0.9801527  Vali weighted F1: 0.9801500  Vali macro F1 0.9741543 
new best score!!!!
Validation loss decreased (0.072967 --> 0.068728).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.290860414505005
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0692592  Vali Loss: 0.1034095 Vali Accuracy: 0.9679389  Vali weighted F1: 0.9669097  Vali macro F1 0.9602445 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.275776386260986
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0738606  Vali Loss: 0.0671397 Vali Accuracy: 0.9776081  Vali weighted F1: 0.9778133  Vali macro F1 0.9705271 
new best score!!!!
Validation loss decreased (0.068728 --> 0.067140).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.276336908340454
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0557314  Vali Loss: 0.0634045 Vali Accuracy: 0.9796438  Vali weighted F1: 0.9796712  Vali macro F1 0.9728595 
new best score!!!!
Validation loss decreased (0.067140 --> 0.063405).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.2683165073394775
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0471100  Vali Loss: 0.0524679 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9853612  Vali macro F1 0.9807977 
new best score!!!!
Validation loss decreased (0.063405 --> 0.052468).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.275472164154053
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0450978  Vali Loss: 0.0543292 Vali Accuracy: 0.9826972  Vali weighted F1: 0.9827087  Vali macro F1 0.9782926 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.2656569480896
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0408250  Vali Loss: 0.0607943 Vali Accuracy: 0.9801527  Vali weighted F1: 0.9802904  Vali macro F1 0.9744314 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 6.264036178588867
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0382014  Vali Loss: 0.0725088 Vali Accuracy: 0.9776081  Vali weighted F1: 0.9775371  Vali macro F1 0.9712568 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 25 cost time: 6.271929502487183
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0380811  Vali Loss: 0.0657666 Vali Accuracy: 0.9821883  Vali weighted F1: 0.9823942  Vali macro F1 0.9764604 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 26 cost time: 6.272430181503296
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0328034  Vali Loss: 0.0585842 Vali Accuracy: 0.9821883  Vali weighted F1: 0.9821739  Vali macro F1 0.9756922 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 27 cost time: 6.291486740112305
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0227770  Vali Loss: 0.0463555 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9858196  Vali macro F1 0.9811830 
new best score!!!!
Validation loss decreased (0.052468 --> 0.046356).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.288054704666138
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0198906  Vali Loss: 0.0456491 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9853019  Vali macro F1 0.9805977 
new best score!!!!
Validation loss decreased (0.046356 --> 0.045649).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.270510196685791
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0188984  Vali Loss: 0.0462471 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9873439  Vali macro F1 0.9835772 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 6.263190031051636
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0183933  Vali Loss: 0.0474226 Vali Accuracy: 0.9867684  Vali weighted F1: 0.9868305  Vali macro F1 0.9832682 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 6.2674431800842285
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0190546  Vali Loss: 0.0484520 Vali Accuracy: 0.9867684  Vali weighted F1: 0.9868487  Vali macro F1 0.9832960 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 32 cost time: 6.2698869705200195
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0177282  Vali Loss: 0.0497354 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9858113  Vali macro F1 0.9816905 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 33 cost time: 6.2734534740448
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0174175  Vali Loss: 0.0489279 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9863208  Vali macro F1 0.9826101 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 34 cost time: 6.267850160598755
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0156678  Vali Loss: 0.0481343 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9863208  Vali macro F1 0.9826101 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 6.26647162437439
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0158001  Vali Loss: 0.0484487 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9858184  Vali macro F1 0.9822018 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 6.294349431991577
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0150651  Vali Loss: 0.0475883 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9858051  Vali macro F1 0.9820017 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 6.28605842590332
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0161109  Vali Loss: 0.0488251 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9863353  Vali macro F1 0.9827182 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 6.266454696655273
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0154273  Vali Loss: 0.0487255 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9858013  Vali macro F1 0.9820819 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 39 cost time: 6.268641471862793
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0143121  Vali Loss: 0.0486049 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9858013  Vali macro F1 0.9820819 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 6.263036012649536
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0169813  Vali Loss: 0.0484523 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9863162  Vali macro F1 0.9826622 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 6.260496616363525
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0159029  Vali Loss: 0.0484193 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9863171  Vali macro F1 0.9826904 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 6.2778425216674805
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0154524  Vali Loss: 0.0482208 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9863162  Vali macro F1 0.9826622 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 6.267048597335815
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0148152  Vali Loss: 0.0480303 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9863162  Vali macro F1 0.9826622 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8541330  Test weighted F1: 0.8622041  Test macro F1 0.8580873 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 240495
pruned model Parameter : 244174
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.251161813735962
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0202936  Vali Loss: 0.0459212 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9873663  Vali macro F1 0.9837007 
Validation loss decreased (inf --> 0.045921).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.248215675354004
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0186931  Vali Loss: 0.0477534 Vali Accuracy: 0.9867684  Vali weighted F1: 0.9868488  Vali macro F1 0.9831763 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.241734266281128
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0179749  Vali Loss: 0.0465929 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9863315  Vali macro F1 0.9826115 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.21241569519043
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0185927  Vali Loss: 0.0495487 Vali Accuracy: 0.9867684  Vali weighted F1: 0.9868747  Vali macro F1 0.9826420 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.242713451385498
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0171736  Vali Loss: 0.0508645 Vali Accuracy: 0.9867684  Vali weighted F1: 0.9868647  Vali macro F1 0.9832110 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.246061563491821
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0168520  Vali Loss: 0.0471231 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9873299  Vali macro F1 0.9838982 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.243379592895508
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0154832  Vali Loss: 0.0487356 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9883717  Vali macro F1 0.9849204 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.232819557189941
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0149285  Vali Loss: 0.0505945 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9863380  Vali macro F1 0.9826365 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.227160215377808
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0141788  Vali Loss: 0.0457183 Vali Accuracy: 0.9867684  Vali weighted F1: 0.9868373  Vali macro F1 0.9828804 
new best score!!!!
Validation loss decreased (0.045921 --> 0.045718).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 6.242866277694702
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0141315  Vali Loss: 0.0452059 Vali Accuracy: 0.9857506  Vali weighted F1: 0.9857644  Vali macro F1 0.9817244 
new best score!!!!
Validation loss decreased (0.045718 --> 0.045206).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 6.2835516929626465
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0141544  Vali Loss: 0.0475702 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9863487  Vali macro F1 0.9820313 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.2573559284210205
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0136905  Vali Loss: 0.0461492 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9878464  Vali macro F1 0.9842673 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.239816904067993
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0149137  Vali Loss: 0.0473631 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9863227  Vali macro F1 0.9821736 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.236333847045898
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0126168  Vali Loss: 0.0475026 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9863093  Vali macro F1 0.9824566 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.225043535232544
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0130293  Vali Loss: 0.0484907 Vali Accuracy: 0.9867684  Vali weighted F1: 0.9868370  Vali macro F1 0.9833221 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 16 cost time: 6.228340148925781
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0116949  Vali Loss: 0.0469737 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9878431  Vali macro F1 0.9848724 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 6.230157136917114
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0109407  Vali Loss: 0.0462460 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9878492  Vali macro F1 0.9846249 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 6.2278876304626465
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0118454  Vali Loss: 0.0469884 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9873282  Vali macro F1 0.9840288 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 6.237946033477783
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0105406  Vali Loss: 0.0468542 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9873369  Vali macro F1 0.9838124 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 6.243708372116089
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0105673  Vali Loss: 0.0470803 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9878496  Vali macro F1 0.9844754 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 21 cost time: 6.25176477432251
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0110004  Vali Loss: 0.0470738 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9873447  Vali macro F1 0.9836535 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 6.241140604019165
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0099924  Vali Loss: 0.0469312 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9878496  Vali macro F1 0.9844754 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 6.227313280105591
Fine Tuning VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0109921  Vali Loss: 0.0471466 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9873447  Vali macro F1 0.9836535 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 6.2471795082092285
Fine Tuning VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0108743  Vali Loss: 0.0471524 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9873447  Vali macro F1 0.9836535 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 25 cost time: 6.238708734512329
Fine Tuning VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0108808  Vali Loss: 0.0470933 Vali Accuracy: 0.9872774  Vali weighted F1: 0.9873447  Vali macro F1 0.9836535 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8518020  Test weighted F1: 0.8588790  Test macro F1 0.8546699 
================ the 3 th CV Experiment ================ 
Leave one Out Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00014899 0.00018302 0.000998   0.00125313 0.00052329 0.00063052]
Train data number :  17473
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1942
Test data number :  12314
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.157054424285889
VALI: Epoch: 1, Steps: 69 | Train Loss: 1.0344328  Vali Loss: 0.6710411 Vali Accuracy: 0.7528321  Vali weighted F1: 0.7098795  Vali macro F1 0.5153302 
Validation loss decreased (inf --> 0.671041).  Saving model ...
Epoch: 2 cost time: 6.151172637939453
VALI: Epoch: 2, Steps: 69 | Train Loss: 0.5309250  Vali Loss: 0.4149555 Vali Accuracy: 0.8496395  Vali weighted F1: 0.8287846  Vali macro F1 0.7871634 
new best score!!!!
Validation loss decreased (0.671041 --> 0.414956).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.157818794250488
VALI: Epoch: 3, Steps: 69 | Train Loss: 0.3609094  Vali Loss: 0.2833533 Vali Accuracy: 0.8939238  Vali weighted F1: 0.8890643  Vali macro F1 0.8573116 
new best score!!!!
Validation loss decreased (0.414956 --> 0.283353).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.165770769119263
VALI: Epoch: 4, Steps: 69 | Train Loss: 0.2573010  Vali Loss: 0.2244382 Vali Accuracy: 0.9196704  Vali weighted F1: 0.9177883  Vali macro F1 0.8953156 
new best score!!!!
Validation loss decreased (0.283353 --> 0.224438).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.158147096633911
VALI: Epoch: 5, Steps: 69 | Train Loss: 0.2113753  Vali Loss: 0.1825755 Vali Accuracy: 0.9346035  Vali weighted F1: 0.9347339  Vali macro F1 0.9160003 
new best score!!!!
Validation loss decreased (0.224438 --> 0.182576).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.157466411590576
VALI: Epoch: 6, Steps: 69 | Train Loss: 0.1829171  Vali Loss: 0.1592573 Vali Accuracy: 0.9449022  Vali weighted F1: 0.9449012  Vali macro F1 0.9281161 
new best score!!!!
Validation loss decreased (0.182576 --> 0.159257).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.157582998275757
VALI: Epoch: 7, Steps: 69 | Train Loss: 0.1553141  Vali Loss: 0.1559752 Vali Accuracy: 0.9392379  Vali weighted F1: 0.9388845  Vali macro F1 0.9206344 
new best score!!!!
Validation loss decreased (0.159257 --> 0.155975).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.153510093688965
VALI: Epoch: 8, Steps: 69 | Train Loss: 0.1478686  Vali Loss: 0.1367314 Vali Accuracy: 0.9510814  Vali weighted F1: 0.9511175  Vali macro F1 0.9355413 
new best score!!!!
Validation loss decreased (0.155975 --> 0.136731).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.1513800621032715
VALI: Epoch: 9, Steps: 69 | Train Loss: 0.1279502  Vali Loss: 0.1311329 Vali Accuracy: 0.9521112  Vali weighted F1: 0.9526033  Vali macro F1 0.9355353 
new best score!!!!
Validation loss decreased (0.136731 --> 0.131133).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.16070818901062
VALI: Epoch: 10, Steps: 69 | Train Loss: 0.1214007  Vali Loss: 0.1441424 Vali Accuracy: 0.9500515  Vali weighted F1: 0.9508167  Vali macro F1 0.9351191 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.168274164199829
VALI: Epoch: 11, Steps: 69 | Train Loss: 0.1178352  Vali Loss: 0.1299874 Vali Accuracy: 0.9552008  Vali weighted F1: 0.9547343  Vali macro F1 0.9442171 
new best score!!!!
Validation loss decreased (0.131133 --> 0.129987).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.179175853729248
VALI: Epoch: 12, Steps: 69 | Train Loss: 0.1040513  Vali Loss: 0.0934171 Vali Accuracy: 0.9701339  Vali weighted F1: 0.9703286  Vali macro F1 0.9632958 
new best score!!!!
Validation loss decreased (0.129987 --> 0.093417).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.1656529903411865
VALI: Epoch: 13, Steps: 69 | Train Loss: 0.0925770  Vali Loss: 0.0880100 Vali Accuracy: 0.9732235  Vali weighted F1: 0.9733114  Vali macro F1 0.9677662 
new best score!!!!
Validation loss decreased (0.093417 --> 0.088010).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.156081199645996
VALI: Epoch: 14, Steps: 69 | Train Loss: 0.0849578  Vali Loss: 0.1140161 Vali Accuracy: 0.9603502  Vali weighted F1: 0.9597104  Vali macro F1 0.9484261 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.148848056793213
VALI: Epoch: 15, Steps: 69 | Train Loss: 0.0835543  Vali Loss: 0.0835102 Vali Accuracy: 0.9711637  Vali weighted F1: 0.9714710  Vali macro F1 0.9644856 
new best score!!!!
Validation loss decreased (0.088010 --> 0.083510).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.1510419845581055
VALI: Epoch: 16, Steps: 69 | Train Loss: 0.0709982  Vali Loss: 0.0842059 Vali Accuracy: 0.9727085  Vali weighted F1: 0.9726163  Vali macro F1 0.9653050 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 6.153005599975586
VALI: Epoch: 17, Steps: 69 | Train Loss: 0.0715543  Vali Loss: 0.0773199 Vali Accuracy: 0.9763131  Vali weighted F1: 0.9764726  Vali macro F1 0.9702203 
new best score!!!!
Validation loss decreased (0.083510 --> 0.077320).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.163077116012573
VALI: Epoch: 18, Steps: 69 | Train Loss: 0.0647272  Vali Loss: 0.0814654 Vali Accuracy: 0.9757981  Vali weighted F1: 0.9757798  Vali macro F1 0.9706977 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.15440821647644
VALI: Epoch: 19, Steps: 69 | Train Loss: 0.0613898  Vali Loss: 0.0776050 Vali Accuracy: 0.9752832  Vali weighted F1: 0.9753023  Vali macro F1 0.9682822 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 6.163742780685425
VALI: Epoch: 20, Steps: 69 | Train Loss: 0.0545506  Vali Loss: 0.0931424 Vali Accuracy: 0.9732235  Vali weighted F1: 0.9727968  Vali macro F1 0.9694462 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 21 cost time: 6.152288198471069
VALI: Epoch: 21, Steps: 69 | Train Loss: 0.0501081  Vali Loss: 0.0707124 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9803314  Vali macro F1 0.9757226 
new best score!!!!
Validation loss decreased (0.077320 --> 0.070712).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.173184871673584
VALI: Epoch: 22, Steps: 69 | Train Loss: 0.0477680  Vali Loss: 0.0798594 Vali Accuracy: 0.9752832  Vali weighted F1: 0.9754271  Vali macro F1 0.9696529 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.154886960983276
VALI: Epoch: 23, Steps: 69 | Train Loss: 0.0493470  Vali Loss: 0.0681139 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9810582  Vali macro F1 0.9770827 
new best score!!!!
Validation loss decreased (0.070712 --> 0.068114).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.161412477493286
VALI: Epoch: 24, Steps: 69 | Train Loss: 0.0366400  Vali Loss: 0.0712168 Vali Accuracy: 0.9799176  Vali weighted F1: 0.9797650  Vali macro F1 0.9765658 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 6.163823843002319
VALI: Epoch: 25, Steps: 69 | Train Loss: 0.0515078  Vali Loss: 0.0624936 Vali Accuracy: 0.9804325  Vali weighted F1: 0.9804596  Vali macro F1 0.9733916 
new best score!!!!
Validation loss decreased (0.068114 --> 0.062494).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.151520490646362
VALI: Epoch: 26, Steps: 69 | Train Loss: 0.0380895  Vali Loss: 0.0625210 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9824587  Vali macro F1 0.9800941 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 6.153796672821045
VALI: Epoch: 27, Steps: 69 | Train Loss: 0.0413309  Vali Loss: 0.1092827 Vali Accuracy: 0.9670443  Vali weighted F1: 0.9678181  Vali macro F1 0.9587500 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 6.1445019245147705
VALI: Epoch: 28, Steps: 69 | Train Loss: 0.0342774  Vali Loss: 0.0662950 Vali Accuracy: 0.9794027  Vali weighted F1: 0.9794034  Vali macro F1 0.9740512 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 29 cost time: 6.164342880249023
VALI: Epoch: 29, Steps: 69 | Train Loss: 0.0304436  Vali Loss: 0.0621923 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9814872  Vali macro F1 0.9773552 
new best score!!!!
Validation loss decreased (0.062494 --> 0.062192).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.169131278991699
VALI: Epoch: 30, Steps: 69 | Train Loss: 0.0386696  Vali Loss: 0.0607144 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9825325  Vali macro F1 0.9793657 
new best score!!!!
Validation loss decreased (0.062192 --> 0.060714).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.154467582702637
VALI: Epoch: 31, Steps: 69 | Train Loss: 0.0280375  Vali Loss: 0.0566513 Vali Accuracy: 0.9835221  Vali weighted F1: 0.9835159  Vali macro F1 0.9754120 
new best score!!!!
Validation loss decreased (0.060714 --> 0.056651).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.158057689666748
VALI: Epoch: 32, Steps: 69 | Train Loss: 0.0231114  Vali Loss: 0.0609568 Vali Accuracy: 0.9835221  Vali weighted F1: 0.9836047  Vali macro F1 0.9798313 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 6.1464598178863525
VALI: Epoch: 33, Steps: 69 | Train Loss: 0.0237769  Vali Loss: 0.0629308 Vali Accuracy: 0.9835221  Vali weighted F1: 0.9835274  Vali macro F1 0.9792421 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 6.154041528701782
VALI: Epoch: 34, Steps: 69 | Train Loss: 0.0224070  Vali Loss: 0.0551231 Vali Accuracy: 0.9819773  Vali weighted F1: 0.9820767  Vali macro F1 0.9780816 
new best score!!!!
Validation loss decreased (0.056651 --> 0.055123).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 6.154000759124756
VALI: Epoch: 35, Steps: 69 | Train Loss: 0.0206535  Vali Loss: 0.0599504 Vali Accuracy: 0.9830072  Vali weighted F1: 0.9830640  Vali macro F1 0.9787079 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 6.145924806594849
VALI: Epoch: 36, Steps: 69 | Train Loss: 0.0268674  Vali Loss: 0.0718727 Vali Accuracy: 0.9783728  Vali weighted F1: 0.9783628  Vali macro F1 0.9739063 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 6.163401365280151
VALI: Epoch: 37, Steps: 69 | Train Loss: 0.0256223  Vali Loss: 0.0760126 Vali Accuracy: 0.9747683  Vali weighted F1: 0.9747133  Vali macro F1 0.9696199 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 6.168046474456787
VALI: Epoch: 38, Steps: 69 | Train Loss: 0.0243316  Vali Loss: 0.0535705 Vali Accuracy: 0.9845520  Vali weighted F1: 0.9845350  Vali macro F1 0.9815797 
new best score!!!!
Validation loss decreased (0.055123 --> 0.053571).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 6.173643589019775
VALI: Epoch: 39, Steps: 69 | Train Loss: 0.0136635  Vali Loss: 0.0591289 Vali Accuracy: 0.9835221  Vali weighted F1: 0.9834417  Vali macro F1 0.9793557 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 6.162611246109009
VALI: Epoch: 40, Steps: 69 | Train Loss: 0.0321684  Vali Loss: 0.0668302 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9807841  Vali macro F1 0.9777790 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 6.17827844619751
VALI: Epoch: 41, Steps: 69 | Train Loss: 0.0170685  Vali Loss: 0.0589693 Vali Accuracy: 0.9840371  Vali weighted F1: 0.9840490  Vali macro F1 0.9772204 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 6.145077228546143
VALI: Epoch: 42, Steps: 69 | Train Loss: 0.0183944  Vali Loss: 0.0661516 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9815008  Vali macro F1 0.9768307 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 6.142695188522339
VALI: Epoch: 43, Steps: 69 | Train Loss: 0.0135026  Vali Loss: 0.0601309 Vali Accuracy: 0.9860968  Vali weighted F1: 0.9860612  Vali macro F1 0.9838699 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 44 cost time: 6.152432680130005
VALI: Epoch: 44, Steps: 69 | Train Loss: 0.0089870  Vali Loss: 0.0547082 Vali Accuracy: 0.9850669  Vali weighted F1: 0.9850398  Vali macro F1 0.9825635 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 6.147261381149292
VALI: Epoch: 45, Steps: 69 | Train Loss: 0.0065654  Vali Loss: 0.0507004 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9855879  Vali macro F1 0.9828727 
new best score!!!!
Validation loss decreased (0.053571 --> 0.050700).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 6.18198299407959
VALI: Epoch: 46, Steps: 69 | Train Loss: 0.0069543  Vali Loss: 0.0504798 Vali Accuracy: 0.9876416  Vali weighted F1: 0.9876471  Vali macro F1 0.9855022 
new best score!!!!
Validation loss decreased (0.050700 --> 0.050480).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 6.182190179824829
VALI: Epoch: 47, Steps: 69 | Train Loss: 0.0060558  Vali Loss: 0.0502999 Vali Accuracy: 0.9876416  Vali weighted F1: 0.9876507  Vali macro F1 0.9858151 
new best score!!!!
Validation loss decreased (0.050480 --> 0.050300).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 6.154419660568237
VALI: Epoch: 48, Steps: 69 | Train Loss: 0.0061558  Vali Loss: 0.0510157 Vali Accuracy: 0.9866117  Vali weighted F1: 0.9866121  Vali macro F1 0.9844347 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 6.149441719055176
VALI: Epoch: 49, Steps: 69 | Train Loss: 0.0063305  Vali Loss: 0.0499614 Vali Accuracy: 0.9876416  Vali weighted F1: 0.9876472  Vali macro F1 0.9855294 
new best score!!!!
Validation loss decreased (0.050300 --> 0.049961).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 6.152735710144043
VALI: Epoch: 50, Steps: 69 | Train Loss: 0.0050877  Vali Loss: 0.0495162 Vali Accuracy: 0.9881565  Vali weighted F1: 0.9881679  Vali macro F1 0.9860752 
new best score!!!!
Validation loss decreased (0.049961 --> 0.049516).  Saving model ...
new best score!!!!
Epoch: 51 cost time: 6.150817155838013
VALI: Epoch: 51, Steps: 69 | Train Loss: 0.0051467  Vali Loss: 0.0502400 Vali Accuracy: 0.9866117  Vali weighted F1: 0.9866185  Vali macro F1 0.9839300 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 6.155140161514282
VALI: Epoch: 52, Steps: 69 | Train Loss: 0.0061813  Vali Loss: 0.0518705 Vali Accuracy: 0.9881565  Vali weighted F1: 0.9881680  Vali macro F1 0.9860275 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 53 cost time: 6.153773307800293
VALI: Epoch: 53, Steps: 69 | Train Loss: 0.0054189  Vali Loss: 0.0500843 Vali Accuracy: 0.9891864  Vali weighted F1: 0.9891994  Vali macro F1 0.9873927 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 54 cost time: 6.1672985553741455
VALI: Epoch: 54, Steps: 69 | Train Loss: 0.0057206  Vali Loss: 0.0521586 Vali Accuracy: 0.9860968  Vali weighted F1: 0.9860978  Vali macro F1 0.9833577 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 55 cost time: 6.183726787567139
VALI: Epoch: 55, Steps: 69 | Train Loss: 0.0054487  Vali Loss: 0.0523479 Vali Accuracy: 0.9876416  Vali weighted F1: 0.9876260  Vali macro F1 0.9854452 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 56 cost time: 6.165567636489868
VALI: Epoch: 56, Steps: 69 | Train Loss: 0.0052569  Vali Loss: 0.0520790 Vali Accuracy: 0.9876416  Vali weighted F1: 0.9876235  Vali macro F1 0.9854634 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 57 cost time: 6.155375957489014
VALI: Epoch: 57, Steps: 69 | Train Loss: 0.0048202  Vali Loss: 0.0518483 Vali Accuracy: 0.9876416  Vali weighted F1: 0.9876286  Vali macro F1 0.9854687 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 58 cost time: 6.153652667999268
VALI: Epoch: 58, Steps: 69 | Train Loss: 0.0055680  Vali Loss: 0.0511962 Vali Accuracy: 0.9871267  Vali weighted F1: 0.9871078  Vali macro F1 0.9849228 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 59 cost time: 6.153027057647705
VALI: Epoch: 59, Steps: 69 | Train Loss: 0.0045260  Vali Loss: 0.0507772 Vali Accuracy: 0.9886715  Vali weighted F1: 0.9886688  Vali macro F1 0.9865173 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 60 cost time: 6.164339303970337
VALI: Epoch: 60, Steps: 69 | Train Loss: 0.0046930  Vali Loss: 0.0508768 Vali Accuracy: 0.9881565  Vali weighted F1: 0.9881450  Vali macro F1 0.9859413 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 61 cost time: 6.1581385135650635
VALI: Epoch: 61, Steps: 69 | Train Loss: 0.0047278  Vali Loss: 0.0508339 Vali Accuracy: 0.9881565  Vali weighted F1: 0.9881450  Vali macro F1 0.9859413 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 62 cost time: 6.160646677017212
VALI: Epoch: 62, Steps: 69 | Train Loss: 0.0046154  Vali Loss: 0.0508680 Vali Accuracy: 0.9881565  Vali weighted F1: 0.9881450  Vali macro F1 0.9859413 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 63 cost time: 6.179732084274292
VALI: Epoch: 63, Steps: 69 | Train Loss: 0.0046618  Vali Loss: 0.0508701 Vali Accuracy: 0.9881565  Vali weighted F1: 0.9881450  Vali macro F1 0.9859413 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 64 cost time: 6.17436957359314
VALI: Epoch: 64, Steps: 69 | Train Loss: 0.0051782  Vali Loss: 0.0508877 Vali Accuracy: 0.9886715  Vali weighted F1: 0.9886701  Vali macro F1 0.9864714 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 65 cost time: 6.15505838394165
VALI: Epoch: 65, Steps: 69 | Train Loss: 0.0042773  Vali Loss: 0.0508943 Vali Accuracy: 0.9886715  Vali weighted F1: 0.9886701  Vali macro F1 0.9864714 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9699529  Test weighted F1: 0.9693656  Test macro F1 0.9601279 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 240495
pruned model Parameter : 244174
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.178979873657227
Fine Tuning VALI: Epoch: 1, Steps: 69 | Train Loss: 0.0064401  Vali Loss: 0.0527276 Vali Accuracy: 0.9860968  Vali weighted F1: 0.9860982  Vali macro F1 0.9833307 
Validation loss decreased (inf --> 0.052728).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.175567626953125
Fine Tuning VALI: Epoch: 2, Steps: 69 | Train Loss: 0.0048165  Vali Loss: 0.0530357 Vali Accuracy: 0.9876416  Vali weighted F1: 0.9876391  Vali macro F1 0.9851548 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.163086414337158
Fine Tuning VALI: Epoch: 3, Steps: 69 | Train Loss: 0.0049876  Vali Loss: 0.0522147 Vali Accuracy: 0.9871267  Vali weighted F1: 0.9871355  Vali macro F1 0.9844447 
new best score!!!!
Validation loss decreased (0.052728 --> 0.052215).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.167273044586182
Fine Tuning VALI: Epoch: 4, Steps: 69 | Train Loss: 0.0051030  Vali Loss: 0.0589426 Vali Accuracy: 0.9850669  Vali weighted F1: 0.9850968  Vali macro F1 0.9823935 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.1890833377838135
Fine Tuning VALI: Epoch: 5, Steps: 69 | Train Loss: 0.0050072  Vali Loss: 0.0538366 Vali Accuracy: 0.9876416  Vali weighted F1: 0.9876572  Vali macro F1 0.9852619 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 6.202022075653076
Fine Tuning VALI: Epoch: 6, Steps: 69 | Train Loss: 0.0043929  Vali Loss: 0.0546077 Vali Accuracy: 0.9876416  Vali weighted F1: 0.9876553  Vali macro F1 0.9854936 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 6.197437286376953
Fine Tuning VALI: Epoch: 7, Steps: 69 | Train Loss: 0.0052079  Vali Loss: 0.0541152 Vali Accuracy: 0.9876416  Vali weighted F1: 0.9876536  Vali macro F1 0.9852046 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 8 cost time: 6.183956146240234
Fine Tuning VALI: Epoch: 8, Steps: 69 | Train Loss: 0.0043515  Vali Loss: 0.0532397 Vali Accuracy: 0.9866117  Vali weighted F1: 0.9865844  Vali macro F1 0.9841087 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 9 cost time: 6.167600870132446
Fine Tuning VALI: Epoch: 9, Steps: 69 | Train Loss: 0.0041329  Vali Loss: 0.0510218 Vali Accuracy: 0.9871267  Vali weighted F1: 0.9871116  Vali macro F1 0.9849787 
new best score!!!!
Validation loss decreased (0.052215 --> 0.051022).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 6.176835060119629
Fine Tuning VALI: Epoch: 10, Steps: 69 | Train Loss: 0.0041992  Vali Loss: 0.0532280 Vali Accuracy: 0.9871267  Vali weighted F1: 0.9871354  Vali macro F1 0.9843702 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 6.172222852706909
Fine Tuning VALI: Epoch: 11, Steps: 69 | Train Loss: 0.0038222  Vali Loss: 0.0541205 Vali Accuracy: 0.9871267  Vali weighted F1: 0.9871046  Vali macro F1 0.9846065 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 6.176565170288086
Fine Tuning VALI: Epoch: 12, Steps: 69 | Train Loss: 0.0046671  Vali Loss: 0.0601508 Vali Accuracy: 0.9860968  Vali weighted F1: 0.9860867  Vali macro F1 0.9836686 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 6.161184549331665
Fine Tuning VALI: Epoch: 13, Steps: 69 | Train Loss: 0.0040651  Vali Loss: 0.0644298 Vali Accuracy: 0.9835221  Vali weighted F1: 0.9834509  Vali macro F1 0.9806839 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 14 cost time: 6.179142475128174
Fine Tuning VALI: Epoch: 14, Steps: 69 | Train Loss: 0.0033461  Vali Loss: 0.0612491 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9855350  Vali macro F1 0.9821698 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 15 cost time: 6.1783764362335205
Fine Tuning VALI: Epoch: 15, Steps: 69 | Train Loss: 0.0031915  Vali Loss: 0.0598016 Vali Accuracy: 0.9860968  Vali weighted F1: 0.9860711  Vali macro F1 0.9826432 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.175279855728149
Fine Tuning VALI: Epoch: 16, Steps: 69 | Train Loss: 0.0033261  Vali Loss: 0.0584560 Vali Accuracy: 0.9860968  Vali weighted F1: 0.9860788  Vali macro F1 0.9826596 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 6.18523097038269
Fine Tuning VALI: Epoch: 17, Steps: 69 | Train Loss: 0.0035272  Vali Loss: 0.0590020 Vali Accuracy: 0.9866117  Vali weighted F1: 0.9865935  Vali macro F1 0.9838137 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 6.180537223815918
Fine Tuning VALI: Epoch: 18, Steps: 69 | Train Loss: 0.0033619  Vali Loss: 0.0585932 Vali Accuracy: 0.9866117  Vali weighted F1: 0.9865935  Vali macro F1 0.9838137 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 6.166652202606201
Fine Tuning VALI: Epoch: 19, Steps: 69 | Train Loss: 0.0031890  Vali Loss: 0.0581288 Vali Accuracy: 0.9860968  Vali weighted F1: 0.9860824  Vali macro F1 0.9830213 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 20 cost time: 6.175695419311523
Fine Tuning VALI: Epoch: 20, Steps: 69 | Train Loss: 0.0029001  Vali Loss: 0.0581776 Vali Accuracy: 0.9860968  Vali weighted F1: 0.9860824  Vali macro F1 0.9830213 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 6.166810035705566
Fine Tuning VALI: Epoch: 21, Steps: 69 | Train Loss: 0.0029767  Vali Loss: 0.0581373 Vali Accuracy: 0.9860968  Vali weighted F1: 0.9860824  Vali macro F1 0.9830213 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 6.162367343902588
Fine Tuning VALI: Epoch: 22, Steps: 69 | Train Loss: 0.0029740  Vali Loss: 0.0582038 Vali Accuracy: 0.9860968  Vali weighted F1: 0.9860824  Vali macro F1 0.9830213 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 6.169090509414673
Fine Tuning VALI: Epoch: 23, Steps: 69 | Train Loss: 0.0030866  Vali Loss: 0.0581859 Vali Accuracy: 0.9860968  Vali weighted F1: 0.9860824  Vali macro F1 0.9830213 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 6.2001731395721436
Fine Tuning VALI: Epoch: 24, Steps: 69 | Train Loss: 0.0033782  Vali Loss: 0.0581607 Vali Accuracy: 0.9860968  Vali weighted F1: 0.9860824  Vali macro F1 0.9830213 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9702777  Test weighted F1: 0.9697036  Test macro F1 0.9615728 
================ the 4 th CV Experiment ================ 
Leave one Out Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.00014986 0.00018779 0.00137741 0.00144092 0.00052356 0.00064392]
Train data number :  16881
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1876
Test data number :  15610
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.936064958572388
VALI: Epoch: 1, Steps: 66 | Train Loss: 1.0563869  Vali Loss: 0.6258392 Vali Accuracy: 0.7723881  Vali weighted F1: 0.7153825  Vali macro F1 0.4763277 
Validation loss decreased (inf --> 0.625839).  Saving model ...
Epoch: 2 cost time: 5.931666374206543
VALI: Epoch: 2, Steps: 66 | Train Loss: 0.5177927  Vali Loss: 0.3993346 Vali Accuracy: 0.8656716  Vali weighted F1: 0.8549881  Vali macro F1 0.8103067 
new best score!!!!
Validation loss decreased (0.625839 --> 0.399335).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.92604398727417
VALI: Epoch: 3, Steps: 66 | Train Loss: 0.3455909  Vali Loss: 0.2737084 Vali Accuracy: 0.9067164  Vali weighted F1: 0.9016576  Vali macro F1 0.8720016 
new best score!!!!
Validation loss decreased (0.399335 --> 0.273708).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.923815727233887
VALI: Epoch: 4, Steps: 66 | Train Loss: 0.2463046  Vali Loss: 0.1849833 Vali Accuracy: 0.9477612  Vali weighted F1: 0.9477861  Vali macro F1 0.9343248 
new best score!!!!
Validation loss decreased (0.273708 --> 0.184983).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.932950973510742
VALI: Epoch: 5, Steps: 66 | Train Loss: 0.1995165  Vali Loss: 0.1776434 Vali Accuracy: 0.9440299  Vali weighted F1: 0.9424559  Vali macro F1 0.9286330 
new best score!!!!
Validation loss decreased (0.184983 --> 0.177643).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.946033716201782
VALI: Epoch: 6, Steps: 66 | Train Loss: 0.1764409  Vali Loss: 0.1431955 Vali Accuracy: 0.9552239  Vali weighted F1: 0.9548157  Vali macro F1 0.9441702 
new best score!!!!
Validation loss decreased (0.177643 --> 0.143196).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.942884683609009
VALI: Epoch: 7, Steps: 66 | Train Loss: 0.1582484  Vali Loss: 0.1440463 Vali Accuracy: 0.9568230  Vali weighted F1: 0.9561353  Vali macro F1 0.9487542 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 8 cost time: 5.932142496109009
VALI: Epoch: 8, Steps: 66 | Train Loss: 0.1401438  Vali Loss: 0.1148402 Vali Accuracy: 0.9653518  Vali weighted F1: 0.9652412  Vali macro F1 0.9568654 
new best score!!!!
Validation loss decreased (0.143196 --> 0.114840).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.94930362701416
VALI: Epoch: 9, Steps: 66 | Train Loss: 0.1268045  Vali Loss: 0.1347138 Vali Accuracy: 0.9637527  Vali weighted F1: 0.9631590  Vali macro F1 0.9471130 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 5.946720838546753
VALI: Epoch: 10, Steps: 66 | Train Loss: 0.1217194  Vali Loss: 0.1400123 Vali Accuracy: 0.9546908  Vali weighted F1: 0.9555361  Vali macro F1 0.9456212 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 11 cost time: 5.933357000350952
VALI: Epoch: 11, Steps: 66 | Train Loss: 0.1167173  Vali Loss: 0.1044630 Vali Accuracy: 0.9712154  Vali weighted F1: 0.9711787  Vali macro F1 0.9611504 
new best score!!!!
Validation loss decreased (0.114840 --> 0.104463).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 5.938328266143799
VALI: Epoch: 12, Steps: 66 | Train Loss: 0.1083314  Vali Loss: 0.0978191 Vali Accuracy: 0.9733475  Vali weighted F1: 0.9733911  Vali macro F1 0.9640641 
new best score!!!!
Validation loss decreased (0.104463 --> 0.097819).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 5.940000534057617
VALI: Epoch: 13, Steps: 66 | Train Loss: 0.0943007  Vali Loss: 0.1026120 Vali Accuracy: 0.9749467  Vali weighted F1: 0.9749846  Vali macro F1 0.9672874 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 5.937851667404175
VALI: Epoch: 14, Steps: 66 | Train Loss: 0.0914248  Vali Loss: 0.0885477 Vali Accuracy: 0.9770789  Vali weighted F1: 0.9771229  Vali macro F1 0.9688906 
new best score!!!!
Validation loss decreased (0.097819 --> 0.088548).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.935762166976929
VALI: Epoch: 15, Steps: 66 | Train Loss: 0.0821152  Vali Loss: 0.0932647 Vali Accuracy: 0.9706823  Vali weighted F1: 0.9705485  Vali macro F1 0.9559236 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 5.92523455619812
VALI: Epoch: 16, Steps: 66 | Train Loss: 0.0810238  Vali Loss: 0.0782150 Vali Accuracy: 0.9781450  Vali weighted F1: 0.9780890  Vali macro F1 0.9666005 
new best score!!!!
Validation loss decreased (0.088548 --> 0.078215).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 5.935920715332031
VALI: Epoch: 17, Steps: 66 | Train Loss: 0.0685181  Vali Loss: 0.0692418 Vali Accuracy: 0.9834755  Vali weighted F1: 0.9834621  Vali macro F1 0.9791557 
new best score!!!!
Validation loss decreased (0.078215 --> 0.069242).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 5.947007417678833
VALI: Epoch: 18, Steps: 66 | Train Loss: 0.0590561  Vali Loss: 0.0807442 Vali Accuracy: 0.9786780  Vali weighted F1: 0.9786994  Vali macro F1 0.9689800 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 5.950623512268066
VALI: Epoch: 19, Steps: 66 | Train Loss: 0.0699045  Vali Loss: 0.0838862 Vali Accuracy: 0.9717484  Vali weighted F1: 0.9717356  Vali macro F1 0.9562474 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 5.966995000839233
VALI: Epoch: 20, Steps: 66 | Train Loss: 0.0565559  Vali Loss: 0.0691180 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9813241  Vali macro F1 0.9762682 
new best score!!!!
Validation loss decreased (0.069242 --> 0.069118).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 5.939203977584839
VALI: Epoch: 21, Steps: 66 | Train Loss: 0.0539857  Vali Loss: 0.0720817 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9798122  Vali macro F1 0.9723412 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 5.934282541275024
VALI: Epoch: 22, Steps: 66 | Train Loss: 0.0494380  Vali Loss: 0.0963525 Vali Accuracy: 0.9717484  Vali weighted F1: 0.9715747  Vali macro F1 0.9603847 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 5.92450737953186
VALI: Epoch: 23, Steps: 66 | Train Loss: 0.0494706  Vali Loss: 0.0845642 Vali Accuracy: 0.9744136  Vali weighted F1: 0.9741042  Vali macro F1 0.9664257 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 24 cost time: 5.929748058319092
VALI: Epoch: 24, Steps: 66 | Train Loss: 0.0433285  Vali Loss: 0.0783202 Vali Accuracy: 0.9749467  Vali weighted F1: 0.9751358  Vali macro F1 0.9666217 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 25 cost time: 5.928706169128418
VALI: Epoch: 25, Steps: 66 | Train Loss: 0.0366971  Vali Loss: 0.0695407 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9798515  Vali macro F1 0.9722022 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 26 cost time: 5.9338319301605225
VALI: Epoch: 26, Steps: 66 | Train Loss: 0.0264864  Vali Loss: 0.0580497 Vali Accuracy: 0.9829424  Vali weighted F1: 0.9829741  Vali macro F1 0.9777557 
new best score!!!!
Validation loss decreased (0.069118 --> 0.058050).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 5.939609527587891
VALI: Epoch: 27, Steps: 66 | Train Loss: 0.0249319  Vali Loss: 0.0582022 Vali Accuracy: 0.9829424  Vali weighted F1: 0.9829741  Vali macro F1 0.9777557 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 5.938446998596191
VALI: Epoch: 28, Steps: 66 | Train Loss: 0.0227099  Vali Loss: 0.0590037 Vali Accuracy: 0.9840085  Vali weighted F1: 0.9840100  Vali macro F1 0.9794462 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 5.944836378097534
VALI: Epoch: 29, Steps: 66 | Train Loss: 0.0232504  Vali Loss: 0.0569514 Vali Accuracy: 0.9845416  Vali weighted F1: 0.9845966  Vali macro F1 0.9799015 
new best score!!!!
Validation loss decreased (0.058050 --> 0.056951).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 5.9439311027526855
VALI: Epoch: 30, Steps: 66 | Train Loss: 0.0226525  Vali Loss: 0.0566790 Vali Accuracy: 0.9840085  Vali weighted F1: 0.9840421  Vali macro F1 0.9796382 
new best score!!!!
Validation loss decreased (0.056951 --> 0.056679).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 5.9478113651275635
VALI: Epoch: 31, Steps: 66 | Train Loss: 0.0211240  Vali Loss: 0.0547617 Vali Accuracy: 0.9845416  Vali weighted F1: 0.9845966  Vali macro F1 0.9799015 
new best score!!!!
Validation loss decreased (0.056679 --> 0.054762).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 5.951651096343994
VALI: Epoch: 32, Steps: 66 | Train Loss: 0.0214849  Vali Loss: 0.0572322 Vali Accuracy: 0.9829424  Vali weighted F1: 0.9829547  Vali macro F1 0.9780136 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 5.9446821212768555
VALI: Epoch: 33, Steps: 66 | Train Loss: 0.0207379  Vali Loss: 0.0564867 Vali Accuracy: 0.9840085  Vali weighted F1: 0.9840435  Vali macro F1 0.9792043 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 5.94871973991394
VALI: Epoch: 34, Steps: 66 | Train Loss: 0.0203545  Vali Loss: 0.0557026 Vali Accuracy: 0.9840085  Vali weighted F1: 0.9840784  Vali macro F1 0.9796226 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 35 cost time: 5.9439098834991455
VALI: Epoch: 35, Steps: 66 | Train Loss: 0.0202873  Vali Loss: 0.0547914 Vali Accuracy: 0.9845416  Vali weighted F1: 0.9845825  Vali macro F1 0.9801773 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 36 cost time: 5.944491147994995
VALI: Epoch: 36, Steps: 66 | Train Loss: 0.0197784  Vali Loss: 0.0548456 Vali Accuracy: 0.9840085  Vali weighted F1: 0.9840552  Vali macro F1 0.9793687 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 37 cost time: 5.94251823425293
VALI: Epoch: 37, Steps: 66 | Train Loss: 0.0185285  Vali Loss: 0.0556723 Vali Accuracy: 0.9829424  Vali weighted F1: 0.9829797  Vali macro F1 0.9778437 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 5.9489099979400635
VALI: Epoch: 38, Steps: 66 | Train Loss: 0.0176813  Vali Loss: 0.0554786 Vali Accuracy: 0.9829424  Vali weighted F1: 0.9829797  Vali macro F1 0.9778437 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 5.951914310455322
VALI: Epoch: 39, Steps: 66 | Train Loss: 0.0186684  Vali Loss: 0.0549731 Vali Accuracy: 0.9840085  Vali weighted F1: 0.9840506  Vali macro F1 0.9792751 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 40 cost time: 5.957979917526245
VALI: Epoch: 40, Steps: 66 | Train Loss: 0.0186580  Vali Loss: 0.0554377 Vali Accuracy: 0.9824094  Vali weighted F1: 0.9824328  Vali macro F1 0.9772147 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 41 cost time: 5.944373607635498
VALI: Epoch: 41, Steps: 66 | Train Loss: 0.0189275  Vali Loss: 0.0558834 Vali Accuracy: 0.9829424  Vali weighted F1: 0.9829741  Vali macro F1 0.9777557 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 42 cost time: 5.9329400062561035
VALI: Epoch: 42, Steps: 66 | Train Loss: 0.0186462  Vali Loss: 0.0558673 Vali Accuracy: 0.9824094  Vali weighted F1: 0.9824328  Vali macro F1 0.9772147 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 5.933404445648193
VALI: Epoch: 43, Steps: 66 | Train Loss: 0.0173181  Vali Loss: 0.0558802 Vali Accuracy: 0.9829424  Vali weighted F1: 0.9829741  Vali macro F1 0.9777557 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 5.939380168914795
VALI: Epoch: 44, Steps: 66 | Train Loss: 0.0185820  Vali Loss: 0.0559922 Vali Accuracy: 0.9829424  Vali weighted F1: 0.9829741  Vali macro F1 0.9777557 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 5.92567253112793
VALI: Epoch: 45, Steps: 66 | Train Loss: 0.0184338  Vali Loss: 0.0559300 Vali Accuracy: 0.9829424  Vali weighted F1: 0.9829741  Vali macro F1 0.9777557 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 46 cost time: 5.9290931224823
VALI: Epoch: 46, Steps: 66 | Train Loss: 0.0189851  Vali Loss: 0.0559150 Vali Accuracy: 0.9829424  Vali weighted F1: 0.9829741  Vali macro F1 0.9777557 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9122357  Test weighted F1: 0.9166525  Test macro F1 0.8851069 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 240495
pruned model Parameter : 244174
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 5.968533039093018
Fine Tuning VALI: Epoch: 1, Steps: 66 | Train Loss: 0.0232848  Vali Loss: 0.0549686 Vali Accuracy: 0.9840085  Vali weighted F1: 0.9840757  Vali macro F1 0.9801125 
Validation loss decreased (inf --> 0.054969).  Saving model ...
Fine Tuning Epoch: 2 cost time: 5.9805521965026855
Fine Tuning VALI: Epoch: 2, Steps: 66 | Train Loss: 0.0221431  Vali Loss: 0.0514941 Vali Accuracy: 0.9872068  Vali weighted F1: 0.9872216  Vali macro F1 0.9839594 
new best score!!!!
Validation loss decreased (0.054969 --> 0.051494).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 5.942268133163452
Fine Tuning VALI: Epoch: 3, Steps: 66 | Train Loss: 0.0214943  Vali Loss: 0.0559540 Vali Accuracy: 0.9824094  Vali weighted F1: 0.9824196  Vali macro F1 0.9774695 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 5.94341254234314
Fine Tuning VALI: Epoch: 4, Steps: 66 | Train Loss: 0.0207004  Vali Loss: 0.0583075 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9808793  Vali macro F1 0.9748932 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 5.947722434997559
Fine Tuning VALI: Epoch: 5, Steps: 66 | Train Loss: 0.0193263  Vali Loss: 0.0552991 Vali Accuracy: 0.9840085  Vali weighted F1: 0.9840365  Vali macro F1 0.9786315 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 5.950161695480347
Fine Tuning VALI: Epoch: 6, Steps: 66 | Train Loss: 0.0187684  Vali Loss: 0.0544871 Vali Accuracy: 0.9850746  Vali weighted F1: 0.9851232  Vali macro F1 0.9800588 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 5.944299221038818
Fine Tuning VALI: Epoch: 7, Steps: 66 | Train Loss: 0.0189482  Vali Loss: 0.0593640 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9813848  Vali macro F1 0.9751453 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 8 cost time: 5.950110673904419
Fine Tuning VALI: Epoch: 8, Steps: 66 | Train Loss: 0.0180441  Vali Loss: 0.0617912 Vali Accuracy: 0.9792111  Vali weighted F1: 0.9792688  Vali macro F1 0.9725174 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 5.94394850730896
Fine Tuning VALI: Epoch: 9, Steps: 66 | Train Loss: 0.0182185  Vali Loss: 0.0559741 Vali Accuracy: 0.9840085  Vali weighted F1: 0.9840825  Vali macro F1 0.9787445 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 5.9499592781066895
Fine Tuning VALI: Epoch: 10, Steps: 66 | Train Loss: 0.0182953  Vali Loss: 0.0574598 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9807999  Vali macro F1 0.9743696 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 5.967408657073975
Fine Tuning VALI: Epoch: 11, Steps: 66 | Train Loss: 0.0168443  Vali Loss: 0.0586450 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9813369  Vali macro F1 0.9752816 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 5.978094816207886
Fine Tuning VALI: Epoch: 12, Steps: 66 | Train Loss: 0.0160659  Vali Loss: 0.0572180 Vali Accuracy: 0.9829424  Vali weighted F1: 0.9829705  Vali macro F1 0.9779077 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 13 cost time: 5.970634937286377
Fine Tuning VALI: Epoch: 13, Steps: 66 | Train Loss: 0.0150714  Vali Loss: 0.0569484 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9813680  Vali macro F1 0.9764954 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 5.944972515106201
Fine Tuning VALI: Epoch: 14, Steps: 66 | Train Loss: 0.0151154  Vali Loss: 0.0561703 Vali Accuracy: 0.9829424  Vali weighted F1: 0.9830076  Vali macro F1 0.9772214 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 5.949039459228516
Fine Tuning VALI: Epoch: 15, Steps: 66 | Train Loss: 0.0154328  Vali Loss: 0.0562150 Vali Accuracy: 0.9824094  Vali weighted F1: 0.9824351  Vali macro F1 0.9765482 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 5.962382555007935
Fine Tuning VALI: Epoch: 16, Steps: 66 | Train Loss: 0.0151250  Vali Loss: 0.0554645 Vali Accuracy: 0.9834755  Vali weighted F1: 0.9835256  Vali macro F1 0.9777205 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 5.954312324523926
Fine Tuning VALI: Epoch: 17, Steps: 66 | Train Loss: 0.0148085  Vali Loss: 0.0560330 Vali Accuracy: 0.9824094  Vali weighted F1: 0.9824351  Vali macro F1 0.9765482 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9135810  Test weighted F1: 0.9170513  Test macro F1 0.8858964 
================ the 5 th CV Experiment ================ 
Leave one Out Experiment : The 6 Part as the test
[-] Target sampling weights:  [0.00014229 0.00018477 0.00097087 0.00122549 0.0005322  0.00063735]
Train data number :  17734
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1971
Test data number :  10878
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.232461214065552
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.0549509  Vali Loss: 0.6457920 Vali Accuracy: 0.7752410  Vali weighted F1: 0.7189088  Vali macro F1 0.5026222 
Validation loss decreased (inf --> 0.645792).  Saving model ...
Epoch: 2 cost time: 6.256550073623657
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.4904496  Vali Loss: 0.3867506 Vali Accuracy: 0.8696093  Vali weighted F1: 0.8543340  Vali macro F1 0.8039167 
new best score!!!!
Validation loss decreased (0.645792 --> 0.386751).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.243937969207764
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.3189951  Vali Loss: 0.2436646 Vali Accuracy: 0.9178082  Vali weighted F1: 0.9139115  Vali macro F1 0.8800681 
new best score!!!!
Validation loss decreased (0.386751 --> 0.243665).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.237961292266846
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.2374949  Vali Loss: 0.1846058 Vali Accuracy: 0.9391172  Vali weighted F1: 0.9396194  Vali macro F1 0.9117579 
new best score!!!!
Validation loss decreased (0.243665 --> 0.184606).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.255714178085327
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.2016812  Vali Loss: 0.1813366 Vali Accuracy: 0.9309995  Vali weighted F1: 0.9306803  Vali macro F1 0.8995218 
new best score!!!!
Validation loss decreased (0.184606 --> 0.181337).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.255890130996704
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.1791859  Vali Loss: 0.1506796 Vali Accuracy: 0.9472349  Vali weighted F1: 0.9465850  Vali macro F1 0.9223598 
new best score!!!!
Validation loss decreased (0.181337 --> 0.150680).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.242125749588013
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.1581662  Vali Loss: 0.1519858 Vali Accuracy: 0.9472349  Vali weighted F1: 0.9474159  Vali macro F1 0.9217419 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 8 cost time: 6.227467060089111
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1429269  Vali Loss: 0.1353603 Vali Accuracy: 0.9528158  Vali weighted F1: 0.9530583  Vali macro F1 0.9318594 
new best score!!!!
Validation loss decreased (0.150680 --> 0.135360).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.236499071121216
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1301162  Vali Loss: 0.1305024 Vali Accuracy: 0.9563673  Vali weighted F1: 0.9558802  Vali macro F1 0.9312039 
new best score!!!!
Validation loss decreased (0.135360 --> 0.130502).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.245605230331421
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1234090  Vali Loss: 0.1173675 Vali Accuracy: 0.9599188  Vali weighted F1: 0.9600123  Vali macro F1 0.9404646 
new best score!!!!
Validation loss decreased (0.130502 --> 0.117367).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.253523826599121
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1095094  Vali Loss: 0.1050041 Vali Accuracy: 0.9644850  Vali weighted F1: 0.9640814  Vali macro F1 0.9518761 
new best score!!!!
Validation loss decreased (0.117367 --> 0.105004).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.255915641784668
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.1061610  Vali Loss: 0.0934128 Vali Accuracy: 0.9670218  Vali weighted F1: 0.9669496  Vali macro F1 0.9545735 
new best score!!!!
Validation loss decreased (0.105004 --> 0.093413).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.265827894210815
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0932266  Vali Loss: 0.0890868 Vali Accuracy: 0.9720954  Vali weighted F1: 0.9720310  Vali macro F1 0.9611652 
new best score!!!!
Validation loss decreased (0.093413 --> 0.089087).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.237827777862549
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0897826  Vali Loss: 0.0894477 Vali Accuracy: 0.9680365  Vali weighted F1: 0.9680219  Vali macro F1 0.9531847 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.241835355758667
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0815587  Vali Loss: 0.0888847 Vali Accuracy: 0.9731101  Vali weighted F1: 0.9726593  Vali macro F1 0.9627395 
new best score!!!!
Validation loss decreased (0.089087 --> 0.088885).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.24873685836792
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0754685  Vali Loss: 0.1203999 Vali Accuracy: 0.9619482  Vali weighted F1: 0.9609126  Vali macro F1 0.9469791 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 6.2489471435546875
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0752434  Vali Loss: 0.1117217 Vali Accuracy: 0.9660071  Vali weighted F1: 0.9664488  Vali macro F1 0.9537497 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 6.248819589614868
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0647781  Vali Loss: 0.0713786 Vali Accuracy: 0.9731101  Vali weighted F1: 0.9731847  Vali macro F1 0.9645536 
new best score!!!!
Validation loss decreased (0.088885 --> 0.071379).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 7.561161279678345
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0623425  Vali Loss: 0.0750750 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9779282  Vali macro F1 0.9688296 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 6.30175256729126
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0657664  Vali Loss: 0.0863807 Vali Accuracy: 0.9726027  Vali weighted F1: 0.9722193  Vali macro F1 0.9618712 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 6.256525754928589
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0696367  Vali Loss: 0.1323988 Vali Accuracy: 0.9589041  Vali weighted F1: 0.9602230  Vali macro F1 0.9418460 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 22 cost time: 6.2574944496154785
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0585254  Vali Loss: 0.0834646 Vali Accuracy: 0.9731101  Vali weighted F1: 0.9734186  Vali macro F1 0.9652243 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 23 cost time: 6.255759239196777
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0495561  Vali Loss: 0.0785105 Vali Accuracy: 0.9741248  Vali weighted F1: 0.9738753  Vali macro F1 0.9647601 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 24 cost time: 6.250316381454468
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0343460  Vali Loss: 0.0554369 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9816807  Vali macro F1 0.9747858 
new best score!!!!
Validation loss decreased (0.071379 --> 0.055437).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.493775367736816
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0310299  Vali Loss: 0.0531984 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832329  Vali macro F1 0.9778043 
new best score!!!!
Validation loss decreased (0.055437 --> 0.053198).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.272375106811523
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0303096  Vali Loss: 0.0573384 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9812132  Vali macro F1 0.9731364 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 6.232901573181152
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0288876  Vali Loss: 0.0552381 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9817945  Vali macro F1 0.9760557 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 6.230757713317871
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0278200  Vali Loss: 0.0561699 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842545  Vali macro F1 0.9782387 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 29 cost time: 6.225369453430176
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0277497  Vali Loss: 0.0560725 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832367  Vali macro F1 0.9774722 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 30 cost time: 6.2498860359191895
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0247853  Vali Loss: 0.0540702 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9807284  Vali macro F1 0.9741556 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 31 cost time: 6.2565224170684814
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0245492  Vali Loss: 0.0542168 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9821997  Vali macro F1 0.9760291 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 6.241530418395996
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0240359  Vali Loss: 0.0545887 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9821912  Vali macro F1 0.9763513 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 6.2308268547058105
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0249807  Vali Loss: 0.0548410 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9816984  Vali macro F1 0.9758474 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 34 cost time: 6.237173557281494
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0244433  Vali Loss: 0.0545267 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9821997  Vali macro F1 0.9760291 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 35 cost time: 6.225883722305298
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0238255  Vali Loss: 0.0544810 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9821997  Vali macro F1 0.9760291 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 36 cost time: 6.22885537147522
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0239118  Vali Loss: 0.0545461 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9821997  Vali macro F1 0.9760291 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 6.2418835163116455
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0240750  Vali Loss: 0.0545216 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827184  Vali macro F1 0.9765752 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 6.240967750549316
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0236328  Vali Loss: 0.0544829 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827184  Vali macro F1 0.9765752 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 6.248247385025024
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0238081  Vali Loss: 0.0544834 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827184  Vali macro F1 0.9765752 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 40 cost time: 6.242058277130127
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0227766  Vali Loss: 0.0545437 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827184  Vali macro F1 0.9765752 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9152418  Test weighted F1: 0.9141305  Test macro F1 0.8327102 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 240495
pruned model Parameter : 244174
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.316875457763672
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0306870  Vali Loss: 0.0538365 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9822605  Vali macro F1 0.9758478 
Validation loss decreased (inf --> 0.053837).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.262064695358276
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0293141  Vali Loss: 0.0540409 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9817994  Vali macro F1 0.9758269 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.25613808631897
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0274332  Vali Loss: 0.0530815 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842421  Vali macro F1 0.9792909 
new best score!!!!
Validation loss decreased (0.053837 --> 0.053082).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.26258397102356
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0261746  Vali Loss: 0.0531672 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847439  Vali macro F1 0.9790807 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.2836267948150635
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0251777  Vali Loss: 0.0535802 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9817514  Vali macro F1 0.9755844 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 6.274443626403809
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0242835  Vali Loss: 0.0540323 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9817423  Vali macro F1 0.9758708 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 6.288015365600586
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0243882  Vali Loss: 0.0557231 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9812394  Vali macro F1 0.9756974 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 8 cost time: 6.295780658721924
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0228825  Vali Loss: 0.0540223 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847771  Vali macro F1 0.9790921 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 9 cost time: 6.298446893692017
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0223908  Vali Loss: 0.0539100 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9812334  Vali macro F1 0.9741279 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.291991233825684
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0225508  Vali Loss: 0.0556245 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827379  Vali macro F1 0.9759532 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 6.280035495758057
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0210455  Vali Loss: 0.0549398 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9836918  Vali macro F1 0.9783988 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 6.2812464237213135
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0203982  Vali Loss: 0.0529413 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832696  Vali macro F1 0.9770871 
new best score!!!!
Validation loss decreased (0.053082 --> 0.052941).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 6.2876198291778564
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0197068  Vali Loss: 0.0528358 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9858079  Vali macro F1 0.9799239 
new best score!!!!
Validation loss decreased (0.052941 --> 0.052836).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 6.2945942878723145
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0185736  Vali Loss: 0.0521825 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837518  Vali macro F1 0.9778637 
new best score!!!!
Validation loss decreased (0.052836 --> 0.052183).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 6.285902738571167
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0185014  Vali Loss: 0.0578973 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9801870  Vali macro F1 0.9725677 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 6.303273439407349
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0181628  Vali Loss: 0.0546577 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9848211  Vali macro F1 0.9788153 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 6.309704542160034
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0181580  Vali Loss: 0.0522419 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832210  Vali macro F1 0.9769880 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 6.298768043518066
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0176274  Vali Loss: 0.0521669 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852732  Vali macro F1 0.9798745 
new best score!!!!
Validation loss decreased (0.052183 --> 0.052167).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 6.3091466426849365
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0169498  Vali Loss: 0.0589621 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827288  Vali macro F1 0.9765927 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 6.274356842041016
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0160057  Vali Loss: 0.0530353 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847541  Vali macro F1 0.9787102 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 6.271453619003296
Fine Tuning VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0161490  Vali Loss: 0.0562249 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9807980  Vali macro F1 0.9740659 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 6.271030902862549
Fine Tuning VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0146989  Vali Loss: 0.0569675 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827424  Vali macro F1 0.9758895 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 23 cost time: 6.272847652435303
Fine Tuning VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0161163  Vali Loss: 0.0526782 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832738  Vali macro F1 0.9769756 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 24 cost time: 6.270982503890991
Fine Tuning VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0143145  Vali Loss: 0.0525832 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847672  Vali macro F1 0.9784762 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 25 cost time: 6.2835633754730225
Fine Tuning VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0141089  Vali Loss: 0.0512276 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842664  Vali macro F1 0.9778589 
new best score!!!!
Validation loss decreased (0.052167 --> 0.051228).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 26 cost time: 6.296640396118164
Fine Tuning VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0133317  Vali Loss: 0.0511427 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852603  Vali macro F1 0.9789294 
new best score!!!!
Validation loss decreased (0.051228 --> 0.051143).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 27 cost time: 6.3151490688323975
Fine Tuning VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0127990  Vali Loss: 0.0512198 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9857679  Vali macro F1 0.9797942 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 28 cost time: 6.271791219711304
Fine Tuning VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0134911  Vali Loss: 0.0506637 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9857590  Vali macro F1 0.9794932 
new best score!!!!
Validation loss decreased (0.051143 --> 0.050664).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 29 cost time: 6.2779541015625
Fine Tuning VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0136828  Vali Loss: 0.0504816 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9862777  Vali macro F1 0.9806706 
new best score!!!!
Validation loss decreased (0.050664 --> 0.050482).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 30 cost time: 6.290595531463623
Fine Tuning VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0134207  Vali Loss: 0.0504328 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9862777  Vali macro F1 0.9806706 
new best score!!!!
Validation loss decreased (0.050482 --> 0.050433).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 31 cost time: 6.279128313064575
Fine Tuning VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0126256  Vali Loss: 0.0504637 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9862777  Vali macro F1 0.9806706 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 32 cost time: 6.293630599975586
Fine Tuning VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0138867  Vali Loss: 0.0504469 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852722  Vali macro F1 0.9792442 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 33 cost time: 6.3162522315979
Fine Tuning VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0121406  Vali Loss: 0.0504526 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9857786  Vali macro F1 0.9801066 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 34 cost time: 6.293999671936035
Fine Tuning VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0126368  Vali Loss: 0.0509166 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847726  Vali macro F1 0.9787210 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 35 cost time: 6.30111837387085
Fine Tuning VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0126374  Vali Loss: 0.0508390 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9857786  Vali macro F1 0.9801066 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 36 cost time: 6.308037996292114
Fine Tuning VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0124582  Vali Loss: 0.0509065 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9857786  Vali macro F1 0.9801066 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 37 cost time: 6.31230902671814
Fine Tuning VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0125942  Vali Loss: 0.0508075 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9862777  Vali macro F1 0.9806706 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 38 cost time: 6.293990850448608
Fine Tuning VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0126741  Vali Loss: 0.0508349 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9862777  Vali macro F1 0.9806706 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 39 cost time: 6.2977588176727295
Fine Tuning VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0118731  Vali Loss: 0.0509378 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9862777  Vali macro F1 0.9806706 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 40 cost time: 6.31761622428894
Fine Tuning VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0128907  Vali Loss: 0.0508251 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9862777  Vali macro F1 0.9806706 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Fine Tuning Epoch: 41 cost time: 6.29479193687439
Fine Tuning VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0124044  Vali Loss: 0.0508108 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9862777  Vali macro F1 0.9806706 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 42 cost time: 6.29685640335083
Fine Tuning VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0119448  Vali Loss: 0.0508082 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9862777  Vali macro F1 0.9806706 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 43 cost time: 6.29562520980835
Fine Tuning VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0122979  Vali Loss: 0.0508079 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9862777  Vali macro F1 0.9806706 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 44 cost time: 6.307500839233398
Fine Tuning VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0123533  Vali Loss: 0.0508181 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9862777  Vali macro F1 0.9806706 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 45 cost time: 6.323437929153442
Fine Tuning VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0119617  Vali Loss: 0.0508195 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9862777  Vali macro F1 0.9806706 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9069682  Test weighted F1: 0.9043853  Test macro F1 0.7723375 
================ the 6 th CV Experiment ================ 
Leave one Out Experiment : The 7 Part as the test
[-] Target sampling weights:  [0.00014168 0.00017867 0.00095969 0.00122549 0.000481   0.00060643]
Train data number :  18241
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2027
Test data number :  8061
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.464402675628662
VALI: Epoch: 1, Steps: 72 | Train Loss: 1.0043694  Vali Loss: 0.6265305 Vali Accuracy: 0.7666502  Vali weighted F1: 0.7338485  Vali macro F1 0.5431268 
Validation loss decreased (inf --> 0.626531).  Saving model ...
Epoch: 2 cost time: 6.4605162143707275
VALI: Epoch: 2, Steps: 72 | Train Loss: 0.4924531  Vali Loss: 0.3655596 Vali Accuracy: 0.8737050  Vali weighted F1: 0.8673003  Vali macro F1 0.8334873 
new best score!!!!
Validation loss decreased (0.626531 --> 0.365560).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.444803953170776
VALI: Epoch: 3, Steps: 72 | Train Loss: 0.3275000  Vali Loss: 0.2837498 Vali Accuracy: 0.9008387  Vali weighted F1: 0.8954792  Vali macro F1 0.8778467 
new best score!!!!
Validation loss decreased (0.365560 --> 0.283750).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.4476470947265625
VALI: Epoch: 4, Steps: 72 | Train Loss: 0.2496921  Vali Loss: 0.2340161 Vali Accuracy: 0.9220523  Vali weighted F1: 0.9181301  Vali macro F1 0.9047460 
new best score!!!!
Validation loss decreased (0.283750 --> 0.234016).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.448359251022339
VALI: Epoch: 5, Steps: 72 | Train Loss: 0.1954095  Vali Loss: 0.1811092 Vali Accuracy: 0.9363592  Vali weighted F1: 0.9358804  Vali macro F1 0.9222392 
new best score!!!!
Validation loss decreased (0.234016 --> 0.181109).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.45394492149353
VALI: Epoch: 6, Steps: 72 | Train Loss: 0.1650029  Vali Loss: 0.1533400 Vali Accuracy: 0.9486926  Vali weighted F1: 0.9492573  Vali macro F1 0.9372701 
new best score!!!!
Validation loss decreased (0.181109 --> 0.153340).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.470763206481934
VALI: Epoch: 7, Steps: 72 | Train Loss: 0.1462323  Vali Loss: 0.1287965 Vali Accuracy: 0.9501727  Vali weighted F1: 0.9496290  Vali macro F1 0.9364368 
new best score!!!!
Validation loss decreased (0.153340 --> 0.128796).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.469315528869629
VALI: Epoch: 8, Steps: 72 | Train Loss: 0.1315785  Vali Loss: 0.1226296 Vali Accuracy: 0.9551061  Vali weighted F1: 0.9553357  Vali macro F1 0.9435498 
new best score!!!!
Validation loss decreased (0.128796 --> 0.122630).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.458595514297485
VALI: Epoch: 9, Steps: 72 | Train Loss: 0.1227910  Vali Loss: 0.1358064 Vali Accuracy: 0.9531327  Vali weighted F1: 0.9525125  Vali macro F1 0.9426037 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 6.463300943374634
VALI: Epoch: 10, Steps: 72 | Train Loss: 0.1067390  Vali Loss: 0.1011635 Vali Accuracy: 0.9664529  Vali weighted F1: 0.9665730  Vali macro F1 0.9559295 
new best score!!!!
Validation loss decreased (0.122630 --> 0.101163).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.45800256729126
VALI: Epoch: 11, Steps: 72 | Train Loss: 0.1016403  Vali Loss: 0.1070684 Vali Accuracy: 0.9689196  Vali weighted F1: 0.9690737  Vali macro F1 0.9601812 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 6.452773332595825
VALI: Epoch: 12, Steps: 72 | Train Loss: 0.0932183  Vali Loss: 0.1035883 Vali Accuracy: 0.9649729  Vali weighted F1: 0.9648594  Vali macro F1 0.9555286 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 13 cost time: 6.451427221298218
VALI: Epoch: 13, Steps: 72 | Train Loss: 0.0894330  Vali Loss: 0.1189734 Vali Accuracy: 0.9605328  Vali weighted F1: 0.9602699  Vali macro F1 0.9467915 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 14 cost time: 6.4599974155426025
VALI: Epoch: 14, Steps: 72 | Train Loss: 0.0889584  Vali Loss: 0.1089058 Vali Accuracy: 0.9634928  Vali weighted F1: 0.9639620  Vali macro F1 0.9510681 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 15 cost time: 6.4608941078186035
VALI: Epoch: 15, Steps: 72 | Train Loss: 0.0764033  Vali Loss: 0.0885324 Vali Accuracy: 0.9684262  Vali weighted F1: 0.9687472  Vali macro F1 0.9588474 
new best score!!!!
Validation loss decreased (0.101163 --> 0.088532).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.458776473999023
VALI: Epoch: 16, Steps: 72 | Train Loss: 0.0704721  Vali Loss: 0.0799738 Vali Accuracy: 0.9758263  Vali weighted F1: 0.9758368  Vali macro F1 0.9685429 
new best score!!!!
Validation loss decreased (0.088532 --> 0.079974).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.470142602920532
VALI: Epoch: 17, Steps: 72 | Train Loss: 0.0672790  Vali Loss: 0.0838417 Vali Accuracy: 0.9738530  Vali weighted F1: 0.9739582  Vali macro F1 0.9663611 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 6.437368631362915
VALI: Epoch: 18, Steps: 72 | Train Loss: 0.0654213  Vali Loss: 0.1127208 Vali Accuracy: 0.9629995  Vali weighted F1: 0.9622277  Vali macro F1 0.9521157 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 6.4425365924835205
VALI: Epoch: 19, Steps: 72 | Train Loss: 0.0609581  Vali Loss: 0.0979808 Vali Accuracy: 0.9689196  Vali weighted F1: 0.9685498  Vali macro F1 0.9610255 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 20 cost time: 6.41724157333374
VALI: Epoch: 20, Steps: 72 | Train Loss: 0.0547082  Vali Loss: 0.0811614 Vali Accuracy: 0.9748397  Vali weighted F1: 0.9746772  Vali macro F1 0.9672800 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 21 cost time: 6.425277233123779
VALI: Epoch: 21, Steps: 72 | Train Loss: 0.0540644  Vali Loss: 0.1270143 Vali Accuracy: 0.9565861  Vali weighted F1: 0.9576454  Vali macro F1 0.9478418 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 22 cost time: 6.4329514503479
VALI: Epoch: 22, Steps: 72 | Train Loss: 0.0463745  Vali Loss: 0.0732973 Vali Accuracy: 0.9763197  Vali weighted F1: 0.9762117  Vali macro F1 0.9684850 
new best score!!!!
Validation loss decreased (0.079974 --> 0.073297).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.434656620025635
VALI: Epoch: 23, Steps: 72 | Train Loss: 0.0366654  Vali Loss: 0.0664519 Vali Accuracy: 0.9777997  Vali weighted F1: 0.9777181  Vali macro F1 0.9719929 
new best score!!!!
Validation loss decreased (0.073297 --> 0.066452).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.428479909896851
VALI: Epoch: 24, Steps: 72 | Train Loss: 0.0339281  Vali Loss: 0.0663259 Vali Accuracy: 0.9782930  Vali weighted F1: 0.9782940  Vali macro F1 0.9709750 
new best score!!!!
Validation loss decreased (0.066452 --> 0.066326).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.434086799621582
VALI: Epoch: 25, Steps: 72 | Train Loss: 0.0312108  Vali Loss: 0.0688236 Vali Accuracy: 0.9782930  Vali weighted F1: 0.9782989  Vali macro F1 0.9715038 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 6.45183801651001
VALI: Epoch: 26, Steps: 72 | Train Loss: 0.0319860  Vali Loss: 0.0673372 Vali Accuracy: 0.9792797  Vali weighted F1: 0.9793057  Vali macro F1 0.9720536 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 6.439320802688599
VALI: Epoch: 27, Steps: 72 | Train Loss: 0.0289243  Vali Loss: 0.0679215 Vali Accuracy: 0.9782930  Vali weighted F1: 0.9783265  Vali macro F1 0.9710001 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 28 cost time: 6.436514139175415
VALI: Epoch: 28, Steps: 72 | Train Loss: 0.0295350  Vali Loss: 0.0681639 Vali Accuracy: 0.9782930  Vali weighted F1: 0.9783115  Vali macro F1 0.9712099 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 29 cost time: 6.436697006225586
VALI: Epoch: 29, Steps: 72 | Train Loss: 0.0284822  Vali Loss: 0.0666793 Vali Accuracy: 0.9787864  Vali weighted F1: 0.9788139  Vali macro F1 0.9717685 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 30 cost time: 6.440484285354614
VALI: Epoch: 30, Steps: 72 | Train Loss: 0.0279284  Vali Loss: 0.0673534 Vali Accuracy: 0.9782930  Vali weighted F1: 0.9783115  Vali macro F1 0.9712099 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 6.432250499725342
VALI: Epoch: 31, Steps: 72 | Train Loss: 0.0268265  Vali Loss: 0.0673854 Vali Accuracy: 0.9782930  Vali weighted F1: 0.9783115  Vali macro F1 0.9712099 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 6.424518823623657
VALI: Epoch: 32, Steps: 72 | Train Loss: 0.0264591  Vali Loss: 0.0669304 Vali Accuracy: 0.9782930  Vali weighted F1: 0.9783115  Vali macro F1 0.9712099 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 6.424771785736084
VALI: Epoch: 33, Steps: 72 | Train Loss: 0.0281747  Vali Loss: 0.0672275 Vali Accuracy: 0.9782930  Vali weighted F1: 0.9783115  Vali macro F1 0.9712099 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 34 cost time: 6.423038482666016
VALI: Epoch: 34, Steps: 72 | Train Loss: 0.0256420  Vali Loss: 0.0673873 Vali Accuracy: 0.9787864  Vali weighted F1: 0.9787907  Vali macro F1 0.9716403 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 35 cost time: 6.452329635620117
VALI: Epoch: 35, Steps: 72 | Train Loss: 0.0276606  Vali Loss: 0.0672998 Vali Accuracy: 0.9787864  Vali weighted F1: 0.9787907  Vali macro F1 0.9716403 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 6.437916278839111
VALI: Epoch: 36, Steps: 72 | Train Loss: 0.0273285  Vali Loss: 0.0672709 Vali Accuracy: 0.9782930  Vali weighted F1: 0.9783115  Vali macro F1 0.9712099 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 6.438048362731934
VALI: Epoch: 37, Steps: 72 | Train Loss: 0.0271756  Vali Loss: 0.0672550 Vali Accuracy: 0.9782930  Vali weighted F1: 0.9783115  Vali macro F1 0.9712099 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 6.432556629180908
VALI: Epoch: 38, Steps: 72 | Train Loss: 0.0266415  Vali Loss: 0.0671912 Vali Accuracy: 0.9782930  Vali weighted F1: 0.9783115  Vali macro F1 0.9712099 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 6.433774471282959
VALI: Epoch: 39, Steps: 72 | Train Loss: 0.0270178  Vali Loss: 0.0670641 Vali Accuracy: 0.9782930  Vali weighted F1: 0.9783115  Vali macro F1 0.9712099 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8451805  Test weighted F1: 0.8396680  Test macro F1 0.6301172 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 240495
pruned model Parameter : 244174
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.497481346130371
Fine Tuning VALI: Epoch: 1, Steps: 72 | Train Loss: 0.0339449  Vali Loss: 0.0682434 Vali Accuracy: 0.9787864  Vali weighted F1: 0.9787267  Vali macro F1 0.9714734 
Validation loss decreased (inf --> 0.068243).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.4717631340026855
Fine Tuning VALI: Epoch: 2, Steps: 72 | Train Loss: 0.0324804  Vali Loss: 0.0660688 Vali Accuracy: 0.9797731  Vali weighted F1: 0.9798288  Vali macro F1 0.9723414 
new best score!!!!
Validation loss decreased (0.068243 --> 0.066069).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.461495637893677
Fine Tuning VALI: Epoch: 3, Steps: 72 | Train Loss: 0.0305685  Vali Loss: 0.0693691 Vali Accuracy: 0.9797731  Vali weighted F1: 0.9797720  Vali macro F1 0.9726540 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.469828367233276
Fine Tuning VALI: Epoch: 4, Steps: 72 | Train Loss: 0.0297108  Vali Loss: 0.0672664 Vali Accuracy: 0.9797731  Vali weighted F1: 0.9797431  Vali macro F1 0.9726089 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.464053630828857
Fine Tuning VALI: Epoch: 5, Steps: 72 | Train Loss: 0.0295251  Vali Loss: 0.0662291 Vali Accuracy: 0.9787864  Vali weighted F1: 0.9787439  Vali macro F1 0.9721011 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 6.479114770889282
Fine Tuning VALI: Epoch: 6, Steps: 72 | Train Loss: 0.0261313  Vali Loss: 0.0640542 Vali Accuracy: 0.9802664  Vali weighted F1: 0.9802460  Vali macro F1 0.9732984 
new best score!!!!
Validation loss decreased (0.066069 --> 0.064054).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 6.470865249633789
Fine Tuning VALI: Epoch: 7, Steps: 72 | Train Loss: 0.0268710  Vali Loss: 0.0616574 Vali Accuracy: 0.9812531  Vali weighted F1: 0.9812500  Vali macro F1 0.9744138 
new best score!!!!
Validation loss decreased (0.064054 --> 0.061657).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 6.469994306564331
Fine Tuning VALI: Epoch: 8, Steps: 72 | Train Loss: 0.0261755  Vali Loss: 0.0633420 Vali Accuracy: 0.9802664  Vali weighted F1: 0.9803272  Vali macro F1 0.9729880 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.460688352584839
Fine Tuning VALI: Epoch: 9, Steps: 72 | Train Loss: 0.0255237  Vali Loss: 0.0694801 Vali Accuracy: 0.9782930  Vali weighted F1: 0.9782552  Vali macro F1 0.9698922 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 6.473617076873779
Fine Tuning VALI: Epoch: 10, Steps: 72 | Train Loss: 0.0262548  Vali Loss: 0.0639517 Vali Accuracy: 0.9802664  Vali weighted F1: 0.9802791  Vali macro F1 0.9735211 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 6.479870080947876
Fine Tuning VALI: Epoch: 11, Steps: 72 | Train Loss: 0.0237980  Vali Loss: 0.0669023 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9806784  Vali macro F1 0.9745985 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 6.465143442153931
Fine Tuning VALI: Epoch: 12, Steps: 72 | Train Loss: 0.0238794  Vali Loss: 0.0625638 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9807603  Vali macro F1 0.9743248 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 13 cost time: 6.458604574203491
Fine Tuning VALI: Epoch: 13, Steps: 72 | Train Loss: 0.0240031  Vali Loss: 0.0684775 Vali Accuracy: 0.9817464  Vali weighted F1: 0.9816937  Vali macro F1 0.9754580 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.4808478355407715
Fine Tuning VALI: Epoch: 14, Steps: 72 | Train Loss: 0.0225486  Vali Loss: 0.0669148 Vali Accuracy: 0.9817464  Vali weighted F1: 0.9818088  Vali macro F1 0.9749720 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.496054649353027
Fine Tuning VALI: Epoch: 15, Steps: 72 | Train Loss: 0.0228710  Vali Loss: 0.0623240 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9808048  Vali macro F1 0.9743354 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.457638740539551
Fine Tuning VALI: Epoch: 16, Steps: 72 | Train Loss: 0.0217325  Vali Loss: 0.0613018 Vali Accuracy: 0.9822398  Vali weighted F1: 0.9822951  Vali macro F1 0.9760590 
new best score!!!!
Validation loss decreased (0.061657 --> 0.061302).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 6.473080635070801
Fine Tuning VALI: Epoch: 17, Steps: 72 | Train Loss: 0.0210008  Vali Loss: 0.0655930 Vali Accuracy: 0.9812531  Vali weighted F1: 0.9812465  Vali macro F1 0.9749402 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 6.468308210372925
Fine Tuning VALI: Epoch: 18, Steps: 72 | Train Loss: 0.0243447  Vali Loss: 0.0660045 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9807161  Vali macro F1 0.9746668 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 6.473772764205933
Fine Tuning VALI: Epoch: 19, Steps: 72 | Train Loss: 0.0202484  Vali Loss: 0.0635347 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9807211  Vali macro F1 0.9747581 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 6.474868297576904
Fine Tuning VALI: Epoch: 20, Steps: 72 | Train Loss: 0.0198177  Vali Loss: 0.0642805 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9807539  Vali macro F1 0.9725998 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 6.463381052017212
Fine Tuning VALI: Epoch: 21, Steps: 72 | Train Loss: 0.0181369  Vali Loss: 0.0654964 Vali Accuracy: 0.9822398  Vali weighted F1: 0.9822001  Vali macro F1 0.9745354 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 22 cost time: 6.479119777679443
Fine Tuning VALI: Epoch: 22, Steps: 72 | Train Loss: 0.0175633  Vali Loss: 0.0640177 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9807742  Vali macro F1 0.9731338 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 6.463180303573608
Fine Tuning VALI: Epoch: 23, Steps: 72 | Train Loss: 0.0175467  Vali Loss: 0.0637617 Vali Accuracy: 0.9802664  Vali weighted F1: 0.9802828  Vali macro F1 0.9721468 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 6.485665559768677
Fine Tuning VALI: Epoch: 24, Steps: 72 | Train Loss: 0.0174595  Vali Loss: 0.0645425 Vali Accuracy: 0.9822398  Vali weighted F1: 0.9822441  Vali macro F1 0.9759570 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 6.470473766326904
Fine Tuning VALI: Epoch: 25, Steps: 72 | Train Loss: 0.0169385  Vali Loss: 0.0632871 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9807785  Vali macro F1 0.9729172 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 6.489379644393921
Fine Tuning VALI: Epoch: 26, Steps: 72 | Train Loss: 0.0180911  Vali Loss: 0.0637926 Vali Accuracy: 0.9817464  Vali weighted F1: 0.9817500  Vali macro F1 0.9743619 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 27 cost time: 6.4747374057769775
Fine Tuning VALI: Epoch: 27, Steps: 72 | Train Loss: 0.0172714  Vali Loss: 0.0637290 Vali Accuracy: 0.9817464  Vali weighted F1: 0.9817500  Vali macro F1 0.9743619 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 28 cost time: 6.477848052978516
Fine Tuning VALI: Epoch: 28, Steps: 72 | Train Loss: 0.0184325  Vali Loss: 0.0637577 Vali Accuracy: 0.9817464  Vali weighted F1: 0.9817500  Vali macro F1 0.9743619 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 29 cost time: 6.460629940032959
Fine Tuning VALI: Epoch: 29, Steps: 72 | Train Loss: 0.0170414  Vali Loss: 0.0638840 Vali Accuracy: 0.9822398  Vali weighted F1: 0.9822317  Vali macro F1 0.9747963 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 30 cost time: 6.4572954177856445
Fine Tuning VALI: Epoch: 30, Steps: 72 | Train Loss: 0.0173586  Vali Loss: 0.0637639 Vali Accuracy: 0.9817464  Vali weighted F1: 0.9817500  Vali macro F1 0.9743619 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 31 cost time: 6.495274543762207
Fine Tuning VALI: Epoch: 31, Steps: 72 | Train Loss: 0.0175694  Vali Loss: 0.0637180 Vali Accuracy: 0.9817464  Vali weighted F1: 0.9817500  Vali macro F1 0.9743619 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8393500  Test weighted F1: 0.8353379  Test macro F1 0.6263069 
================ the 7 th CV Experiment ================ 
Leave one Out Experiment : The 8 Part as the test
[-] Target sampling weights:  [0.0001452  0.00016892 0.00099305 0.00131234 0.00049875 0.00062893]
Train data number :  18171
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2019
Test data number :  8450
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.434321641921997
VALI: Epoch: 1, Steps: 71 | Train Loss: 0.9953926  Vali Loss: 0.5779473 Vali Accuracy: 0.7934621  Vali weighted F1: 0.7550330  Vali macro F1 0.5342431 
Validation loss decreased (inf --> 0.577947).  Saving model ...
Epoch: 2 cost time: 6.419589519500732
VALI: Epoch: 2, Steps: 71 | Train Loss: 0.4885909  Vali Loss: 0.3846537 Vali Accuracy: 0.8637940  Vali weighted F1: 0.8458328  Vali macro F1 0.7984945 
new best score!!!!
Validation loss decreased (0.577947 --> 0.384654).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.432759523391724
VALI: Epoch: 3, Steps: 71 | Train Loss: 0.3714936  Vali Loss: 0.2629308 Vali Accuracy: 0.9098564  Vali weighted F1: 0.9065372  Vali macro F1 0.8732533 
new best score!!!!
Validation loss decreased (0.384654 --> 0.262931).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.42103385925293
VALI: Epoch: 4, Steps: 71 | Train Loss: 0.2802356  Vali Loss: 0.2259592 Vali Accuracy: 0.9162952  Vali weighted F1: 0.9119137  Vali macro F1 0.8781226 
new best score!!!!
Validation loss decreased (0.262931 --> 0.225959).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.424340486526489
VALI: Epoch: 5, Steps: 71 | Train Loss: 0.2309441  Vali Loss: 0.1754230 Vali Accuracy: 0.9410599  Vali weighted F1: 0.9397656  Vali macro F1 0.9151474 
new best score!!!!
Validation loss decreased (0.225959 --> 0.175423).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.433965444564819
VALI: Epoch: 6, Steps: 71 | Train Loss: 0.2038280  Vali Loss: 0.1535469 Vali Accuracy: 0.9489846  Vali weighted F1: 0.9489906  Vali macro F1 0.9235033 
new best score!!!!
Validation loss decreased (0.175423 --> 0.153547).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.440740346908569
VALI: Epoch: 7, Steps: 71 | Train Loss: 0.1649068  Vali Loss: 0.1391462 Vali Accuracy: 0.9504705  Vali weighted F1: 0.9504863  Vali macro F1 0.9248190 
new best score!!!!
Validation loss decreased (0.153547 --> 0.139146).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.4339919090271
VALI: Epoch: 8, Steps: 71 | Train Loss: 0.1523551  Vali Loss: 0.1199972 Vali Accuracy: 0.9588905  Vali weighted F1: 0.9587154  Vali macro F1 0.9375792 
new best score!!!!
Validation loss decreased (0.139146 --> 0.119997).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.450601577758789
VALI: Epoch: 9, Steps: 71 | Train Loss: 0.1384212  Vali Loss: 0.1061177 Vali Accuracy: 0.9623576  Vali weighted F1: 0.9620513  Vali macro F1 0.9416166 
new best score!!!!
Validation loss decreased (0.119997 --> 0.106118).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.44671368598938
VALI: Epoch: 10, Steps: 71 | Train Loss: 0.1170845  Vali Loss: 0.1104225 Vali Accuracy: 0.9593858  Vali weighted F1: 0.9597339  Vali macro F1 0.9395146 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.448499441146851
VALI: Epoch: 11, Steps: 71 | Train Loss: 0.1071378  Vali Loss: 0.0946185 Vali Accuracy: 0.9633482  Vali weighted F1: 0.9628793  Vali macro F1 0.9430887 
new best score!!!!
Validation loss decreased (0.106118 --> 0.094619).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.433496713638306
VALI: Epoch: 12, Steps: 71 | Train Loss: 0.0983687  Vali Loss: 0.0925618 Vali Accuracy: 0.9683011  Vali weighted F1: 0.9681983  Vali macro F1 0.9480898 
new best score!!!!
Validation loss decreased (0.094619 --> 0.092562).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.436906576156616
VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0899436  Vali Loss: 0.1459779 Vali Accuracy: 0.9514611  Vali weighted F1: 0.9507867  Vali macro F1 0.9310626 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 6.449576377868652
VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0881326  Vali Loss: 0.0852592 Vali Accuracy: 0.9712729  Vali weighted F1: 0.9707921  Vali macro F1 0.9582173 
new best score!!!!
Validation loss decreased (0.092562 --> 0.085259).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.4348695278167725
VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0819562  Vali Loss: 0.0721208 Vali Accuracy: 0.9732541  Vali weighted F1: 0.9731639  Vali macro F1 0.9604147 
new best score!!!!
Validation loss decreased (0.085259 --> 0.072121).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.428606271743774
VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0689791  Vali Loss: 0.0723093 Vali Accuracy: 0.9767211  Vali weighted F1: 0.9767441  Vali macro F1 0.9659372 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 6.431177139282227
VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0624080  Vali Loss: 0.0679052 Vali Accuracy: 0.9757306  Vali weighted F1: 0.9756032  Vali macro F1 0.9617964 
new best score!!!!
Validation loss decreased (0.072121 --> 0.067905).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.448734760284424
VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0595761  Vali Loss: 0.0883135 Vali Accuracy: 0.9687964  Vali weighted F1: 0.9680799  Vali macro F1 0.9521425 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.455135345458984
VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0577736  Vali Loss: 0.0692676 Vali Accuracy: 0.9777117  Vali weighted F1: 0.9774364  Vali macro F1 0.9654188 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 6.436253547668457
VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0583972  Vali Loss: 0.0681793 Vali Accuracy: 0.9757306  Vali weighted F1: 0.9756524  Vali macro F1 0.9624011 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 21 cost time: 6.432795524597168
VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0448457  Vali Loss: 0.0673727 Vali Accuracy: 0.9742447  Vali weighted F1: 0.9740834  Vali macro F1 0.9564345 
new best score!!!!
Validation loss decreased (0.067905 --> 0.067373).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.43658709526062
VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0434173  Vali Loss: 0.0818455 Vali Accuracy: 0.9692917  Vali weighted F1: 0.9684517  Vali macro F1 0.9569802 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.439414024353027
VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0454853  Vali Loss: 0.0704689 Vali Accuracy: 0.9762259  Vali weighted F1: 0.9760646  Vali macro F1 0.9642304 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 6.440594911575317
VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0387808  Vali Loss: 0.0540834 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9806297  Vali macro F1 0.9690102 
new best score!!!!
Validation loss decreased (0.067373 --> 0.054083).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.4328882694244385
VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0318209  Vali Loss: 0.0605046 Vali Accuracy: 0.9787023  Vali weighted F1: 0.9785403  Vali macro F1 0.9672647 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 6.428266763687134
VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0393050  Vali Loss: 0.0716006 Vali Accuracy: 0.9772164  Vali weighted F1: 0.9769265  Vali macro F1 0.9659746 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 6.467593193054199
VALI: Epoch: 27, Steps: 71 | Train Loss: 0.0336159  Vali Loss: 0.0616905 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9805447  Vali macro F1 0.9714609 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 28 cost time: 6.450336456298828
VALI: Epoch: 28, Steps: 71 | Train Loss: 0.0266430  Vali Loss: 0.0674167 Vali Accuracy: 0.9757306  Vali weighted F1: 0.9752676  Vali macro F1 0.9628697 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 29 cost time: 6.438596725463867
VALI: Epoch: 29, Steps: 71 | Train Loss: 0.0398648  Vali Loss: 0.0640259 Vali Accuracy: 0.9811788  Vali weighted F1: 0.9811824  Vali macro F1 0.9709461 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 30 cost time: 6.436692476272583
VALI: Epoch: 30, Steps: 71 | Train Loss: 0.0247775  Vali Loss: 0.0514976 Vali Accuracy: 0.9856365  Vali weighted F1: 0.9856463  Vali macro F1 0.9764358 
new best score!!!!
Validation loss decreased (0.054083 --> 0.051498).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.436314582824707
VALI: Epoch: 31, Steps: 71 | Train Loss: 0.0185791  Vali Loss: 0.0521724 Vali Accuracy: 0.9831600  Vali weighted F1: 0.9830989  Vali macro F1 0.9730809 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 6.434113502502441
VALI: Epoch: 32, Steps: 71 | Train Loss: 0.0163746  Vali Loss: 0.0535975 Vali Accuracy: 0.9821694  Vali weighted F1: 0.9820787  Vali macro F1 0.9718653 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 6.452219724655151
VALI: Epoch: 33, Steps: 71 | Train Loss: 0.0159425  Vali Loss: 0.0516978 Vali Accuracy: 0.9856365  Vali weighted F1: 0.9855898  Vali macro F1 0.9772524 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 34 cost time: 6.425734281539917
VALI: Epoch: 34, Steps: 71 | Train Loss: 0.0143218  Vali Loss: 0.0506914 Vali Accuracy: 0.9846459  Vali weighted F1: 0.9846302  Vali macro F1 0.9746682 
new best score!!!!
Validation loss decreased (0.051498 --> 0.050691).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 6.436261415481567
VALI: Epoch: 35, Steps: 71 | Train Loss: 0.0140125  Vali Loss: 0.0515291 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9825917  Vali macro F1 0.9724187 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 6.461840391159058
VALI: Epoch: 36, Steps: 71 | Train Loss: 0.0130497  Vali Loss: 0.0504865 Vali Accuracy: 0.9851412  Vali weighted F1: 0.9851257  Vali macro F1 0.9743142 
new best score!!!!
Validation loss decreased (0.050691 --> 0.050487).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.4384400844573975
VALI: Epoch: 37, Steps: 71 | Train Loss: 0.0130717  Vali Loss: 0.0518854 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9836009  Vali macro F1 0.9727611 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 6.444776773452759
VALI: Epoch: 38, Steps: 71 | Train Loss: 0.0129703  Vali Loss: 0.0506862 Vali Accuracy: 0.9846459  Vali weighted F1: 0.9846172  Vali macro F1 0.9737939 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 6.4257652759552
VALI: Epoch: 39, Steps: 71 | Train Loss: 0.0120115  Vali Loss: 0.0510305 Vali Accuracy: 0.9851412  Vali weighted F1: 0.9851146  Vali macro F1 0.9746894 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 40 cost time: 6.430590391159058
VALI: Epoch: 40, Steps: 71 | Train Loss: 0.0115797  Vali Loss: 0.0515030 Vali Accuracy: 0.9851412  Vali weighted F1: 0.9850948  Vali macro F1 0.9752822 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 41 cost time: 6.432762145996094
VALI: Epoch: 41, Steps: 71 | Train Loss: 0.0113703  Vali Loss: 0.0512312 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9826188  Vali macro F1 0.9706923 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 42 cost time: 6.428832054138184
VALI: Epoch: 42, Steps: 71 | Train Loss: 0.0111970  Vali Loss: 0.0509871 Vali Accuracy: 0.9831600  Vali weighted F1: 0.9831195  Vali macro F1 0.9714926 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 6.4285359382629395
VALI: Epoch: 43, Steps: 71 | Train Loss: 0.0106409  Vali Loss: 0.0509698 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9836155  Vali macro F1 0.9723503 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 6.428230285644531
VALI: Epoch: 44, Steps: 71 | Train Loss: 0.0103698  Vali Loss: 0.0510222 Vali Accuracy: 0.9846459  Vali weighted F1: 0.9846077  Vali macro F1 0.9740678 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 6.438687801361084
VALI: Epoch: 45, Steps: 71 | Train Loss: 0.0108349  Vali Loss: 0.0512612 Vali Accuracy: 0.9841506  Vali weighted F1: 0.9841115  Vali macro F1 0.9732087 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 46 cost time: 6.439387321472168
VALI: Epoch: 46, Steps: 71 | Train Loss: 0.0097455  Vali Loss: 0.0509803 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9836155  Vali macro F1 0.9723503 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 47 cost time: 6.436990261077881
VALI: Epoch: 47, Steps: 71 | Train Loss: 0.0099610  Vali Loss: 0.0509858 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9836155  Vali macro F1 0.9723503 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 6.437521934509277
VALI: Epoch: 48, Steps: 71 | Train Loss: 0.0102393  Vali Loss: 0.0510605 Vali Accuracy: 0.9841506  Vali weighted F1: 0.9841115  Vali macro F1 0.9732087 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 6.429356813430786
VALI: Epoch: 49, Steps: 71 | Train Loss: 0.0104894  Vali Loss: 0.0510420 Vali Accuracy: 0.9841506  Vali weighted F1: 0.9841115  Vali macro F1 0.9732087 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 50 cost time: 6.43027138710022
VALI: Epoch: 50, Steps: 71 | Train Loss: 0.0099696  Vali Loss: 0.0511095 Vali Accuracy: 0.9841506  Vali weighted F1: 0.9841115  Vali macro F1 0.9732087 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 51 cost time: 6.423743009567261
VALI: Epoch: 51, Steps: 71 | Train Loss: 0.0106605  Vali Loss: 0.0510521 Vali Accuracy: 0.9841506  Vali weighted F1: 0.9841115  Vali macro F1 0.9732087 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.7758580  Test weighted F1: 0.7828038  Test macro F1 0.8150645 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 240495
pruned model Parameter : 244174
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.453831911087036
Fine Tuning VALI: Epoch: 1, Steps: 71 | Train Loss: 0.0118879  Vali Loss: 0.0595903 Vali Accuracy: 0.9811788  Vali weighted F1: 0.9810415  Vali macro F1 0.9704864 
Validation loss decreased (inf --> 0.059590).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.44033670425415
Fine Tuning VALI: Epoch: 2, Steps: 71 | Train Loss: 0.0138850  Vali Loss: 0.0515088 Vali Accuracy: 0.9841506  Vali weighted F1: 0.9841352  Vali macro F1 0.9733614 
new best score!!!!
Validation loss decreased (0.059590 --> 0.051509).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.457597017288208
Fine Tuning VALI: Epoch: 3, Steps: 71 | Train Loss: 0.0112685  Vali Loss: 0.0539243 Vali Accuracy: 0.9846459  Vali weighted F1: 0.9845867  Vali macro F1 0.9740773 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.433295726776123
Fine Tuning VALI: Epoch: 4, Steps: 71 | Train Loss: 0.0115263  Vali Loss: 0.0535619 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9836021  Vali macro F1 0.9727085 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.471771001815796
Fine Tuning VALI: Epoch: 5, Steps: 71 | Train Loss: 0.0106231  Vali Loss: 0.0517413 Vali Accuracy: 0.9846459  Vali weighted F1: 0.9846314  Vali macro F1 0.9742210 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 6.45048451423645
Fine Tuning VALI: Epoch: 6, Steps: 71 | Train Loss: 0.0106409  Vali Loss: 0.0524741 Vali Accuracy: 0.9846459  Vali weighted F1: 0.9846282  Vali macro F1 0.9734658 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 6.447075605392456
Fine Tuning VALI: Epoch: 7, Steps: 71 | Train Loss: 0.0094703  Vali Loss: 0.0527766 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9836268  Vali macro F1 0.9721244 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 8 cost time: 6.442800760269165
Fine Tuning VALI: Epoch: 8, Steps: 71 | Train Loss: 0.0089721  Vali Loss: 0.0513298 Vali Accuracy: 0.9841506  Vali weighted F1: 0.9841460  Vali macro F1 0.9729992 
new best score!!!!
Validation loss decreased (0.051509 --> 0.051330).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.439334869384766
Fine Tuning VALI: Epoch: 9, Steps: 71 | Train Loss: 0.0095385  Vali Loss: 0.0541542 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9836666  Vali macro F1 0.9726380 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.442989826202393
Fine Tuning VALI: Epoch: 10, Steps: 71 | Train Loss: 0.0092805  Vali Loss: 0.0500663 Vali Accuracy: 0.9861317  Vali weighted F1: 0.9861492  Vali macro F1 0.9757725 
new best score!!!!
Validation loss decreased (0.051330 --> 0.050066).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 6.44257664680481
Fine Tuning VALI: Epoch: 11, Steps: 71 | Train Loss: 0.0086963  Vali Loss: 0.0537557 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9836272  Vali macro F1 0.9721437 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.448369979858398
Fine Tuning VALI: Epoch: 12, Steps: 71 | Train Loss: 0.0089677  Vali Loss: 0.0511193 Vali Accuracy: 0.9841506  Vali weighted F1: 0.9842132  Vali macro F1 0.9727868 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.471592664718628
Fine Tuning VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0084216  Vali Loss: 0.0524780 Vali Accuracy: 0.9831600  Vali weighted F1: 0.9831860  Vali macro F1 0.9713222 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.4720470905303955
Fine Tuning VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0085516  Vali Loss: 0.0502877 Vali Accuracy: 0.9861317  Vali weighted F1: 0.9861614  Vali macro F1 0.9755124 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.436338424682617
Fine Tuning VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0084267  Vali Loss: 0.0495198 Vali Accuracy: 0.9871223  Vali weighted F1: 0.9871192  Vali macro F1 0.9775232 
new best score!!!!
Validation loss decreased (0.050066 --> 0.049520).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 6.443476676940918
Fine Tuning VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0075651  Vali Loss: 0.0515731 Vali Accuracy: 0.9851412  Vali weighted F1: 0.9851475  Vali macro F1 0.9743988 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 6.445754051208496
Fine Tuning VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0078301  Vali Loss: 0.0626718 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9800508  Vali macro F1 0.9682076 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 6.449845314025879
Fine Tuning VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0085950  Vali Loss: 0.0598264 Vali Accuracy: 0.9821694  Vali weighted F1: 0.9821235  Vali macro F1 0.9705514 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 6.451244592666626
Fine Tuning VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0079150  Vali Loss: 0.0529674 Vali Accuracy: 0.9846459  Vali weighted F1: 0.9846310  Vali macro F1 0.9742065 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 6.4532599449157715
Fine Tuning VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0071089  Vali Loss: 0.0538583 Vali Accuracy: 0.9856365  Vali weighted F1: 0.9856434  Vali macro F1 0.9753928 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 21 cost time: 6.461467742919922
Fine Tuning VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0058069  Vali Loss: 0.0534346 Vali Accuracy: 0.9861317  Vali weighted F1: 0.9861157  Vali macro F1 0.9762380 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 6.462131500244141
Fine Tuning VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0057292  Vali Loss: 0.0535072 Vali Accuracy: 0.9866270  Vali weighted F1: 0.9866340  Vali macro F1 0.9764177 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 6.468286514282227
Fine Tuning VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0059010  Vali Loss: 0.0535793 Vali Accuracy: 0.9856365  Vali weighted F1: 0.9856296  Vali macro F1 0.9750497 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 6.4358038902282715
Fine Tuning VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0060505  Vali Loss: 0.0540962 Vali Accuracy: 0.9846459  Vali weighted F1: 0.9846229  Vali macro F1 0.9736538 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 25 cost time: 6.4436585903167725
Fine Tuning VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0063165  Vali Loss: 0.0538624 Vali Accuracy: 0.9846459  Vali weighted F1: 0.9846284  Vali macro F1 0.9735879 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 26 cost time: 6.44482946395874
Fine Tuning VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0055573  Vali Loss: 0.0538555 Vali Accuracy: 0.9846459  Vali weighted F1: 0.9846284  Vali macro F1 0.9735879 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 27 cost time: 6.4470508098602295
Fine Tuning VALI: Epoch: 27, Steps: 71 | Train Loss: 0.0058069  Vali Loss: 0.0538942 Vali Accuracy: 0.9846459  Vali weighted F1: 0.9846284  Vali macro F1 0.9735879 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 28 cost time: 6.466087579727173
Fine Tuning VALI: Epoch: 28, Steps: 71 | Train Loss: 0.0058232  Vali Loss: 0.0538262 Vali Accuracy: 0.9846459  Vali weighted F1: 0.9846284  Vali macro F1 0.9735879 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 29 cost time: 6.464360475540161
Fine Tuning VALI: Epoch: 29, Steps: 71 | Train Loss: 0.0055499  Vali Loss: 0.0538247 Vali Accuracy: 0.9846459  Vali weighted F1: 0.9846284  Vali macro F1 0.9735879 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 30 cost time: 6.455156087875366
Fine Tuning VALI: Epoch: 30, Steps: 71 | Train Loss: 0.0055092  Vali Loss: 0.0538532 Vali Accuracy: 0.9846459  Vali weighted F1: 0.9846284  Vali macro F1 0.9735879 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.7520710  Test weighted F1: 0.7607340  Test macro F1 0.7880407 
================ the 8 th CV Experiment ================ 
Leave one Out Experiment : The 9 Part as the test
[-] Target sampling weights:  [0.00014665 0.00017765 0.00108578 0.00135318 0.00049407 0.00062383]
Train data number :  17735
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1971
Test data number :  10867
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.295622825622559
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.0395641  Vali Loss: 0.6338941 Vali Accuracy: 0.7656012  Vali weighted F1: 0.7062824  Vali macro F1 0.4796420 
Validation loss decreased (inf --> 0.633894).  Saving model ...
Epoch: 2 cost time: 6.286498785018921
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.5438131  Vali Loss: 0.4796491 Vali Accuracy: 0.8153222  Vali weighted F1: 0.8117169  Vali macro F1 0.7664311 
new best score!!!!
Validation loss decreased (0.633894 --> 0.479649).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.281526803970337
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.4074498  Vali Loss: 0.3367693 Vali Accuracy: 0.8939625  Vali weighted F1: 0.8828166  Vali macro F1 0.8496075 
new best score!!!!
Validation loss decreased (0.479649 --> 0.336769).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.301237344741821
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.3113867  Vali Loss: 0.2444570 Vali Accuracy: 0.9178082  Vali weighted F1: 0.9144483  Vali macro F1 0.8857819 
new best score!!!!
Validation loss decreased (0.336769 --> 0.244457).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.299598932266235
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.2351951  Vali Loss: 0.1863903 Vali Accuracy: 0.9406393  Vali weighted F1: 0.9391973  Vali macro F1 0.9227854 
new best score!!!!
Validation loss decreased (0.244457 --> 0.186390).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.312227010726929
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.1850990  Vali Loss: 0.1697992 Vali Accuracy: 0.9421613  Vali weighted F1: 0.9408592  Vali macro F1 0.9206848 
new best score!!!!
Validation loss decreased (0.186390 --> 0.169799).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.280611991882324
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.1684254  Vali Loss: 0.1710050 Vali Accuracy: 0.9452055  Vali weighted F1: 0.9438569  Vali macro F1 0.9275872 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 8 cost time: 6.274990558624268
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1408210  Vali Loss: 0.1314539 Vali Accuracy: 0.9558600  Vali weighted F1: 0.9554993  Vali macro F1 0.9410257 
new best score!!!!
Validation loss decreased (0.169799 --> 0.131454).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.290004014968872
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1262431  Vali Loss: 0.1419089 Vali Accuracy: 0.9507864  Vali weighted F1: 0.9500034  Vali macro F1 0.9320854 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 6.316197395324707
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1146964  Vali Loss: 0.1069051 Vali Accuracy: 0.9660071  Vali weighted F1: 0.9659651  Vali macro F1 0.9552472 
new best score!!!!
Validation loss decreased (0.131454 --> 0.106905).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.294437646865845
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1070051  Vali Loss: 0.1253851 Vali Accuracy: 0.9594115  Vali weighted F1: 0.9586240  Vali macro F1 0.9458182 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 6.304872035980225
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0932945  Vali Loss: 0.1196094 Vali Accuracy: 0.9583968  Vali weighted F1: 0.9575763  Vali macro F1 0.9456349 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 13 cost time: 6.295657396316528
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0883851  Vali Loss: 0.0958427 Vali Accuracy: 0.9675292  Vali weighted F1: 0.9674312  Vali macro F1 0.9570751 
new best score!!!!
Validation loss decreased (0.106905 --> 0.095843).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.279869079589844
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0853348  Vali Loss: 0.1067396 Vali Accuracy: 0.9634703  Vali weighted F1: 0.9629682  Vali macro F1 0.9511322 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.301254749298096
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0760760  Vali Loss: 0.0816429 Vali Accuracy: 0.9731101  Vali weighted F1: 0.9731005  Vali macro F1 0.9625596 
new best score!!!!
Validation loss decreased (0.095843 --> 0.081643).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.3027307987213135
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0748924  Vali Loss: 0.0903362 Vali Accuracy: 0.9690512  Vali weighted F1: 0.9696234  Vali macro F1 0.9584719 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 6.295223236083984
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0706173  Vali Loss: 0.0749300 Vali Accuracy: 0.9741248  Vali weighted F1: 0.9742743  Vali macro F1 0.9637492 
new best score!!!!
Validation loss decreased (0.081643 --> 0.074930).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.3110809326171875
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0630566  Vali Loss: 0.0801422 Vali Accuracy: 0.9710807  Vali weighted F1: 0.9711567  Vali macro F1 0.9609709 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.3095433712005615
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0574527  Vali Loss: 0.1217519 Vali Accuracy: 0.9609335  Vali weighted F1: 0.9594992  Vali macro F1 0.9454017 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 6.3040711879730225
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0656470  Vali Loss: 0.0800562 Vali Accuracy: 0.9736175  Vali weighted F1: 0.9736072  Vali macro F1 0.9600926 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 21 cost time: 6.297669887542725
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0556837  Vali Loss: 0.1242846 Vali Accuracy: 0.9614409  Vali weighted F1: 0.9609004  Vali macro F1 0.9514901 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 22 cost time: 6.285179376602173
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0504626  Vali Loss: 0.0739184 Vali Accuracy: 0.9781837  Vali weighted F1: 0.9780865  Vali macro F1 0.9676318 
new best score!!!!
Validation loss decreased (0.074930 --> 0.073918).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.286052703857422
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0451578  Vali Loss: 0.0751430 Vali Accuracy: 0.9726027  Vali weighted F1: 0.9723123  Vali macro F1 0.9607302 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 6.288489580154419
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0422419  Vali Loss: 0.0845296 Vali Accuracy: 0.9726027  Vali weighted F1: 0.9730588  Vali macro F1 0.9635787 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 6.300891637802124
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0464678  Vali Loss: 0.0675474 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9774821  Vali macro F1 0.9668834 
new best score!!!!
Validation loss decreased (0.073918 --> 0.067547).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.307458877563477
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0368009  Vali Loss: 0.0594697 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9797647  Vali macro F1 0.9703976 
new best score!!!!
Validation loss decreased (0.067547 --> 0.059470).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.306400299072266
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0389060  Vali Loss: 0.0714054 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9791825  Vali macro F1 0.9695137 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.315357446670532
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0352663  Vali Loss: 0.0728573 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9791516  Vali macro F1 0.9685929 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 6.331138372421265
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0326940  Vali Loss: 0.0598618 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9801896  Vali macro F1 0.9708096 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 6.303736209869385
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0245149  Vali Loss: 0.0591287 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9807100  Vali macro F1 0.9708536 
new best score!!!!
Validation loss decreased (0.059470 --> 0.059129).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.287122964859009
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0244585  Vali Loss: 0.0921673 Vali Accuracy: 0.9705733  Vali weighted F1: 0.9701528  Vali macro F1 0.9593420 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 6.30143928527832
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0297999  Vali Loss: 0.0749546 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9776727  Vali macro F1 0.9678420 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 6.2850470542907715
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0351829  Vali Loss: 0.0752359 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9794149  Vali macro F1 0.9689781 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 34 cost time: 6.302273750305176
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0305931  Vali Loss: 0.0628171 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9813278  Vali macro F1 0.9715580 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 35 cost time: 6.290001630783081
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0272722  Vali Loss: 0.0849352 Vali Accuracy: 0.9736175  Vali weighted F1: 0.9733394  Vali macro F1 0.9618063 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 36 cost time: 6.3091254234313965
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0189456  Vali Loss: 0.0594444 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9807240  Vali macro F1 0.9705360 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 6.314054489135742
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0129400  Vali Loss: 0.0559714 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9822923  Vali macro F1 0.9722184 
new best score!!!!
Validation loss decreased (0.059129 --> 0.055971).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 6.314787864685059
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0118377  Vali Loss: 0.0565170 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9828200  Vali macro F1 0.9742328 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 6.311517000198364
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0117204  Vali Loss: 0.0564014 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9822652  Vali macro F1 0.9721885 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 6.303603172302246
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0111425  Vali Loss: 0.0571588 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9833266  Vali macro F1 0.9744615 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 6.304162979125977
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0098388  Vali Loss: 0.0557302 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9833066  Vali macro F1 0.9748078 
new best score!!!!
Validation loss decreased (0.055971 --> 0.055730).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 6.293218374252319
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0106009  Vali Loss: 0.0579082 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9838111  Vali macro F1 0.9756786 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 6.299583435058594
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0100727  Vali Loss: 0.0577479 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853434  Vali macro F1 0.9778848 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 6.294116973876953
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0098587  Vali Loss: 0.0572320 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9823121  Vali macro F1 0.9725192 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 6.299014329910278
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0095077  Vali Loss: 0.0560457 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9817884  Vali macro F1 0.9718184 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 46 cost time: 6.33762264251709
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0094978  Vali Loss: 0.0571937 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9823214  Vali macro F1 0.9722507 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 47 cost time: 6.318323850631714
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0084332  Vali Loss: 0.0577339 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9823004  Vali macro F1 0.9725953 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 6.3079705238342285
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0088857  Vali Loss: 0.0579590 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9822717  Vali macro F1 0.9725501 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 6.30899715423584
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0078009  Vali Loss: 0.0578016 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9822717  Vali macro F1 0.9725501 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 50 cost time: 6.3081748485565186
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0086383  Vali Loss: 0.0579102 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827762  Vali macro F1 0.9734092 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 51 cost time: 6.301253318786621
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0084110  Vali Loss: 0.0580539 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9828038  Vali macro F1 0.9734529 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 52 cost time: 6.300993919372559
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0086865  Vali Loss: 0.0580347 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9822780  Vali macro F1 0.9729369 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 6.310532808303833
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0087140  Vali Loss: 0.0580778 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9822780  Vali macro F1 0.9729369 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 6.29698634147644
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0083749  Vali Loss: 0.0580110 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9822780  Vali macro F1 0.9729369 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 55 cost time: 6.326753854751587
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0080993  Vali Loss: 0.0579510 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9822780  Vali macro F1 0.9729369 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 56 cost time: 6.3249897956848145
VALI: Epoch: 56, Steps: 70 | Train Loss: 0.0084320  Vali Loss: 0.0579161 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9822780  Vali macro F1 0.9729369 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9296034  Test weighted F1: 0.9296705  Test macro F1 0.8792386 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 240495
pruned model Parameter : 244174
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.3113853931427
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0107618  Vali Loss: 0.0615080 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9822456  Vali macro F1 0.9733963 
Validation loss decreased (inf --> 0.061508).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.284201622009277
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0107132  Vali Loss: 0.0568014 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9828113  Vali macro F1 0.9737646 
new best score!!!!
Validation loss decreased (0.061508 --> 0.056801).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.295220613479614
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0100851  Vali Loss: 0.0579585 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9828062  Vali macro F1 0.9729531 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.287020206451416
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0096047  Vali Loss: 0.0569538 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9822752  Vali macro F1 0.9733764 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 6.295980930328369
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0086578  Vali Loss: 0.0582824 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9833094  Vali macro F1 0.9732303 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 6.294720411300659
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0084686  Vali Loss: 0.0612477 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9817542  Vali macro F1 0.9704792 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 6.320160150527954
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0076906  Vali Loss: 0.0592802 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9822805  Vali macro F1 0.9723905 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 8 cost time: 6.317607879638672
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0074987  Vali Loss: 0.0599379 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9817694  Vali macro F1 0.9721263 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.305737257003784
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0067035  Vali Loss: 0.0665004 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9812107  Vali macro F1 0.9710970 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 6.300480604171753
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0075231  Vali Loss: 0.0610167 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827700  Vali macro F1 0.9738436 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 6.300861835479736
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0066974  Vali Loss: 0.0652432 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9817236  Vali macro F1 0.9723900 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 6.294205904006958
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0067396  Vali Loss: 0.0633975 Vali Accuracy: 0.9827499  Vali weighted F1: 0.9827508  Vali macro F1 0.9733560 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 13 cost time: 6.302228212356567
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0061102  Vali Loss: 0.0614229 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837896  Vali macro F1 0.9740631 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.28902268409729
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0061395  Vali Loss: 0.0616300 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832637  Vali macro F1 0.9735470 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.302122592926025
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0060699  Vali Loss: 0.0627358 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837901  Vali macro F1 0.9745029 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.296566963195801
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0052245  Vali Loss: 0.0615244 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832642  Vali macro F1 0.9739868 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 6.321287393569946
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0061266  Vali Loss: 0.0614452 Vali Accuracy: 0.9832572  Vali weighted F1: 0.9832642  Vali macro F1 0.9739868 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9306156  Test weighted F1: 0.9307322  Test macro F1 0.8810975 
================ the 9 th CV Experiment ================ 
Leave one Out Experiment : The 10 Part as the test
[-] Target sampling weights:  [0.00014041 0.00018215 0.00102459 0.00129702 0.00049213 0.0005963 ]
Train data number :  18068
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2008
Test data number :  9022
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.405877590179443
VALI: Epoch: 1, Steps: 71 | Train Loss: 0.9903397  Vali Loss: 0.5814711 Vali Accuracy: 0.7938247  Vali weighted F1: 0.7538201  Vali macro F1 0.5517450 
Validation loss decreased (inf --> 0.581471).  Saving model ...
Epoch: 2 cost time: 6.396124601364136
VALI: Epoch: 2, Steps: 71 | Train Loss: 0.4472114  Vali Loss: 0.3374134 Vali Accuracy: 0.8789841  Vali weighted F1: 0.8704217  Vali macro F1 0.8242803 
new best score!!!!
Validation loss decreased (0.581471 --> 0.337413).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.3835718631744385
VALI: Epoch: 3, Steps: 71 | Train Loss: 0.3093378  Vali Loss: 0.2497859 Vali Accuracy: 0.9153386  Vali weighted F1: 0.9121824  Vali macro F1 0.8817349 
new best score!!!!
Validation loss decreased (0.337413 --> 0.249786).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.380842208862305
VALI: Epoch: 4, Steps: 71 | Train Loss: 0.2288160  Vali Loss: 0.1976406 Vali Accuracy: 0.9302789  Vali weighted F1: 0.9296749  Vali macro F1 0.9023038 
new best score!!!!
Validation loss decreased (0.249786 --> 0.197641).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.393481731414795
VALI: Epoch: 5, Steps: 71 | Train Loss: 0.1976106  Vali Loss: 0.1985568 Vali Accuracy: 0.9233068  Vali weighted F1: 0.9248534  Vali macro F1 0.9005271 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 6 cost time: 6.397218942642212
VALI: Epoch: 6, Steps: 71 | Train Loss: 0.1681276  Vali Loss: 0.1614972 Vali Accuracy: 0.9447211  Vali weighted F1: 0.9438955  Vali macro F1 0.9194981 
new best score!!!!
Validation loss decreased (0.197641 --> 0.161497).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.385053396224976
VALI: Epoch: 7, Steps: 71 | Train Loss: 0.1511807  Vali Loss: 0.1333421 Vali Accuracy: 0.9561753  Vali weighted F1: 0.9562341  Vali macro F1 0.9369592 
new best score!!!!
Validation loss decreased (0.161497 --> 0.133342).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.422512531280518
VALI: Epoch: 8, Steps: 71 | Train Loss: 0.1447383  Vali Loss: 0.1388799 Vali Accuracy: 0.9551793  Vali weighted F1: 0.9549080  Vali macro F1 0.9332619 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 9 cost time: 6.398515224456787
VALI: Epoch: 9, Steps: 71 | Train Loss: 0.1394377  Vali Loss: 0.1355422 Vali Accuracy: 0.9531873  Vali weighted F1: 0.9529992  Vali macro F1 0.9287895 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 10 cost time: 6.410851240158081
VALI: Epoch: 10, Steps: 71 | Train Loss: 0.1235387  Vali Loss: 0.1338333 Vali Accuracy: 0.9531873  Vali weighted F1: 0.9526070  Vali macro F1 0.9296790 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 11 cost time: 6.391703367233276
VALI: Epoch: 11, Steps: 71 | Train Loss: 0.1076445  Vali Loss: 0.1150118 Vali Accuracy: 0.9571713  Vali weighted F1: 0.9564488  Vali macro F1 0.9383139 
new best score!!!!
Validation loss decreased (0.133342 --> 0.115012).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.3928399085998535
VALI: Epoch: 12, Steps: 71 | Train Loss: 0.1040542  Vali Loss: 0.1120196 Vali Accuracy: 0.9656375  Vali weighted F1: 0.9657168  Vali macro F1 0.9504612 
new best score!!!!
Validation loss decreased (0.115012 --> 0.112020).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.394371509552002
VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0947741  Vali Loss: 0.1107428 Vali Accuracy: 0.9601594  Vali weighted F1: 0.9594922  Vali macro F1 0.9459596 
new best score!!!!
Validation loss decreased (0.112020 --> 0.110743).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.397947788238525
VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0865282  Vali Loss: 0.1004249 Vali Accuracy: 0.9711155  Vali weighted F1: 0.9712698  Vali macro F1 0.9609113 
new best score!!!!
Validation loss decreased (0.110743 --> 0.100425).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.404095888137817
VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0791423  Vali Loss: 0.2495593 Vali Accuracy: 0.9213147  Vali weighted F1: 0.9199412  Vali macro F1 0.8981012 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.382634401321411
VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0945053  Vali Loss: 0.0885581 Vali Accuracy: 0.9741036  Vali weighted F1: 0.9743180  Vali macro F1 0.9630735 
new best score!!!!
Validation loss decreased (0.100425 --> 0.088558).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.411455154418945
VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0650280  Vali Loss: 0.0784866 Vali Accuracy: 0.9750996  Vali weighted F1: 0.9752578  Vali macro F1 0.9629824 
new best score!!!!
Validation loss decreased (0.088558 --> 0.078487).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.383231163024902
VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0597181  Vali Loss: 0.0789824 Vali Accuracy: 0.9775896  Vali weighted F1: 0.9776637  Vali macro F1 0.9681342 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 6.403289556503296
VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0639228  Vali Loss: 0.0958695 Vali Accuracy: 0.9691235  Vali weighted F1: 0.9684271  Vali macro F1 0.9584144 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 6.404153108596802
VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0538932  Vali Loss: 0.0846494 Vali Accuracy: 0.9741036  Vali weighted F1: 0.9738312  Vali macro F1 0.9654089 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 21 cost time: 6.399498224258423
VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0574106  Vali Loss: 0.1354952 Vali Accuracy: 0.9576693  Vali weighted F1: 0.9573257  Vali macro F1 0.9459462 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 22 cost time: 6.389641523361206
VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0567480  Vali Loss: 0.0803539 Vali Accuracy: 0.9755976  Vali weighted F1: 0.9755793  Vali macro F1 0.9657400 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 23 cost time: 6.387941122055054
VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0361257  Vali Loss: 0.0711740 Vali Accuracy: 0.9795817  Vali weighted F1: 0.9796339  Vali macro F1 0.9710416 
new best score!!!!
Validation loss decreased (0.078487 --> 0.071174).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.392321586608887
VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0324053  Vali Loss: 0.0705086 Vali Accuracy: 0.9805777  Vali weighted F1: 0.9806306  Vali macro F1 0.9720286 
new best score!!!!
Validation loss decreased (0.071174 --> 0.070509).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.388178586959839
VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0307866  Vali Loss: 0.0702466 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9810898  Vali macro F1 0.9724617 
new best score!!!!
Validation loss decreased (0.070509 --> 0.070247).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.406890153884888
VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0313292  Vali Loss: 0.0710849 Vali Accuracy: 0.9800797  Vali weighted F1: 0.9800999  Vali macro F1 0.9713176 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 6.399233341217041
VALI: Epoch: 27, Steps: 71 | Train Loss: 0.0296496  Vali Loss: 0.0733943 Vali Accuracy: 0.9805777  Vali weighted F1: 0.9805657  Vali macro F1 0.9715878 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 6.413889408111572
VALI: Epoch: 28, Steps: 71 | Train Loss: 0.0297447  Vali Loss: 0.0711665 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9816302  Vali macro F1 0.9724862 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 29 cost time: 6.395442724227905
VALI: Epoch: 29, Steps: 71 | Train Loss: 0.0289378  Vali Loss: 0.0710806 Vali Accuracy: 0.9800797  Vali weighted F1: 0.9800913  Vali macro F1 0.9709794 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 30 cost time: 6.397916078567505
VALI: Epoch: 30, Steps: 71 | Train Loss: 0.0267131  Vali Loss: 0.0710581 Vali Accuracy: 0.9800797  Vali weighted F1: 0.9800913  Vali macro F1 0.9709794 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 31 cost time: 6.401303052902222
VALI: Epoch: 31, Steps: 71 | Train Loss: 0.0257624  Vali Loss: 0.0705516 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9811421  Vali macro F1 0.9720485 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 6.395458698272705
VALI: Epoch: 32, Steps: 71 | Train Loss: 0.0257704  Vali Loss: 0.0709372 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9811421  Vali macro F1 0.9720485 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 6.395512580871582
VALI: Epoch: 33, Steps: 71 | Train Loss: 0.0255414  Vali Loss: 0.0703856 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9811421  Vali macro F1 0.9720485 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 34 cost time: 6.395936012268066
VALI: Epoch: 34, Steps: 71 | Train Loss: 0.0246135  Vali Loss: 0.0703943 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9811421  Vali macro F1 0.9720485 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 35 cost time: 6.411054611206055
VALI: Epoch: 35, Steps: 71 | Train Loss: 0.0250958  Vali Loss: 0.0703078 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9811421  Vali macro F1 0.9720485 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 36 cost time: 6.411652088165283
VALI: Epoch: 36, Steps: 71 | Train Loss: 0.0249609  Vali Loss: 0.0702986 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9811421  Vali macro F1 0.9720485 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 6.402981281280518
VALI: Epoch: 37, Steps: 71 | Train Loss: 0.0255176  Vali Loss: 0.0703005 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9811421  Vali macro F1 0.9720485 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 6.397182941436768
VALI: Epoch: 38, Steps: 71 | Train Loss: 0.0252512  Vali Loss: 0.0703257 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9811421  Vali macro F1 0.9720485 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 6.419718027114868
VALI: Epoch: 39, Steps: 71 | Train Loss: 0.0248143  Vali Loss: 0.0703324 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9811421  Vali macro F1 0.9720485 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 40 cost time: 6.401454210281372
VALI: Epoch: 40, Steps: 71 | Train Loss: 0.0251025  Vali Loss: 0.0702957 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9811421  Vali macro F1 0.9720485 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9296165  Test weighted F1: 0.9299872  Test macro F1 0.8947583 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 240495
pruned model Parameter : 244174
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.404056072235107
Fine Tuning VALI: Epoch: 1, Steps: 71 | Train Loss: 0.0312154  Vali Loss: 0.0723367 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9815813  Vali macro F1 0.9728135 
Validation loss decreased (inf --> 0.072337).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.374282121658325
Fine Tuning VALI: Epoch: 2, Steps: 71 | Train Loss: 0.0295198  Vali Loss: 0.0715941 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9811666  Vali macro F1 0.9720856 
new best score!!!!
Validation loss decreased (0.072337 --> 0.071594).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.3870391845703125
Fine Tuning VALI: Epoch: 3, Steps: 71 | Train Loss: 0.0291630  Vali Loss: 0.0745928 Vali Accuracy: 0.9790837  Vali weighted F1: 0.9792253  Vali macro F1 0.9704096 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 6.386950492858887
Fine Tuning VALI: Epoch: 4, Steps: 71 | Train Loss: 0.0273907  Vali Loss: 0.0698692 Vali Accuracy: 0.9805777  Vali weighted F1: 0.9806609  Vali macro F1 0.9714715 
new best score!!!!
Validation loss decreased (0.071594 --> 0.069869).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 6.400471925735474
Fine Tuning VALI: Epoch: 5, Steps: 71 | Train Loss: 0.0264561  Vali Loss: 0.0730532 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9826452  Vali macro F1 0.9740576 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 6.388044595718384
Fine Tuning VALI: Epoch: 6, Steps: 71 | Train Loss: 0.0242375  Vali Loss: 0.0734033 Vali Accuracy: 0.9810757  Vali weighted F1: 0.9811411  Vali macro F1 0.9716697 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 7 cost time: 6.395741701126099
Fine Tuning VALI: Epoch: 7, Steps: 71 | Train Loss: 0.0250973  Vali Loss: 0.0684946 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9821623  Vali macro F1 0.9726651 
new best score!!!!
Validation loss decreased (0.069869 --> 0.068495).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 6.391389846801758
Fine Tuning VALI: Epoch: 8, Steps: 71 | Train Loss: 0.0238557  Vali Loss: 0.0701897 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9826298  Vali macro F1 0.9734766 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 6.382950305938721
Fine Tuning VALI: Epoch: 9, Steps: 71 | Train Loss: 0.0237483  Vali Loss: 0.0716920 Vali Accuracy: 0.9800797  Vali weighted F1: 0.9801104  Vali macro F1 0.9706839 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 6.379584789276123
Fine Tuning VALI: Epoch: 10, Steps: 71 | Train Loss: 0.0243024  Vali Loss: 0.0700482 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9826302  Vali macro F1 0.9743262 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 6.376066446304321
Fine Tuning VALI: Epoch: 11, Steps: 71 | Train Loss: 0.0226343  Vali Loss: 0.0707622 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9826482  Vali macro F1 0.9739856 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 6.373758554458618
Fine Tuning VALI: Epoch: 12, Steps: 71 | Train Loss: 0.0229109  Vali Loss: 0.0728508 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9821426  Vali macro F1 0.9729988 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 13 cost time: 6.40323805809021
Fine Tuning VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0215715  Vali Loss: 0.0744566 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9821591  Vali macro F1 0.9737251 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 6.409946918487549
Fine Tuning VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0222309  Vali Loss: 0.0740367 Vali Accuracy: 0.9805777  Vali weighted F1: 0.9807258  Vali macro F1 0.9718363 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 6.38259220123291
Fine Tuning VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0213786  Vali Loss: 0.0710783 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9821377  Vali macro F1 0.9735148 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 6.388607978820801
Fine Tuning VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0214535  Vali Loss: 0.0721107 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9821814  Vali macro F1 0.9736235 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 6.385913133621216
Fine Tuning VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0197251  Vali Loss: 0.0720783 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9815638  Vali macro F1 0.9731379 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 18 cost time: 6.380864143371582
Fine Tuning VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0185729  Vali Loss: 0.0701511 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9821558  Vali macro F1 0.9730440 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 6.391353607177734
Fine Tuning VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0172502  Vali Loss: 0.0700928 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9816692  Vali macro F1 0.9726088 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 6.397263526916504
Fine Tuning VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0172476  Vali Loss: 0.0696791 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9826539  Vali macro F1 0.9738785 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 6.4140307903289795
Fine Tuning VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0171265  Vali Loss: 0.0701875 Vali Accuracy: 0.9825697  Vali weighted F1: 0.9826539  Vali macro F1 0.9738785 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 6.393810033798218
Fine Tuning VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0175085  Vali Loss: 0.0701003 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9821355  Vali macro F1 0.9735872 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9315008  Test weighted F1: 0.9317086  Test macro F1 0.8985280 
Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 240495
Set the seed as :  5
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
-----------------------Sliding file are generated -----------------------
================ LOCV Mode ====================
================ 10 CV ======================
================ the 0 th CV Experiment ================ 
Leave one Out Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.00014613 0.00018073 0.00098135 0.00123762 0.00048216 0.00061576]
Train data number :  17901
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1989
Test data number :  9947
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.403236389160156
VALI: Epoch: 1, Steps: 70 | Train Loss: 0.9969566  Vali Loss: 0.5431512 Vali Accuracy: 0.8044243  Vali weighted F1: 0.7732714  Vali macro F1 0.6986807 
Validation loss decreased (inf --> 0.543151).  Saving model ...
Epoch: 2 cost time: 6.372324228286743
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.4579631  Vali Loss: 0.3431145 Vali Accuracy: 0.8813474  Vali weighted F1: 0.8739388  Vali macro F1 0.8469028 
new best score!!!!
Validation loss decreased (0.543151 --> 0.343114).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.375601291656494
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.3112279  Vali Loss: 0.2261744 Vali Accuracy: 0.9291101  Vali weighted F1: 0.9281376  Vali macro F1 0.9092458 
new best score!!!!
Validation loss decreased (0.343114 --> 0.226174).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.372304677963257
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.2323859  Vali Loss: 0.1965390 Vali Accuracy: 0.9311212  Vali weighted F1: 0.9279488  Vali macro F1 0.9028303 
new best score!!!!
Validation loss decreased (0.226174 --> 0.196539).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.395901679992676
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.1975167  Vali Loss: 0.1528281 Vali Accuracy: 0.9467069  Vali weighted F1: 0.9458668  Vali macro F1 0.9289355 
new best score!!!!
Validation loss decreased (0.196539 --> 0.152828).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.3857386112213135
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.1754456  Vali Loss: 0.1331616 Vali Accuracy: 0.9552539  Vali weighted F1: 0.9545944  Vali macro F1 0.9362024 
new best score!!!!
Validation loss decreased (0.152828 --> 0.133162).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.391666412353516
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.1435293  Vali Loss: 0.1371762 Vali Accuracy: 0.9532428  Vali weighted F1: 0.9524308  Vali macro F1 0.9323106 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 8 cost time: 6.397033214569092
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1265189  Vali Loss: 0.1130538 Vali Accuracy: 0.9582705  Vali weighted F1: 0.9581148  Vali macro F1 0.9426941 
new best score!!!!
Validation loss decreased (0.133162 --> 0.113054).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.412202835083008
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1160066  Vali Loss: 0.1194079 Vali Accuracy: 0.9587733  Vali weighted F1: 0.9586811  Vali macro F1 0.9466694 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 6.3828208446502686
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1060002  Vali Loss: 0.1284089 Vali Accuracy: 0.9582705  Vali weighted F1: 0.9579465  Vali macro F1 0.9492611 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 11 cost time: 6.3841023445129395
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1005971  Vali Loss: 0.0827987 Vali Accuracy: 0.9703369  Vali weighted F1: 0.9699718  Vali macro F1 0.9620168 
new best score!!!!
Validation loss decreased (0.113054 --> 0.082799).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.382146835327148
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0908254  Vali Loss: 0.0701339 Vali Accuracy: 0.9753645  Vali weighted F1: 0.9753065  Vali macro F1 0.9687290 
new best score!!!!
Validation loss decreased (0.082799 --> 0.070134).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.391130447387695
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0740865  Vali Loss: 0.0752447 Vali Accuracy: 0.9763700  Vali weighted F1: 0.9762118  Vali macro F1 0.9693441 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 6.3904852867126465
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0706331  Vali Loss: 0.0770333 Vali Accuracy: 0.9728507  Vali weighted F1: 0.9725550  Vali macro F1 0.9663999 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 15 cost time: 6.392875671386719
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0649647  Vali Loss: 0.0749000 Vali Accuracy: 0.9718451  Vali weighted F1: 0.9713000  Vali macro F1 0.9641912 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 16 cost time: 6.383759260177612
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0665487  Vali Loss: 0.0840204 Vali Accuracy: 0.9703369  Vali weighted F1: 0.9703123  Vali macro F1 0.9621753 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 17 cost time: 6.406814098358154
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0619303  Vali Loss: 0.0763105 Vali Accuracy: 0.9703369  Vali weighted F1: 0.9702869  Vali macro F1 0.9618791 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 18 cost time: 6.406780242919922
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0445561  Vali Loss: 0.0496164 Vali Accuracy: 0.9864253  Vali weighted F1: 0.9864235  Vali macro F1 0.9817854 
new best score!!!!
Validation loss decreased (0.070134 --> 0.049616).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.4063169956207275
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0406529  Vali Loss: 0.0515460 Vali Accuracy: 0.9829060  Vali weighted F1: 0.9828770  Vali macro F1 0.9779127 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 6.3850483894348145
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0386278  Vali Loss: 0.0516178 Vali Accuracy: 0.9829060  Vali weighted F1: 0.9828206  Vali macro F1 0.9778128 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 6.395104646682739
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0375377  Vali Loss: 0.0506859 Vali Accuracy: 0.9834087  Vali weighted F1: 0.9833029  Vali macro F1 0.9785626 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 22 cost time: 6.3973448276519775
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0362575  Vali Loss: 0.0503554 Vali Accuracy: 0.9839115  Vali weighted F1: 0.9838404  Vali macro F1 0.9794159 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 23 cost time: 6.398664236068726
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0354655  Vali Loss: 0.0492863 Vali Accuracy: 0.9834087  Vali weighted F1: 0.9833278  Vali macro F1 0.9782514 
new best score!!!!
Validation loss decreased (0.049616 --> 0.049286).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.388011932373047
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0347573  Vali Loss: 0.0486056 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9848237  Vali macro F1 0.9803080 
new best score!!!!
Validation loss decreased (0.049286 --> 0.048606).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.392844915390015
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0341601  Vali Loss: 0.0492482 Vali Accuracy: 0.9829060  Vali weighted F1: 0.9828466  Vali macro F1 0.9775563 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 6.419010877609253
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0322109  Vali Loss: 0.0480346 Vali Accuracy: 0.9839115  Vali weighted F1: 0.9838304  Vali macro F1 0.9785157 
new best score!!!!
Validation loss decreased (0.048606 --> 0.048035).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.409891843795776
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0325495  Vali Loss: 0.0493097 Vali Accuracy: 0.9839115  Vali weighted F1: 0.9838075  Vali macro F1 0.9787449 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.410599708557129
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0339126  Vali Loss: 0.0481931 Vali Accuracy: 0.9839115  Vali weighted F1: 0.9838316  Vali macro F1 0.9799356 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 6.39530873298645
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0307523  Vali Loss: 0.0480011 Vali Accuracy: 0.9834087  Vali weighted F1: 0.9833385  Vali macro F1 0.9780148 
new best score!!!!
Validation loss decreased (0.048035 --> 0.048001).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.393008708953857
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0308587  Vali Loss: 0.0482156 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9848429  Vali macro F1 0.9803690 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 6.388427495956421
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0304382  Vali Loss: 0.0494600 Vali Accuracy: 0.9829060  Vali weighted F1: 0.9828573  Vali macro F1 0.9767187 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 6.390962362289429
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0295269  Vali Loss: 0.0506266 Vali Accuracy: 0.9834087  Vali weighted F1: 0.9833117  Vali macro F1 0.9779724 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 6.392158508300781
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0295856  Vali Loss: 0.0504943 Vali Accuracy: 0.9834087  Vali weighted F1: 0.9833346  Vali macro F1 0.9777428 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 34 cost time: 6.390395402908325
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0290098  Vali Loss: 0.0480474 Vali Accuracy: 0.9864253  Vali weighted F1: 0.9863464  Vali macro F1 0.9830128 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 35 cost time: 6.414713382720947
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0279513  Vali Loss: 0.0477039 Vali Accuracy: 0.9829060  Vali weighted F1: 0.9828189  Vali macro F1 0.9775123 
new best score!!!!
Validation loss decreased (0.048001 --> 0.047704).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.393476963043213
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0265889  Vali Loss: 0.0471249 Vali Accuracy: 0.9844143  Vali weighted F1: 0.9843445  Vali macro F1 0.9795971 
new best score!!!!
Validation loss decreased (0.047704 --> 0.047125).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.409127473831177
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0259331  Vali Loss: 0.0485683 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9848175  Vali macro F1 0.9803020 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 6.388809680938721
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0261897  Vali Loss: 0.0473521 Vali Accuracy: 0.9844143  Vali weighted F1: 0.9843323  Vali macro F1 0.9798462 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 6.389451503753662
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0261798  Vali Loss: 0.0475891 Vali Accuracy: 0.9854198  Vali weighted F1: 0.9853222  Vali macro F1 0.9810798 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 40 cost time: 6.39806866645813
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0274165  Vali Loss: 0.0473267 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9858335  Vali macro F1 0.9818644 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 41 cost time: 6.395673513412476
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0254651  Vali Loss: 0.0470854 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9858335  Vali macro F1 0.9818644 
new best score!!!!
Validation loss decreased (0.047125 --> 0.047085).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 6.39989972114563
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0265669  Vali Loss: 0.0476029 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9848398  Vali macro F1 0.9800726 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 6.398606777191162
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0266054  Vali Loss: 0.0470984 Vali Accuracy: 0.9854198  Vali weighted F1: 0.9853400  Vali macro F1 0.9813994 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 6.420258522033691
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0262942  Vali Loss: 0.0465927 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9848237  Vali macro F1 0.9803080 
new best score!!!!
Validation loss decreased (0.047085 --> 0.046593).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 6.42296576499939
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0249678  Vali Loss: 0.0470107 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9858335  Vali macro F1 0.9818644 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 6.402755260467529
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0257897  Vali Loss: 0.0466859 Vali Accuracy: 0.9854198  Vali weighted F1: 0.9853287  Vali macro F1 0.9810864 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 6.403343677520752
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0262869  Vali Loss: 0.0477511 Vali Accuracy: 0.9854198  Vali weighted F1: 0.9853287  Vali macro F1 0.9810864 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 6.402938365936279
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0258609  Vali Loss: 0.0467303 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9848363  Vali macro F1 0.9806231 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 6.4068450927734375
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0269204  Vali Loss: 0.0469405 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9858399  Vali macro F1 0.9818710 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 50 cost time: 6.39560079574585
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0251959  Vali Loss: 0.0469521 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9858399  Vali macro F1 0.9818710 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 6.39943528175354
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0263747  Vali Loss: 0.0468841 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9858399  Vali macro F1 0.9818710 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 6.400683403015137
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0251927  Vali Loss: 0.0468806 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9858399  Vali macro F1 0.9818710 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 53 cost time: 6.415893316268921
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0253970  Vali Loss: 0.0469099 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9858399  Vali macro F1 0.9818710 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 54 cost time: 6.409971475601196
VALI: Epoch: 54, Steps: 70 | Train Loss: 0.0261502  Vali Loss: 0.0469281 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9858399  Vali macro F1 0.9818710 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 55 cost time: 6.426394701004028
VALI: Epoch: 55, Steps: 70 | Train Loss: 0.0249857  Vali Loss: 0.0469431 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9858399  Vali macro F1 0.9818710 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 6.409029722213745
VALI: Epoch: 56, Steps: 70 | Train Loss: 0.0245405  Vali Loss: 0.0469600 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9858399  Vali macro F1 0.9818710 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 57 cost time: 6.402151584625244
VALI: Epoch: 57, Steps: 70 | Train Loss: 0.0269254  Vali Loss: 0.0469566 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9858399  Vali macro F1 0.9818710 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 58 cost time: 6.395174264907837
VALI: Epoch: 58, Steps: 70 | Train Loss: 0.0252926  Vali Loss: 0.0469304 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9858399  Vali macro F1 0.9818710 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 59 cost time: 6.397459983825684
VALI: Epoch: 59, Steps: 70 | Train Loss: 0.0257188  Vali Loss: 0.0469446 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9858399  Vali macro F1 0.9818710 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8461848  Test weighted F1: 0.8509835  Test macro F1 0.7699044 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 240495
pruned model Parameter : 244174
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.399774789810181
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0285400  Vali Loss: 0.0462430 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9858269  Vali macro F1 0.9818647 
Validation loss decreased (inf --> 0.046243).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.364553451538086
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0282053  Vali Loss: 0.0499126 Vali Accuracy: 0.9834087  Vali weighted F1: 0.9833117  Vali macro F1 0.9779724 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.392123222351074
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0268636  Vali Loss: 0.0471257 Vali Accuracy: 0.9859226  Vali weighted F1: 0.9858640  Vali macro F1 0.9813948 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.362539768218994
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0251894  Vali Loss: 0.0463169 Vali Accuracy: 0.9844143  Vali weighted F1: 0.9843700  Vali macro F1 0.9790540 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.39654541015625
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0258505  Vali Loss: 0.0461691 Vali Accuracy: 0.9854198  Vali weighted F1: 0.9853340  Vali macro F1 0.9813853 
new best score!!!!
Validation loss decreased (0.046243 --> 0.046169).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 6.383217096328735
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0245936  Vali Loss: 0.0488289 Vali Accuracy: 0.9834087  Vali weighted F1: 0.9834308  Vali macro F1 0.9775954 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.380039215087891
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0274877  Vali Loss: 0.0484106 Vali Accuracy: 0.9844143  Vali weighted F1: 0.9844011  Vali macro F1 0.9797219 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.388272047042847
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0238950  Vali Loss: 0.0488610 Vali Accuracy: 0.9839115  Vali weighted F1: 0.9838351  Vali macro F1 0.9799030 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.3910746574401855
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0237420  Vali Loss: 0.0486935 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9848153  Vali macro F1 0.9806647 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.388666152954102
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0239626  Vali Loss: 0.0505266 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9848571  Vali macro F1 0.9809880 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 11 cost time: 6.383310556411743
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0219062  Vali Loss: 0.0509300 Vali Accuracy: 0.9844143  Vali weighted F1: 0.9843367  Vali macro F1 0.9807064 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.390048503875732
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0215758  Vali Loss: 0.0524316 Vali Accuracy: 0.9834087  Vali weighted F1: 0.9833085  Vali macro F1 0.9782584 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.392549514770508
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0195868  Vali Loss: 0.0475251 Vali Accuracy: 0.9854198  Vali weighted F1: 0.9853400  Vali macro F1 0.9813994 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.417591571807861
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0205059  Vali Loss: 0.0485646 Vali Accuracy: 0.9849170  Vali weighted F1: 0.9848860  Vali macro F1 0.9801352 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.37597131729126
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0204716  Vali Loss: 0.0528328 Vali Accuracy: 0.9834087  Vali weighted F1: 0.9834002  Vali macro F1 0.9780936 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 16 cost time: 6.380127429962158
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0199392  Vali Loss: 0.0484360 Vali Accuracy: 0.9869281  Vali weighted F1: 0.9868434  Vali macro F1 0.9834548 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 6.38521146774292
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0184207  Vali Loss: 0.0471393 Vali Accuracy: 0.9854198  Vali weighted F1: 0.9853553  Vali macro F1 0.9811366 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 6.379316568374634
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0180363  Vali Loss: 0.0468720 Vali Accuracy: 0.9864253  Vali weighted F1: 0.9863473  Vali macro F1 0.9829167 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 6.384866952896118
Fine Tuning VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0184583  Vali Loss: 0.0471613 Vali Accuracy: 0.9864253  Vali weighted F1: 0.9863520  Vali macro F1 0.9824037 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 6.388768672943115
Fine Tuning VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0190992  Vali Loss: 0.0465529 Vali Accuracy: 0.9864253  Vali weighted F1: 0.9863734  Vali macro F1 0.9824383 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8512114  Test weighted F1: 0.8538112  Test macro F1 0.7983387 
================ the 1 th CV Experiment ================ 
Leave one Out Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00015004 0.00018238 0.0010989  0.00140056 0.00050813 0.00061996]
Train data number :  17353
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1929
Test data number :  12988
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.198731899261475
VALI: Epoch: 1, Steps: 68 | Train Loss: 1.0271553  Vali Loss: 0.5843571 Vali Accuracy: 0.7719025  Vali weighted F1: 0.7094971  Vali macro F1 0.4978143 
Validation loss decreased (inf --> 0.584357).  Saving model ...
Epoch: 2 cost time: 6.1999430656433105
VALI: Epoch: 2, Steps: 68 | Train Loss: 0.4620842  Vali Loss: 0.3516078 Vali Accuracy: 0.8812856  Vali weighted F1: 0.8720777  Vali macro F1 0.8304350 
new best score!!!!
Validation loss decreased (0.584357 --> 0.351608).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.185446500778198
VALI: Epoch: 3, Steps: 68 | Train Loss: 0.3212882  Vali Loss: 0.2668221 Vali Accuracy: 0.9113530  Vali weighted F1: 0.9096775  Vali macro F1 0.8853354 
new best score!!!!
Validation loss decreased (0.351608 --> 0.266822).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.182034015655518
VALI: Epoch: 4, Steps: 68 | Train Loss: 0.2292707  Vali Loss: 0.1977913 Vali Accuracy: 0.9362364  Vali weighted F1: 0.9338024  Vali macro F1 0.9077725 
new best score!!!!
Validation loss decreased (0.266822 --> 0.197791).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.178369998931885
VALI: Epoch: 5, Steps: 68 | Train Loss: 0.1885535  Vali Loss: 0.1792499 Vali Accuracy: 0.9455677  Vali weighted F1: 0.9432598  Vali macro F1 0.9227806 
new best score!!!!
Validation loss decreased (0.197791 --> 0.179250).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.181256532669067
VALI: Epoch: 6, Steps: 68 | Train Loss: 0.1619638  Vali Loss: 0.1776082 Vali Accuracy: 0.9409020  Vali weighted F1: 0.9382373  Vali macro F1 0.9144873 
new best score!!!!
Validation loss decreased (0.179250 --> 0.177608).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.1819539070129395
VALI: Epoch: 7, Steps: 68 | Train Loss: 0.1385775  Vali Loss: 0.1296568 Vali Accuracy: 0.9564541  Vali weighted F1: 0.9567766  Vali macro F1 0.9398632 
new best score!!!!
Validation loss decreased (0.177608 --> 0.129657).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.185351371765137
VALI: Epoch: 8, Steps: 68 | Train Loss: 0.1328805  Vali Loss: 0.1181725 Vali Accuracy: 0.9621566  Vali weighted F1: 0.9624221  Vali macro F1 0.9467796 
new best score!!!!
Validation loss decreased (0.129657 --> 0.118173).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.184589147567749
VALI: Epoch: 9, Steps: 68 | Train Loss: 0.1259505  Vali Loss: 0.1079295 Vali Accuracy: 0.9616382  Vali weighted F1: 0.9614140  Vali macro F1 0.9462865 
new best score!!!!
Validation loss decreased (0.118173 --> 0.107930).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.1988701820373535
VALI: Epoch: 10, Steps: 68 | Train Loss: 0.1060861  Vali Loss: 0.0953670 Vali Accuracy: 0.9657854  Vali weighted F1: 0.9655835  Vali macro F1 0.9503820 
new best score!!!!
Validation loss decreased (0.107930 --> 0.095367).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.216143846511841
VALI: Epoch: 11, Steps: 68 | Train Loss: 0.0971085  Vali Loss: 0.0891065 Vali Accuracy: 0.9725246  Vali weighted F1: 0.9721618  Vali macro F1 0.9621117 
new best score!!!!
Validation loss decreased (0.095367 --> 0.089107).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.189610719680786
VALI: Epoch: 12, Steps: 68 | Train Loss: 0.0844439  Vali Loss: 0.0906856 Vali Accuracy: 0.9694142  Vali weighted F1: 0.9690147  Vali macro F1 0.9586429 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 6.169034242630005
VALI: Epoch: 13, Steps: 68 | Train Loss: 0.0797554  Vali Loss: 0.0906518 Vali Accuracy: 0.9657854  Vali weighted F1: 0.9663219  Vali macro F1 0.9527235 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 14 cost time: 6.177120685577393
VALI: Epoch: 14, Steps: 68 | Train Loss: 0.0726286  Vali Loss: 0.0683384 Vali Accuracy: 0.9756350  Vali weighted F1: 0.9757154  Vali macro F1 0.9657158 
new best score!!!!
Validation loss decreased (0.089107 --> 0.068338).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.167742013931274
VALI: Epoch: 15, Steps: 68 | Train Loss: 0.0611033  Vali Loss: 0.0680961 Vali Accuracy: 0.9766719  Vali weighted F1: 0.9766080  Vali macro F1 0.9655781 
new best score!!!!
Validation loss decreased (0.068338 --> 0.068096).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.183629274368286
VALI: Epoch: 16, Steps: 68 | Train Loss: 0.0693566  Vali Loss: 0.0621636 Vali Accuracy: 0.9797823  Vali weighted F1: 0.9797732  Vali macro F1 0.9711737 
new best score!!!!
Validation loss decreased (0.068096 --> 0.062164).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.186046361923218
VALI: Epoch: 17, Steps: 68 | Train Loss: 0.0565282  Vali Loss: 0.0598427 Vali Accuracy: 0.9792639  Vali weighted F1: 0.9792457  Vali macro F1 0.9696578 
new best score!!!!
Validation loss decreased (0.062164 --> 0.059843).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.175217390060425
VALI: Epoch: 18, Steps: 68 | Train Loss: 0.0487645  Vali Loss: 0.0554074 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9837915  Vali macro F1 0.9759331 
new best score!!!!
Validation loss decreased (0.059843 --> 0.055407).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.199765205383301
VALI: Epoch: 19, Steps: 68 | Train Loss: 0.0529390  Vali Loss: 0.0759606 Vali Accuracy: 0.9797823  Vali weighted F1: 0.9795414  Vali macro F1 0.9711644 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 6.177448034286499
VALI: Epoch: 20, Steps: 68 | Train Loss: 0.0430671  Vali Loss: 0.0545924 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9838711  Vali macro F1 0.9776942 
new best score!!!!
Validation loss decreased (0.055407 --> 0.054592).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.193392038345337
VALI: Epoch: 21, Steps: 68 | Train Loss: 0.0387157  Vali Loss: 0.0479775 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9839771  Vali macro F1 0.9760360 
new best score!!!!
Validation loss decreased (0.054592 --> 0.047978).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.178380966186523
VALI: Epoch: 22, Steps: 68 | Train Loss: 0.0473626  Vali Loss: 0.0615832 Vali Accuracy: 0.9797823  Vali weighted F1: 0.9795233  Vali macro F1 0.9721199 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.177877426147461
VALI: Epoch: 23, Steps: 68 | Train Loss: 0.0393322  Vali Loss: 0.0557549 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9828745  Vali macro F1 0.9750943 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 6.187898635864258
VALI: Epoch: 24, Steps: 68 | Train Loss: 0.0352297  Vali Loss: 0.0660600 Vali Accuracy: 0.9787455  Vali weighted F1: 0.9786667  Vali macro F1 0.9690992 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 25 cost time: 6.173916578292847
VALI: Epoch: 25, Steps: 68 | Train Loss: 0.0319368  Vali Loss: 0.0513411 Vali Accuracy: 0.9839295  Vali weighted F1: 0.9840287  Vali macro F1 0.9755639 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 26 cost time: 6.178476095199585
VALI: Epoch: 26, Steps: 68 | Train Loss: 0.0292299  Vali Loss: 0.0505066 Vali Accuracy: 0.9828927  Vali weighted F1: 0.9828104  Vali macro F1 0.9756008 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 27 cost time: 6.181384325027466
VALI: Epoch: 27, Steps: 68 | Train Loss: 0.0193832  Vali Loss: 0.0405943 Vali Accuracy: 0.9891135  Vali weighted F1: 0.9891270  Vali macro F1 0.9847405 
new best score!!!!
Validation loss decreased (0.047978 --> 0.040594).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.193695545196533
VALI: Epoch: 28, Steps: 68 | Train Loss: 0.0168822  Vali Loss: 0.0384614 Vali Accuracy: 0.9896319  Vali weighted F1: 0.9896394  Vali macro F1 0.9846165 
new best score!!!!
Validation loss decreased (0.040594 --> 0.038461).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.199389696121216
VALI: Epoch: 29, Steps: 68 | Train Loss: 0.0161281  Vali Loss: 0.0413122 Vali Accuracy: 0.9891135  Vali weighted F1: 0.9890844  Vali macro F1 0.9844527 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 6.213690757751465
VALI: Epoch: 30, Steps: 68 | Train Loss: 0.0162575  Vali Loss: 0.0394417 Vali Accuracy: 0.9891135  Vali weighted F1: 0.9891122  Vali macro F1 0.9842259 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 6.1965014934539795
VALI: Epoch: 31, Steps: 68 | Train Loss: 0.0153776  Vali Loss: 0.0438994 Vali Accuracy: 0.9885951  Vali weighted F1: 0.9885640  Vali macro F1 0.9836020 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 32 cost time: 6.177050590515137
VALI: Epoch: 32, Steps: 68 | Train Loss: 0.0146520  Vali Loss: 0.0428691 Vali Accuracy: 0.9880767  Vali weighted F1: 0.9880342  Vali macro F1 0.9826319 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 33 cost time: 6.182149410247803
VALI: Epoch: 33, Steps: 68 | Train Loss: 0.0150243  Vali Loss: 0.0414298 Vali Accuracy: 0.9896319  Vali weighted F1: 0.9896257  Vali macro F1 0.9845715 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 34 cost time: 6.178252935409546
VALI: Epoch: 34, Steps: 68 | Train Loss: 0.0144772  Vali Loss: 0.0421008 Vali Accuracy: 0.9896319  Vali weighted F1: 0.9896213  Vali macro F1 0.9847864 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 6.179657459259033
VALI: Epoch: 35, Steps: 68 | Train Loss: 0.0138226  Vali Loss: 0.0423890 Vali Accuracy: 0.9901503  Vali weighted F1: 0.9901445  Vali macro F1 0.9854295 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 6.175935983657837
VALI: Epoch: 36, Steps: 68 | Train Loss: 0.0133428  Vali Loss: 0.0423510 Vali Accuracy: 0.9901503  Vali weighted F1: 0.9901445  Vali macro F1 0.9854295 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 6.187161445617676
VALI: Epoch: 37, Steps: 68 | Train Loss: 0.0134142  Vali Loss: 0.0426958 Vali Accuracy: 0.9891135  Vali weighted F1: 0.9891090  Vali macro F1 0.9837441 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 6.211872577667236
VALI: Epoch: 38, Steps: 68 | Train Loss: 0.0132090  Vali Loss: 0.0425635 Vali Accuracy: 0.9885951  Vali weighted F1: 0.9885915  Vali macro F1 0.9828987 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 39 cost time: 6.211331129074097
VALI: Epoch: 39, Steps: 68 | Train Loss: 0.0141262  Vali Loss: 0.0423690 Vali Accuracy: 0.9891135  Vali weighted F1: 0.9891085  Vali macro F1 0.9837341 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 6.212929725646973
VALI: Epoch: 40, Steps: 68 | Train Loss: 0.0140582  Vali Loss: 0.0423632 Vali Accuracy: 0.9891135  Vali weighted F1: 0.9891085  Vali macro F1 0.9837341 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 6.200149774551392
VALI: Epoch: 41, Steps: 68 | Train Loss: 0.0139522  Vali Loss: 0.0423980 Vali Accuracy: 0.9891135  Vali weighted F1: 0.9891085  Vali macro F1 0.9837341 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 6.20782995223999
VALI: Epoch: 42, Steps: 68 | Train Loss: 0.0143184  Vali Loss: 0.0423381 Vali Accuracy: 0.9891135  Vali weighted F1: 0.9891085  Vali macro F1 0.9837341 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 6.2013654708862305
VALI: Epoch: 43, Steps: 68 | Train Loss: 0.0134937  Vali Loss: 0.0423050 Vali Accuracy: 0.9891135  Vali weighted F1: 0.9891085  Vali macro F1 0.9837341 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9554204  Test weighted F1: 0.9563090  Test macro F1 0.9310861 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 240495
pruned model Parameter : 244174
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.185765027999878
Fine Tuning VALI: Epoch: 1, Steps: 68 | Train Loss: 0.0177291  Vali Loss: 0.0401103 Vali Accuracy: 0.9885951  Vali weighted F1: 0.9885947  Vali macro F1 0.9832760 
Validation loss decreased (inf --> 0.040110).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.151350736618042
Fine Tuning VALI: Epoch: 2, Steps: 68 | Train Loss: 0.0165866  Vali Loss: 0.0417028 Vali Accuracy: 0.9875583  Vali weighted F1: 0.9875186  Vali macro F1 0.9806149 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.152390480041504
Fine Tuning VALI: Epoch: 3, Steps: 68 | Train Loss: 0.0145505  Vali Loss: 0.0453241 Vali Accuracy: 0.9849663  Vali weighted F1: 0.9849508  Vali macro F1 0.9784773 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.176518440246582
Fine Tuning VALI: Epoch: 4, Steps: 68 | Train Loss: 0.0146595  Vali Loss: 0.0443695 Vali Accuracy: 0.9865215  Vali weighted F1: 0.9864850  Vali macro F1 0.9801789 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.189580917358398
Fine Tuning VALI: Epoch: 5, Steps: 68 | Train Loss: 0.0141417  Vali Loss: 0.0421028 Vali Accuracy: 0.9880767  Vali weighted F1: 0.9880569  Vali macro F1 0.9825798 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.179399251937866
Fine Tuning VALI: Epoch: 6, Steps: 68 | Train Loss: 0.0136198  Vali Loss: 0.0441293 Vali Accuracy: 0.9880767  Vali weighted F1: 0.9880320  Vali macro F1 0.9826436 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.170989274978638
Fine Tuning VALI: Epoch: 7, Steps: 68 | Train Loss: 0.0132271  Vali Loss: 0.0507055 Vali Accuracy: 0.9854847  Vali weighted F1: 0.9854883  Vali macro F1 0.9784332 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.170808792114258
Fine Tuning VALI: Epoch: 8, Steps: 68 | Train Loss: 0.0130724  Vali Loss: 0.0436411 Vali Accuracy: 0.9891135  Vali weighted F1: 0.9891085  Vali macro F1 0.9837341 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.1611223220825195
Fine Tuning VALI: Epoch: 9, Steps: 68 | Train Loss: 0.0129806  Vali Loss: 0.0511647 Vali Accuracy: 0.9854847  Vali weighted F1: 0.9854107  Vali macro F1 0.9793518 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.169394016265869
Fine Tuning VALI: Epoch: 10, Steps: 68 | Train Loss: 0.0120286  Vali Loss: 0.0538350 Vali Accuracy: 0.9860031  Vali weighted F1: 0.9860062  Vali macro F1 0.9787752 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 11 cost time: 6.1715288162231445
Fine Tuning VALI: Epoch: 11, Steps: 68 | Train Loss: 0.0131624  Vali Loss: 0.0453589 Vali Accuracy: 0.9885951  Vali weighted F1: 0.9885847  Vali macro F1 0.9824703 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.166061162948608
Fine Tuning VALI: Epoch: 12, Steps: 68 | Train Loss: 0.0109412  Vali Loss: 0.0449726 Vali Accuracy: 0.9865215  Vali weighted F1: 0.9864842  Vali macro F1 0.9803755 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.18903112411499
Fine Tuning VALI: Epoch: 13, Steps: 68 | Train Loss: 0.0105045  Vali Loss: 0.0431404 Vali Accuracy: 0.9891135  Vali weighted F1: 0.9891137  Vali macro F1 0.9829917 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.195497035980225
Fine Tuning VALI: Epoch: 14, Steps: 68 | Train Loss: 0.0115320  Vali Loss: 0.0424508 Vali Accuracy: 0.9885951  Vali weighted F1: 0.9885822  Vali macro F1 0.9824567 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.173393726348877
Fine Tuning VALI: Epoch: 15, Steps: 68 | Train Loss: 0.0108816  Vali Loss: 0.0432855 Vali Accuracy: 0.9875583  Vali weighted F1: 0.9875307  Vali macro F1 0.9813019 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 16 cost time: 6.163892507553101
Fine Tuning VALI: Epoch: 16, Steps: 68 | Train Loss: 0.0108543  Vali Loss: 0.0431652 Vali Accuracy: 0.9880767  Vali weighted F1: 0.9880561  Vali macro F1 0.9825686 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9566523  Test weighted F1: 0.9574192  Test macro F1 0.9328089 
================ the 2 th CV Experiment ================ 
Leave one Out Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.00014912 0.00018123 0.00097087 0.00125    0.00049702 0.00061805]
Train data number :  17684
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1965
Test data number :  11154
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.28365683555603
VALI: Epoch: 1, Steps: 70 | Train Loss: 1.0014633  Vali Loss: 0.5539988 Vali Accuracy: 0.8045802  Vali weighted F1: 0.7585638  Vali macro F1 0.6945779 
Validation loss decreased (inf --> 0.553999).  Saving model ...
Epoch: 2 cost time: 6.2834367752075195
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.4481864  Vali Loss: 0.4095274 Vali Accuracy: 0.8513995  Vali weighted F1: 0.8406466  Vali macro F1 0.7972243 
new best score!!!!
Validation loss decreased (0.553999 --> 0.409527).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.294446229934692
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.3338148  Vali Loss: 0.2859550 Vali Accuracy: 0.8972010  Vali weighted F1: 0.8953969  Vali macro F1 0.8608443 
new best score!!!!
Validation loss decreased (0.409527 --> 0.285955).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.307910919189453
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.2481966  Vali Loss: 0.2253575 Vali Accuracy: 0.9211196  Vali weighted F1: 0.9171767  Vali macro F1 0.8844302 
new best score!!!!
Validation loss decreased (0.285955 --> 0.225358).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.32959771156311
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.1990028  Vali Loss: 0.1715671 Vali Accuracy: 0.9404580  Vali weighted F1: 0.9390691  Vali macro F1 0.9106996 
new best score!!!!
Validation loss decreased (0.225358 --> 0.171567).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.309341669082642
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.1730992  Vali Loss: 0.1797633 Vali Accuracy: 0.9348601  Vali weighted F1: 0.9344395  Vali macro F1 0.9021920 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 7 cost time: 6.296138048171997
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.1455551  Vali Loss: 0.1569824 Vali Accuracy: 0.9450382  Vali weighted F1: 0.9440702  Vali macro F1 0.9257489 
new best score!!!!
Validation loss decreased (0.171567 --> 0.156982).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.29826021194458
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1297315  Vali Loss: 0.1232180 Vali Accuracy: 0.9557252  Vali weighted F1: 0.9550973  Vali macro F1 0.9404084 
new best score!!!!
Validation loss decreased (0.156982 --> 0.123218).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.312481880187988
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1168826  Vali Loss: 0.1243169 Vali Accuracy: 0.9541985  Vali weighted F1: 0.9528477  Vali macro F1 0.9376693 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 6.306117296218872
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1193900  Vali Loss: 0.1572076 Vali Accuracy: 0.9496183  Vali weighted F1: 0.9493348  Vali macro F1 0.9338786 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 11 cost time: 6.308354139328003
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1056462  Vali Loss: 0.1255976 Vali Accuracy: 0.9572519  Vali weighted F1: 0.9562929  Vali macro F1 0.9380908 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 12 cost time: 6.299891233444214
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0994774  Vali Loss: 0.1062516 Vali Accuracy: 0.9628499  Vali weighted F1: 0.9623754  Vali macro F1 0.9496430 
new best score!!!!
Validation loss decreased (0.123218 --> 0.106252).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.333569049835205
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0857605  Vali Loss: 0.1399298 Vali Accuracy: 0.9587786  Vali weighted F1: 0.9569425  Vali macro F1 0.9441134 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 6.318346977233887
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0846293  Vali Loss: 0.0812990 Vali Accuracy: 0.9715013  Vali weighted F1: 0.9711811  Vali macro F1 0.9580501 
new best score!!!!
Validation loss decreased (0.106252 --> 0.081299).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.299448251724243
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0669174  Vali Loss: 0.1034734 Vali Accuracy: 0.9648855  Vali weighted F1: 0.9639966  Vali macro F1 0.9507861 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.302112340927124
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0767923  Vali Loss: 0.0813808 Vali Accuracy: 0.9730280  Vali weighted F1: 0.9725858  Vali macro F1 0.9611431 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 17 cost time: 6.3038976192474365
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0564641  Vali Loss: 0.0761870 Vali Accuracy: 0.9740458  Vali weighted F1: 0.9738959  Vali macro F1 0.9602272 
new best score!!!!
Validation loss decreased (0.081299 --> 0.076187).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 6.2857506275177
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0557222  Vali Loss: 0.0676681 Vali Accuracy: 0.9770992  Vali weighted F1: 0.9769877  Vali macro F1 0.9685899 
new best score!!!!
Validation loss decreased (0.076187 --> 0.067668).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.298115968704224
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0496022  Vali Loss: 0.0745299 Vali Accuracy: 0.9735369  Vali weighted F1: 0.9731091  Vali macro F1 0.9625189 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 6.29524827003479
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0437889  Vali Loss: 0.0760966 Vali Accuracy: 0.9725191  Vali weighted F1: 0.9724735  Vali macro F1 0.9642706 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 6.2995946407318115
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0454475  Vali Loss: 0.0582547 Vali Accuracy: 0.9786260  Vali weighted F1: 0.9783879  Vali macro F1 0.9689045 
new best score!!!!
Validation loss decreased (0.067668 --> 0.058255).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.306020975112915
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0412405  Vali Loss: 0.0737899 Vali Accuracy: 0.9740458  Vali weighted F1: 0.9734723  Vali macro F1 0.9649037 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.295393943786621
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0499162  Vali Loss: 0.0675187 Vali Accuracy: 0.9760814  Vali weighted F1: 0.9760704  Vali macro F1 0.9666205 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 6.294201850891113
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0348891  Vali Loss: 0.0582238 Vali Accuracy: 0.9811705  Vali weighted F1: 0.9810202  Vali macro F1 0.9723493 
new best score!!!!
Validation loss decreased (0.058255 --> 0.058224).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.293323755264282
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0289401  Vali Loss: 0.0550925 Vali Accuracy: 0.9816794  Vali weighted F1: 0.9815395  Vali macro F1 0.9730421 
new best score!!!!
Validation loss decreased (0.058224 --> 0.055093).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.298908472061157
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0341992  Vali Loss: 0.0578635 Vali Accuracy: 0.9816794  Vali weighted F1: 0.9814720  Vali macro F1 0.9735527 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 6.283766269683838
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0306676  Vali Loss: 0.0479698 Vali Accuracy: 0.9816794  Vali weighted F1: 0.9815876  Vali macro F1 0.9705694 
new best score!!!!
Validation loss decreased (0.055093 --> 0.047970).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.29915189743042
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0274806  Vali Loss: 0.0394920 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9877819  Vali macro F1 0.9830804 
new best score!!!!
Validation loss decreased (0.047970 --> 0.039492).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.288380146026611
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0221533  Vali Loss: 0.0435284 Vali Accuracy: 0.9862595  Vali weighted F1: 0.9861672  Vali macro F1 0.9812216 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 6.320846080780029
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0198947  Vali Loss: 0.0507931 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9836447  Vali macro F1 0.9751481 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 6.310986518859863
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0275240  Vali Loss: 0.0456446 Vali Accuracy: 0.9847328  Vali weighted F1: 0.9846071  Vali macro F1 0.9786657 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 32 cost time: 6.299885511398315
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0223206  Vali Loss: 0.0510094 Vali Accuracy: 0.9852417  Vali weighted F1: 0.9851896  Vali macro F1 0.9789333 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 33 cost time: 6.297044992446899
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0183345  Vali Loss: 0.0519703 Vali Accuracy: 0.9837150  Vali weighted F1: 0.9835375  Vali macro F1 0.9775936 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 34 cost time: 6.2922728061676025
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0121371  Vali Loss: 0.0396626 Vali Accuracy: 0.9898219  Vali weighted F1: 0.9897931  Vali macro F1 0.9863506 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 6.290965557098389
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0110844  Vali Loss: 0.0363737 Vali Accuracy: 0.9903308  Vali weighted F1: 0.9903006  Vali macro F1 0.9866008 
new best score!!!!
Validation loss decreased (0.039492 --> 0.036374).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.293623685836792
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0116641  Vali Loss: 0.0363720 Vali Accuracy: 0.9893130  Vali weighted F1: 0.9892854  Vali macro F1 0.9852247 
new best score!!!!
Validation loss decreased (0.036374 --> 0.036372).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 6.298417091369629
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0089256  Vali Loss: 0.0357683 Vali Accuracy: 0.9893130  Vali weighted F1: 0.9892741  Vali macro F1 0.9858867 
new best score!!!!
Validation loss decreased (0.036372 --> 0.035768).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 6.302806615829468
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0084447  Vali Loss: 0.0352352 Vali Accuracy: 0.9913486  Vali weighted F1: 0.9913275  Vali macro F1 0.9879760 
new best score!!!!
Validation loss decreased (0.035768 --> 0.035235).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 6.314723491668701
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0080771  Vali Loss: 0.0353277 Vali Accuracy: 0.9908397  Vali weighted F1: 0.9908097  Vali macro F1 0.9874739 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 6.303007125854492
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0081126  Vali Loss: 0.0370877 Vali Accuracy: 0.9913486  Vali weighted F1: 0.9913083  Vali macro F1 0.9882853 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 6.298763990402222
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0075062  Vali Loss: 0.0361455 Vali Accuracy: 0.9908397  Vali weighted F1: 0.9908167  Vali macro F1 0.9865911 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 6.299015522003174
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0077169  Vali Loss: 0.0378591 Vali Accuracy: 0.9918575  Vali weighted F1: 0.9918356  Vali macro F1 0.9876086 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 6.303595066070557
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0070656  Vali Loss: 0.0397602 Vali Accuracy: 0.9898219  Vali weighted F1: 0.9897804  Vali macro F1 0.9848957 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 44 cost time: 6.312679767608643
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0066193  Vali Loss: 0.0386930 Vali Accuracy: 0.9898219  Vali weighted F1: 0.9897804  Vali macro F1 0.9848957 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 6.309869050979614
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0070105  Vali Loss: 0.0376182 Vali Accuracy: 0.9908397  Vali weighted F1: 0.9908146  Vali macro F1 0.9859382 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 6.292480945587158
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0063137  Vali Loss: 0.0378572 Vali Accuracy: 0.9903308  Vali weighted F1: 0.9903066  Vali macro F1 0.9842130 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 6.322567462921143
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0071174  Vali Loss: 0.0374802 Vali Accuracy: 0.9898219  Vali weighted F1: 0.9897901  Vali macro F1 0.9837127 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 6.310771942138672
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0069056  Vali Loss: 0.0373632 Vali Accuracy: 0.9893130  Vali weighted F1: 0.9892900  Vali macro F1 0.9831990 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 49 cost time: 6.311293363571167
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0072730  Vali Loss: 0.0373280 Vali Accuracy: 0.9893130  Vali weighted F1: 0.9892900  Vali macro F1 0.9831990 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 6.298937797546387
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0068986  Vali Loss: 0.0372386 Vali Accuracy: 0.9893130  Vali weighted F1: 0.9892900  Vali macro F1 0.9831990 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 6.325350284576416
VALI: Epoch: 51, Steps: 70 | Train Loss: 0.0075790  Vali Loss: 0.0372246 Vali Accuracy: 0.9893130  Vali weighted F1: 0.9892900  Vali macro F1 0.9831990 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 6.30835747718811
VALI: Epoch: 52, Steps: 70 | Train Loss: 0.0065618  Vali Loss: 0.0371797 Vali Accuracy: 0.9893130  Vali weighted F1: 0.9892900  Vali macro F1 0.9831990 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 6.294452905654907
VALI: Epoch: 53, Steps: 70 | Train Loss: 0.0067173  Vali Loss: 0.0371200 Vali Accuracy: 0.9893130  Vali weighted F1: 0.9892900  Vali macro F1 0.9831990 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8446297  Test weighted F1: 0.8491500  Test macro F1 0.8181497 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 240495
pruned model Parameter : 244174
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.301609992980957
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0092157  Vali Loss: 0.0366052 Vali Accuracy: 0.9898219  Vali weighted F1: 0.9898015  Vali macro F1 0.9854734 
Validation loss decreased (inf --> 0.036605).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.289919853210449
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0084942  Vali Loss: 0.0412658 Vali Accuracy: 0.9877863  Vali weighted F1: 0.9877620  Vali macro F1 0.9812781 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.2859063148498535
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0075805  Vali Loss: 0.0395526 Vali Accuracy: 0.9898219  Vali weighted F1: 0.9898000  Vali macro F1 0.9848270 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.285531282424927
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0086100  Vali Loss: 0.0417831 Vali Accuracy: 0.9882952  Vali weighted F1: 0.9882296  Vali macro F1 0.9827385 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.295496225357056
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0073724  Vali Loss: 0.0413499 Vali Accuracy: 0.9893130  Vali weighted F1: 0.9892843  Vali macro F1 0.9828562 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.293171167373657
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0066495  Vali Loss: 0.0418056 Vali Accuracy: 0.9893130  Vali weighted F1: 0.9892586  Vali macro F1 0.9835366 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.296749114990234
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0067313  Vali Loss: 0.0381719 Vali Accuracy: 0.9893130  Vali weighted F1: 0.9892939  Vali macro F1 0.9843393 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.289095640182495
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0066620  Vali Loss: 0.0387539 Vali Accuracy: 0.9903308  Vali weighted F1: 0.9902970  Vali macro F1 0.9860210 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.282040357589722
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0060219  Vali Loss: 0.0385944 Vali Accuracy: 0.9898219  Vali weighted F1: 0.9897761  Vali macro F1 0.9849330 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.281527042388916
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0060232  Vali Loss: 0.0379133 Vali Accuracy: 0.9898219  Vali weighted F1: 0.9897726  Vali macro F1 0.9861068 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 11 cost time: 6.310970306396484
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0053764  Vali Loss: 0.0400368 Vali Accuracy: 0.9913486  Vali weighted F1: 0.9913033  Vali macro F1 0.9883208 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.319412469863892
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0050978  Vali Loss: 0.0385181 Vali Accuracy: 0.9913486  Vali weighted F1: 0.9913121  Vali macro F1 0.9879909 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.2889814376831055
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0052498  Vali Loss: 0.0393551 Vali Accuracy: 0.9908397  Vali weighted F1: 0.9907934  Vali macro F1 0.9874870 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.286277532577515
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0051182  Vali Loss: 0.0397690 Vali Accuracy: 0.9898219  Vali weighted F1: 0.9897727  Vali macro F1 0.9858171 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.277449607849121
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0059607  Vali Loss: 0.0386144 Vali Accuracy: 0.9903308  Vali weighted F1: 0.9902913  Vali macro F1 0.9863209 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 16 cost time: 6.2819130420684814
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0056212  Vali Loss: 0.0387256 Vali Accuracy: 0.9903308  Vali weighted F1: 0.9902913  Vali macro F1 0.9863209 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8491124  Test weighted F1: 0.8543753  Test macro F1 0.8315709 
================ the 3 th CV Experiment ================ 
Leave one Out Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00014928 0.00018298 0.000999   0.0012837  0.00052329 0.00061805]
Train data number :  17473
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1942
Test data number :  12314
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.193708419799805
VALI: Epoch: 1, Steps: 69 | Train Loss: 1.0003194  Vali Loss: 0.5270656 Vali Accuracy: 0.8223481  Vali weighted F1: 0.7969686  Vali macro F1 0.7282303 
Validation loss decreased (inf --> 0.527066).  Saving model ...
Epoch: 2 cost time: 12.94763469696045
VALI: Epoch: 2, Steps: 69 | Train Loss: 0.4366227  Vali Loss: 0.4596057 Vali Accuracy: 0.8393409  Vali weighted F1: 0.8285364  Vali macro F1 0.7994564 
new best score!!!!
Validation loss decreased (0.527066 --> 0.459606).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.280758380889893
VALI: Epoch: 3, Steps: 69 | Train Loss: 0.3083137  Vali Loss: 0.2594232 Vali Accuracy: 0.9062822  Vali weighted F1: 0.8992052  Vali macro F1 0.8738717 
new best score!!!!
Validation loss decreased (0.459606 --> 0.259423).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 7.0621654987335205
VALI: Epoch: 4, Steps: 69 | Train Loss: 0.2383816  Vali Loss: 0.2001853 Vali Accuracy: 0.9284243  Vali weighted F1: 0.9266575  Vali macro F1 0.9041196 
new best score!!!!
Validation loss decreased (0.259423 --> 0.200185).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.23173713684082
VALI: Epoch: 5, Steps: 69 | Train Loss: 0.1843610  Vali Loss: 0.1741505 Vali Accuracy: 0.9397528  Vali weighted F1: 0.9398235  Vali macro F1 0.9197558 
new best score!!!!
Validation loss decreased (0.200185 --> 0.174151).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.2018914222717285
VALI: Epoch: 6, Steps: 69 | Train Loss: 0.1669521  Vali Loss: 0.2157120 Vali Accuracy: 0.9263646  Vali weighted F1: 0.9256349  Vali macro F1 0.8989188 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 7 cost time: 6.209953784942627
VALI: Epoch: 7, Steps: 69 | Train Loss: 0.1495697  Vali Loss: 0.1357140 Vali Accuracy: 0.9479918  Vali weighted F1: 0.9472203  Vali macro F1 0.9266079 
new best score!!!!
Validation loss decreased (0.174151 --> 0.135714).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 7.023298025131226
VALI: Epoch: 8, Steps: 69 | Train Loss: 0.1277533  Vali Loss: 0.1320423 Vali Accuracy: 0.9515963  Vali weighted F1: 0.9511075  Vali macro F1 0.9361549 
new best score!!!!
Validation loss decreased (0.135714 --> 0.132042).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.1754536628723145
VALI: Epoch: 9, Steps: 69 | Train Loss: 0.1165744  Vali Loss: 0.1276553 Vali Accuracy: 0.9541710  Vali weighted F1: 0.9552657  Vali macro F1 0.9404987 
new best score!!!!
Validation loss decreased (0.132042 --> 0.127655).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.176538705825806
VALI: Epoch: 10, Steps: 69 | Train Loss: 0.1084705  Vali Loss: 0.0946227 Vali Accuracy: 0.9680742  Vali weighted F1: 0.9680716  Vali macro F1 0.9587517 
new best score!!!!
Validation loss decreased (0.127655 --> 0.094623).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.180714845657349
VALI: Epoch: 11, Steps: 69 | Train Loss: 0.0963225  Vali Loss: 0.0825813 Vali Accuracy: 0.9727085  Vali weighted F1: 0.9726040  Vali macro F1 0.9630831 
new best score!!!!
Validation loss decreased (0.094623 --> 0.082581).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.184129238128662
VALI: Epoch: 12, Steps: 69 | Train Loss: 0.0886655  Vali Loss: 0.0711560 Vali Accuracy: 0.9768280  Vali weighted F1: 0.9766302  Vali macro F1 0.9695832 
new best score!!!!
Validation loss decreased (0.082581 --> 0.071156).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.190418481826782
VALI: Epoch: 13, Steps: 69 | Train Loss: 0.0778517  Vali Loss: 0.1066811 Vali Accuracy: 0.9644696  Vali weighted F1: 0.9641626  Vali macro F1 0.9530868 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 6.162832736968994
VALI: Epoch: 14, Steps: 69 | Train Loss: 0.0759094  Vali Loss: 0.0782580 Vali Accuracy: 0.9752832  Vali weighted F1: 0.9753407  Vali macro F1 0.9692945 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 15 cost time: 6.174857139587402
VALI: Epoch: 15, Steps: 69 | Train Loss: 0.0709426  Vali Loss: 0.0612096 Vali Accuracy: 0.9778579  Vali weighted F1: 0.9776854  Vali macro F1 0.9711204 
new best score!!!!
Validation loss decreased (0.071156 --> 0.061210).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.177394866943359
VALI: Epoch: 16, Steps: 69 | Train Loss: 0.0586851  Vali Loss: 0.0928686 Vali Accuracy: 0.9680742  Vali weighted F1: 0.9681494  Vali macro F1 0.9550752 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 6.156976938247681
VALI: Epoch: 17, Steps: 69 | Train Loss: 0.0583781  Vali Loss: 0.0716167 Vali Accuracy: 0.9747683  Vali weighted F1: 0.9746918  Vali macro F1 0.9683376 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 6.174070358276367
VALI: Epoch: 18, Steps: 69 | Train Loss: 0.0556717  Vali Loss: 0.0742245 Vali Accuracy: 0.9757981  Vali weighted F1: 0.9755149  Vali macro F1 0.9688645 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 19 cost time: 6.153424024581909
VALI: Epoch: 19, Steps: 69 | Train Loss: 0.0464331  Vali Loss: 0.0714321 Vali Accuracy: 0.9752832  Vali weighted F1: 0.9753298  Vali macro F1 0.9678530 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 20 cost time: 6.15849494934082
VALI: Epoch: 20, Steps: 69 | Train Loss: 0.0434312  Vali Loss: 0.0676255 Vali Accuracy: 0.9778579  Vali weighted F1: 0.9778475  Vali macro F1 0.9710006 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 21 cost time: 6.180925369262695
VALI: Epoch: 21, Steps: 69 | Train Loss: 0.0323776  Vali Loss: 0.0574432 Vali Accuracy: 0.9809475  Vali weighted F1: 0.9809034  Vali macro F1 0.9748224 
new best score!!!!
Validation loss decreased (0.061210 --> 0.057443).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.172968864440918
VALI: Epoch: 22, Steps: 69 | Train Loss: 0.0293771  Vali Loss: 0.0565835 Vali Accuracy: 0.9814624  Vali weighted F1: 0.9813902  Vali macro F1 0.9751382 
new best score!!!!
Validation loss decreased (0.057443 --> 0.056583).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.179481744766235
VALI: Epoch: 23, Steps: 69 | Train Loss: 0.0276307  Vali Loss: 0.0530301 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9824298  Vali macro F1 0.9768850 
new best score!!!!
Validation loss decreased (0.056583 --> 0.053030).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.160183906555176
VALI: Epoch: 24, Steps: 69 | Train Loss: 0.0249771  Vali Loss: 0.0544296 Vali Accuracy: 0.9830072  Vali weighted F1: 0.9829613  Vali macro F1 0.9776871 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 6.162679195404053
VALI: Epoch: 25, Steps: 69 | Train Loss: 0.0243548  Vali Loss: 0.0548347 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9824309  Vali macro F1 0.9776349 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 6.1553590297698975
VALI: Epoch: 26, Steps: 69 | Train Loss: 0.0239133  Vali Loss: 0.0538421 Vali Accuracy: 0.9830072  Vali weighted F1: 0.9829634  Vali macro F1 0.9781671 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 27 cost time: 6.160754919052124
VALI: Epoch: 27, Steps: 69 | Train Loss: 0.0247229  Vali Loss: 0.0542311 Vali Accuracy: 0.9835221  Vali weighted F1: 0.9834921  Vali macro F1 0.9799549 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 28 cost time: 6.159458637237549
VALI: Epoch: 28, Steps: 69 | Train Loss: 0.0225275  Vali Loss: 0.0527289 Vali Accuracy: 0.9840371  Vali weighted F1: 0.9840376  Vali macro F1 0.9801358 
new best score!!!!
Validation loss decreased (0.053030 --> 0.052729).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.173337697982788
VALI: Epoch: 29, Steps: 69 | Train Loss: 0.0224111  Vali Loss: 0.0522266 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9855445  Vali macro F1 0.9823282 
new best score!!!!
Validation loss decreased (0.052729 --> 0.052227).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.175092697143555
VALI: Epoch: 30, Steps: 69 | Train Loss: 0.0211407  Vali Loss: 0.0539851 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9855677  Vali macro F1 0.9814073 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 6.172355890274048
VALI: Epoch: 31, Steps: 69 | Train Loss: 0.0220674  Vali Loss: 0.0514898 Vali Accuracy: 0.9845520  Vali weighted F1: 0.9845280  Vali macro F1 0.9801473 
new best score!!!!
Validation loss decreased (0.052227 --> 0.051490).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.164012908935547
VALI: Epoch: 32, Steps: 69 | Train Loss: 0.0215561  Vali Loss: 0.0538987 Vali Accuracy: 0.9835221  Vali weighted F1: 0.9834410  Vali macro F1 0.9797592 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 6.185533761978149
VALI: Epoch: 33, Steps: 69 | Train Loss: 0.0206285  Vali Loss: 0.0524779 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9855731  Vali macro F1 0.9814049 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 6.167377233505249
VALI: Epoch: 34, Steps: 69 | Train Loss: 0.0204303  Vali Loss: 0.0535962 Vali Accuracy: 0.9860968  Vali weighted F1: 0.9860691  Vali macro F1 0.9831138 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 35 cost time: 6.1701273918151855
VALI: Epoch: 35, Steps: 69 | Train Loss: 0.0190585  Vali Loss: 0.0533160 Vali Accuracy: 0.9850669  Vali weighted F1: 0.9850443  Vali macro F1 0.9803884 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 36 cost time: 6.167737245559692
VALI: Epoch: 36, Steps: 69 | Train Loss: 0.0187592  Vali Loss: 0.0526584 Vali Accuracy: 0.9840371  Vali weighted F1: 0.9840281  Vali macro F1 0.9794227 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 37 cost time: 6.174324989318848
VALI: Epoch: 37, Steps: 69 | Train Loss: 0.0190300  Vali Loss: 0.0530638 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9855581  Vali macro F1 0.9812543 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 6.181504249572754
VALI: Epoch: 38, Steps: 69 | Train Loss: 0.0178351  Vali Loss: 0.0531321 Vali Accuracy: 0.9850669  Vali weighted F1: 0.9850485  Vali macro F1 0.9807788 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 6.168901681900024
VALI: Epoch: 39, Steps: 69 | Train Loss: 0.0189885  Vali Loss: 0.0544650 Vali Accuracy: 0.9850669  Vali weighted F1: 0.9850485  Vali macro F1 0.9807788 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 40 cost time: 6.166792392730713
VALI: Epoch: 40, Steps: 69 | Train Loss: 0.0176781  Vali Loss: 0.0542902 Vali Accuracy: 0.9850669  Vali weighted F1: 0.9850485  Vali macro F1 0.9807788 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 41 cost time: 6.186962127685547
VALI: Epoch: 41, Steps: 69 | Train Loss: 0.0186488  Vali Loss: 0.0543571 Vali Accuracy: 0.9860968  Vali weighted F1: 0.9860774  Vali macro F1 0.9818828 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 42 cost time: 6.185190916061401
VALI: Epoch: 42, Steps: 69 | Train Loss: 0.0182639  Vali Loss: 0.0541259 Vali Accuracy: 0.9850669  Vali weighted F1: 0.9850485  Vali macro F1 0.9807788 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 6.179643869400024
VALI: Epoch: 43, Steps: 69 | Train Loss: 0.0164988  Vali Loss: 0.0541164 Vali Accuracy: 0.9850669  Vali weighted F1: 0.9850485  Vali macro F1 0.9807788 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 6.1693103313446045
VALI: Epoch: 44, Steps: 69 | Train Loss: 0.0181413  Vali Loss: 0.0540860 Vali Accuracy: 0.9850669  Vali weighted F1: 0.9850485  Vali macro F1 0.9807788 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 6.269466161727905
VALI: Epoch: 45, Steps: 69 | Train Loss: 0.0181012  Vali Loss: 0.0540608 Vali Accuracy: 0.9850669  Vali weighted F1: 0.9850485  Vali macro F1 0.9807788 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 46 cost time: 6.159603595733643
VALI: Epoch: 46, Steps: 69 | Train Loss: 0.0187306  Vali Loss: 0.0540042 Vali Accuracy: 0.9850669  Vali weighted F1: 0.9850485  Vali macro F1 0.9807788 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9593958  Test weighted F1: 0.9587421  Test macro F1 0.9457952 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 240495
pruned model Parameter : 244174
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.332070827484131
Fine Tuning VALI: Epoch: 1, Steps: 69 | Train Loss: 0.0245213  Vali Loss: 0.0529077 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9855430  Vali macro F1 0.9826400 
Validation loss decreased (inf --> 0.052908).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.204862594604492
Fine Tuning VALI: Epoch: 2, Steps: 69 | Train Loss: 0.0225912  Vali Loss: 0.0607965 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9824094  Vali macro F1 0.9769870 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.18527626991272
Fine Tuning VALI: Epoch: 3, Steps: 69 | Train Loss: 0.0207712  Vali Loss: 0.0569255 Vali Accuracy: 0.9835221  Vali weighted F1: 0.9834786  Vali macro F1 0.9794440 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.193618059158325
Fine Tuning VALI: Epoch: 4, Steps: 69 | Train Loss: 0.0204499  Vali Loss: 0.0537612 Vali Accuracy: 0.9845520  Vali weighted F1: 0.9845223  Vali macro F1 0.9809692 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.186903476715088
Fine Tuning VALI: Epoch: 5, Steps: 69 | Train Loss: 0.0201487  Vali Loss: 0.0539907 Vali Accuracy: 0.9835221  Vali weighted F1: 0.9835697  Vali macro F1 0.9778919 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.180458307266235
Fine Tuning VALI: Epoch: 6, Steps: 69 | Train Loss: 0.0194260  Vali Loss: 0.0533667 Vali Accuracy: 0.9850669  Vali weighted F1: 0.9850233  Vali macro F1 0.9801141 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.194265842437744
Fine Tuning VALI: Epoch: 7, Steps: 69 | Train Loss: 0.0190746  Vali Loss: 0.0572837 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9823793  Vali macro F1 0.9776845 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.178256273269653
Fine Tuning VALI: Epoch: 8, Steps: 69 | Train Loss: 0.0179566  Vali Loss: 0.0517849 Vali Accuracy: 0.9835221  Vali weighted F1: 0.9834889  Vali macro F1 0.9784766 
new best score!!!!
Validation loss decreased (0.052908 --> 0.051785).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 6.183236598968506
Fine Tuning VALI: Epoch: 9, Steps: 69 | Train Loss: 0.0180432  Vali Loss: 0.0522319 Vali Accuracy: 0.9840371  Vali weighted F1: 0.9839702  Vali macro F1 0.9789688 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.200404405593872
Fine Tuning VALI: Epoch: 10, Steps: 69 | Train Loss: 0.0189361  Vali Loss: 0.0506703 Vali Accuracy: 0.9845520  Vali weighted F1: 0.9845354  Vali macro F1 0.9814018 
new best score!!!!
Validation loss decreased (0.051785 --> 0.050670).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 6.189286231994629
Fine Tuning VALI: Epoch: 11, Steps: 69 | Train Loss: 0.0174220  Vali Loss: 0.0473530 Vali Accuracy: 0.9860968  Vali weighted F1: 0.9861012  Vali macro F1 0.9833259 
new best score!!!!
Validation loss decreased (0.050670 --> 0.047353).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 6.195244073867798
Fine Tuning VALI: Epoch: 12, Steps: 69 | Train Loss: 0.0174148  Vali Loss: 0.0531012 Vali Accuracy: 0.9840371  Vali weighted F1: 0.9840363  Vali macro F1 0.9804326 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 6.212725639343262
Fine Tuning VALI: Epoch: 13, Steps: 69 | Train Loss: 0.0161370  Vali Loss: 0.0559800 Vali Accuracy: 0.9840371  Vali weighted F1: 0.9839864  Vali macro F1 0.9799781 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 6.209099292755127
Fine Tuning VALI: Epoch: 14, Steps: 69 | Train Loss: 0.0148483  Vali Loss: 0.0566978 Vali Accuracy: 0.9830072  Vali weighted F1: 0.9829678  Vali macro F1 0.9778431 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 6.18885612487793
Fine Tuning VALI: Epoch: 15, Steps: 69 | Train Loss: 0.0167827  Vali Loss: 0.0597658 Vali Accuracy: 0.9824923  Vali weighted F1: 0.9824009  Vali macro F1 0.9775201 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 6.209966421127319
Fine Tuning VALI: Epoch: 16, Steps: 69 | Train Loss: 0.0165211  Vali Loss: 0.0572327 Vali Accuracy: 0.9819773  Vali weighted F1: 0.9820307  Vali macro F1 0.9767490 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 17 cost time: 6.1824257373809814
Fine Tuning VALI: Epoch: 17, Steps: 69 | Train Loss: 0.0144126  Vali Loss: 0.0539998 Vali Accuracy: 0.9845520  Vali weighted F1: 0.9845130  Vali macro F1 0.9806087 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 6.195361375808716
Fine Tuning VALI: Epoch: 18, Steps: 69 | Train Loss: 0.0133721  Vali Loss: 0.0544291 Vali Accuracy: 0.9845520  Vali weighted F1: 0.9845130  Vali macro F1 0.9806087 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 6.18025016784668
Fine Tuning VALI: Epoch: 19, Steps: 69 | Train Loss: 0.0135681  Vali Loss: 0.0533876 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9855532  Vali macro F1 0.9820295 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 6.188499689102173
Fine Tuning VALI: Epoch: 20, Steps: 69 | Train Loss: 0.0138609  Vali Loss: 0.0523226 Vali Accuracy: 0.9845520  Vali weighted F1: 0.9845110  Vali macro F1 0.9805221 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 6.196744680404663
Fine Tuning VALI: Epoch: 21, Steps: 69 | Train Loss: 0.0133968  Vali Loss: 0.0524087 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9855532  Vali macro F1 0.9820295 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 22 cost time: 6.201425313949585
Fine Tuning VALI: Epoch: 22, Steps: 69 | Train Loss: 0.0137176  Vali Loss: 0.0525318 Vali Accuracy: 0.9850669  Vali weighted F1: 0.9850289  Vali macro F1 0.9814023 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 6.216125965118408
Fine Tuning VALI: Epoch: 23, Steps: 69 | Train Loss: 0.0128041  Vali Loss: 0.0525783 Vali Accuracy: 0.9855819  Vali weighted F1: 0.9855469  Vali macro F1 0.9822836 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 6.172043561935425
Fine Tuning VALI: Epoch: 24, Steps: 69 | Train Loss: 0.0125660  Vali Loss: 0.0527234 Vali Accuracy: 0.9850669  Vali weighted F1: 0.9850289  Vali macro F1 0.9814023 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 6.176328182220459
Fine Tuning VALI: Epoch: 25, Steps: 69 | Train Loss: 0.0120714  Vali Loss: 0.0529427 Vali Accuracy: 0.9850669  Vali weighted F1: 0.9850289  Vali macro F1 0.9814023 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 6.181258201599121
Fine Tuning VALI: Epoch: 26, Steps: 69 | Train Loss: 0.0125745  Vali Loss: 0.0529440 Vali Accuracy: 0.9850669  Vali weighted F1: 0.9850289  Vali macro F1 0.9814023 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9512750  Test weighted F1: 0.9511732  Test macro F1 0.9388315 
================ the 4 th CV Experiment ================ 
Leave one Out Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.00014959 0.00018678 0.00138313 0.00145985 0.00052882 0.00064809]
Train data number :  16881
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1876
Test data number :  15610
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 5.968050241470337
VALI: Epoch: 1, Steps: 66 | Train Loss: 1.0203224  Vali Loss: 0.5944031 Vali Accuracy: 0.7969083  Vali weighted F1: 0.7788617  Vali macro F1 0.7160466 
Validation loss decreased (inf --> 0.594403).  Saving model ...
Epoch: 2 cost time: 5.939378261566162
VALI: Epoch: 2, Steps: 66 | Train Loss: 0.4524494  Vali Loss: 0.3482695 Vali Accuracy: 0.8763326  Vali weighted F1: 0.8665298  Vali macro F1 0.8401475 
new best score!!!!
Validation loss decreased (0.594403 --> 0.348269).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 5.961925268173218
VALI: Epoch: 3, Steps: 66 | Train Loss: 0.3117974  Vali Loss: 0.2760986 Vali Accuracy: 0.9077825  Vali weighted F1: 0.9049540  Vali macro F1 0.8852888 
new best score!!!!
Validation loss decreased (0.348269 --> 0.276099).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 5.969990253448486
VALI: Epoch: 4, Steps: 66 | Train Loss: 0.2357127  Vali Loss: 0.1995077 Vali Accuracy: 0.9365672  Vali weighted F1: 0.9351017  Vali macro F1 0.9229374 
new best score!!!!
Validation loss decreased (0.276099 --> 0.199508).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 5.9904162883758545
VALI: Epoch: 5, Steps: 66 | Train Loss: 0.1992705  Vali Loss: 0.1837245 Vali Accuracy: 0.9450959  Vali weighted F1: 0.9449715  Vali macro F1 0.9358254 
new best score!!!!
Validation loss decreased (0.199508 --> 0.183724).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 5.975358486175537
VALI: Epoch: 6, Steps: 66 | Train Loss: 0.1593409  Vali Loss: 0.1646631 Vali Accuracy: 0.9520256  Vali weighted F1: 0.9514787  Vali macro F1 0.9411838 
new best score!!!!
Validation loss decreased (0.183724 --> 0.164663).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 5.97107720375061
VALI: Epoch: 7, Steps: 66 | Train Loss: 0.1530647  Vali Loss: 0.1552994 Vali Accuracy: 0.9536247  Vali weighted F1: 0.9514423  Vali macro F1 0.9435653 
new best score!!!!
Validation loss decreased (0.164663 --> 0.155299).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 5.967814207077026
VALI: Epoch: 8, Steps: 66 | Train Loss: 0.1344443  Vali Loss: 0.1216145 Vali Accuracy: 0.9610874  Vali weighted F1: 0.9600458  Vali macro F1 0.9498063 
new best score!!!!
Validation loss decreased (0.155299 --> 0.121614).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 5.965655565261841
VALI: Epoch: 9, Steps: 66 | Train Loss: 0.1093537  Vali Loss: 0.1105383 Vali Accuracy: 0.9642857  Vali weighted F1: 0.9637890  Vali macro F1 0.9536396 
new best score!!!!
Validation loss decreased (0.121614 --> 0.110538).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 5.976606369018555
VALI: Epoch: 10, Steps: 66 | Train Loss: 0.1043100  Vali Loss: 0.1006228 Vali Accuracy: 0.9701493  Vali weighted F1: 0.9698549  Vali macro F1 0.9603638 
new best score!!!!
Validation loss decreased (0.110538 --> 0.100623).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 5.969918727874756
VALI: Epoch: 11, Steps: 66 | Train Loss: 0.0901713  Vali Loss: 0.1098156 Vali Accuracy: 0.9696162  Vali weighted F1: 0.9691480  Vali macro F1 0.9605167 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 5.9539923667907715
VALI: Epoch: 12, Steps: 66 | Train Loss: 0.0830900  Vali Loss: 0.1800133 Vali Accuracy: 0.9371002  Vali weighted F1: 0.9382087  Vali macro F1 0.9280907 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 13 cost time: 5.976961135864258
VALI: Epoch: 13, Steps: 66 | Train Loss: 0.0863234  Vali Loss: 0.0897578 Vali Accuracy: 0.9722814  Vali weighted F1: 0.9722341  Vali macro F1 0.9636147 
new best score!!!!
Validation loss decreased (0.100623 --> 0.089758).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 5.984319686889648
VALI: Epoch: 14, Steps: 66 | Train Loss: 0.0677317  Vali Loss: 0.0776654 Vali Accuracy: 0.9765458  Vali weighted F1: 0.9763356  Vali macro F1 0.9715329 
new best score!!!!
Validation loss decreased (0.089758 --> 0.077665).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 5.951975345611572
VALI: Epoch: 15, Steps: 66 | Train Loss: 0.0603580  Vali Loss: 0.0934828 Vali Accuracy: 0.9706823  Vali weighted F1: 0.9700051  Vali macro F1 0.9634952 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 5.949660301208496
VALI: Epoch: 16, Steps: 66 | Train Loss: 0.0602334  Vali Loss: 0.0705578 Vali Accuracy: 0.9749467  Vali weighted F1: 0.9750533  Vali macro F1 0.9678386 
new best score!!!!
Validation loss decreased (0.077665 --> 0.070558).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 5.970840215682983
VALI: Epoch: 17, Steps: 66 | Train Loss: 0.0507224  Vali Loss: 0.0872442 Vali Accuracy: 0.9738806  Vali weighted F1: 0.9737664  Vali macro F1 0.9686562 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 5.95124363899231
VALI: Epoch: 18, Steps: 66 | Train Loss: 0.0544449  Vali Loss: 0.0706926 Vali Accuracy: 0.9770789  Vali weighted F1: 0.9767868  Vali macro F1 0.9703078 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 5.964221000671387
VALI: Epoch: 19, Steps: 66 | Train Loss: 0.0480954  Vali Loss: 0.0662500 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9811491  Vali macro F1 0.9762339 
new best score!!!!
Validation loss decreased (0.070558 --> 0.066250).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 5.961249828338623
VALI: Epoch: 20, Steps: 66 | Train Loss: 0.0384354  Vali Loss: 0.0712929 Vali Accuracy: 0.9754797  Vali weighted F1: 0.9752280  Vali macro F1 0.9695646 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 5.960432529449463
VALI: Epoch: 21, Steps: 66 | Train Loss: 0.0404569  Vali Loss: 0.0668740 Vali Accuracy: 0.9797441  Vali weighted F1: 0.9795703  Vali macro F1 0.9757088 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 5.961567163467407
VALI: Epoch: 22, Steps: 66 | Train Loss: 0.0400787  Vali Loss: 0.1013396 Vali Accuracy: 0.9680171  Vali weighted F1: 0.9676318  Vali macro F1 0.9615764 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 23 cost time: 5.9660022258758545
VALI: Epoch: 23, Steps: 66 | Train Loss: 0.0429367  Vali Loss: 0.0664215 Vali Accuracy: 0.9808102  Vali weighted F1: 0.9806726  Vali macro F1 0.9776184 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 24 cost time: 5.948749303817749
VALI: Epoch: 24, Steps: 66 | Train Loss: 0.0338448  Vali Loss: 0.0691220 Vali Accuracy: 0.9813433  Vali weighted F1: 0.9813002  Vali macro F1 0.9750403 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 25 cost time: 5.944030046463013
VALI: Epoch: 25, Steps: 66 | Train Loss: 0.0222639  Vali Loss: 0.0594972 Vali Accuracy: 0.9834755  Vali weighted F1: 0.9834093  Vali macro F1 0.9784242 
new best score!!!!
Validation loss decreased (0.066250 --> 0.059497).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 5.961880683898926
VALI: Epoch: 26, Steps: 66 | Train Loss: 0.0201030  Vali Loss: 0.0601999 Vali Accuracy: 0.9845416  Vali weighted F1: 0.9844832  Vali macro F1 0.9798303 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 5.971159219741821
VALI: Epoch: 27, Steps: 66 | Train Loss: 0.0184165  Vali Loss: 0.0598018 Vali Accuracy: 0.9840085  Vali weighted F1: 0.9839173  Vali macro F1 0.9792007 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 5.9633564949035645
VALI: Epoch: 28, Steps: 66 | Train Loss: 0.0192011  Vali Loss: 0.0601090 Vali Accuracy: 0.9834755  Vali weighted F1: 0.9834061  Vali macro F1 0.9781488 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 29 cost time: 5.9569175243377686
VALI: Epoch: 29, Steps: 66 | Train Loss: 0.0172767  Vali Loss: 0.0598086 Vali Accuracy: 0.9840085  Vali weighted F1: 0.9839630  Vali macro F1 0.9795505 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 30 cost time: 5.949385643005371
VALI: Epoch: 30, Steps: 66 | Train Loss: 0.0155098  Vali Loss: 0.0592360 Vali Accuracy: 0.9829424  Vali weighted F1: 0.9828898  Vali macro F1 0.9772541 
new best score!!!!
Validation loss decreased (0.059497 --> 0.059236).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 5.972372055053711
VALI: Epoch: 31, Steps: 66 | Train Loss: 0.0163712  Vali Loss: 0.0577265 Vali Accuracy: 0.9840085  Vali weighted F1: 0.9839614  Vali macro F1 0.9789625 
new best score!!!!
Validation loss decreased (0.059236 --> 0.057726).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 5.988678455352783
VALI: Epoch: 32, Steps: 66 | Train Loss: 0.0158274  Vali Loss: 0.0579106 Vali Accuracy: 0.9850746  Vali weighted F1: 0.9850002  Vali macro F1 0.9819372 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 5.963256120681763
VALI: Epoch: 33, Steps: 66 | Train Loss: 0.0161376  Vali Loss: 0.0604910 Vali Accuracy: 0.9829424  Vali weighted F1: 0.9828762  Vali macro F1 0.9795202 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 5.964242458343506
VALI: Epoch: 34, Steps: 66 | Train Loss: 0.0155467  Vali Loss: 0.0615988 Vali Accuracy: 0.9824094  Vali weighted F1: 0.9823328  Vali macro F1 0.9786811 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 35 cost time: 5.948242664337158
VALI: Epoch: 35, Steps: 66 | Train Loss: 0.0149650  Vali Loss: 0.0586342 Vali Accuracy: 0.9845416  Vali weighted F1: 0.9844908  Vali macro F1 0.9817189 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 36 cost time: 5.946408271789551
VALI: Epoch: 36, Steps: 66 | Train Loss: 0.0132994  Vali Loss: 0.0581695 Vali Accuracy: 0.9850746  Vali weighted F1: 0.9850091  Vali macro F1 0.9820200 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 37 cost time: 5.942989826202393
VALI: Epoch: 37, Steps: 66 | Train Loss: 0.0132895  Vali Loss: 0.0570196 Vali Accuracy: 0.9866738  Vali weighted F1: 0.9866396  Vali macro F1 0.9842704 
new best score!!!!
Validation loss decreased (0.057726 --> 0.057020).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 5.954389810562134
VALI: Epoch: 38, Steps: 66 | Train Loss: 0.0132266  Vali Loss: 0.0583013 Vali Accuracy: 0.9840085  Vali weighted F1: 0.9839433  Vali macro F1 0.9812040 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 5.953962326049805
VALI: Epoch: 39, Steps: 66 | Train Loss: 0.0130933  Vali Loss: 0.0579645 Vali Accuracy: 0.9840085  Vali weighted F1: 0.9839484  Vali macro F1 0.9812038 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 5.9765660762786865
VALI: Epoch: 40, Steps: 66 | Train Loss: 0.0136664  Vali Loss: 0.0572012 Vali Accuracy: 0.9840085  Vali weighted F1: 0.9839722  Vali macro F1 0.9812414 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 5.962425231933594
VALI: Epoch: 41, Steps: 66 | Train Loss: 0.0134985  Vali Loss: 0.0574004 Vali Accuracy: 0.9834755  Vali weighted F1: 0.9834246  Vali macro F1 0.9807017 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 42 cost time: 5.967973470687866
VALI: Epoch: 42, Steps: 66 | Train Loss: 0.0132756  Vali Loss: 0.0572898 Vali Accuracy: 0.9834755  Vali weighted F1: 0.9834246  Vali macro F1 0.9807017 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 43 cost time: 5.960702419281006
VALI: Epoch: 43, Steps: 66 | Train Loss: 0.0129931  Vali Loss: 0.0572760 Vali Accuracy: 0.9834755  Vali weighted F1: 0.9834246  Vali macro F1 0.9807017 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 5.961711883544922
VALI: Epoch: 44, Steps: 66 | Train Loss: 0.0128128  Vali Loss: 0.0572663 Vali Accuracy: 0.9834755  Vali weighted F1: 0.9834246  Vali macro F1 0.9807017 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 5.956301927566528
VALI: Epoch: 45, Steps: 66 | Train Loss: 0.0132840  Vali Loss: 0.0572567 Vali Accuracy: 0.9834755  Vali weighted F1: 0.9834246  Vali macro F1 0.9807017 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 46 cost time: 5.953014135360718
VALI: Epoch: 46, Steps: 66 | Train Loss: 0.0134887  Vali Loss: 0.0572486 Vali Accuracy: 0.9834755  Vali weighted F1: 0.9834246  Vali macro F1 0.9807017 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 47 cost time: 5.955954313278198
VALI: Epoch: 47, Steps: 66 | Train Loss: 0.0138525  Vali Loss: 0.0572564 Vali Accuracy: 0.9834755  Vali weighted F1: 0.9834246  Vali macro F1 0.9807017 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 48 cost time: 5.957759857177734
VALI: Epoch: 48, Steps: 66 | Train Loss: 0.0141590  Vali Loss: 0.0572503 Vali Accuracy: 0.9834755  Vali weighted F1: 0.9834246  Vali macro F1 0.9807017 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 5.961975574493408
VALI: Epoch: 49, Steps: 66 | Train Loss: 0.0127269  Vali Loss: 0.0572572 Vali Accuracy: 0.9834755  Vali weighted F1: 0.9834246  Vali macro F1 0.9807017 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 5.976794481277466
VALI: Epoch: 50, Steps: 66 | Train Loss: 0.0135902  Vali Loss: 0.0572558 Vali Accuracy: 0.9834755  Vali weighted F1: 0.9834246  Vali macro F1 0.9807017 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 5.957329750061035
VALI: Epoch: 51, Steps: 66 | Train Loss: 0.0131827  Vali Loss: 0.0572559 Vali Accuracy: 0.9834755  Vali weighted F1: 0.9834246  Vali macro F1 0.9807017 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 52 cost time: 5.944063186645508
VALI: Epoch: 52, Steps: 66 | Train Loss: 0.0135144  Vali Loss: 0.0572631 Vali Accuracy: 0.9834755  Vali weighted F1: 0.9834246  Vali macro F1 0.9807017 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9222934  Test weighted F1: 0.9257902  Test macro F1 0.9038533 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 240495
pruned model Parameter : 244174
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 5.997320890426636
Fine Tuning VALI: Epoch: 1, Steps: 66 | Train Loss: 0.0159556  Vali Loss: 0.0677103 Vali Accuracy: 0.9802772  Vali weighted F1: 0.9801739  Vali macro F1 0.9759116 
Validation loss decreased (inf --> 0.067710).  Saving model ...
Fine Tuning Epoch: 2 cost time: 5.97127890586853
Fine Tuning VALI: Epoch: 2, Steps: 66 | Train Loss: 0.0154320  Vali Loss: 0.0590307 Vali Accuracy: 0.9824094  Vali weighted F1: 0.9823837  Vali macro F1 0.9784161 
new best score!!!!
Validation loss decreased (0.067710 --> 0.059031).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 5.9555487632751465
Fine Tuning VALI: Epoch: 3, Steps: 66 | Train Loss: 0.0143283  Vali Loss: 0.0592426 Vali Accuracy: 0.9850746  Vali weighted F1: 0.9851109  Vali macro F1 0.9824691 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 5.956458568572998
Fine Tuning VALI: Epoch: 4, Steps: 66 | Train Loss: 0.0144984  Vali Loss: 0.0623520 Vali Accuracy: 0.9829424  Vali weighted F1: 0.9828681  Vali macro F1 0.9784188 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 5.993391752243042
Fine Tuning VALI: Epoch: 5, Steps: 66 | Train Loss: 0.0135077  Vali Loss: 0.0627182 Vali Accuracy: 0.9840085  Vali weighted F1: 0.9839568  Vali macro F1 0.9795779 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 5.997046232223511
Fine Tuning VALI: Epoch: 6, Steps: 66 | Train Loss: 0.0138297  Vali Loss: 0.0617836 Vali Accuracy: 0.9845416  Vali weighted F1: 0.9844901  Vali macro F1 0.9803404 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 5.989083766937256
Fine Tuning VALI: Epoch: 7, Steps: 66 | Train Loss: 0.0140708  Vali Loss: 0.0648289 Vali Accuracy: 0.9845416  Vali weighted F1: 0.9844769  Vali macro F1 0.9811114 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 8 cost time: 5.983036994934082
Fine Tuning VALI: Epoch: 8, Steps: 66 | Train Loss: 0.0123258  Vali Loss: 0.0643507 Vali Accuracy: 0.9834755  Vali weighted F1: 0.9834038  Vali macro F1 0.9786435 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 5.982752084732056
Fine Tuning VALI: Epoch: 9, Steps: 66 | Train Loss: 0.0115141  Vali Loss: 0.0634277 Vali Accuracy: 0.9840085  Vali weighted F1: 0.9839293  Vali macro F1 0.9808416 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 5.9892051219940186
Fine Tuning VALI: Epoch: 10, Steps: 66 | Train Loss: 0.0099740  Vali Loss: 0.0579075 Vali Accuracy: 0.9856077  Vali weighted F1: 0.9855849  Vali macro F1 0.9831822 
new best score!!!!
Validation loss decreased (0.059031 --> 0.057908).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 5.985597133636475
Fine Tuning VALI: Epoch: 11, Steps: 66 | Train Loss: 0.0100976  Vali Loss: 0.0581213 Vali Accuracy: 0.9866738  Vali weighted F1: 0.9866849  Vali macro F1 0.9836683 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.003128290176392
Fine Tuning VALI: Epoch: 12, Steps: 66 | Train Loss: 0.0105724  Vali Loss: 0.0646096 Vali Accuracy: 0.9850746  Vali weighted F1: 0.9850259  Vali macro F1 0.9799680 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 5.980615615844727
Fine Tuning VALI: Epoch: 13, Steps: 66 | Train Loss: 0.0106080  Vali Loss: 0.0607273 Vali Accuracy: 0.9840085  Vali weighted F1: 0.9839719  Vali macro F1 0.9793032 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 5.999123811721802
Fine Tuning VALI: Epoch: 14, Steps: 66 | Train Loss: 0.0098964  Vali Loss: 0.0638211 Vali Accuracy: 0.9845416  Vali weighted F1: 0.9844637  Vali macro F1 0.9796943 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 5.9949727058410645
Fine Tuning VALI: Epoch: 15, Steps: 66 | Train Loss: 0.0114363  Vali Loss: 0.0578064 Vali Accuracy: 0.9861407  Vali weighted F1: 0.9861168  Vali macro F1 0.9829934 
new best score!!!!
Validation loss decreased (0.057908 --> 0.057806).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 5.985941648483276
Fine Tuning VALI: Epoch: 16, Steps: 66 | Train Loss: 0.0092487  Vali Loss: 0.0602301 Vali Accuracy: 0.9850746  Vali weighted F1: 0.9850503  Vali macro F1 0.9806554 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 5.989672899246216
Fine Tuning VALI: Epoch: 17, Steps: 66 | Train Loss: 0.0089695  Vali Loss: 0.0602556 Vali Accuracy: 0.9861407  Vali weighted F1: 0.9861460  Vali macro F1 0.9823879 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 5.978574275970459
Fine Tuning VALI: Epoch: 18, Steps: 66 | Train Loss: 0.0095082  Vali Loss: 0.0672711 Vali Accuracy: 0.9834755  Vali weighted F1: 0.9833812  Vali macro F1 0.9804933 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 5.980489492416382
Fine Tuning VALI: Epoch: 19, Steps: 66 | Train Loss: 0.0092420  Vali Loss: 0.0618252 Vali Accuracy: 0.9834755  Vali weighted F1: 0.9834272  Vali macro F1 0.9789797 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 5.9753577709198
Fine Tuning VALI: Epoch: 20, Steps: 66 | Train Loss: 0.0095999  Vali Loss: 0.0596113 Vali Accuracy: 0.9840085  Vali weighted F1: 0.9839671  Vali macro F1 0.9793037 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 21 cost time: 5.985356330871582
Fine Tuning VALI: Epoch: 21, Steps: 66 | Train Loss: 0.0083501  Vali Loss: 0.0609285 Vali Accuracy: 0.9850746  Vali weighted F1: 0.9850645  Vali macro F1 0.9803779 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 5.985069751739502
Fine Tuning VALI: Epoch: 22, Steps: 66 | Train Loss: 0.0077152  Vali Loss: 0.0599507 Vali Accuracy: 0.9861407  Vali weighted F1: 0.9861234  Vali macro F1 0.9823586 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 6.008818864822388
Fine Tuning VALI: Epoch: 23, Steps: 66 | Train Loss: 0.0072937  Vali Loss: 0.0604558 Vali Accuracy: 0.9850746  Vali weighted F1: 0.9850417  Vali macro F1 0.9809833 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 6.005154371261597
Fine Tuning VALI: Epoch: 24, Steps: 66 | Train Loss: 0.0079288  Vali Loss: 0.0616444 Vali Accuracy: 0.9856077  Vali weighted F1: 0.9855907  Vali macro F1 0.9815182 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 25 cost time: 5.999810218811035
Fine Tuning VALI: Epoch: 25, Steps: 66 | Train Loss: 0.0073089  Vali Loss: 0.0612357 Vali Accuracy: 0.9845416  Vali weighted F1: 0.9844954  Vali macro F1 0.9804454 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 26 cost time: 5.9958837032318115
Fine Tuning VALI: Epoch: 26, Steps: 66 | Train Loss: 0.0073883  Vali Loss: 0.0612292 Vali Accuracy: 0.9845416  Vali weighted F1: 0.9844954  Vali macro F1 0.9804454 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 27 cost time: 5.9905922412872314
Fine Tuning VALI: Epoch: 27, Steps: 66 | Train Loss: 0.0067524  Vali Loss: 0.0611535 Vali Accuracy: 0.9845416  Vali weighted F1: 0.9844954  Vali macro F1 0.9804454 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 28 cost time: 5.9886744022369385
Fine Tuning VALI: Epoch: 28, Steps: 66 | Train Loss: 0.0071681  Vali Loss: 0.0609635 Vali Accuracy: 0.9850746  Vali weighted F1: 0.9850417  Vali macro F1 0.9809833 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 29 cost time: 5.987092971801758
Fine Tuning VALI: Epoch: 29, Steps: 66 | Train Loss: 0.0071809  Vali Loss: 0.0609990 Vali Accuracy: 0.9850746  Vali weighted F1: 0.9850417  Vali macro F1 0.9809833 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 30 cost time: 5.979722499847412
Fine Tuning VALI: Epoch: 30, Steps: 66 | Train Loss: 0.0063042  Vali Loss: 0.0608467 Vali Accuracy: 0.9856077  Vali weighted F1: 0.9855872  Vali macro F1 0.9815197 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9155669  Test weighted F1: 0.9197702  Test macro F1 0.8970757 
================ the 5 th CV Experiment ================ 
Leave one Out Experiment : The 6 Part as the test
[-] Target sampling weights:  [0.0001419  0.00018467 0.00096712 0.00125    0.0005291  0.00064599]
Train data number :  17734
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1971
Test data number :  10878
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.367630243301392
VALI: Epoch: 1, Steps: 70 | Train Loss: 0.9839244  Vali Loss: 0.4898094 Vali Accuracy: 0.8280061  Vali weighted F1: 0.7913511  Vali macro F1 0.7289876 
Validation loss decreased (inf --> 0.489809).  Saving model ...
Epoch: 2 cost time: 6.28921103477478
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.4336134  Vali Loss: 0.3121131 Vali Accuracy: 0.8924404  Vali weighted F1: 0.8879547  Vali macro F1 0.8543711 
new best score!!!!
Validation loss decreased (0.489809 --> 0.312113).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.291196823120117
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.3234613  Vali Loss: 0.2349745 Vali Accuracy: 0.9173009  Vali weighted F1: 0.9176469  Vali macro F1 0.8875632 
new best score!!!!
Validation loss decreased (0.312113 --> 0.234974).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.2889628410339355
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.2331324  Vali Loss: 0.1931969 Vali Accuracy: 0.9289701  Vali weighted F1: 0.9252517  Vali macro F1 0.8966846 
new best score!!!!
Validation loss decreased (0.234974 --> 0.193197).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.294431924819946
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.1818719  Vali Loss: 0.1350966 Vali Accuracy: 0.9497717  Vali weighted F1: 0.9488218  Vali macro F1 0.9264768 
new best score!!!!
Validation loss decreased (0.193197 --> 0.135097).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.286781311035156
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.1438673  Vali Loss: 0.1147582 Vali Accuracy: 0.9624556  Vali weighted F1: 0.9623855  Vali macro F1 0.9471290 
new best score!!!!
Validation loss decreased (0.135097 --> 0.114758).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.287299156188965
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.1287198  Vali Loss: 0.1168381 Vali Accuracy: 0.9578894  Vali weighted F1: 0.9573973  Vali macro F1 0.9401456 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 8 cost time: 6.287415027618408
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1111535  Vali Loss: 0.1008586 Vali Accuracy: 0.9644850  Vali weighted F1: 0.9641972  Vali macro F1 0.9519188 
new best score!!!!
Validation loss decreased (0.114758 --> 0.100859).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.290585279464722
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0997393  Vali Loss: 0.0955589 Vali Accuracy: 0.9685439  Vali weighted F1: 0.9687149  Vali macro F1 0.9561496 
new best score!!!!
Validation loss decreased (0.100859 --> 0.095559).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.332319021224976
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0928714  Vali Loss: 0.0951989 Vali Accuracy: 0.9685439  Vali weighted F1: 0.9685687  Vali macro F1 0.9551442 
new best score!!!!
Validation loss decreased (0.095559 --> 0.095199).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.305093765258789
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0797299  Vali Loss: 0.0823283 Vali Accuracy: 0.9741248  Vali weighted F1: 0.9741102  Vali macro F1 0.9637329 
new best score!!!!
Validation loss decreased (0.095199 --> 0.082328).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.283212184906006
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0773656  Vali Loss: 0.0859206 Vali Accuracy: 0.9726027  Vali weighted F1: 0.9725418  Vali macro F1 0.9620572 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 6.284684896469116
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0672944  Vali Loss: 0.0768667 Vali Accuracy: 0.9720954  Vali weighted F1: 0.9721195  Vali macro F1 0.9607767 
new best score!!!!
Validation loss decreased (0.082328 --> 0.076867).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.2794554233551025
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0617489  Vali Loss: 0.0703597 Vali Accuracy: 0.9771689  Vali weighted F1: 0.9771047  Vali macro F1 0.9669345 
new best score!!!!
Validation loss decreased (0.076867 --> 0.070360).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.293932676315308
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0589575  Vali Loss: 0.0710773 Vali Accuracy: 0.9756469  Vali weighted F1: 0.9755210  Vali macro F1 0.9661358 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.29658317565918
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0537354  Vali Loss: 0.0622279 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9802567  Vali macro F1 0.9712606 
new best score!!!!
Validation loss decreased (0.070360 --> 0.062228).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.290344715118408
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0454600  Vali Loss: 0.0634652 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9800076  Vali macro F1 0.9726783 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 6.316900253295898
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0512060  Vali Loss: 0.0638336 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9786864  Vali macro F1 0.9687096 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 6.292071104049683
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0376090  Vali Loss: 0.0631533 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9801966  Vali macro F1 0.9683248 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 20 cost time: 6.3007423877716064
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0417692  Vali Loss: 0.0643182 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9787237  Vali macro F1 0.9701860 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 21 cost time: 6.283951759338379
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0408553  Vali Loss: 0.0571369 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9811037  Vali macro F1 0.9723592 
new best score!!!!
Validation loss decreased (0.062228 --> 0.057137).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.276508092880249
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0275307  Vali Loss: 0.0592525 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9821336  Vali macro F1 0.9754804 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.283934116363525
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0314457  Vali Loss: 0.0566430 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9822425  Vali macro F1 0.9736333 
new best score!!!!
Validation loss decreased (0.057137 --> 0.056643).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.290250778198242
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0265552  Vali Loss: 0.0494956 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9857927  Vali macro F1 0.9789573 
new best score!!!!
Validation loss decreased (0.056643 --> 0.049496).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.294210910797119
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0326876  Vali Loss: 0.0600726 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9801422  Vali macro F1 0.9722902 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 6.290656805038452
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0232887  Vali Loss: 0.0746307 Vali Accuracy: 0.9791984  Vali weighted F1: 0.9791362  Vali macro F1 0.9696662 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 6.310805082321167
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0218801  Vali Loss: 0.0547604 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9817371  Vali macro F1 0.9770178 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 28 cost time: 6.310975551605225
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0223959  Vali Loss: 0.0529215 Vali Accuracy: 0.9812278  Vali weighted F1: 0.9811542  Vali macro F1 0.9730011 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 29 cost time: 6.296947479248047
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0210490  Vali Loss: 0.0550361 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837076  Vali macro F1 0.9781478 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 30 cost time: 6.32875657081604
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0119954  Vali Loss: 0.0515064 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842234  Vali macro F1 0.9784460 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 6.348068714141846
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0105943  Vali Loss: 0.0505376 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852644  Vali macro F1 0.9795763 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 6.3473052978515625
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0091940  Vali Loss: 0.0526786 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842105  Vali macro F1 0.9787156 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 6.341187477111816
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0091403  Vali Loss: 0.0491252 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842584  Vali macro F1 0.9782194 
new best score!!!!
Validation loss decreased (0.049496 --> 0.049125).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.335761785507202
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0087657  Vali Loss: 0.0506301 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9862357  Vali macro F1 0.9811573 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 6.3389458656311035
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0082735  Vali Loss: 0.0508126 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9857090  Vali macro F1 0.9808942 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 6.367033004760742
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0082061  Vali Loss: 0.0498323 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852764  Vali macro F1 0.9792959 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 6.351577997207642
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0078867  Vali Loss: 0.0501081 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9857494  Vali macro F1 0.9803755 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 6.364682197570801
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0068717  Vali Loss: 0.0508000 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852629  Vali macro F1 0.9795630 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 39 cost time: 6.338109254837036
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0070331  Vali Loss: 0.0505536 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9857602  Vali macro F1 0.9800793 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 6.344906806945801
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0070152  Vali Loss: 0.0506578 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9862805  Vali macro F1 0.9806500 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 6.336389064788818
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0067877  Vali Loss: 0.0506388 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9857608  Vali macro F1 0.9800928 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 6.3368823528289795
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0069018  Vali Loss: 0.0506343 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852400  Vali macro F1 0.9795333 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 6.3346288204193115
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0063496  Vali Loss: 0.0506198 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9857494  Vali macro F1 0.9803755 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 44 cost time: 6.3375160694122314
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0072670  Vali Loss: 0.0506242 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9857608  Vali macro F1 0.9800928 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 6.357172966003418
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0066184  Vali Loss: 0.0506159 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9857608  Vali macro F1 0.9800928 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 6.340364217758179
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0065911  Vali Loss: 0.0505826 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9857608  Vali macro F1 0.9800928 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 6.356147050857544
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0067466  Vali Loss: 0.0505408 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9857608  Vali macro F1 0.9800928 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 6.335999250411987
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0071094  Vali Loss: 0.0505072 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9857608  Vali macro F1 0.9800928 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8973157  Test weighted F1: 0.8955911  Test macro F1 0.9038311 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 240495
pruned model Parameter : 244174
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.348946571350098
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0094479  Vali Loss: 0.0497829 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9867273  Vali macro F1 0.9819680 
Validation loss decreased (inf --> 0.049783).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.313369512557983
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0080414  Vali Loss: 0.0509833 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9857353  Vali macro F1 0.9800608 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.304968595504761
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0084395  Vali Loss: 0.0501553 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847169  Vali macro F1 0.9798490 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.305363893508911
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0080245  Vali Loss: 0.0534414 Vali Accuracy: 0.9817352  Vali weighted F1: 0.9817161  Vali macro F1 0.9746370 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.3231284618377686
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0072782  Vali Loss: 0.0526746 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9862466  Vali macro F1 0.9809032 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.343873023986816
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0076167  Vali Loss: 0.0530907 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852658  Vali macro F1 0.9786639 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.3163416385650635
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0066220  Vali Loss: 0.0555872 Vali Accuracy: 0.9822425  Vali weighted F1: 0.9822167  Vali macro F1 0.9742088 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.337304353713989
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0067912  Vali Loss: 0.0530741 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9858100  Vali macro F1 0.9795859 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.308789253234863
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0067530  Vali Loss: 0.0541315 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842473  Vali macro F1 0.9769265 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.31709361076355
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0066365  Vali Loss: 0.0551132 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847563  Vali macro F1 0.9781317 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 11 cost time: 6.318750619888306
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0051762  Vali Loss: 0.0552712 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847563  Vali macro F1 0.9781317 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.311702728271484
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0057557  Vali Loss: 0.0554390 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847563  Vali macro F1 0.9781317 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.321105480194092
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0054517  Vali Loss: 0.0541900 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847468  Vali macro F1 0.9783905 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.34991192817688
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0051435  Vali Loss: 0.0551597 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842206  Vali macro F1 0.9778376 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.348384380340576
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0049065  Vali Loss: 0.0546446 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847465  Vali macro F1 0.9784335 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 16 cost time: 6.371650218963623
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0053651  Vali Loss: 0.0546375 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847465  Vali macro F1 0.9784335 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8986946  Test weighted F1: 0.8964023  Test macro F1 0.8993707 
================ the 6 th CV Experiment ================ 
Leave one Out Experiment : The 7 Part as the test
[-] Target sampling weights:  [0.00014207 0.00017835 0.00097371 0.0011976  0.0004817  0.0006035 ]
Train data number :  18241
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2027
Test data number :  8061
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.517177104949951
VALI: Epoch: 1, Steps: 72 | Train Loss: 0.9804166  Vali Loss: 0.5104972 Vali Accuracy: 0.8238777  Vali weighted F1: 0.7961654  Vali macro F1 0.7384634 
Validation loss decreased (inf --> 0.510497).  Saving model ...
Epoch: 2 cost time: 6.5029003620147705
VALI: Epoch: 2, Steps: 72 | Train Loss: 0.4248707  Vali Loss: 0.3933617 Vali Accuracy: 0.8579181  Vali weighted F1: 0.8568018  Vali macro F1 0.8372167 
new best score!!!!
Validation loss decreased (0.510497 --> 0.393362).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.488078832626343
VALI: Epoch: 3, Steps: 72 | Train Loss: 0.2942956  Vali Loss: 0.2090108 Vali Accuracy: 0.9294524  Vali weighted F1: 0.9282797  Vali macro F1 0.9066428 
new best score!!!!
Validation loss decreased (0.393362 --> 0.209011).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.490292549133301
VALI: Epoch: 4, Steps: 72 | Train Loss: 0.2048626  Vali Loss: 0.1961106 Vali Accuracy: 0.9319191  Vali weighted F1: 0.9295790  Vali macro F1 0.9085500 
new best score!!!!
Validation loss decreased (0.209011 --> 0.196111).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.498863220214844
VALI: Epoch: 5, Steps: 72 | Train Loss: 0.1654616  Vali Loss: 0.1702412 Vali Accuracy: 0.9343858  Vali weighted F1: 0.9324892  Vali macro F1 0.9081021 
new best score!!!!
Validation loss decreased (0.196111 --> 0.170241).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.51017165184021
VALI: Epoch: 6, Steps: 72 | Train Loss: 0.1417207  Vali Loss: 0.1139063 Vali Accuracy: 0.9565861  Vali weighted F1: 0.9565275  Vali macro F1 0.9342111 
new best score!!!!
Validation loss decreased (0.170241 --> 0.113906).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.529276132583618
VALI: Epoch: 7, Steps: 72 | Train Loss: 0.1196296  Vali Loss: 0.1085049 Vali Accuracy: 0.9570794  Vali weighted F1: 0.9573805  Vali macro F1 0.9409580 
new best score!!!!
Validation loss decreased (0.113906 --> 0.108505).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.527015924453735
VALI: Epoch: 8, Steps: 72 | Train Loss: 0.1115289  Vali Loss: 0.1306008 Vali Accuracy: 0.9467193  Vali weighted F1: 0.9476653  Vali macro F1 0.9260402 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 9 cost time: 6.53068733215332
VALI: Epoch: 9, Steps: 72 | Train Loss: 0.1018471  Vali Loss: 0.0835535 Vali Accuracy: 0.9684262  Vali weighted F1: 0.9681144  Vali macro F1 0.9537176 
new best score!!!!
Validation loss decreased (0.108505 --> 0.083554).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.512706518173218
VALI: Epoch: 10, Steps: 72 | Train Loss: 0.0916309  Vali Loss: 0.0849882 Vali Accuracy: 0.9708929  Vali weighted F1: 0.9709548  Vali macro F1 0.9553693 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.496832847595215
VALI: Epoch: 11, Steps: 72 | Train Loss: 0.0841172  Vali Loss: 0.1015753 Vali Accuracy: 0.9659595  Vali weighted F1: 0.9654478  Vali macro F1 0.9557755 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 12 cost time: 6.498424291610718
VALI: Epoch: 12, Steps: 72 | Train Loss: 0.0764442  Vali Loss: 0.0870787 Vali Accuracy: 0.9708929  Vali weighted F1: 0.9707191  Vali macro F1 0.9589475 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 13 cost time: 6.541693687438965
VALI: Epoch: 13, Steps: 72 | Train Loss: 0.0661318  Vali Loss: 0.0742645 Vali Accuracy: 0.9753330  Vali weighted F1: 0.9753116  Vali macro F1 0.9643724 
new best score!!!!
Validation loss decreased (0.083554 --> 0.074265).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.493002891540527
VALI: Epoch: 14, Steps: 72 | Train Loss: 0.0726187  Vali Loss: 0.0799597 Vali Accuracy: 0.9753330  Vali weighted F1: 0.9750742  Vali macro F1 0.9648031 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.500420570373535
VALI: Epoch: 15, Steps: 72 | Train Loss: 0.0555713  Vali Loss: 0.0776128 Vali Accuracy: 0.9733596  Vali weighted F1: 0.9733605  Vali macro F1 0.9647621 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 16 cost time: 6.515528678894043
VALI: Epoch: 16, Steps: 72 | Train Loss: 0.0505048  Vali Loss: 0.0601203 Vali Accuracy: 0.9787864  Vali weighted F1: 0.9786602  Vali macro F1 0.9704343 
new best score!!!!
Validation loss decreased (0.074265 --> 0.060120).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.518924713134766
VALI: Epoch: 17, Steps: 72 | Train Loss: 0.0494882  Vali Loss: 0.0794871 Vali Accuracy: 0.9723730  Vali weighted F1: 0.9721082  Vali macro F1 0.9629574 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 6.532723426818848
VALI: Epoch: 18, Steps: 72 | Train Loss: 0.0442223  Vali Loss: 0.0593028 Vali Accuracy: 0.9782930  Vali weighted F1: 0.9784019  Vali macro F1 0.9686012 
new best score!!!!
Validation loss decreased (0.060120 --> 0.059303).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.517852783203125
VALI: Epoch: 19, Steps: 72 | Train Loss: 0.0418927  Vali Loss: 0.0661272 Vali Accuracy: 0.9777997  Vali weighted F1: 0.9777677  Vali macro F1 0.9696960 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 6.504163503646851
VALI: Epoch: 20, Steps: 72 | Train Loss: 0.0398015  Vali Loss: 0.0550087 Vali Accuracy: 0.9817464  Vali weighted F1: 0.9817278  Vali macro F1 0.9728352 
new best score!!!!
Validation loss decreased (0.059303 --> 0.055009).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 6.502236366271973
VALI: Epoch: 21, Steps: 72 | Train Loss: 0.0345714  Vali Loss: 0.0511419 Vali Accuracy: 0.9832264  Vali weighted F1: 0.9832096  Vali macro F1 0.9776297 
new best score!!!!
Validation loss decreased (0.055009 --> 0.051142).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 6.508329153060913
VALI: Epoch: 22, Steps: 72 | Train Loss: 0.0384985  Vali Loss: 0.0677638 Vali Accuracy: 0.9782930  Vali weighted F1: 0.9783498  Vali macro F1 0.9692935 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 6.501373291015625
VALI: Epoch: 23, Steps: 72 | Train Loss: 0.0418174  Vali Loss: 0.0720049 Vali Accuracy: 0.9743463  Vali weighted F1: 0.9746398  Vali macro F1 0.9643597 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 6.513289451599121
VALI: Epoch: 24, Steps: 72 | Train Loss: 0.0276975  Vali Loss: 0.0614865 Vali Accuracy: 0.9777997  Vali weighted F1: 0.9776147  Vali macro F1 0.9670419 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 25 cost time: 6.516876697540283
VALI: Epoch: 25, Steps: 72 | Train Loss: 0.0252157  Vali Loss: 0.0707812 Vali Accuracy: 0.9758263  Vali weighted F1: 0.9755539  Vali macro F1 0.9670580 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 26 cost time: 6.528360605239868
VALI: Epoch: 26, Steps: 72 | Train Loss: 0.0241555  Vali Loss: 0.0551689 Vali Accuracy: 0.9807597  Vali weighted F1: 0.9807285  Vali macro F1 0.9721507 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 27 cost time: 6.518898963928223
VALI: Epoch: 27, Steps: 72 | Train Loss: 0.0168696  Vali Loss: 0.0473445 Vali Accuracy: 0.9837198  Vali weighted F1: 0.9837221  Vali macro F1 0.9757629 
new best score!!!!
Validation loss decreased (0.051142 --> 0.047345).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 6.496811151504517
VALI: Epoch: 28, Steps: 72 | Train Loss: 0.0145164  Vali Loss: 0.0470357 Vali Accuracy: 0.9832264  Vali weighted F1: 0.9832363  Vali macro F1 0.9757295 
new best score!!!!
Validation loss decreased (0.047345 --> 0.047036).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 6.4914021492004395
VALI: Epoch: 29, Steps: 72 | Train Loss: 0.0123287  Vali Loss: 0.0448504 Vali Accuracy: 0.9847065  Vali weighted F1: 0.9847440  Vali macro F1 0.9771226 
new best score!!!!
Validation loss decreased (0.047036 --> 0.044850).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.49640965461731
VALI: Epoch: 30, Steps: 72 | Train Loss: 0.0118587  Vali Loss: 0.0458037 Vali Accuracy: 0.9847065  Vali weighted F1: 0.9847470  Vali macro F1 0.9774558 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 6.486457109451294
VALI: Epoch: 31, Steps: 72 | Train Loss: 0.0106509  Vali Loss: 0.0469978 Vali Accuracy: 0.9856931  Vali weighted F1: 0.9857224  Vali macro F1 0.9789980 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 6.4930830001831055
VALI: Epoch: 32, Steps: 72 | Train Loss: 0.0113247  Vali Loss: 0.0490254 Vali Accuracy: 0.9832264  Vali weighted F1: 0.9832543  Vali macro F1 0.9757577 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 6.492622137069702
VALI: Epoch: 33, Steps: 72 | Train Loss: 0.0107012  Vali Loss: 0.0480776 Vali Accuracy: 0.9842131  Vali weighted F1: 0.9842545  Vali macro F1 0.9764648 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 34 cost time: 6.503451347351074
VALI: Epoch: 34, Steps: 72 | Train Loss: 0.0095788  Vali Loss: 0.0502088 Vali Accuracy: 0.9842131  Vali weighted F1: 0.9842631  Vali macro F1 0.9764895 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 35 cost time: 6.503533601760864
VALI: Epoch: 35, Steps: 72 | Train Loss: 0.0095264  Vali Loss: 0.0499362 Vali Accuracy: 0.9837198  Vali weighted F1: 0.9837672  Vali macro F1 0.9756950 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 6.515101671218872
VALI: Epoch: 36, Steps: 72 | Train Loss: 0.0096696  Vali Loss: 0.0498286 Vali Accuracy: 0.9842131  Vali weighted F1: 0.9842545  Vali macro F1 0.9764648 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 6.497924566268921
VALI: Epoch: 37, Steps: 72 | Train Loss: 0.0106971  Vali Loss: 0.0495079 Vali Accuracy: 0.9842131  Vali weighted F1: 0.9842545  Vali macro F1 0.9764648 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 6.490275621414185
VALI: Epoch: 38, Steps: 72 | Train Loss: 0.0098858  Vali Loss: 0.0495252 Vali Accuracy: 0.9842131  Vali weighted F1: 0.9842545  Vali macro F1 0.9764648 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 6.503072738647461
VALI: Epoch: 39, Steps: 72 | Train Loss: 0.0108940  Vali Loss: 0.0493577 Vali Accuracy: 0.9847065  Vali weighted F1: 0.9847506  Vali macro F1 0.9772595 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 40 cost time: 6.491009712219238
VALI: Epoch: 40, Steps: 72 | Train Loss: 0.0107628  Vali Loss: 0.0493639 Vali Accuracy: 0.9847065  Vali weighted F1: 0.9847506  Vali macro F1 0.9772595 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 6.491394758224487
VALI: Epoch: 41, Steps: 72 | Train Loss: 0.0099626  Vali Loss: 0.0493639 Vali Accuracy: 0.9847065  Vali weighted F1: 0.9847506  Vali macro F1 0.9772595 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 6.498376131057739
VALI: Epoch: 42, Steps: 72 | Train Loss: 0.0095119  Vali Loss: 0.0493512 Vali Accuracy: 0.9847065  Vali weighted F1: 0.9847506  Vali macro F1 0.9772595 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 6.51338267326355
VALI: Epoch: 43, Steps: 72 | Train Loss: 0.0097159  Vali Loss: 0.0493404 Vali Accuracy: 0.9847065  Vali weighted F1: 0.9847506  Vali macro F1 0.9772595 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 44 cost time: 6.506930589675903
VALI: Epoch: 44, Steps: 72 | Train Loss: 0.0096842  Vali Loss: 0.0493456 Vali Accuracy: 0.9847065  Vali weighted F1: 0.9847506  Vali macro F1 0.9772595 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.8640367  Test weighted F1: 0.8514207  Test macro F1 0.6416559 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 240495
pruned model Parameter : 244174
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.56745171546936
Fine Tuning VALI: Epoch: 1, Steps: 72 | Train Loss: 0.0130208  Vali Loss: 0.0493339 Vali Accuracy: 0.9847065  Vali weighted F1: 0.9847283  Vali macro F1 0.9774041 
Validation loss decreased (inf --> 0.049334).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.507815361022949
Fine Tuning VALI: Epoch: 2, Steps: 72 | Train Loss: 0.0110792  Vali Loss: 0.0503098 Vali Accuracy: 0.9851998  Vali weighted F1: 0.9852134  Vali macro F1 0.9783367 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.504193067550659
Fine Tuning VALI: Epoch: 3, Steps: 72 | Train Loss: 0.0113768  Vali Loss: 0.0481111 Vali Accuracy: 0.9851998  Vali weighted F1: 0.9852382  Vali macro F1 0.9780302 
new best score!!!!
Validation loss decreased (0.049334 --> 0.048111).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.498638391494751
Fine Tuning VALI: Epoch: 4, Steps: 72 | Train Loss: 0.0112428  Vali Loss: 0.0502562 Vali Accuracy: 0.9851998  Vali weighted F1: 0.9852308  Vali macro F1 0.9780067 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.503063678741455
Fine Tuning VALI: Epoch: 5, Steps: 72 | Train Loss: 0.0100962  Vali Loss: 0.0495774 Vali Accuracy: 0.9837198  Vali weighted F1: 0.9837644  Vali macro F1 0.9748425 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 6.509939193725586
Fine Tuning VALI: Epoch: 6, Steps: 72 | Train Loss: 0.0096560  Vali Loss: 0.0529117 Vali Accuracy: 0.9847065  Vali weighted F1: 0.9847257  Vali macro F1 0.9771567 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 6.526773452758789
Fine Tuning VALI: Epoch: 7, Steps: 72 | Train Loss: 0.0110058  Vali Loss: 0.0550768 Vali Accuracy: 0.9842131  Vali weighted F1: 0.9842573  Vali macro F1 0.9768837 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 8 cost time: 6.538388729095459
Fine Tuning VALI: Epoch: 8, Steps: 72 | Train Loss: 0.0096069  Vali Loss: 0.0516815 Vali Accuracy: 0.9842131  Vali weighted F1: 0.9842466  Vali macro F1 0.9764395 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 9 cost time: 6.541618824005127
Fine Tuning VALI: Epoch: 9, Steps: 72 | Train Loss: 0.0082274  Vali Loss: 0.0523189 Vali Accuracy: 0.9847065  Vali weighted F1: 0.9847263  Vali macro F1 0.9760371 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.552624225616455
Fine Tuning VALI: Epoch: 10, Steps: 72 | Train Loss: 0.0077962  Vali Loss: 0.0524275 Vali Accuracy: 0.9851998  Vali weighted F1: 0.9852226  Vali macro F1 0.9768321 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 6.5185370445251465
Fine Tuning VALI: Epoch: 11, Steps: 72 | Train Loss: 0.0079661  Vali Loss: 0.0529597 Vali Accuracy: 0.9851998  Vali weighted F1: 0.9852278  Vali macro F1 0.9777818 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 6.515143871307373
Fine Tuning VALI: Epoch: 12, Steps: 72 | Train Loss: 0.0084368  Vali Loss: 0.0527002 Vali Accuracy: 0.9861865  Vali weighted F1: 0.9861853  Vali macro F1 0.9800016 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 6.511505126953125
Fine Tuning VALI: Epoch: 13, Steps: 72 | Train Loss: 0.0073985  Vali Loss: 0.0514004 Vali Accuracy: 0.9851998  Vali weighted F1: 0.9852282  Vali macro F1 0.9771986 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 14 cost time: 6.517793416976929
Fine Tuning VALI: Epoch: 14, Steps: 72 | Train Loss: 0.0065808  Vali Loss: 0.0510097 Vali Accuracy: 0.9847065  Vali weighted F1: 0.9847513  Vali macro F1 0.9760850 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 6.526810646057129
Fine Tuning VALI: Epoch: 15, Steps: 72 | Train Loss: 0.0070013  Vali Loss: 0.0519233 Vali Accuracy: 0.9842131  Vali weighted F1: 0.9842451  Vali macro F1 0.9752871 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 6.522055387496948
Fine Tuning VALI: Epoch: 16, Steps: 72 | Train Loss: 0.0063529  Vali Loss: 0.0519248 Vali Accuracy: 0.9847065  Vali weighted F1: 0.9847338  Vali macro F1 0.9760593 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 6.5308942794799805
Fine Tuning VALI: Epoch: 17, Steps: 72 | Train Loss: 0.0069205  Vali Loss: 0.0515453 Vali Accuracy: 0.9847065  Vali weighted F1: 0.9847420  Vali macro F1 0.9757555 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 6.534021615982056
Fine Tuning VALI: Epoch: 18, Steps: 72 | Train Loss: 0.0061947  Vali Loss: 0.0516803 Vali Accuracy: 0.9847065  Vali weighted F1: 0.9847338  Vali macro F1 0.9760593 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.8563454  Test weighted F1: 0.8447399  Test macro F1 0.6392056 
================ the 7 th CV Experiment ================ 
Leave one Out Experiment : The 8 Part as the test
[-] Target sampling weights:  [0.00014443 0.00016863 0.00100908 0.00133333 0.00050075 0.00063331]
Train data number :  18171
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2019
Test data number :  8450
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.479493141174316
VALI: Epoch: 1, Steps: 71 | Train Loss: 0.9593234  Vali Loss: 0.5113707 Vali Accuracy: 0.8192174  Vali weighted F1: 0.7995246  Vali macro F1 0.7165824 
Validation loss decreased (inf --> 0.511371).  Saving model ...
Epoch: 2 cost time: 6.480695486068726
VALI: Epoch: 2, Steps: 71 | Train Loss: 0.4303443  Vali Loss: 0.3273620 Vali Accuracy: 0.8890540  Vali weighted F1: 0.8809095  Vali macro F1 0.8350345 
new best score!!!!
Validation loss decreased (0.511371 --> 0.327362).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.47359561920166
VALI: Epoch: 3, Steps: 71 | Train Loss: 0.2693733  Vali Loss: 0.2201240 Vali Accuracy: 0.9257058  Vali weighted F1: 0.9235812  Vali macro F1 0.8909625 
new best score!!!!
Validation loss decreased (0.327362 --> 0.220124).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.47004508972168
VALI: Epoch: 4, Steps: 71 | Train Loss: 0.2012526  Vali Loss: 0.1761609 Vali Accuracy: 0.9395740  Vali weighted F1: 0.9396410  Vali macro F1 0.9102539 
new best score!!!!
Validation loss decreased (0.220124 --> 0.176161).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.484980583190918
VALI: Epoch: 5, Steps: 71 | Train Loss: 0.1769219  Vali Loss: 0.1561727 Vali Accuracy: 0.9489846  Vali weighted F1: 0.9489367  Vali macro F1 0.9282102 
new best score!!!!
Validation loss decreased (0.176161 --> 0.156173).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.480252742767334
VALI: Epoch: 6, Steps: 71 | Train Loss: 0.1619342  Vali Loss: 0.1394792 Vali Accuracy: 0.9514611  Vali weighted F1: 0.9508446  Vali macro F1 0.9301529 
new best score!!!!
Validation loss decreased (0.156173 --> 0.139479).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.490053415298462
VALI: Epoch: 7, Steps: 71 | Train Loss: 0.1280538  Vali Loss: 0.1175890 Vali Accuracy: 0.9574047  Vali weighted F1: 0.9568445  Vali macro F1 0.9375958 
new best score!!!!
Validation loss decreased (0.139479 --> 0.117589).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 6.506401300430298
VALI: Epoch: 8, Steps: 71 | Train Loss: 0.1118681  Vali Loss: 0.1060228 Vali Accuracy: 0.9628529  Vali weighted F1: 0.9625944  Vali macro F1 0.9440997 
new best score!!!!
Validation loss decreased (0.117589 --> 0.106023).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.5075905323028564
VALI: Epoch: 9, Steps: 71 | Train Loss: 0.1065540  Vali Loss: 0.0938971 Vali Accuracy: 0.9673105  Vali weighted F1: 0.9675650  Vali macro F1 0.9488967 
new best score!!!!
Validation loss decreased (0.106023 --> 0.093897).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.510731935501099
VALI: Epoch: 10, Steps: 71 | Train Loss: 0.0952979  Vali Loss: 0.0919692 Vali Accuracy: 0.9658247  Vali weighted F1: 0.9657323  Vali macro F1 0.9497813 
new best score!!!!
Validation loss decreased (0.093897 --> 0.091969).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 6.487162113189697
VALI: Epoch: 11, Steps: 71 | Train Loss: 0.0871167  Vali Loss: 0.1003809 Vali Accuracy: 0.9663200  Vali weighted F1: 0.9660965  Vali macro F1 0.9513051 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 6.481100797653198
VALI: Epoch: 12, Steps: 71 | Train Loss: 0.0785484  Vali Loss: 0.0786417 Vali Accuracy: 0.9742447  Vali weighted F1: 0.9742904  Vali macro F1 0.9620397 
new best score!!!!
Validation loss decreased (0.091969 --> 0.078642).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.489519834518433
VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0713485  Vali Loss: 0.0925735 Vali Accuracy: 0.9687964  Vali weighted F1: 0.9682109  Vali macro F1 0.9554815 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 6.4921348094940186
VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0687316  Vali Loss: 0.0826507 Vali Accuracy: 0.9747400  Vali weighted F1: 0.9744793  Vali macro F1 0.9623659 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 15 cost time: 6.479344129562378
VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0581782  Vali Loss: 0.0919234 Vali Accuracy: 0.9658247  Vali weighted F1: 0.9652483  Vali macro F1 0.9525150 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 16 cost time: 6.487204551696777
VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0578582  Vali Loss: 0.0655986 Vali Accuracy: 0.9796929  Vali weighted F1: 0.9798050  Vali macro F1 0.9690538 
new best score!!!!
Validation loss decreased (0.078642 --> 0.065599).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.497893333435059
VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0462425  Vali Loss: 0.0726981 Vali Accuracy: 0.9772164  Vali weighted F1: 0.9771970  Vali macro F1 0.9634903 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 6.48077917098999
VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0474847  Vali Loss: 0.0920738 Vali Accuracy: 0.9683011  Vali weighted F1: 0.9681813  Vali macro F1 0.9472326 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 7.001753807067871
VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0473710  Vali Loss: 0.0873069 Vali Accuracy: 0.9712729  Vali weighted F1: 0.9713498  Vali macro F1 0.9571828 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 20 cost time: 6.525610685348511
VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0537173  Vali Loss: 0.0799440 Vali Accuracy: 0.9752353  Vali weighted F1: 0.9753036  Vali macro F1 0.9619691 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 21 cost time: 6.473009824752808
VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0382690  Vali Loss: 0.0810332 Vali Accuracy: 0.9767211  Vali weighted F1: 0.9765721  Vali macro F1 0.9663943 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 22 cost time: 6.4853668212890625
VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0250424  Vali Loss: 0.0567547 Vali Accuracy: 0.9816741  Vali weighted F1: 0.9817387  Vali macro F1 0.9707982 
new best score!!!!
Validation loss decreased (0.065599 --> 0.056755).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.47640323638916
VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0216742  Vali Loss: 0.0558290 Vali Accuracy: 0.9811788  Vali weighted F1: 0.9813216  Vali macro F1 0.9719538 
new best score!!!!
Validation loss decreased (0.056755 --> 0.055829).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 6.474945306777954
VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0208909  Vali Loss: 0.0558222 Vali Accuracy: 0.9821694  Vali weighted F1: 0.9822816  Vali macro F1 0.9723534 
new best score!!!!
Validation loss decreased (0.055829 --> 0.055822).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.477227687835693
VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0198337  Vali Loss: 0.0572928 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9827235  Vali macro F1 0.9724406 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 6.494927644729614
VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0199934  Vali Loss: 0.0572995 Vali Accuracy: 0.9816741  Vali weighted F1: 0.9817212  Vali macro F1 0.9710327 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 6.47600245475769
VALI: Epoch: 27, Steps: 71 | Train Loss: 0.0183146  Vali Loss: 0.0567914 Vali Accuracy: 0.9811788  Vali weighted F1: 0.9812898  Vali macro F1 0.9703837 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 28 cost time: 6.496248245239258
VALI: Epoch: 28, Steps: 71 | Train Loss: 0.0168765  Vali Loss: 0.0576012 Vali Accuracy: 0.9811788  Vali weighted F1: 0.9812723  Vali macro F1 0.9705863 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 29 cost time: 6.482207775115967
VALI: Epoch: 29, Steps: 71 | Train Loss: 0.0180820  Vali Loss: 0.0586714 Vali Accuracy: 0.9796929  Vali weighted F1: 0.9798262  Vali macro F1 0.9688253 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 30 cost time: 6.488664150238037
VALI: Epoch: 30, Steps: 71 | Train Loss: 0.0165437  Vali Loss: 0.0576312 Vali Accuracy: 0.9811788  Vali weighted F1: 0.9812592  Vali macro F1 0.9702495 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 6.482829809188843
VALI: Epoch: 31, Steps: 71 | Train Loss: 0.0166268  Vali Loss: 0.0581272 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9807663  Vali macro F1 0.9694269 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 6.4739670753479
VALI: Epoch: 32, Steps: 71 | Train Loss: 0.0163820  Vali Loss: 0.0569625 Vali Accuracy: 0.9816741  Vali weighted F1: 0.9817687  Vali macro F1 0.9708568 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 6.48176121711731
VALI: Epoch: 33, Steps: 71 | Train Loss: 0.0163824  Vali Loss: 0.0569817 Vali Accuracy: 0.9821694  Vali weighted F1: 0.9822307  Vali macro F1 0.9715341 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 34 cost time: 6.476365089416504
VALI: Epoch: 34, Steps: 71 | Train Loss: 0.0160021  Vali Loss: 0.0569373 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9827264  Vali macro F1 0.9732366 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 35 cost time: 6.496685028076172
VALI: Epoch: 35, Steps: 71 | Train Loss: 0.0166807  Vali Loss: 0.0569524 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9827264  Vali macro F1 0.9732366 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 6.480356454849243
VALI: Epoch: 36, Steps: 71 | Train Loss: 0.0160296  Vali Loss: 0.0569857 Vali Accuracy: 0.9826647  Vali weighted F1: 0.9827264  Vali macro F1 0.9732366 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 6.493633270263672
VALI: Epoch: 37, Steps: 71 | Train Loss: 0.0160658  Vali Loss: 0.0569891 Vali Accuracy: 0.9821694  Vali weighted F1: 0.9822307  Vali macro F1 0.9715341 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 6.474830865859985
VALI: Epoch: 38, Steps: 71 | Train Loss: 0.0163863  Vali Loss: 0.0570338 Vali Accuracy: 0.9816741  Vali weighted F1: 0.9817512  Vali macro F1 0.9710596 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 6.476071834564209
VALI: Epoch: 39, Steps: 71 | Train Loss: 0.0154174  Vali Loss: 0.0570446 Vali Accuracy: 0.9816741  Vali weighted F1: 0.9817512  Vali macro F1 0.9710596 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.7985799  Test weighted F1: 0.8006020  Test macro F1 0.7862060 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 240495
pruned model Parameter : 244174
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.616931915283203
Fine Tuning VALI: Epoch: 1, Steps: 71 | Train Loss: 0.0207096  Vali Loss: 0.0581143 Vali Accuracy: 0.9811788  Vali weighted F1: 0.9813216  Vali macro F1 0.9719538 
Validation loss decreased (inf --> 0.058114).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.672137975692749
Fine Tuning VALI: Epoch: 2, Steps: 71 | Train Loss: 0.0185653  Vali Loss: 0.0578856 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9803163  Vali macro F1 0.9696438 
new best score!!!!
Validation loss decreased (0.058114 --> 0.057886).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 6.555867671966553
Fine Tuning VALI: Epoch: 3, Steps: 71 | Train Loss: 0.0168207  Vali Loss: 0.0556109 Vali Accuracy: 0.9841506  Vali weighted F1: 0.9842145  Vali macro F1 0.9760261 
new best score!!!!
Validation loss decreased (0.057886 --> 0.055611).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.532569885253906
Fine Tuning VALI: Epoch: 4, Steps: 71 | Train Loss: 0.0163805  Vali Loss: 0.0556246 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9837243  Vali macro F1 0.9736785 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.6413257122039795
Fine Tuning VALI: Epoch: 5, Steps: 71 | Train Loss: 0.0156329  Vali Loss: 0.0585450 Vali Accuracy: 0.9811788  Vali weighted F1: 0.9812787  Vali macro F1 0.9697299 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 6.547871828079224
Fine Tuning VALI: Epoch: 6, Steps: 71 | Train Loss: 0.0166616  Vali Loss: 0.0648342 Vali Accuracy: 0.9787023  Vali weighted F1: 0.9788836  Vali macro F1 0.9676362 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 6.5294740200042725
Fine Tuning VALI: Epoch: 7, Steps: 71 | Train Loss: 0.0166177  Vali Loss: 0.0586146 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9802529  Vali macro F1 0.9680061 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 8 cost time: 6.5158984661102295
Fine Tuning VALI: Epoch: 8, Steps: 71 | Train Loss: 0.0146713  Vali Loss: 0.0584165 Vali Accuracy: 0.9831600  Vali weighted F1: 0.9832164  Vali macro F1 0.9740336 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 9 cost time: 6.543499946594238
Fine Tuning VALI: Epoch: 9, Steps: 71 | Train Loss: 0.0138007  Vali Loss: 0.0579322 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9807970  Vali macro F1 0.9709319 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.52061653137207
Fine Tuning VALI: Epoch: 10, Steps: 71 | Train Loss: 0.0135812  Vali Loss: 0.0585872 Vali Accuracy: 0.9811788  Vali weighted F1: 0.9812733  Vali macro F1 0.9714659 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 6.53001856803894
Fine Tuning VALI: Epoch: 11, Steps: 71 | Train Loss: 0.0140770  Vali Loss: 0.0587716 Vali Accuracy: 0.9801882  Vali weighted F1: 0.9803384  Vali macro F1 0.9702502 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 6.535057783126831
Fine Tuning VALI: Epoch: 12, Steps: 71 | Train Loss: 0.0134795  Vali Loss: 0.0585392 Vali Accuracy: 0.9836553  Vali weighted F1: 0.9837086  Vali macro F1 0.9748452 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 6.533468008041382
Fine Tuning VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0119833  Vali Loss: 0.0595293 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9808168  Vali macro F1 0.9692713 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 14 cost time: 6.525415420532227
Fine Tuning VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0117978  Vali Loss: 0.0589062 Vali Accuracy: 0.9811788  Vali weighted F1: 0.9812840  Vali macro F1 0.9694086 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 6.523643970489502
Fine Tuning VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0103433  Vali Loss: 0.0579671 Vali Accuracy: 0.9816741  Vali weighted F1: 0.9817350  Vali macro F1 0.9697520 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 6.522972822189331
Fine Tuning VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0113298  Vali Loss: 0.0579398 Vali Accuracy: 0.9811788  Vali weighted F1: 0.9812545  Vali macro F1 0.9692760 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 6.540345907211304
Fine Tuning VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0114775  Vali Loss: 0.0560502 Vali Accuracy: 0.9816741  Vali weighted F1: 0.9817230  Vali macro F1 0.9709398 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 6.545647382736206
Fine Tuning VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0112057  Vali Loss: 0.0580886 Vali Accuracy: 0.9806835  Vali weighted F1: 0.9807920  Vali macro F1 0.9700372 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.7834320  Test weighted F1: 0.7871789  Test macro F1 0.7824161 
================ the 8 th CV Experiment ================ 
Leave one Out Experiment : The 9 Part as the test
[-] Target sampling weights:  [0.00014624 0.00017832 0.00108342 0.00132979 0.00049529 0.00062696]
Train data number :  17735
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  1971
Test data number :  10867
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.362130165100098
VALI: Epoch: 1, Steps: 70 | Train Loss: 0.9962468  Vali Loss: 0.5889880 Vali Accuracy: 0.7904617  Vali weighted F1: 0.7409496  Vali macro F1 0.6321074 
Validation loss decreased (inf --> 0.588988).  Saving model ...
Epoch: 2 cost time: 6.346740484237671
VALI: Epoch: 2, Steps: 70 | Train Loss: 0.4675520  Vali Loss: 0.4442596 Vali Accuracy: 0.8554033  Vali weighted F1: 0.8441736  Vali macro F1 0.8064202 
new best score!!!!
Validation loss decreased (0.588988 --> 0.444260).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.353194713592529
VALI: Epoch: 3, Steps: 70 | Train Loss: 0.3426608  Vali Loss: 0.2814762 Vali Accuracy: 0.9056317  Vali weighted F1: 0.9035570  Vali macro F1 0.8839706 
new best score!!!!
Validation loss decreased (0.444260 --> 0.281476).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.336015462875366
VALI: Epoch: 4, Steps: 70 | Train Loss: 0.2619833  Vali Loss: 0.2023397 Vali Accuracy: 0.9360731  Vali weighted F1: 0.9347281  Vali macro F1 0.9154201 
new best score!!!!
Validation loss decreased (0.281476 --> 0.202340).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.356955289840698
VALI: Epoch: 5, Steps: 70 | Train Loss: 0.1953650  Vali Loss: 0.1734700 Vali Accuracy: 0.9462202  Vali weighted F1: 0.9447789  Vali macro F1 0.9310720 
new best score!!!!
Validation loss decreased (0.202340 --> 0.173470).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.337788820266724
VALI: Epoch: 6, Steps: 70 | Train Loss: 0.1664617  Vali Loss: 0.1438324 Vali Accuracy: 0.9528158  Vali weighted F1: 0.9526018  Vali macro F1 0.9403420 
new best score!!!!
Validation loss decreased (0.173470 --> 0.143832).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.367226839065552
VALI: Epoch: 7, Steps: 70 | Train Loss: 0.1425965  Vali Loss: 0.1604593 Vali Accuracy: 0.9452055  Vali weighted F1: 0.9466202  Vali macro F1 0.9289517 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 8 cost time: 6.370724439620972
VALI: Epoch: 8, Steps: 70 | Train Loss: 0.1272345  Vali Loss: 0.1175609 Vali Accuracy: 0.9604262  Vali weighted F1: 0.9601021  Vali macro F1 0.9527566 
new best score!!!!
Validation loss decreased (0.143832 --> 0.117561).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.385593414306641
VALI: Epoch: 9, Steps: 70 | Train Loss: 0.1175251  Vali Loss: 0.1083802 Vali Accuracy: 0.9629630  Vali weighted F1: 0.9631332  Vali macro F1 0.9548704 
new best score!!!!
Validation loss decreased (0.117561 --> 0.108380).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.352591037750244
VALI: Epoch: 10, Steps: 70 | Train Loss: 0.1043050  Vali Loss: 0.1216272 Vali Accuracy: 0.9589041  Vali weighted F1: 0.9584050  Vali macro F1 0.9470231 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.34605073928833
VALI: Epoch: 11, Steps: 70 | Train Loss: 0.1018588  Vali Loss: 0.1112583 Vali Accuracy: 0.9629630  Vali weighted F1: 0.9625619  Vali macro F1 0.9520407 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 12 cost time: 6.344554901123047
VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0837745  Vali Loss: 0.1026973 Vali Accuracy: 0.9634703  Vali weighted F1: 0.9632317  Vali macro F1 0.9572757 
new best score!!!!
Validation loss decreased (0.108380 --> 0.102697).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 6.346760034561157
VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0765958  Vali Loss: 0.0826888 Vali Accuracy: 0.9685439  Vali weighted F1: 0.9686313  Vali macro F1 0.9636314 
new best score!!!!
Validation loss decreased (0.102697 --> 0.082689).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.339361190795898
VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0699837  Vali Loss: 0.0762638 Vali Accuracy: 0.9751395  Vali weighted F1: 0.9752411  Vali macro F1 0.9693513 
new best score!!!!
Validation loss decreased (0.082689 --> 0.076264).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 6.338275671005249
VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0650198  Vali Loss: 0.0857241 Vali Accuracy: 0.9705733  Vali weighted F1: 0.9709842  Vali macro F1 0.9628577 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 6.355374574661255
VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0582581  Vali Loss: 0.0687747 Vali Accuracy: 0.9766616  Vali weighted F1: 0.9766467  Vali macro F1 0.9695792 
new best score!!!!
Validation loss decreased (0.076264 --> 0.068775).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 6.38652777671814
VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0552153  Vali Loss: 0.0747831 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9775327  Vali macro F1 0.9727722 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 6.354233980178833
VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0497239  Vali Loss: 0.0616204 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9806392  Vali macro F1 0.9759112 
new best score!!!!
Validation loss decreased (0.068775 --> 0.061620).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 6.344738006591797
VALI: Epoch: 19, Steps: 70 | Train Loss: 0.0463006  Vali Loss: 0.0605769 Vali Accuracy: 0.9802131  Vali weighted F1: 0.9803735  Vali macro F1 0.9746481 
new best score!!!!
Validation loss decreased (0.061620 --> 0.060577).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.343058824539185
VALI: Epoch: 20, Steps: 70 | Train Loss: 0.0443024  Vali Loss: 0.0616846 Vali Accuracy: 0.9797057  Vali weighted F1: 0.9798836  Vali macro F1 0.9740735 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.34839940071106
VALI: Epoch: 21, Steps: 70 | Train Loss: 0.0390619  Vali Loss: 0.0659413 Vali Accuracy: 0.9786910  Vali weighted F1: 0.9785197  Vali macro F1 0.9737704 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 6.360020160675049
VALI: Epoch: 22, Steps: 70 | Train Loss: 0.0354915  Vali Loss: 0.0617442 Vali Accuracy: 0.9807204  Vali weighted F1: 0.9806017  Vali macro F1 0.9748578 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 23 cost time: 6.355114221572876
VALI: Epoch: 23, Steps: 70 | Train Loss: 0.0400800  Vali Loss: 0.0704634 Vali Accuracy: 0.9776763  Vali weighted F1: 0.9773980  Vali macro F1 0.9713564 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 24 cost time: 6.355759382247925
VALI: Epoch: 24, Steps: 70 | Train Loss: 0.0402835  Vali Loss: 0.0903711 Vali Accuracy: 0.9710807  Vali weighted F1: 0.9712849  Vali macro F1 0.9604699 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 25 cost time: 6.370941877365112
VALI: Epoch: 25, Steps: 70 | Train Loss: 0.0318069  Vali Loss: 0.0482991 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9857594  Vali macro F1 0.9820100 
new best score!!!!
Validation loss decreased (0.060577 --> 0.048299).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.3788161277771
VALI: Epoch: 26, Steps: 70 | Train Loss: 0.0219687  Vali Loss: 0.0468726 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842788  Vali macro F1 0.9808787 
new best score!!!!
Validation loss decreased (0.048299 --> 0.046873).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 6.353764772415161
VALI: Epoch: 27, Steps: 70 | Train Loss: 0.0207927  Vali Loss: 0.0480229 Vali Accuracy: 0.9837646  Vali weighted F1: 0.9837427  Vali macro F1 0.9800079 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 6.350186109542847
VALI: Epoch: 28, Steps: 70 | Train Loss: 0.0190865  Vali Loss: 0.0470881 Vali Accuracy: 0.9847793  Vali weighted F1: 0.9847992  Vali macro F1 0.9814004 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 6.363916397094727
VALI: Epoch: 29, Steps: 70 | Train Loss: 0.0193025  Vali Loss: 0.0467538 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853175  Vali macro F1 0.9818147 
new best score!!!!
Validation loss decreased (0.046873 --> 0.046754).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 6.350695371627808
VALI: Epoch: 30, Steps: 70 | Train Loss: 0.0185670  Vali Loss: 0.0452064 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9867890  Vali macro F1 0.9833421 
new best score!!!!
Validation loss decreased (0.046754 --> 0.045206).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 6.360627889633179
VALI: Epoch: 31, Steps: 70 | Train Loss: 0.0187413  Vali Loss: 0.0445867 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9852832  Vali macro F1 0.9816719 
new best score!!!!
Validation loss decreased (0.045206 --> 0.044587).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.344517469406128
VALI: Epoch: 32, Steps: 70 | Train Loss: 0.0173539  Vali Loss: 0.0445060 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9863329  Vali macro F1 0.9829690 
new best score!!!!
Validation loss decreased (0.044587 --> 0.044506).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 6.340994358062744
VALI: Epoch: 33, Steps: 70 | Train Loss: 0.0177326  Vali Loss: 0.0437217 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9868307  Vali macro F1 0.9835221 
new best score!!!!
Validation loss decreased (0.044506 --> 0.043722).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.371309041976929
VALI: Epoch: 34, Steps: 70 | Train Loss: 0.0175215  Vali Loss: 0.0434483 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9858131  Vali macro F1 0.9823834 
new best score!!!!
Validation loss decreased (0.043722 --> 0.043448).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 6.367201805114746
VALI: Epoch: 35, Steps: 70 | Train Loss: 0.0164795  Vali Loss: 0.0428972 Vali Accuracy: 0.9873161  Vali weighted F1: 0.9873139  Vali macro F1 0.9842510 
new best score!!!!
Validation loss decreased (0.043448 --> 0.042897).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 6.370301723480225
VALI: Epoch: 36, Steps: 70 | Train Loss: 0.0158978  Vali Loss: 0.0444409 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9857679  Vali macro F1 0.9830341 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 6.35510778427124
VALI: Epoch: 37, Steps: 70 | Train Loss: 0.0151615  Vali Loss: 0.0450145 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9862928  Vali macro F1 0.9828977 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 6.36431360244751
VALI: Epoch: 38, Steps: 70 | Train Loss: 0.0155200  Vali Loss: 0.0455798 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9868101  Vali macro F1 0.9833956 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 6.349888801574707
VALI: Epoch: 39, Steps: 70 | Train Loss: 0.0155487  Vali Loss: 0.0448771 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9868101  Vali macro F1 0.9833956 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 40 cost time: 6.350475072860718
VALI: Epoch: 40, Steps: 70 | Train Loss: 0.0143442  Vali Loss: 0.0458503 Vali Accuracy: 0.9888382  Vali weighted F1: 0.9888460  Vali macro F1 0.9857987 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 41 cost time: 6.3512468338012695
VALI: Epoch: 41, Steps: 70 | Train Loss: 0.0141437  Vali Loss: 0.0447537 Vali Accuracy: 0.9878234  Vali weighted F1: 0.9878332  Vali macro F1 0.9847449 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 6.355998754501343
VALI: Epoch: 42, Steps: 70 | Train Loss: 0.0137322  Vali Loss: 0.0441106 Vali Accuracy: 0.9878234  Vali weighted F1: 0.9878433  Vali macro F1 0.9844273 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 6.3808512687683105
VALI: Epoch: 43, Steps: 70 | Train Loss: 0.0132739  Vali Loss: 0.0440415 Vali Accuracy: 0.9878234  Vali weighted F1: 0.9878311  Vali macro F1 0.9848156 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 6.3783118724823
VALI: Epoch: 44, Steps: 70 | Train Loss: 0.0135122  Vali Loss: 0.0438501 Vali Accuracy: 0.9878234  Vali weighted F1: 0.9878433  Vali macro F1 0.9844273 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 45 cost time: 6.355472803115845
VALI: Epoch: 45, Steps: 70 | Train Loss: 0.0129539  Vali Loss: 0.0439293 Vali Accuracy: 0.9878234  Vali weighted F1: 0.9878433  Vali macro F1 0.9844273 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 46 cost time: 6.34775447845459
VALI: Epoch: 46, Steps: 70 | Train Loss: 0.0133547  Vali Loss: 0.0439264 Vali Accuracy: 0.9878234  Vali weighted F1: 0.9878433  Vali macro F1 0.9844273 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 6.342679500579834
VALI: Epoch: 47, Steps: 70 | Train Loss: 0.0142808  Vali Loss: 0.0438916 Vali Accuracy: 0.9878234  Vali weighted F1: 0.9878433  Vali macro F1 0.9844273 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 48 cost time: 6.348350763320923
VALI: Epoch: 48, Steps: 70 | Train Loss: 0.0129844  Vali Loss: 0.0438607 Vali Accuracy: 0.9878234  Vali weighted F1: 0.9878433  Vali macro F1 0.9844273 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 49 cost time: 6.344873428344727
VALI: Epoch: 49, Steps: 70 | Train Loss: 0.0136535  Vali Loss: 0.0438384 Vali Accuracy: 0.9878234  Vali weighted F1: 0.9878433  Vali macro F1 0.9844273 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 50 cost time: 6.356525897979736
VALI: Epoch: 50, Steps: 70 | Train Loss: 0.0143094  Vali Loss: 0.0438390 Vali Accuracy: 0.9878234  Vali weighted F1: 0.9878433  Vali macro F1 0.9844273 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9327321  Test weighted F1: 0.9330663  Test macro F1 0.8819682 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 240495
pruned model Parameter : 244174
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.377666234970093
Fine Tuning VALI: Epoch: 1, Steps: 70 | Train Loss: 0.0165265  Vali Loss: 0.0454125 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9868204  Vali macro F1 0.9836697 
Validation loss decreased (inf --> 0.045413).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.3479108810424805
Fine Tuning VALI: Epoch: 2, Steps: 70 | Train Loss: 0.0158815  Vali Loss: 0.0471294 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9858134  Vali macro F1 0.9823628 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.363975763320923
Fine Tuning VALI: Epoch: 3, Steps: 70 | Train Loss: 0.0154230  Vali Loss: 0.0435581 Vali Accuracy: 0.9883308  Vali weighted F1: 0.9883778  Vali macro F1 0.9850264 
new best score!!!!
Validation loss decreased (0.045413 --> 0.043558).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 6.353250503540039
Fine Tuning VALI: Epoch: 4, Steps: 70 | Train Loss: 0.0152653  Vali Loss: 0.0503157 Vali Accuracy: 0.9842719  Vali weighted F1: 0.9842031  Vali macro F1 0.9810320 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 6.3569488525390625
Fine Tuning VALI: Epoch: 5, Steps: 70 | Train Loss: 0.0138991  Vali Loss: 0.0502000 Vali Accuracy: 0.9852867  Vali weighted F1: 0.9853051  Vali macro F1 0.9804455 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 6.360584020614624
Fine Tuning VALI: Epoch: 6, Steps: 70 | Train Loss: 0.0138196  Vali Loss: 0.0486165 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9857398  Vali macro F1 0.9826073 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 6.357254981994629
Fine Tuning VALI: Epoch: 7, Steps: 70 | Train Loss: 0.0152312  Vali Loss: 0.0482374 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9857284  Vali macro F1 0.9833424 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 8 cost time: 6.358346700668335
Fine Tuning VALI: Epoch: 8, Steps: 70 | Train Loss: 0.0133523  Vali Loss: 0.0443592 Vali Accuracy: 0.9878234  Vali weighted F1: 0.9878695  Vali macro F1 0.9852171 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 9 cost time: 6.3537070751190186
Fine Tuning VALI: Epoch: 9, Steps: 70 | Train Loss: 0.0132304  Vali Loss: 0.0438828 Vali Accuracy: 0.9873161  Vali weighted F1: 0.9873294  Vali macro F1 0.9850264 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 6.356288194656372
Fine Tuning VALI: Epoch: 10, Steps: 70 | Train Loss: 0.0116450  Vali Loss: 0.0468898 Vali Accuracy: 0.9857940  Vali weighted F1: 0.9858251  Vali macro F1 0.9827262 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 6.369879484176636
Fine Tuning VALI: Epoch: 11, Steps: 70 | Train Loss: 0.0116654  Vali Loss: 0.0469395 Vali Accuracy: 0.9868087  Vali weighted F1: 0.9868089  Vali macro F1 0.9833686 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 6.356367349624634
Fine Tuning VALI: Epoch: 12, Steps: 70 | Train Loss: 0.0116964  Vali Loss: 0.0445023 Vali Accuracy: 0.9888382  Vali weighted F1: 0.9888634  Vali macro F1 0.9864313 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 6.364455461502075
Fine Tuning VALI: Epoch: 13, Steps: 70 | Train Loss: 0.0132961  Vali Loss: 0.0478576 Vali Accuracy: 0.9863014  Vali weighted F1: 0.9862587  Vali macro F1 0.9837864 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 14 cost time: 6.407905578613281
Fine Tuning VALI: Epoch: 14, Steps: 70 | Train Loss: 0.0105278  Vali Loss: 0.0443480 Vali Accuracy: 0.9883308  Vali weighted F1: 0.9883491  Vali macro F1 0.9853527 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 6.515170335769653
Fine Tuning VALI: Epoch: 15, Steps: 70 | Train Loss: 0.0100948  Vali Loss: 0.0440143 Vali Accuracy: 0.9878234  Vali weighted F1: 0.9878408  Vali macro F1 0.9851100 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 6.3907482624053955
Fine Tuning VALI: Epoch: 16, Steps: 70 | Train Loss: 0.0098129  Vali Loss: 0.0442464 Vali Accuracy: 0.9883308  Vali weighted F1: 0.9883491  Vali macro F1 0.9853527 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 6.380978584289551
Fine Tuning VALI: Epoch: 17, Steps: 70 | Train Loss: 0.0102017  Vali Loss: 0.0441092 Vali Accuracy: 0.9883308  Vali weighted F1: 0.9883491  Vali macro F1 0.9853527 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 6.355838060379028
Fine Tuning VALI: Epoch: 18, Steps: 70 | Train Loss: 0.0094112  Vali Loss: 0.0439910 Vali Accuracy: 0.9888382  Vali weighted F1: 0.9888534  Vali macro F1 0.9861818 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9315358  Test weighted F1: 0.9318808  Test macro F1 0.8806025 
================ the 9 th CV Experiment ================ 
Leave one Out Experiment : The 10 Part as the test
[-] Target sampling weights:  [0.00013998 0.00018225 0.00103093 0.00127065 0.00049751 0.0005988 ]
Train data number :  18068
The number of classes is :  6
The input_length  is :  100
The channel_in is :  3
Validation data number :  2008
Test data number :  9022
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 6.451492547988892
VALI: Epoch: 1, Steps: 71 | Train Loss: 0.9987603  Vali Loss: 0.5553740 Vali Accuracy: 0.7998008  Vali weighted F1: 0.7687882  Vali macro F1 0.6609903 
Validation loss decreased (inf --> 0.555374).  Saving model ...
Epoch: 2 cost time: 6.43926215171814
VALI: Epoch: 2, Steps: 71 | Train Loss: 0.4333880  Vali Loss: 0.3698010 Vali Accuracy: 0.8695219  Vali weighted F1: 0.8616901  Vali macro F1 0.8363231 
new best score!!!!
Validation loss decreased (0.555374 --> 0.369801).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 6.453337907791138
VALI: Epoch: 3, Steps: 71 | Train Loss: 0.2754667  Vali Loss: 0.2357551 Vali Accuracy: 0.9183267  Vali weighted F1: 0.9172228  Vali macro F1 0.8930693 
new best score!!!!
Validation loss decreased (0.369801 --> 0.235755).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 6.489931106567383
VALI: Epoch: 4, Steps: 71 | Train Loss: 0.2060956  Vali Loss: 0.1792704 Vali Accuracy: 0.9382470  Vali weighted F1: 0.9381744  Vali macro F1 0.9180432 
new best score!!!!
Validation loss decreased (0.235755 --> 0.179270).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 6.4622602462768555
VALI: Epoch: 5, Steps: 71 | Train Loss: 0.1650437  Vali Loss: 0.1657985 Vali Accuracy: 0.9407371  Vali weighted F1: 0.9405286  Vali macro F1 0.9167309 
new best score!!!!
Validation loss decreased (0.179270 --> 0.165799).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 6.452972412109375
VALI: Epoch: 6, Steps: 71 | Train Loss: 0.1454875  Vali Loss: 0.1512516 Vali Accuracy: 0.9487052  Vali weighted F1: 0.9474810  Vali macro F1 0.9347216 
new best score!!!!
Validation loss decreased (0.165799 --> 0.151252).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 6.442559719085693
VALI: Epoch: 7, Steps: 71 | Train Loss: 0.1393500  Vali Loss: 0.1944087 Vali Accuracy: 0.9322709  Vali weighted F1: 0.9282794  Vali macro F1 0.9182585 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 8 cost time: 6.453058481216431
VALI: Epoch: 8, Steps: 71 | Train Loss: 0.1204874  Vali Loss: 0.1403441 Vali Accuracy: 0.9511952  Vali weighted F1: 0.9509680  Vali macro F1 0.9411439 
new best score!!!!
Validation loss decreased (0.151252 --> 0.140344).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 6.4550275802612305
VALI: Epoch: 9, Steps: 71 | Train Loss: 0.1033666  Vali Loss: 0.1132671 Vali Accuracy: 0.9616534  Vali weighted F1: 0.9610614  Vali macro F1 0.9524269 
new best score!!!!
Validation loss decreased (0.140344 --> 0.113267).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 6.444998264312744
VALI: Epoch: 10, Steps: 71 | Train Loss: 0.0973103  Vali Loss: 0.1157883 Vali Accuracy: 0.9596614  Vali weighted F1: 0.9596266  Vali macro F1 0.9499612 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 6.467031240463257
VALI: Epoch: 11, Steps: 71 | Train Loss: 0.0804024  Vali Loss: 0.1003251 Vali Accuracy: 0.9706175  Vali weighted F1: 0.9708873  Vali macro F1 0.9639686 
new best score!!!!
Validation loss decreased (0.113267 --> 0.100325).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 6.450555801391602
VALI: Epoch: 12, Steps: 71 | Train Loss: 0.0727531  Vali Loss: 0.1092036 Vali Accuracy: 0.9661355  Vali weighted F1: 0.9658850  Vali macro F1 0.9594476 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 6.450911045074463
VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0781992  Vali Loss: 0.0919223 Vali Accuracy: 0.9696215  Vali weighted F1: 0.9695545  Vali macro F1 0.9627392 
new best score!!!!
Validation loss decreased (0.100325 --> 0.091922).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 6.428845167160034
VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0710004  Vali Loss: 0.0959571 Vali Accuracy: 0.9686255  Vali weighted F1: 0.9682363  Vali macro F1 0.9618577 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 6.460582971572876
VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0699662  Vali Loss: 0.0781353 Vali Accuracy: 0.9760956  Vali weighted F1: 0.9760379  Vali macro F1 0.9724460 
new best score!!!!
Validation loss decreased (0.091922 --> 0.078135).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 6.4582860469818115
VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0602896  Vali Loss: 0.0781736 Vali Accuracy: 0.9775896  Vali weighted F1: 0.9775111  Vali macro F1 0.9738250 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 6.462517261505127
VALI: Epoch: 17, Steps: 71 | Train Loss: 0.0547761  Vali Loss: 0.0918436 Vali Accuracy: 0.9726096  Vali weighted F1: 0.9723472  Vali macro F1 0.9667846 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 6.466514587402344
VALI: Epoch: 18, Steps: 71 | Train Loss: 0.0480239  Vali Loss: 0.0789062 Vali Accuracy: 0.9760956  Vali weighted F1: 0.9759026  Vali macro F1 0.9717499 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 19 cost time: 6.460883378982544
VALI: Epoch: 19, Steps: 71 | Train Loss: 0.0436648  Vali Loss: 0.0730812 Vali Accuracy: 0.9800797  Vali weighted F1: 0.9801413  Vali macro F1 0.9752931 
new best score!!!!
Validation loss decreased (0.078135 --> 0.073081).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 6.47863507270813
VALI: Epoch: 20, Steps: 71 | Train Loss: 0.0503270  Vali Loss: 0.0770672 Vali Accuracy: 0.9790837  Vali weighted F1: 0.9792002  Vali macro F1 0.9754107 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 6.4560089111328125
VALI: Epoch: 21, Steps: 71 | Train Loss: 0.0381711  Vali Loss: 0.0810325 Vali Accuracy: 0.9780876  Vali weighted F1: 0.9779697  Vali macro F1 0.9742205 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 6.460505247116089
VALI: Epoch: 22, Steps: 71 | Train Loss: 0.0414408  Vali Loss: 0.0713813 Vali Accuracy: 0.9800797  Vali weighted F1: 0.9803235  Vali macro F1 0.9752974 
new best score!!!!
Validation loss decreased (0.073081 --> 0.071381).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 6.450368165969849
VALI: Epoch: 23, Steps: 71 | Train Loss: 0.0322114  Vali Loss: 0.0745596 Vali Accuracy: 0.9800797  Vali weighted F1: 0.9801630  Vali macro F1 0.9760625 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 6.451260805130005
VALI: Epoch: 24, Steps: 71 | Train Loss: 0.0342100  Vali Loss: 0.0649447 Vali Accuracy: 0.9800797  Vali weighted F1: 0.9800717  Vali macro F1 0.9762036 
new best score!!!!
Validation loss decreased (0.071381 --> 0.064945).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 6.461695909500122
VALI: Epoch: 25, Steps: 71 | Train Loss: 0.0309258  Vali Loss: 0.0620454 Vali Accuracy: 0.9820717  Vali weighted F1: 0.9821790  Vali macro F1 0.9779612 
new best score!!!!
Validation loss decreased (0.064945 --> 0.062045).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 6.44901442527771
VALI: Epoch: 26, Steps: 71 | Train Loss: 0.0285558  Vali Loss: 0.0797474 Vali Accuracy: 0.9736056  Vali weighted F1: 0.9736556  Vali macro F1 0.9664252 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 6.456223964691162
VALI: Epoch: 27, Steps: 71 | Train Loss: 0.0320725  Vali Loss: 0.0657947 Vali Accuracy: 0.9790837  Vali weighted F1: 0.9789965  Vali macro F1 0.9752915 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 6.4784932136535645
VALI: Epoch: 28, Steps: 71 | Train Loss: 0.0255849  Vali Loss: 0.0828684 Vali Accuracy: 0.9790837  Vali weighted F1: 0.9790886  Vali macro F1 0.9764650 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 29 cost time: 6.468909978866577
VALI: Epoch: 29, Steps: 71 | Train Loss: 0.0237364  Vali Loss: 0.0674567 Vali Accuracy: 0.9840637  Vali weighted F1: 0.9840918  Vali macro F1 0.9801812 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 30 cost time: 6.455444574356079
VALI: Epoch: 30, Steps: 71 | Train Loss: 0.0224208  Vali Loss: 0.0627703 Vali Accuracy: 0.9815737  Vali weighted F1: 0.9816423  Vali macro F1 0.9780217 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 31 cost time: 6.458920240402222
VALI: Epoch: 31, Steps: 71 | Train Loss: 0.0155019  Vali Loss: 0.0538268 Vali Accuracy: 0.9855578  Vali weighted F1: 0.9855909  Vali macro F1 0.9824457 
new best score!!!!
Validation loss decreased (0.062045 --> 0.053827).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 6.460693120956421
VALI: Epoch: 32, Steps: 71 | Train Loss: 0.0131993  Vali Loss: 0.0581469 Vali Accuracy: 0.9865538  Vali weighted F1: 0.9865732  Vali macro F1 0.9837169 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 6.4441022872924805
VALI: Epoch: 33, Steps: 71 | Train Loss: 0.0116931  Vali Loss: 0.0522034 Vali Accuracy: 0.9875498  Vali weighted F1: 0.9876074  Vali macro F1 0.9845669 
new best score!!!!
Validation loss decreased (0.053827 --> 0.052203).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 6.442846298217773
VALI: Epoch: 34, Steps: 71 | Train Loss: 0.0101525  Vali Loss: 0.0529520 Vali Accuracy: 0.9870518  Vali weighted F1: 0.9871156  Vali macro F1 0.9838037 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 6.462208271026611
VALI: Epoch: 35, Steps: 71 | Train Loss: 0.0106299  Vali Loss: 0.0522301 Vali Accuracy: 0.9870518  Vali weighted F1: 0.9871007  Vali macro F1 0.9841283 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 6.468985319137573
VALI: Epoch: 36, Steps: 71 | Train Loss: 0.0110823  Vali Loss: 0.0557558 Vali Accuracy: 0.9865538  Vali weighted F1: 0.9866075  Vali macro F1 0.9829817 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 6.477942228317261
VALI: Epoch: 37, Steps: 71 | Train Loss: 0.0098564  Vali Loss: 0.0547298 Vali Accuracy: 0.9875498  Vali weighted F1: 0.9875713  Vali macro F1 0.9846084 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 6.455920457839966
VALI: Epoch: 38, Steps: 71 | Train Loss: 0.0099151  Vali Loss: 0.0539833 Vali Accuracy: 0.9860558  Vali weighted F1: 0.9860978  Vali macro F1 0.9825392 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 39 cost time: 6.444003105163574
VALI: Epoch: 39, Steps: 71 | Train Loss: 0.0086843  Vali Loss: 0.0535898 Vali Accuracy: 0.9865538  Vali weighted F1: 0.9865941  Vali macro F1 0.9836538 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 6.456151723861694
VALI: Epoch: 40, Steps: 71 | Train Loss: 0.0089213  Vali Loss: 0.0533243 Vali Accuracy: 0.9865538  Vali weighted F1: 0.9865941  Vali macro F1 0.9836538 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 6.448753118515015
VALI: Epoch: 41, Steps: 71 | Train Loss: 0.0092357  Vali Loss: 0.0527976 Vali Accuracy: 0.9860558  Vali weighted F1: 0.9860975  Vali macro F1 0.9828714 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 6.43984317779541
VALI: Epoch: 42, Steps: 71 | Train Loss: 0.0084809  Vali Loss: 0.0528362 Vali Accuracy: 0.9860558  Vali weighted F1: 0.9860857  Vali macro F1 0.9832128 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 6.447272062301636
VALI: Epoch: 43, Steps: 71 | Train Loss: 0.0087278  Vali Loss: 0.0529467 Vali Accuracy: 0.9865538  Vali weighted F1: 0.9865769  Vali macro F1 0.9836289 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 44 cost time: 6.466730117797852
VALI: Epoch: 44, Steps: 71 | Train Loss: 0.0091576  Vali Loss: 0.0529935 Vali Accuracy: 0.9865538  Vali weighted F1: 0.9865769  Vali macro F1 0.9836289 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 6.475744009017944
VALI: Epoch: 45, Steps: 71 | Train Loss: 0.0086828  Vali Loss: 0.0530296 Vali Accuracy: 0.9865538  Vali weighted F1: 0.9865769  Vali macro F1 0.9836289 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 6.461838483810425
VALI: Epoch: 46, Steps: 71 | Train Loss: 0.0083692  Vali Loss: 0.0529977 Vali Accuracy: 0.9865538  Vali weighted F1: 0.9865769  Vali macro F1 0.9836289 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 6.443980693817139
VALI: Epoch: 47, Steps: 71 | Train Loss: 0.0092834  Vali Loss: 0.0530380 Vali Accuracy: 0.9865538  Vali weighted F1: 0.9865769  Vali macro F1 0.9836289 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 6.446886301040649
VALI: Epoch: 48, Steps: 71 | Train Loss: 0.0084296  Vali Loss: 0.0530901 Vali Accuracy: 0.9865538  Vali weighted F1: 0.9865769  Vali macro F1 0.9836289 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9278431  Test weighted F1: 0.9255146  Test macro F1 0.8669713 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 240495
pruned model Parameter : 244174
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 6.4837565422058105
Fine Tuning VALI: Epoch: 1, Steps: 71 | Train Loss: 0.0116214  Vali Loss: 0.0519869 Vali Accuracy: 0.9865538  Vali weighted F1: 0.9865908  Vali macro F1 0.9836729 
Validation loss decreased (inf --> 0.051987).  Saving model ...
Fine Tuning Epoch: 2 cost time: 6.4614012241363525
Fine Tuning VALI: Epoch: 2, Steps: 71 | Train Loss: 0.0107222  Vali Loss: 0.0531295 Vali Accuracy: 0.9870518  Vali weighted F1: 0.9871188  Vali macro F1 0.9842229 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 6.443744897842407
Fine Tuning VALI: Epoch: 3, Steps: 71 | Train Loss: 0.0106441  Vali Loss: 0.0545975 Vali Accuracy: 0.9855578  Vali weighted F1: 0.9855906  Vali macro F1 0.9824807 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 6.451951503753662
Fine Tuning VALI: Epoch: 4, Steps: 71 | Train Loss: 0.0093975  Vali Loss: 0.0575609 Vali Accuracy: 0.9855578  Vali weighted F1: 0.9855520  Vali macro F1 0.9828654 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 6.4546120166778564
Fine Tuning VALI: Epoch: 5, Steps: 71 | Train Loss: 0.0092367  Vali Loss: 0.0570886 Vali Accuracy: 0.9850598  Vali weighted F1: 0.9850973  Vali macro F1 0.9810195 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 6.4681396484375
Fine Tuning VALI: Epoch: 6, Steps: 71 | Train Loss: 0.0097382  Vali Loss: 0.0558759 Vali Accuracy: 0.9855578  Vali weighted F1: 0.9855893  Vali macro F1 0.9824304 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 6.454213857650757
Fine Tuning VALI: Epoch: 7, Steps: 71 | Train Loss: 0.0077575  Vali Loss: 0.0599401 Vali Accuracy: 0.9845618  Vali weighted F1: 0.9845646  Vali macro F1 0.9812183 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 6.459645748138428
Fine Tuning VALI: Epoch: 8, Steps: 71 | Train Loss: 0.0081506  Vali Loss: 0.0555762 Vali Accuracy: 0.9865538  Vali weighted F1: 0.9866110  Vali macro F1 0.9834162 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 6.457921504974365
Fine Tuning VALI: Epoch: 9, Steps: 71 | Train Loss: 0.0071379  Vali Loss: 0.0546598 Vali Accuracy: 0.9865538  Vali weighted F1: 0.9866131  Vali macro F1 0.9830353 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 6.4541614055633545
Fine Tuning VALI: Epoch: 10, Steps: 71 | Train Loss: 0.0074164  Vali Loss: 0.0564219 Vali Accuracy: 0.9865538  Vali weighted F1: 0.9866042  Vali macro F1 0.9833458 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 11 cost time: 6.448328495025635
Fine Tuning VALI: Epoch: 11, Steps: 71 | Train Loss: 0.0065726  Vali Loss: 0.0573844 Vali Accuracy: 0.9855578  Vali weighted F1: 0.9855775  Vali macro F1 0.9827359 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 6.441490173339844
Fine Tuning VALI: Epoch: 12, Steps: 71 | Train Loss: 0.0066441  Vali Loss: 0.0557382 Vali Accuracy: 0.9870518  Vali weighted F1: 0.9871007  Vali macro F1 0.9841283 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 6.461333990097046
Fine Tuning VALI: Epoch: 13, Steps: 71 | Train Loss: 0.0070020  Vali Loss: 0.0565913 Vali Accuracy: 0.9870518  Vali weighted F1: 0.9871007  Vali macro F1 0.9841283 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 6.471043109893799
Fine Tuning VALI: Epoch: 14, Steps: 71 | Train Loss: 0.0067902  Vali Loss: 0.0562014 Vali Accuracy: 0.9870518  Vali weighted F1: 0.9871007  Vali macro F1 0.9841283 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 6.468379497528076
Fine Tuning VALI: Epoch: 15, Steps: 71 | Train Loss: 0.0064397  Vali Loss: 0.0561664 Vali Accuracy: 0.9865538  Vali weighted F1: 0.9865934  Vali macro F1 0.9836886 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 16 cost time: 6.469139575958252
Fine Tuning VALI: Epoch: 16, Steps: 71 | Train Loss: 0.0069298  Vali Loss: 0.0561747 Vali Accuracy: 0.9865538  Vali weighted F1: 0.9865934  Vali macro F1 0.9836886 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9225227  Test weighted F1: 0.9204012  Test macro F1 0.8620071 

============================= JOB FEEDBACK =============================

NodeName=uc2n562
Job ID: 20948445
Cluster: uc2
User/Group: px3192/tm
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 20
CPU Utilized: 07:17:11
CPU Efficiency: 4.98% of 6-02:17:20 core-walltime
Job Wall-clock time: 07:18:52
Memory Utilized: 5.01 GB
Memory Efficiency: 0.00% of 0.00 MB
