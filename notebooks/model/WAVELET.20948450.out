Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 73347
Set the seed as :  1
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
================ SOCV Mode ====================
================ 5 CV ======================
================ the 0 th CV Experiment ================ 
Overlapping random Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.0027933  0.00240964 0.00243309 0.00330033 0.00526316 0.00581395
 0.00303951 0.00290698 0.00234742 0.00421941]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 2.330080986022949
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.2915179  Vali Loss: 2.2765035 Vali Accuracy: 0.1412429  Vali weighted F1: 0.0422943  Vali macro F1 0.0307239 
Validation loss decreased (inf --> 2.276504).  Saving model ...
Epoch: 2 cost time: 1.2440593242645264
VALI: Epoch: 2, Steps: 13 | Train Loss: 2.2456170  Vali Loss: 2.1973671 Vali Accuracy: 0.1638418  Vali weighted F1: 0.0930793  Vali macro F1 0.0850247 
new best score!!!!
Validation loss decreased (2.276504 --> 2.197367).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.240891695022583
VALI: Epoch: 3, Steps: 13 | Train Loss: 2.0467257  Vali Loss: 1.7667542 Vali Accuracy: 0.4548023  Vali weighted F1: 0.4226130  Vali macro F1 0.3942044 
new best score!!!!
Validation loss decreased (2.197367 --> 1.766754).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.2392890453338623
VALI: Epoch: 4, Steps: 13 | Train Loss: 1.6605723  Vali Loss: 1.3351895 Vali Accuracy: 0.5762712  Vali weighted F1: 0.5492266  Vali macro F1 0.5214816 
new best score!!!!
Validation loss decreased (1.766754 --> 1.335189).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.2419304847717285
VALI: Epoch: 5, Steps: 13 | Train Loss: 1.3265620  Vali Loss: 1.0818414 Vali Accuracy: 0.6581921  Vali weighted F1: 0.6502039  Vali macro F1 0.6274457 
new best score!!!!
Validation loss decreased (1.335189 --> 1.081841).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.2443444728851318
VALI: Epoch: 6, Steps: 13 | Train Loss: 1.0857127  Vali Loss: 0.8581610 Vali Accuracy: 0.7570621  Vali weighted F1: 0.7349622  Vali macro F1 0.6979088 
new best score!!!!
Validation loss decreased (1.081841 --> 0.858161).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.2428748607635498
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.8974526  Vali Loss: 0.7526693 Vali Accuracy: 0.7485876  Vali weighted F1: 0.7302102  Vali macro F1 0.6942183 
new best score!!!!
Validation loss decreased (0.858161 --> 0.752669).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.24312424659729
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.7736473  Vali Loss: 0.6267762 Vali Accuracy: 0.7740113  Vali weighted F1: 0.7519432  Vali macro F1 0.7150673 
new best score!!!!
Validation loss decreased (0.752669 --> 0.626776).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.243680715560913
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.6605577  Vali Loss: 0.5465100 Vali Accuracy: 0.8248588  Vali weighted F1: 0.8053685  Vali macro F1 0.7646705 
new best score!!!!
Validation loss decreased (0.626776 --> 0.546510).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.2438745498657227
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.5829113  Vali Loss: 0.4853039 Vali Accuracy: 0.8418079  Vali weighted F1: 0.8241624  Vali macro F1 0.7868993 
new best score!!!!
Validation loss decreased (0.546510 --> 0.485304).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.2457056045532227
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.5191511  Vali Loss: 0.4534115 Vali Accuracy: 0.8559322  Vali weighted F1: 0.8451193  Vali macro F1 0.8133926 
new best score!!!!
Validation loss decreased (0.485304 --> 0.453411).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.2481741905212402
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.4791955  Vali Loss: 0.4017888 Vali Accuracy: 0.8615819  Vali weighted F1: 0.8613497  Vali macro F1 0.8317837 
new best score!!!!
Validation loss decreased (0.453411 --> 0.401789).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.24723482131958
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.4476873  Vali Loss: 0.3759420 Vali Accuracy: 0.8813559  Vali weighted F1: 0.8779279  Vali macro F1 0.8580145 
new best score!!!!
Validation loss decreased (0.401789 --> 0.375942).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.247182846069336
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.4039396  Vali Loss: 0.3404643 Vali Accuracy: 0.8672316  Vali weighted F1: 0.8542321  Vali macro F1 0.8171111 
new best score!!!!
Validation loss decreased (0.375942 --> 0.340464).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.2486560344696045
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.3783525  Vali Loss: 0.3036384 Vali Accuracy: 0.8841808  Vali weighted F1: 0.8716886  Vali macro F1 0.8318042 
new best score!!!!
Validation loss decreased (0.340464 --> 0.303638).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.247520923614502
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.3464774  Vali Loss: 0.2924425 Vali Accuracy: 0.9039548  Vali weighted F1: 0.8927111  Vali macro F1 0.8550180 
new best score!!!!
Validation loss decreased (0.303638 --> 0.292443).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.2485554218292236
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.3332160  Vali Loss: 0.2722294 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9203162  Vali macro F1 0.9050180 
new best score!!!!
Validation loss decreased (0.292443 --> 0.272229).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.2413420677185059
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.3092141  Vali Loss: 0.2543534 Vali Accuracy: 0.9265537  Vali weighted F1: 0.9254482  Vali macro F1 0.9098667 
new best score!!!!
Validation loss decreased (0.272229 --> 0.254353).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.2370634078979492
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.2889271  Vali Loss: 0.2246944 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9179544  Vali macro F1 0.8866976 
new best score!!!!
Validation loss decreased (0.254353 --> 0.224694).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.238853931427002
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.2699866  Vali Loss: 0.2143774 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9157703  Vali macro F1 0.8833876 
new best score!!!!
Validation loss decreased (0.224694 --> 0.214377).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.2411808967590332
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.2544150  Vali Loss: 0.1951466 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9311694  Vali macro F1 0.9023555 
new best score!!!!
Validation loss decreased (0.214377 --> 0.195147).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.240135908126831
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.2405749  Vali Loss: 0.1835551 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9414876  Vali macro F1 0.9121431 
new best score!!!!
Validation loss decreased (0.195147 --> 0.183555).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.2400708198547363
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.2207082  Vali Loss: 0.1601021 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9488170  Vali macro F1 0.9223721 
new best score!!!!
Validation loss decreased (0.183555 --> 0.160102).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.2445411682128906
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.2092455  Vali Loss: 0.1646263 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9468427  Vali macro F1 0.9263061 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 1.2407619953155518
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.2020184  Vali Loss: 0.1545736 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9468368  Vali macro F1 0.9267245 
new best score!!!!
Validation loss decreased (0.160102 --> 0.154574).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.2393431663513184
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.1927704  Vali Loss: 0.1437918 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9477642  Vali macro F1 0.9258723 
new best score!!!!
Validation loss decreased (0.154574 --> 0.143792).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.2402076721191406
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.1783966  Vali Loss: 0.1228867 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9574905  Vali macro F1 0.9323458 
new best score!!!!
Validation loss decreased (0.143792 --> 0.122887).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 1.2428290843963623
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.1715170  Vali Loss: 0.1199930 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9688599  Vali macro F1 0.9549735 
new best score!!!!
Validation loss decreased (0.122887 --> 0.119993).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.240633487701416
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.1630298  Vali Loss: 0.1142850 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9626651  Vali macro F1 0.9441600 
new best score!!!!
Validation loss decreased (0.119993 --> 0.114285).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.245530366897583
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.1509265  Vali Loss: 0.1213226 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9563805  Vali macro F1 0.9404075 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 1.2412052154541016
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.1406174  Vali Loss: 0.1082620 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9743129  Vali macro F1 0.9647734 
new best score!!!!
Validation loss decreased (0.114285 --> 0.108262).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 1.2426462173461914
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.1292502  Vali Loss: 0.0956156 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9680144  Vali macro F1 0.9531618 
new best score!!!!
Validation loss decreased (0.108262 --> 0.095616).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 1.2420873641967773
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.1254325  Vali Loss: 0.0887808 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745018  Vali macro F1 0.9664859 
new best score!!!!
Validation loss decreased (0.095616 --> 0.088781).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 1.242762804031372
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.1244833  Vali Loss: 0.0824975 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9768426  Vali macro F1 0.9633535 
new best score!!!!
Validation loss decreased (0.088781 --> 0.082498).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.2436485290527344
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.1145494  Vali Loss: 0.0808435 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802327  Vali macro F1 0.9758405 
new best score!!!!
Validation loss decreased (0.082498 --> 0.080844).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 1.2465944290161133
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.1080211  Vali Loss: 0.0749442 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858381  Vali macro F1 0.9805019 
new best score!!!!
Validation loss decreased (0.080844 --> 0.074944).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 1.2430920600891113
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.1051815  Vali Loss: 0.0774643 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9772513  Vali macro F1 0.9716378 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 1.2410590648651123
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.1100473  Vali Loss: 0.0750862 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801479  Vali macro F1 0.9734821 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 1.2401490211486816
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0993523  Vali Loss: 0.0827981 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9685789  Vali macro F1 0.9580709 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 40 cost time: 1.2403087615966797
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.1036388  Vali Loss: 0.0644879 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829552  Vali macro F1 0.9755089 
new best score!!!!
Validation loss decreased (0.074944 --> 0.064488).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 1.2420551776885986
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0896647  Vali Loss: 0.0576162 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858341  Vali macro F1 0.9808073 
new best score!!!!
Validation loss decreased (0.064488 --> 0.057616).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 1.2456998825073242
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0960135  Vali Loss: 0.0676241 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9742276  Vali macro F1 0.9637071 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 1.2413506507873535
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0889966  Vali Loss: 0.0731886 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9744514  Vali macro F1 0.9712033 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 1.2429394721984863
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0839483  Vali Loss: 0.0567724 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858325  Vali macro F1 0.9837332 
new best score!!!!
Validation loss decreased (0.057616 --> 0.056772).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 1.2402305603027344
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0798509  Vali Loss: 0.0487877 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886635  Vali macro F1 0.9832802 
new best score!!!!
Validation loss decreased (0.056772 --> 0.048788).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 1.2407782077789307
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0729993  Vali Loss: 0.0519545 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858381  Vali macro F1 0.9805019 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 1.2391586303710938
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0681136  Vali Loss: 0.0580082 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801832  Vali macro F1 0.9757333 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 48 cost time: 1.2426786422729492
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0624900  Vali Loss: 0.0482326 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858480  Vali macro F1 0.9836870 
new best score!!!!
Validation loss decreased (0.048788 --> 0.048233).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 1.2407100200653076
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0610810  Vali Loss: 0.0439887 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886635  Vali macro F1 0.9832802 
new best score!!!!
Validation loss decreased (0.048233 --> 0.043989).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 1.239778995513916
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0550550  Vali Loss: 0.0449899 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801684  Vali macro F1 0.9760060 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 1.2395663261413574
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0564911  Vali Loss: 0.0517130 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801972  Vali macro F1 0.9780522 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 1.2411994934082031
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0571806  Vali Loss: 0.0447047 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886816  Vali macro F1 0.9878432 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 53 cost time: 1.2412643432617188
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0553306  Vali Loss: 0.0456449 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858645  Vali macro F1 0.9846057 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 54 cost time: 1.243525505065918
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0523610  Vali Loss: 0.0457731 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857976  Vali macro F1 0.9821444 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 55 cost time: 1.2405238151550293
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0533402  Vali Loss: 0.0439863 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886946  Vali macro F1 0.9859767 
new best score!!!!
Validation loss decreased (0.043989 --> 0.043986).  Saving model ...
new best score!!!!
Epoch: 56 cost time: 1.2421677112579346
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0461084  Vali Loss: 0.0444682 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886946  Vali macro F1 0.9859767 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 57 cost time: 1.2426049709320068
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0437090  Vali Loss: 0.0401584 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858498  Vali macro F1 0.9835570 
new best score!!!!
Validation loss decreased (0.043986 --> 0.040158).  Saving model ...
new best score!!!!
Epoch: 58 cost time: 1.241731882095337
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0476418  Vali Loss: 0.0430684 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886946  Vali macro F1 0.9859767 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 1.2427704334259033
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0426705  Vali Loss: 0.0417556 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886946  Vali macro F1 0.9859767 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 60 cost time: 1.2425603866577148
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0477266  Vali Loss: 0.0409132 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886946  Vali macro F1 0.9859767 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 61 cost time: 1.242692232131958
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0439043  Vali Loss: 0.0396377 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886946  Vali macro F1 0.9859767 
new best score!!!!
Validation loss decreased (0.040158 --> 0.039638).  Saving model ...
new best score!!!!
Epoch: 62 cost time: 1.2416770458221436
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0433682  Vali Loss: 0.0389303 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886946  Vali macro F1 0.9859767 
new best score!!!!
Validation loss decreased (0.039638 --> 0.038930).  Saving model ...
new best score!!!!
Epoch: 63 cost time: 1.239673376083374
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0443533  Vali Loss: 0.0394888 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886946  Vali macro F1 0.9859767 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 64 cost time: 1.2404403686523438
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0432157  Vali Loss: 0.0396458 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886946  Vali macro F1 0.9859767 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 65 cost time: 1.238534688949585
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0433103  Vali Loss: 0.0403459 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886946  Vali macro F1 0.9859767 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 66 cost time: 1.2407166957855225
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0434677  Vali Loss: 0.0425983 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858498  Vali macro F1 0.9835570 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 67 cost time: 1.2407360076904297
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0442305  Vali Loss: 0.0411381 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830244  Vali macro F1 0.9807787 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 68 cost time: 1.2380595207214355
VALI: Epoch: 68, Steps: 13 | Train Loss: 0.0455424  Vali Loss: 0.0410619 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830244  Vali macro F1 0.9807787 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 69 cost time: 1.2398138046264648
VALI: Epoch: 69, Steps: 13 | Train Loss: 0.0427969  Vali Loss: 0.0409815 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858692  Vali macro F1 0.9831983 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 70 cost time: 1.2398622035980225
VALI: Epoch: 70, Steps: 13 | Train Loss: 0.0414374  Vali Loss: 0.0407276 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886946  Vali macro F1 0.9859767 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 71 cost time: 1.241210699081421
VALI: Epoch: 71, Steps: 13 | Train Loss: 0.0421331  Vali Loss: 0.0402869 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886946  Vali macro F1 0.9859767 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 72 cost time: 1.2401070594787598
VALI: Epoch: 72, Steps: 13 | Train Loss: 0.0430442  Vali Loss: 0.0402402 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886946  Vali macro F1 0.9859767 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 73 cost time: 1.242121934890747
VALI: Epoch: 73, Steps: 13 | Train Loss: 0.0393057  Vali Loss: 0.0402511 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886946  Vali macro F1 0.9859767 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 74 cost time: 1.2375712394714355
VALI: Epoch: 74, Steps: 13 | Train Loss: 0.0399030  Vali Loss: 0.0402641 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886946  Vali macro F1 0.9859767 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 75 cost time: 1.2383842468261719
VALI: Epoch: 75, Steps: 13 | Train Loss: 0.0403375  Vali Loss: 0.0402540 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886946  Vali macro F1 0.9859767 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 76 cost time: 1.2390532493591309
VALI: Epoch: 76, Steps: 13 | Train Loss: 0.0421839  Vali Loss: 0.0402563 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886946  Vali macro F1 0.9859767 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 77 cost time: 1.240553379058838
VALI: Epoch: 77, Steps: 13 | Train Loss: 0.0398464  Vali Loss: 0.0402650 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886946  Vali macro F1 0.9859767 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9852941  Test weighted F1: 0.9852883  Test macro F1 0.9831936 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 73347
pruned model Parameter : 76626
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.2645766735076904
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0460766  Vali Loss: 0.0442938 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858692  Vali macro F1 0.9831983 
Validation loss decreased (inf --> 0.044294).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.259265422821045
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0474412  Vali Loss: 0.0367465 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886946  Vali macro F1 0.9859767 
new best score!!!!
Validation loss decreased (0.044294 --> 0.036746).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 1.2600605487823486
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0446503  Vali Loss: 0.0385238 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886946  Vali macro F1 0.9859767 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 1.2639284133911133
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0439134  Vali Loss: 0.0399149 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858932  Vali macro F1 0.9835145 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 1.260073184967041
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0430982  Vali Loss: 0.0433163 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858932  Vali macro F1 0.9835145 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 1.2654058933258057
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0431748  Vali Loss: 0.0358479 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887293  Vali macro F1 0.9882953 
new best score!!!!
Validation loss decreased (0.036746 --> 0.035848).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 1.2599053382873535
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0435548  Vali Loss: 0.0370326 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858932  Vali macro F1 0.9835145 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 1.279662847518921
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0442475  Vali Loss: 0.0377641 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858932  Vali macro F1 0.9835145 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 1.2578821182250977
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0376959  Vali Loss: 0.0379916 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858932  Vali macro F1 0.9835145 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 1.2629194259643555
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0392162  Vali Loss: 0.0335727 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858932  Vali macro F1 0.9835145 
new best score!!!!
Validation loss decreased (0.035848 --> 0.033573).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 1.2604236602783203
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0385693  Vali Loss: 0.0336857 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858932  Vali macro F1 0.9835145 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 1.2632780075073242
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0425705  Vali Loss: 0.0347917 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886946  Vali macro F1 0.9859767 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 1.2606146335601807
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0396945  Vali Loss: 0.0354388 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887293  Vali macro F1 0.9882953 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 1.2609531879425049
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0387630  Vali Loss: 0.0386030 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858932  Vali macro F1 0.9835145 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 1.262136459350586
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0380736  Vali Loss: 0.0362531 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887293  Vali macro F1 0.9882953 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 16 cost time: 1.2637317180633545
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0389728  Vali Loss: 0.0376921 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858932  Vali macro F1 0.9835145 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 1.2642667293548584
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0355226  Vali Loss: 0.0322146 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858932  Vali macro F1 0.9835145 
new best score!!!!
Validation loss decreased (0.033573 --> 0.032215).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 18 cost time: 1.2635939121246338
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0359363  Vali Loss: 0.0316804 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858932  Vali macro F1 0.9835145 
new best score!!!!
Validation loss decreased (0.032215 --> 0.031680).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 1.2640957832336426
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0374088  Vali Loss: 0.0343283 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858932  Vali macro F1 0.9835145 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 1.2643682956695557
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0346536  Vali Loss: 0.0314551 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887293  Vali macro F1 0.9882953 
new best score!!!!
Validation loss decreased (0.031680 --> 0.031455).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 21 cost time: 1.2640504837036133
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0406439  Vali Loss: 0.0365442 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858932  Vali macro F1 0.9835145 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 1.2641010284423828
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0391950  Vali Loss: 0.0366004 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858932  Vali macro F1 0.9835145 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 1.2630982398986816
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0345611  Vali Loss: 0.0352566 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887293  Vali macro F1 0.9882953 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 1.2649617195129395
Fine Tuning VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0360529  Vali Loss: 0.0372094 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859039  Vali macro F1 0.9855170 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 25 cost time: 1.2645912170410156
Fine Tuning VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0354242  Vali Loss: 0.0358704 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887293  Vali macro F1 0.9882953 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 26 cost time: 1.2629063129425049
Fine Tuning VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0350171  Vali Loss: 0.0356557 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887293  Vali macro F1 0.9882953 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 27 cost time: 1.2611095905303955
Fine Tuning VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0345762  Vali Loss: 0.0356768 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887293  Vali macro F1 0.9882953 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 28 cost time: 1.2610182762145996
Fine Tuning VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0356471  Vali Loss: 0.0359136 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887293  Vali macro F1 0.9882953 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 29 cost time: 1.2611100673675537
Fine Tuning VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0351260  Vali Loss: 0.0362644 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887293  Vali macro F1 0.9882953 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 30 cost time: 1.2606182098388672
Fine Tuning VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0345398  Vali Loss: 0.0360100 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887293  Vali macro F1 0.9882953 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 31 cost time: 1.2612178325653076
Fine Tuning VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0336172  Vali Loss: 0.0359381 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887293  Vali macro F1 0.9882953 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 32 cost time: 1.2644178867340088
Fine Tuning VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0322793  Vali Loss: 0.0359150 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887293  Vali macro F1 0.9882953 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 33 cost time: 1.2614614963531494
Fine Tuning VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0343908  Vali Loss: 0.0358911 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887293  Vali macro F1 0.9882953 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 34 cost time: 1.2624390125274658
Fine Tuning VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0364377  Vali Loss: 0.0358551 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887293  Vali macro F1 0.9882953 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 35 cost time: 1.2594106197357178
Fine Tuning VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0367119  Vali Loss: 0.0358194 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887293  Vali macro F1 0.9882953 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9852941  Test weighted F1: 0.9852883  Test macro F1 0.9831936 
================ the 1 th CV Experiment ================ 
Overlapping random Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00280112 0.00243902 0.00238095 0.00328947 0.00561798 0.00568182
 0.00304878 0.00282486 0.00238095 0.00420168]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.2423412799835205
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.2921286  Vali Loss: 2.2780953 Vali Accuracy: 0.1355932  Vali weighted F1: 0.0323805  Vali macro F1 0.0238806 
Validation loss decreased (inf --> 2.278095).  Saving model ...
Epoch: 2 cost time: 1.2461519241333008
VALI: Epoch: 2, Steps: 13 | Train Loss: 2.2460894  Vali Loss: 2.1964408 Vali Accuracy: 0.1920904  Vali weighted F1: 0.1145174  Vali macro F1 0.1059732 
new best score!!!!
Validation loss decreased (2.278095 --> 2.196441).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.2401628494262695
VALI: Epoch: 3, Steps: 13 | Train Loss: 2.0470612  Vali Loss: 1.7666858 Vali Accuracy: 0.4745763  Vali weighted F1: 0.4225788  Vali macro F1 0.3961472 
new best score!!!!
Validation loss decreased (2.196441 --> 1.766686).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.2381768226623535
VALI: Epoch: 4, Steps: 13 | Train Loss: 1.6495300  Vali Loss: 1.3289894 Vali Accuracy: 0.5508475  Vali weighted F1: 0.5227422  Vali macro F1 0.4937529 
new best score!!!!
Validation loss decreased (1.766686 --> 1.328989).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.2564985752105713
VALI: Epoch: 5, Steps: 13 | Train Loss: 1.3117945  Vali Loss: 1.0537441 Vali Accuracy: 0.7005650  Vali weighted F1: 0.6801352  Vali macro F1 0.6459449 
new best score!!!!
Validation loss decreased (1.328989 --> 1.053744).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.240762710571289
VALI: Epoch: 6, Steps: 13 | Train Loss: 1.0697200  Vali Loss: 0.8638934 Vali Accuracy: 0.7259887  Vali weighted F1: 0.7018167  Vali macro F1 0.6619600 
new best score!!!!
Validation loss decreased (1.053744 --> 0.863893).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.2417728900909424
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.8846889  Vali Loss: 0.7127108 Vali Accuracy: 0.7768362  Vali weighted F1: 0.7547104  Vali macro F1 0.7188936 
new best score!!!!
Validation loss decreased (0.863893 --> 0.712711).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.2402222156524658
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.7528586  Vali Loss: 0.6092639 Vali Accuracy: 0.8220339  Vali weighted F1: 0.8030946  Vali macro F1 0.7638221 
new best score!!!!
Validation loss decreased (0.712711 --> 0.609264).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.2399044036865234
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.6411323  Vali Loss: 0.5446921 Vali Accuracy: 0.8276836  Vali weighted F1: 0.8131236  Vali macro F1 0.7807969 
new best score!!!!
Validation loss decreased (0.609264 --> 0.544692).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.2381935119628906
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.5707688  Vali Loss: 0.4749103 Vali Accuracy: 0.8418079  Vali weighted F1: 0.8386066  Vali macro F1 0.8224742 
new best score!!!!
Validation loss decreased (0.544692 --> 0.474910).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.2382934093475342
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.5155188  Vali Loss: 0.4286139 Vali Accuracy: 0.8531073  Vali weighted F1: 0.8334587  Vali macro F1 0.7900864 
new best score!!!!
Validation loss decreased (0.474910 --> 0.428614).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.2398393154144287
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.4813525  Vali Loss: 0.4129376 Vali Accuracy: 0.8615819  Vali weighted F1: 0.8417558  Vali macro F1 0.7977339 
new best score!!!!
Validation loss decreased (0.428614 --> 0.412938).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.2399101257324219
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.4500598  Vali Loss: 0.3689838 Vali Accuracy: 0.8785311  Vali weighted F1: 0.8728509  Vali macro F1 0.8479652 
new best score!!!!
Validation loss decreased (0.412938 --> 0.368984).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.2415094375610352
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.4047919  Vali Loss: 0.3264058 Vali Accuracy: 0.8954802  Vali weighted F1: 0.8857981  Vali macro F1 0.8531663 
new best score!!!!
Validation loss decreased (0.368984 --> 0.326406).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.2404425144195557
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.3730901  Vali Loss: 0.2872135 Vali Accuracy: 0.8898305  Vali weighted F1: 0.8763878  Vali macro F1 0.8365459 
new best score!!!!
Validation loss decreased (0.326406 --> 0.287213).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.2443945407867432
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.3492846  Vali Loss: 0.2742942 Vali Accuracy: 0.8954802  Vali weighted F1: 0.8857727  Vali macro F1 0.8534711 
new best score!!!!
Validation loss decreased (0.287213 --> 0.274294).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.242706060409546
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.3213301  Vali Loss: 0.2431254 Vali Accuracy: 0.9124294  Vali weighted F1: 0.9050383  Vali macro F1 0.8729202 
new best score!!!!
Validation loss decreased (0.274294 --> 0.243125).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.2425730228424072
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.2924578  Vali Loss: 0.2251435 Vali Accuracy: 0.9180791  Vali weighted F1: 0.9084719  Vali macro F1 0.8736736 
new best score!!!!
Validation loss decreased (0.243125 --> 0.225143).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.2444758415222168
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.2786766  Vali Loss: 0.2241903 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9192840  Vali macro F1 0.8971461 
new best score!!!!
Validation loss decreased (0.225143 --> 0.224190).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.244901180267334
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.2596488  Vali Loss: 0.2021825 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9217117  Vali macro F1 0.8886231 
new best score!!!!
Validation loss decreased (0.224190 --> 0.202182).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.2449123859405518
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.2431455  Vali Loss: 0.1857486 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9244414  Vali macro F1 0.8909377 
new best score!!!!
Validation loss decreased (0.202182 --> 0.185749).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.2442519664764404
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.2350884  Vali Loss: 0.1899891 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9090854  Vali macro F1 0.8711201 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 1.2447614669799805
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.2135300  Vali Loss: 0.1631870 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9372132  Vali macro F1 0.9062114 
new best score!!!!
Validation loss decreased (0.185749 --> 0.163187).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.2461028099060059
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.1986888  Vali Loss: 0.1533543 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9404248  Vali macro F1 0.9161795 
new best score!!!!
Validation loss decreased (0.163187 --> 0.153354).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.2452588081359863
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.1879193  Vali Loss: 0.1422258 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9484392  Vali macro F1 0.9202292 
new best score!!!!
Validation loss decreased (0.153354 --> 0.142226).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.2461533546447754
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.1854638  Vali Loss: 0.1390845 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9536410  Vali macro F1 0.9351567 
new best score!!!!
Validation loss decreased (0.142226 --> 0.139085).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.2462093830108643
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.1731714  Vali Loss: 0.1270521 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9596571  Vali macro F1 0.9435225 
new best score!!!!
Validation loss decreased (0.139085 --> 0.127052).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 1.2456839084625244
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.1615370  Vali Loss: 0.1187492 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9682265  Vali macro F1 0.9511381 
new best score!!!!
Validation loss decreased (0.127052 --> 0.118749).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.2427904605865479
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.1568029  Vali Loss: 0.1146072 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9623751  Vali macro F1 0.9413416 
new best score!!!!
Validation loss decreased (0.118749 --> 0.114607).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.24462890625
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.1517739  Vali Loss: 0.1133098 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9592986  Vali macro F1 0.9421137 
new best score!!!!
Validation loss decreased (0.114607 --> 0.113310).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 1.2439463138580322
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.1391694  Vali Loss: 0.1083456 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9480713  Vali macro F1 0.9211204 
new best score!!!!
Validation loss decreased (0.113310 --> 0.108346).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 1.2448558807373047
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.1380038  Vali Loss: 0.1035236 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9508475  Vali macro F1 0.9243958 
new best score!!!!
Validation loss decreased (0.108346 --> 0.103524).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 1.243525743484497
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.1272697  Vali Loss: 0.0979791 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9715919  Vali macro F1 0.9563381 
new best score!!!!
Validation loss decreased (0.103524 --> 0.097979).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 1.2434062957763672
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.1368639  Vali Loss: 0.0933143 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9586916  Vali macro F1 0.9327142 
new best score!!!!
Validation loss decreased (0.097979 --> 0.093314).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.2498066425323486
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.1297538  Vali Loss: 0.1038475 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9358050  Vali macro F1 0.9009573 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 1.242548942565918
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.1215245  Vali Loss: 0.1021911 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9559006  Vali macro F1 0.9368197 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 1.2597739696502686
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.1171207  Vali Loss: 0.0988224 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9592391  Vali macro F1 0.9427834 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 1.2436962127685547
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.1109954  Vali Loss: 0.0860445 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9708861  Vali macro F1 0.9557284 
new best score!!!!
Validation loss decreased (0.093314 --> 0.086044).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 1.244950294494629
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.1068430  Vali Loss: 0.0782206 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9688982  Vali macro F1 0.9523377 
new best score!!!!
Validation loss decreased (0.086044 --> 0.078221).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 1.2453372478485107
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.1024338  Vali Loss: 0.0706417 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829854  Vali macro F1 0.9736667 
new best score!!!!
Validation loss decreased (0.078221 --> 0.070642).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 1.2445757389068604
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0959492  Vali Loss: 0.0855150 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9493930  Vali macro F1 0.9302401 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 1.2448596954345703
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0961466  Vali Loss: 0.0822650 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9598685  Vali macro F1 0.9479715 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 1.246067762374878
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0916653  Vali Loss: 0.0643843 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829854  Vali macro F1 0.9736667 
new best score!!!!
Validation loss decreased (0.070642 --> 0.064384).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 1.2462694644927979
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0849910  Vali Loss: 0.0612629 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857782  Vali macro F1 0.9784558 
new best score!!!!
Validation loss decreased (0.064384 --> 0.061263).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 1.2446906566619873
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0812315  Vali Loss: 0.0562784 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915196  Vali macro F1 0.9880529 
new best score!!!!
Validation loss decreased (0.061263 --> 0.056278).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 1.2462635040283203
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0761614  Vali Loss: 0.0594908 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858586  Vali macro F1 0.9808608 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 1.244781255722046
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0719912  Vali Loss: 0.0541122 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887270  Vali macro F1 0.9856960 
new best score!!!!
Validation loss decreased (0.056278 --> 0.054112).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 1.242645025253296
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0688622  Vali Loss: 0.0574338 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9772743  Vali macro F1 0.9708215 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 1.2433180809020996
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0675239  Vali Loss: 0.0533009 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801458  Vali macro F1 0.9740905 
new best score!!!!
Validation loss decreased (0.054112 --> 0.053301).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 1.2462377548217773
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0581310  Vali Loss: 0.0416773 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858183  Vali macro F1 0.9808602 
new best score!!!!
Validation loss decreased (0.053301 --> 0.041677).  Saving model ...
new best score!!!!
Epoch: 51 cost time: 1.2438061237335205
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0635546  Vali Loss: 0.0424547 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915099  Vali macro F1 0.9904546 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 1.243001937866211
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0599634  Vali Loss: 0.0408021 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886734  Vali macro F1 0.9881751 
new best score!!!!
Validation loss decreased (0.041677 --> 0.040802).  Saving model ...
new best score!!!!
Epoch: 53 cost time: 1.2424726486206055
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0562389  Vali Loss: 0.0349256 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943557  Vali macro F1 0.9928337 
new best score!!!!
Validation loss decreased (0.040802 --> 0.034926).  Saving model ...
new best score!!!!
Epoch: 54 cost time: 1.2419500350952148
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0554686  Vali Loss: 0.0443277 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858172  Vali macro F1 0.9809396 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 1.2429516315460205
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0543479  Vali Loss: 0.0333762 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915502  Vali macro F1 0.9904552 
new best score!!!!
Validation loss decreased (0.034926 --> 0.033376).  Saving model ...
new best score!!!!
Epoch: 56 cost time: 1.2442469596862793
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0531005  Vali Loss: 0.0510114 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858939  Vali macro F1 0.9849747 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 57 cost time: 1.2441365718841553
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0585264  Vali Loss: 0.0330776 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915190  Vali macro F1 0.9880937 
new best score!!!!
Validation loss decreased (0.033376 --> 0.033078).  Saving model ...
new best score!!!!
Epoch: 58 cost time: 1.2421410083770752
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0514914  Vali Loss: 0.0371417 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915132  Vali macro F1 0.9875968 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 1.243821144104004
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0516936  Vali Loss: 0.0344997 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915176  Vali macro F1 0.9878580 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 60 cost time: 1.2428669929504395
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0510890  Vali Loss: 0.0335476 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887253  Vali macro F1 0.9876383 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 61 cost time: 1.2432444095611572
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0430564  Vali Loss: 0.0318999 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886841  Vali macro F1 0.9884679 
new best score!!!!
Validation loss decreased (0.033078 --> 0.031900).  Saving model ...
new best score!!!!
Epoch: 62 cost time: 1.2428123950958252
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0427213  Vali Loss: 0.0278588 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943557  Vali macro F1 0.9928337 
new best score!!!!
Validation loss decreased (0.031900 --> 0.027859).  Saving model ...
new best score!!!!
Epoch: 63 cost time: 1.2414450645446777
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0391876  Vali Loss: 0.0256392 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943557  Vali macro F1 0.9928337 
new best score!!!!
Validation loss decreased (0.027859 --> 0.025639).  Saving model ...
new best score!!!!
Epoch: 64 cost time: 1.2416081428527832
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0427355  Vali Loss: 0.0299858 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915288  Vali macro F1 0.9908875 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 65 cost time: 1.2423601150512695
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0510654  Vali Loss: 0.0485513 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830993  Vali macro F1 0.9834487 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 66 cost time: 1.2422831058502197
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0420946  Vali Loss: 0.0250884 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915099  Vali macro F1 0.9904546 
new best score!!!!
Validation loss decreased (0.025639 --> 0.025088).  Saving model ...
new best score!!!!
Epoch: 67 cost time: 1.2462234497070312
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0414463  Vali Loss: 0.0219235 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971822  Vali macro F1 0.9975983 
new best score!!!!
Validation loss decreased (0.025088 --> 0.021923).  Saving model ...
new best score!!!!
Epoch: 68 cost time: 1.2436225414276123
VALI: Epoch: 68, Steps: 13 | Train Loss: 0.0397666  Vali Loss: 0.0240358 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915009  Vali macro F1 0.9928603 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 69 cost time: 1.2431833744049072
VALI: Epoch: 69, Steps: 13 | Train Loss: 0.0340974  Vali Loss: 0.0256433 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915480  Vali macro F1 0.9905345 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 70 cost time: 1.2605323791503906
VALI: Epoch: 70, Steps: 13 | Train Loss: 0.0290688  Vali Loss: 0.0267572 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915480  Vali macro F1 0.9905345 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 71 cost time: 1.2420272827148438
VALI: Epoch: 71, Steps: 13 | Train Loss: 0.0343461  Vali Loss: 0.0217482 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971816  Vali macro F1 0.9976392 
new best score!!!!
Validation loss decreased (0.021923 --> 0.021748).  Saving model ...
new best score!!!!
Epoch: 72 cost time: 1.2447984218597412
VALI: Epoch: 72, Steps: 13 | Train Loss: 0.0309963  Vali Loss: 0.0230128 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886762  Vali macro F1 0.9880572 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 73 cost time: 1.2431623935699463
VALI: Epoch: 73, Steps: 13 | Train Loss: 0.0284495  Vali Loss: 0.0163687 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.021748 --> 0.016369).  Saving model ...
new best score!!!!
Epoch: 74 cost time: 1.2421822547912598
VALI: Epoch: 74, Steps: 13 | Train Loss: 0.0234781  Vali Loss: 0.0199246 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915502  Vali macro F1 0.9904552 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 75 cost time: 1.2425367832183838
VALI: Epoch: 75, Steps: 13 | Train Loss: 0.0299253  Vali Loss: 0.0193049 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943557  Vali macro F1 0.9928337 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 76 cost time: 1.2425780296325684
VALI: Epoch: 76, Steps: 13 | Train Loss: 0.0278749  Vali Loss: 0.0252905 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915288  Vali macro F1 0.9908875 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 77 cost time: 1.243441104888916
VALI: Epoch: 77, Steps: 13 | Train Loss: 0.0236639  Vali Loss: 0.0202354 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943551  Vali macro F1 0.9928746 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 78 cost time: 1.2428550720214844
VALI: Epoch: 78, Steps: 13 | Train Loss: 0.0222516  Vali Loss: 0.0226272 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915288  Vali macro F1 0.9908875 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 79 cost time: 1.2452003955841064
VALI: Epoch: 79, Steps: 13 | Train Loss: 0.0224522  Vali Loss: 0.0185158 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943553  Vali macro F1 0.9956521 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 80 cost time: 1.2436790466308594
VALI: Epoch: 80, Steps: 13 | Train Loss: 0.0195008  Vali Loss: 0.0180266 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915288  Vali macro F1 0.9908875 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 81 cost time: 1.2435123920440674
VALI: Epoch: 81, Steps: 13 | Train Loss: 0.0204627  Vali Loss: 0.0177686 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915288  Vali macro F1 0.9908875 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 82 cost time: 1.242980718612671
VALI: Epoch: 82, Steps: 13 | Train Loss: 0.0204643  Vali Loss: 0.0187446 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915288  Vali macro F1 0.9908875 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 83 cost time: 1.2433090209960938
VALI: Epoch: 83, Steps: 13 | Train Loss: 0.0203113  Vali Loss: 0.0196484 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915288  Vali macro F1 0.9908875 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 84 cost time: 1.2431533336639404
VALI: Epoch: 84, Steps: 13 | Train Loss: 0.0195569  Vali Loss: 0.0194818 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915288  Vali macro F1 0.9908875 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 85 cost time: 1.2427713871002197
VALI: Epoch: 85, Steps: 13 | Train Loss: 0.0224400  Vali Loss: 0.0191881 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915288  Vali macro F1 0.9908875 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 86 cost time: 1.2457659244537354
VALI: Epoch: 86, Steps: 13 | Train Loss: 0.0190832  Vali Loss: 0.0187956 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915288  Vali macro F1 0.9908875 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 87 cost time: 1.2431855201721191
VALI: Epoch: 87, Steps: 13 | Train Loss: 0.0193895  Vali Loss: 0.0188133 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915288  Vali macro F1 0.9908875 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 88 cost time: 1.2429282665252686
VALI: Epoch: 88, Steps: 13 | Train Loss: 0.0191048  Vali Loss: 0.0185936 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915288  Vali macro F1 0.9908875 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9909502  Test weighted F1: 0.9909533  Test macro F1 0.9904241 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 73347
pruned model Parameter : 76626
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.26719331741333
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0281944  Vali Loss: 0.0203174 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971735  Vali macro F1 0.9952354 
Validation loss decreased (inf --> 0.020317).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.2628180980682373
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0239954  Vali Loss: 0.0162020 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943551  Vali macro F1 0.9928746 
new best score!!!!
Validation loss decreased (0.020317 --> 0.016202).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 1.263159990310669
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0239063  Vali Loss: 0.0169363 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943551  Vali macro F1 0.9928746 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 1.2650477886199951
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0255762  Vali Loss: 0.0181506 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943551  Vali macro F1 0.9928746 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 1.2621896266937256
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0224290  Vali Loss: 0.0182486 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943551  Vali macro F1 0.9928746 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 1.2656755447387695
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0237429  Vali Loss: 0.0202656 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915480  Vali macro F1 0.9905345 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 1.2683987617492676
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0250683  Vali Loss: 0.0186574 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943551  Vali macro F1 0.9928746 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 8 cost time: 1.266812801361084
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0242751  Vali Loss: 0.0168913 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971735  Vali macro F1 0.9952354 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 1.2668285369873047
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0231287  Vali Loss: 0.0170986 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971735  Vali macro F1 0.9952354 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 1.2659780979156494
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0214120  Vali Loss: 0.0198264 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943551  Vali macro F1 0.9928746 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 1.2723557949066162
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0216772  Vali Loss: 0.0162311 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943551  Vali macro F1 0.9928746 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 1.2684779167175293
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0217603  Vali Loss: 0.0180552 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943551  Vali macro F1 0.9928746 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 13 cost time: 1.2670738697052002
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0215600  Vali Loss: 0.0179836 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943551  Vali macro F1 0.9928746 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 1.2847862243652344
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0203688  Vali Loss: 0.0184857 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943551  Vali macro F1 0.9928746 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 1.2670457363128662
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0221816  Vali Loss: 0.0184659 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943551  Vali macro F1 0.9928746 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 1.2705066204071045
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0211943  Vali Loss: 0.0186815 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943551  Vali macro F1 0.9928746 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 1.2704763412475586
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0216396  Vali Loss: 0.0186438 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943551  Vali macro F1 0.9928746 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9909502  Test weighted F1: 0.9909449  Test macro F1 0.9917110 
================ the 2 th CV Experiment ================ 
Overlapping random Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.00276243 0.00239234 0.00246305 0.00330033 0.00595238 0.00574713
 0.00308642 0.00291545 0.00232019 0.00390625]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.2416560649871826
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.2921947  Vali Loss: 2.2768435 Vali Accuracy: 0.1355932  Vali weighted F1: 0.0323805  Vali macro F1 0.0238806 
Validation loss decreased (inf --> 2.276843).  Saving model ...
Epoch: 2 cost time: 1.239755630493164
VALI: Epoch: 2, Steps: 13 | Train Loss: 2.2482856  Vali Loss: 2.1991035 Vali Accuracy: 0.1412429  Vali weighted F1: 0.0732633  Vali macro F1 0.0565434 
new best score!!!!
Validation loss decreased (2.276843 --> 2.199104).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.238682508468628
VALI: Epoch: 3, Steps: 13 | Train Loss: 2.0438777  Vali Loss: 1.7507837 Vali Accuracy: 0.5056497  Vali weighted F1: 0.4685388  Vali macro F1 0.4428877 
new best score!!!!
Validation loss decreased (2.199104 --> 1.750784).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.2388827800750732
VALI: Epoch: 4, Steps: 13 | Train Loss: 1.6339260  Vali Loss: 1.3216840 Vali Accuracy: 0.5762712  Vali weighted F1: 0.5612965  Vali macro F1 0.5324207 
new best score!!!!
Validation loss decreased (1.750784 --> 1.321684).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.239910364151001
VALI: Epoch: 5, Steps: 13 | Train Loss: 1.2950691  Vali Loss: 1.0322754 Vali Accuracy: 0.7175141  Vali weighted F1: 0.6971783  Vali macro F1 0.6605761 
new best score!!!!
Validation loss decreased (1.321684 --> 1.032275).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.2379059791564941
VALI: Epoch: 6, Steps: 13 | Train Loss: 1.0412633  Vali Loss: 0.8203009 Vali Accuracy: 0.7711864  Vali weighted F1: 0.7513615  Vali macro F1 0.7143332 
new best score!!!!
Validation loss decreased (1.032275 --> 0.820301).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.2383527755737305
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.8729947  Vali Loss: 0.7007445 Vali Accuracy: 0.7881356  Vali weighted F1: 0.7655044  Vali macro F1 0.7266828 
new best score!!!!
Validation loss decreased (0.820301 --> 0.700744).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.2386064529418945
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.7394652  Vali Loss: 0.5904694 Vali Accuracy: 0.8163842  Vali weighted F1: 0.7951657  Vali macro F1 0.7560504 
new best score!!!!
Validation loss decreased (0.700744 --> 0.590469).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.2388131618499756
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.6376627  Vali Loss: 0.5281850 Vali Accuracy: 0.8305085  Vali weighted F1: 0.8160242  Vali macro F1 0.7775833 
new best score!!!!
Validation loss decreased (0.590469 --> 0.528185).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.2377781867980957
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.5641358  Vali Loss: 0.4743844 Vali Accuracy: 0.8474576  Vali weighted F1: 0.8340121  Vali macro F1 0.8032178 
new best score!!!!
Validation loss decreased (0.528185 --> 0.474384).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.2377345561981201
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.5047085  Vali Loss: 0.4365559 Vali Accuracy: 0.8418079  Vali weighted F1: 0.8199684  Vali macro F1 0.7786128 
new best score!!!!
Validation loss decreased (0.474384 --> 0.436556).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.240938663482666
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.4765183  Vali Loss: 0.3987060 Vali Accuracy: 0.8644068  Vali weighted F1: 0.8434659  Vali macro F1 0.7994530 
new best score!!!!
Validation loss decreased (0.436556 --> 0.398706).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.2413671016693115
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.4356019  Vali Loss: 0.3654123 Vali Accuracy: 0.8644068  Vali weighted F1: 0.8459628  Vali macro F1 0.8071786 
new best score!!!!
Validation loss decreased (0.398706 --> 0.365412).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.2396700382232666
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.4045815  Vali Loss: 0.3452244 Vali Accuracy: 0.8757062  Vali weighted F1: 0.8626890  Vali macro F1 0.8307641 
new best score!!!!
Validation loss decreased (0.365412 --> 0.345224).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.2411682605743408
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.3845136  Vali Loss: 0.3120033 Vali Accuracy: 0.8728814  Vali weighted F1: 0.8560499  Vali macro F1 0.8149655 
new best score!!!!
Validation loss decreased (0.345224 --> 0.312003).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.240527868270874
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.3550793  Vali Loss: 0.2928794 Vali Accuracy: 0.8757062  Vali weighted F1: 0.8585279  Vali macro F1 0.8167940 
new best score!!!!
Validation loss decreased (0.312003 --> 0.292879).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.2404916286468506
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.3349516  Vali Loss: 0.2770012 Vali Accuracy: 0.8785311  Vali weighted F1: 0.8608958  Vali macro F1 0.8206005 
new best score!!!!
Validation loss decreased (0.292879 --> 0.277001).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.2417702674865723
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.3021361  Vali Loss: 0.2511522 Vali Accuracy: 0.8898305  Vali weighted F1: 0.8727718  Vali macro F1 0.8295232 
new best score!!!!
Validation loss decreased (0.277001 --> 0.251152).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.2416481971740723
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.2878188  Vali Loss: 0.2434321 Vali Accuracy: 0.9096045  Vali weighted F1: 0.9083779  Vali macro F1 0.8843292 
new best score!!!!
Validation loss decreased (0.251152 --> 0.243432).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.2409348487854004
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.2642719  Vali Loss: 0.2323577 Vali Accuracy: 0.9265537  Vali weighted F1: 0.9214812  Vali macro F1 0.8926654 
new best score!!!!
Validation loss decreased (0.243432 --> 0.232358).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.2427067756652832
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.2438230  Vali Loss: 0.2016818 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9260537  Vali macro F1 0.8952905 
new best score!!!!
Validation loss decreased (0.232358 --> 0.201682).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.242565631866455
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.2276455  Vali Loss: 0.1877797 Vali Accuracy: 0.9265537  Vali weighted F1: 0.9127213  Vali macro F1 0.8692845 
new best score!!!!
Validation loss decreased (0.201682 --> 0.187780).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.2410640716552734
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.2146387  Vali Loss: 0.1742093 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9479632  Vali macro F1 0.9238611 
new best score!!!!
Validation loss decreased (0.187780 --> 0.174209).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.2417140007019043
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.2038083  Vali Loss: 0.1625644 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9399986  Vali macro F1 0.9123748 
new best score!!!!
Validation loss decreased (0.174209 --> 0.162564).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.2411625385284424
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.1826722  Vali Loss: 0.1505994 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9320587  Vali macro F1 0.9002535 
new best score!!!!
Validation loss decreased (0.162564 --> 0.150599).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.2474241256713867
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.1804142  Vali Loss: 0.1513901 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9492528  Vali macro F1 0.9331132 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 1.2411456108093262
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.1779354  Vali Loss: 0.1517297 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9417755  Vali macro F1 0.9117876 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 1.2407851219177246
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.1672894  Vali Loss: 0.1265131 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9602308  Vali macro F1 0.9400802 
new best score!!!!
Validation loss decreased (0.150599 --> 0.126513).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.249800205230713
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.1469222  Vali Loss: 0.1282013 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9495979  Vali macro F1 0.9287515 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 1.2452261447906494
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.1497328  Vali Loss: 0.1272893 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9547090  Vali macro F1 0.9399363 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 1.242769718170166
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.1422448  Vali Loss: 0.1165728 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9512086  Vali macro F1 0.9296733 
new best score!!!!
Validation loss decreased (0.126513 --> 0.116573).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 1.2424707412719727
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.1361583  Vali Loss: 0.1095864 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9615168  Vali macro F1 0.9422898 
new best score!!!!
Validation loss decreased (0.116573 --> 0.109586).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 1.2430293560028076
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.1349294  Vali Loss: 0.1087772 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9688296  Vali macro F1 0.9571108 
new best score!!!!
Validation loss decreased (0.109586 --> 0.108777).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 1.2414028644561768
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.1286726  Vali Loss: 0.1045388 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9648621  Vali macro F1 0.9483921 
new best score!!!!
Validation loss decreased (0.108777 --> 0.104539).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.2421820163726807
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.1312358  Vali Loss: 0.1385938 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9395795  Vali macro F1 0.9146259 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 1.2412610054016113
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.1282089  Vali Loss: 0.1007520 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9545980  Vali macro F1 0.9310897 
new best score!!!!
Validation loss decreased (0.104539 --> 0.100752).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 1.2414171695709229
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.1179836  Vali Loss: 0.0909364 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745603  Vali macro F1 0.9647405 
new best score!!!!
Validation loss decreased (0.100752 --> 0.090936).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 1.2433710098266602
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.1147645  Vali Loss: 0.0983862 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9552762  Vali macro F1 0.9337542 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 1.2416424751281738
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.1113984  Vali Loss: 0.0970585 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9553130  Vali macro F1 0.9347150 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 1.242957353591919
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.1035545  Vali Loss: 0.0819960 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773958  Vali macro F1 0.9643255 
new best score!!!!
Validation loss decreased (0.090936 --> 0.081996).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 1.242729902267456
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.1008139  Vali Loss: 0.0848694 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9615651  Vali macro F1 0.9427011 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 1.240772008895874
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0955758  Vali Loss: 0.0988257 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9517634  Vali macro F1 0.9287314 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 1.2411305904388428
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0935686  Vali Loss: 0.0786254 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9771725  Vali macro F1 0.9687879 
new best score!!!!
Validation loss decreased (0.081996 --> 0.078625).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 1.2421095371246338
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0882283  Vali Loss: 0.0764622 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745007  Vali macro F1 0.9673392 
new best score!!!!
Validation loss decreased (0.078625 --> 0.076462).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 1.2409119606018066
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0871587  Vali Loss: 0.0681146 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773146  Vali macro F1 0.9692503 
new best score!!!!
Validation loss decreased (0.076462 --> 0.068115).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 1.2416722774505615
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0791586  Vali Loss: 0.0770120 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9743741  Vali macro F1 0.9691056 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 1.2430078983306885
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0806970  Vali Loss: 0.0666199 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745242  Vali macro F1 0.9645069 
new best score!!!!
Validation loss decreased (0.068115 --> 0.066620).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 1.2426798343658447
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0814764  Vali Loss: 0.0673768 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9743107  Vali macro F1 0.9666326 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 1.2436468601226807
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0789908  Vali Loss: 0.0746839 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9620373  Vali macro F1 0.9456143 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 1.241649866104126
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0694853  Vali Loss: 0.0667865 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9772026  Vali macro F1 0.9687220 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 1.240903377532959
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0685182  Vali Loss: 0.0690133 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9711909  Vali macro F1 0.9585881 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 52 cost time: 1.2406456470489502
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0710126  Vali Loss: 0.0536015 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801090  Vali macro F1 0.9739213 
new best score!!!!
Validation loss decreased (0.066620 --> 0.053602).  Saving model ...
new best score!!!!
Epoch: 53 cost time: 1.2404448986053467
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0651882  Vali Loss: 0.0614271 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9771576  Vali macro F1 0.9710904 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 1.2455859184265137
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0584633  Vali Loss: 0.0589946 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829938  Vali macro F1 0.9787843 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 1.2464702129364014
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0563377  Vali Loss: 0.0602716 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9772836  Vali macro F1 0.9711430 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 56 cost time: 1.2448880672454834
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0580219  Vali Loss: 0.0569882 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829932  Vali macro F1 0.9788229 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 57 cost time: 1.2436175346374512
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0688003  Vali Loss: 0.0648178 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801161  Vali macro F1 0.9767238 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 58 cost time: 1.2439641952514648
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0532247  Vali Loss: 0.0591233 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801206  Vali macro F1 0.9763846 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 1.2513978481292725
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0492225  Vali Loss: 0.0577653 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9771851  Vali macro F1 0.9689507 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 60 cost time: 1.2453498840332031
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0541389  Vali Loss: 0.0526508 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829944  Vali macro F1 0.9787435 
new best score!!!!
Validation loss decreased (0.053602 --> 0.052651).  Saving model ...
new best score!!!!
Epoch: 61 cost time: 1.2594852447509766
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0488555  Vali Loss: 0.0508472 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829944  Vali macro F1 0.9787435 
new best score!!!!
Validation loss decreased (0.052651 --> 0.050847).  Saving model ...
new best score!!!!
Epoch: 62 cost time: 1.2458772659301758
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0486723  Vali Loss: 0.0512525 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801690  Vali macro F1 0.9759652 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 63 cost time: 1.245344877243042
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0478811  Vali Loss: 0.0496085 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801206  Vali macro F1 0.9763846 
new best score!!!!
Validation loss decreased (0.050847 --> 0.049608).  Saving model ...
new best score!!!!
Epoch: 64 cost time: 1.2449216842651367
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0486073  Vali Loss: 0.0494253 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829944  Vali macro F1 0.9787435 
new best score!!!!
Validation loss decreased (0.049608 --> 0.049425).  Saving model ...
new best score!!!!
Epoch: 65 cost time: 1.2443974018096924
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0465608  Vali Loss: 0.0468051 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858391  Vali macro F1 0.9811631 
new best score!!!!
Validation loss decreased (0.049425 --> 0.046805).  Saving model ...
new best score!!!!
Epoch: 66 cost time: 1.2450549602508545
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0466979  Vali Loss: 0.0457058 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829932  Vali macro F1 0.9788229 
new best score!!!!
Validation loss decreased (0.046805 --> 0.045706).  Saving model ...
new best score!!!!
Epoch: 67 cost time: 1.3236885070800781
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0464926  Vali Loss: 0.0459540 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858391  Vali macro F1 0.9811631 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 68 cost time: 1.325728416442871
VALI: Epoch: 68, Steps: 13 | Train Loss: 0.0480959  Vali Loss: 0.0447277 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858391  Vali macro F1 0.9811631 
new best score!!!!
Validation loss decreased (0.045706 --> 0.044728).  Saving model ...
new best score!!!!
Epoch: 69 cost time: 1.3280344009399414
VALI: Epoch: 69, Steps: 13 | Train Loss: 0.0468762  Vali Loss: 0.0443946 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829932  Vali macro F1 0.9788229 
new best score!!!!
Validation loss decreased (0.044728 --> 0.044395).  Saving model ...
new best score!!!!
Epoch: 70 cost time: 1.3276054859161377
VALI: Epoch: 70, Steps: 13 | Train Loss: 0.0475857  Vali Loss: 0.0471503 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829932  Vali macro F1 0.9788229 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 71 cost time: 1.3233187198638916
VALI: Epoch: 71, Steps: 13 | Train Loss: 0.0470561  Vali Loss: 0.0464055 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829932  Vali macro F1 0.9788229 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 72 cost time: 1.3187334537506104
VALI: Epoch: 72, Steps: 13 | Train Loss: 0.0436687  Vali Loss: 0.0455660 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829932  Vali macro F1 0.9788229 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 73 cost time: 1.2524404525756836
VALI: Epoch: 73, Steps: 13 | Train Loss: 0.0423776  Vali Loss: 0.0440125 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829932  Vali macro F1 0.9788229 
new best score!!!!
Validation loss decreased (0.044395 --> 0.044012).  Saving model ...
new best score!!!!
Epoch: 74 cost time: 1.2453622817993164
VALI: Epoch: 74, Steps: 13 | Train Loss: 0.0393579  Vali Loss: 0.0448791 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829932  Vali macro F1 0.9788229 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 75 cost time: 1.249072551727295
VALI: Epoch: 75, Steps: 13 | Train Loss: 0.0451658  Vali Loss: 0.0453802 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829932  Vali macro F1 0.9788229 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 76 cost time: 1.249697208404541
VALI: Epoch: 76, Steps: 13 | Train Loss: 0.0417645  Vali Loss: 0.0456881 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829932  Vali macro F1 0.9788229 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 77 cost time: 1.2810673713684082
VALI: Epoch: 77, Steps: 13 | Train Loss: 0.0417360  Vali Loss: 0.0425114 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829932  Vali macro F1 0.9788229 
new best score!!!!
Validation loss decreased (0.044012 --> 0.042511).  Saving model ...
new best score!!!!
Epoch: 78 cost time: 1.2427194118499756
VALI: Epoch: 78, Steps: 13 | Train Loss: 0.0451010  Vali Loss: 0.0464510 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829932  Vali macro F1 0.9788229 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 79 cost time: 1.2483227252960205
VALI: Epoch: 79, Steps: 13 | Train Loss: 0.0429008  Vali Loss: 0.0456788 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829932  Vali macro F1 0.9788229 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 80 cost time: 1.2418463230133057
VALI: Epoch: 80, Steps: 13 | Train Loss: 0.0403170  Vali Loss: 0.0453979 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801684  Vali macro F1 0.9760451 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 81 cost time: 1.2431411743164062
VALI: Epoch: 81, Steps: 13 | Train Loss: 0.0437415  Vali Loss: 0.0446850 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829932  Vali macro F1 0.9788229 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 82 cost time: 1.2430205345153809
VALI: Epoch: 82, Steps: 13 | Train Loss: 0.0402197  Vali Loss: 0.0463873 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829932  Vali macro F1 0.9788229 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 83 cost time: 1.2493126392364502
VALI: Epoch: 83, Steps: 13 | Train Loss: 0.0445552  Vali Loss: 0.0464919 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829932  Vali macro F1 0.9788229 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 84 cost time: 1.2439396381378174
VALI: Epoch: 84, Steps: 13 | Train Loss: 0.0454525  Vali Loss: 0.0459767 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829932  Vali macro F1 0.9788229 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 85 cost time: 1.2433998584747314
VALI: Epoch: 85, Steps: 13 | Train Loss: 0.0428286  Vali Loss: 0.0457311 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829932  Vali macro F1 0.9788229 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 86 cost time: 1.2423062324523926
VALI: Epoch: 86, Steps: 13 | Train Loss: 0.0404953  Vali Loss: 0.0455205 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829932  Vali macro F1 0.9788229 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 87 cost time: 1.2430193424224854
VALI: Epoch: 87, Steps: 13 | Train Loss: 0.0422325  Vali Loss: 0.0449614 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829932  Vali macro F1 0.9788229 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 88 cost time: 1.2424688339233398
VALI: Epoch: 88, Steps: 13 | Train Loss: 0.0421236  Vali Loss: 0.0449162 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829932  Vali macro F1 0.9788229 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 89 cost time: 1.2453253269195557
VALI: Epoch: 89, Steps: 13 | Train Loss: 0.0405433  Vali Loss: 0.0448654 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829932  Vali macro F1 0.9788229 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 90 cost time: 1.2439165115356445
VALI: Epoch: 90, Steps: 13 | Train Loss: 0.0427796  Vali Loss: 0.0448423 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829932  Vali macro F1 0.9788229 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 91 cost time: 1.2487661838531494
VALI: Epoch: 91, Steps: 13 | Train Loss: 0.0401918  Vali Loss: 0.0448594 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829932  Vali macro F1 0.9788229 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 92 cost time: 1.2439279556274414
VALI: Epoch: 92, Steps: 13 | Train Loss: 0.0399206  Vali Loss: 0.0448483 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829932  Vali macro F1 0.9788229 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9819005  Test weighted F1: 0.9818989  Test macro F1 0.9790165 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 73347
pruned model Parameter : 76626
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.2650699615478516
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0439003  Vali Loss: 0.0436931 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829932  Vali macro F1 0.9788229 
Validation loss decreased (inf --> 0.043693).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.2605793476104736
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0448818  Vali Loss: 0.0479121 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801684  Vali macro F1 0.9760451 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.2758798599243164
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0415425  Vali Loss: 0.0435494 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829932  Vali macro F1 0.9788229 
new best score!!!!
Validation loss decreased (0.043693 --> 0.043549).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 1.2599437236785889
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0448202  Vali Loss: 0.0460335 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829932  Vali macro F1 0.9788229 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 1.2584145069122314
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0452188  Vali Loss: 0.0413159 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829932  Vali macro F1 0.9788229 
new best score!!!!
Validation loss decreased (0.043549 --> 0.041316).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 1.2608449459075928
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0396617  Vali Loss: 0.0424963 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829932  Vali macro F1 0.9788229 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 1.2603521347045898
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0407336  Vali Loss: 0.0411197 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829932  Vali macro F1 0.9788229 
new best score!!!!
Validation loss decreased (0.041316 --> 0.041120).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 1.261613130569458
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0394359  Vali Loss: 0.0402204 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829932  Vali macro F1 0.9788229 
new best score!!!!
Validation loss decreased (0.041120 --> 0.040220).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 1.2598495483398438
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0412334  Vali Loss: 0.0401150 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829932  Vali macro F1 0.9788229 
new best score!!!!
Validation loss decreased (0.040220 --> 0.040115).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 1.2606961727142334
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0406013  Vali Loss: 0.0411429 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829932  Vali macro F1 0.9788229 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 1.2597970962524414
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0422471  Vali Loss: 0.0416064 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829932  Vali macro F1 0.9788229 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 1.2613296508789062
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0405016  Vali Loss: 0.0375148 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886848  Vali macro F1 0.9884173 
new best score!!!!
Validation loss decreased (0.040115 --> 0.037515).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 1.259974479675293
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0436395  Vali Loss: 0.0434360 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801684  Vali macro F1 0.9760451 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 1.2594020366668701
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0372500  Vali Loss: 0.0384149 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829932  Vali macro F1 0.9788229 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 1.2608346939086914
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0363915  Vali Loss: 0.0428234 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829932  Vali macro F1 0.9788229 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 1.2599678039550781
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0376050  Vali Loss: 0.0413607 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829932  Vali macro F1 0.9788229 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 1.2599267959594727
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0373502  Vali Loss: 0.0438193 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801684  Vali macro F1 0.9760451 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 18 cost time: 1.2601501941680908
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0391307  Vali Loss: 0.0358218 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886848  Vali macro F1 0.9884173 
new best score!!!!
Validation loss decreased (0.037515 --> 0.035822).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 1.2596051692962646
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0398199  Vali Loss: 0.0372323 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829932  Vali macro F1 0.9788229 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 1.2668232917785645
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0395055  Vali Loss: 0.0402595 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829932  Vali macro F1 0.9788229 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 1.2643828392028809
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0380226  Vali Loss: 0.0385171 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829932  Vali macro F1 0.9788229 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 1.266066074371338
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0369835  Vali Loss: 0.0384324 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829932  Vali macro F1 0.9788229 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 23 cost time: 1.263462781906128
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0377900  Vali Loss: 0.0361094 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829760  Vali macro F1 0.9811982 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 24 cost time: 1.2643544673919678
Fine Tuning VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0355036  Vali Loss: 0.0357614 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829760  Vali macro F1 0.9811982 
new best score!!!!
Validation loss decreased (0.035822 --> 0.035761).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 25 cost time: 1.2643396854400635
Fine Tuning VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0358522  Vali Loss: 0.0368465 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858487  Vali macro F1 0.9836364 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 1.2638018131256104
Fine Tuning VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0364824  Vali Loss: 0.0373769 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858487  Vali macro F1 0.9836364 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 27 cost time: 1.264784812927246
Fine Tuning VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0346023  Vali Loss: 0.0370959 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858487  Vali macro F1 0.9836364 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 28 cost time: 1.2646877765655518
Fine Tuning VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0331821  Vali Loss: 0.0369803 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858487  Vali macro F1 0.9836364 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 29 cost time: 1.2648589611053467
Fine Tuning VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0357338  Vali Loss: 0.0365424 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858487  Vali macro F1 0.9836364 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 30 cost time: 1.2637503147125244
Fine Tuning VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0354036  Vali Loss: 0.0365088 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858487  Vali macro F1 0.9836364 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 31 cost time: 1.2682342529296875
Fine Tuning VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0342069  Vali Loss: 0.0365471 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858487  Vali macro F1 0.9836364 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 32 cost time: 1.2666499614715576
Fine Tuning VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0350470  Vali Loss: 0.0366084 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858487  Vali macro F1 0.9836364 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 33 cost time: 1.2738170623779297
Fine Tuning VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0330041  Vali Loss: 0.0366425 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858487  Vali macro F1 0.9836364 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 34 cost time: 1.2638123035430908
Fine Tuning VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0359003  Vali Loss: 0.0367368 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858487  Vali macro F1 0.9836364 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Fine Tuning Epoch: 35 cost time: 1.2788212299346924
Fine Tuning VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0344691  Vali Loss: 0.0367416 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858487  Vali macro F1 0.9836364 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 36 cost time: 1.2647969722747803
Fine Tuning VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0333627  Vali Loss: 0.0367427 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858487  Vali macro F1 0.9836364 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 37 cost time: 1.2662544250488281
Fine Tuning VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0365730  Vali Loss: 0.0367431 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858487  Vali macro F1 0.9836364 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 38 cost time: 1.2686212062835693
Fine Tuning VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0372715  Vali Loss: 0.0367437 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858487  Vali macro F1 0.9836364 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 39 cost time: 1.2656912803649902
Fine Tuning VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0352552  Vali Loss: 0.0367356 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858487  Vali macro F1 0.9836364 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9796380  Test weighted F1: 0.9796133  Test macro F1 0.9768624 
================ the 3 th CV Experiment ================ 
Overlapping random Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00280899 0.00242718 0.00236967 0.00330033 0.00574713 0.00581395
 0.00315457 0.00280112 0.002331   0.00411523]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.2427012920379639
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.2924666  Vali Loss: 2.2783866 Vali Accuracy: 0.1355932  Vali weighted F1: 0.0323805  Vali macro F1 0.0238806 
Validation loss decreased (inf --> 2.278387).  Saving model ...
Epoch: 2 cost time: 1.2422003746032715
VALI: Epoch: 2, Steps: 13 | Train Loss: 2.2470665  Vali Loss: 2.2047027 Vali Accuracy: 0.1327684  Vali weighted F1: 0.0619931  Vali macro F1 0.0588903 
new best score!!!!
Validation loss decreased (2.278387 --> 2.204703).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.2473888397216797
VALI: Epoch: 3, Steps: 13 | Train Loss: 2.0561544  Vali Loss: 1.7848443 Vali Accuracy: 0.4576271  Vali weighted F1: 0.3638118  Vali macro F1 0.3362288 
new best score!!!!
Validation loss decreased (2.204703 --> 1.784844).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.242480993270874
VALI: Epoch: 4, Steps: 13 | Train Loss: 1.6645008  Vali Loss: 1.3396177 Vali Accuracy: 0.5564972  Vali weighted F1: 0.5424875  Vali macro F1 0.5166829 
new best score!!!!
Validation loss decreased (1.784844 --> 1.339618).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.2414934635162354
VALI: Epoch: 5, Steps: 13 | Train Loss: 1.3189407  Vali Loss: 1.0423271 Vali Accuracy: 0.6807910  Vali weighted F1: 0.6692903  Vali macro F1 0.6342145 
new best score!!!!
Validation loss decreased (1.339618 --> 1.042327).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.2424421310424805
VALI: Epoch: 6, Steps: 13 | Train Loss: 1.0670896  Vali Loss: 0.8591618 Vali Accuracy: 0.7457627  Vali weighted F1: 0.7225789  Vali macro F1 0.6859041 
new best score!!!!
Validation loss decreased (1.042327 --> 0.859162).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.2439372539520264
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.8864854  Vali Loss: 0.6836581 Vali Accuracy: 0.8248588  Vali weighted F1: 0.8115469  Vali macro F1 0.7791796 
new best score!!!!
Validation loss decreased (0.859162 --> 0.683658).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.2449398040771484
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.7446912  Vali Loss: 0.6107973 Vali Accuracy: 0.8050847  Vali weighted F1: 0.7839976  Vali macro F1 0.7457996 
new best score!!!!
Validation loss decreased (0.683658 --> 0.610797).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.2448654174804688
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.6473039  Vali Loss: 0.5387429 Vali Accuracy: 0.8276836  Vali weighted F1: 0.8256130  Vali macro F1 0.7943776 
new best score!!!!
Validation loss decreased (0.610797 --> 0.538743).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.2786097526550293
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.5664496  Vali Loss: 0.4724369 Vali Accuracy: 0.8446328  Vali weighted F1: 0.8337884  Vali macro F1 0.7932670 
new best score!!!!
Validation loss decreased (0.538743 --> 0.472437).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.3072543144226074
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.5098027  Vali Loss: 0.4264922 Vali Accuracy: 0.8531073  Vali weighted F1: 0.8391893  Vali macro F1 0.8020225 
new best score!!!!
Validation loss decreased (0.472437 --> 0.426492).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.3158819675445557
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.4720699  Vali Loss: 0.3890059 Vali Accuracy: 0.8672316  Vali weighted F1: 0.8481367  Vali macro F1 0.8031789 
new best score!!!!
Validation loss decreased (0.426492 --> 0.389006).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.3138461112976074
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.4288906  Vali Loss: 0.3648549 Vali Accuracy: 0.8700565  Vali weighted F1: 0.8638136  Vali macro F1 0.8357054 
new best score!!!!
Validation loss decreased (0.389006 --> 0.364855).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.315920352935791
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.4044258  Vali Loss: 0.3225781 Vali Accuracy: 0.9011299  Vali weighted F1: 0.8899003  Vali macro F1 0.8532473 
new best score!!!!
Validation loss decreased (0.364855 --> 0.322578).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.3113069534301758
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.3798629  Vali Loss: 0.3084898 Vali Accuracy: 0.8841808  Vali weighted F1: 0.8677031  Vali macro F1 0.8257327 
new best score!!!!
Validation loss decreased (0.322578 --> 0.308490).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.3154592514038086
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.3544882  Vali Loss: 0.2765792 Vali Accuracy: 0.8954802  Vali weighted F1: 0.8789066  Vali macro F1 0.8363851 
new best score!!!!
Validation loss decreased (0.308490 --> 0.276579).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.321943998336792
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.3251181  Vali Loss: 0.2694503 Vali Accuracy: 0.9067797  Vali weighted F1: 0.9037955  Vali macro F1 0.8777668 
new best score!!!!
Validation loss decreased (0.276579 --> 0.269450).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.3133504390716553
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.2995968  Vali Loss: 0.2368104 Vali Accuracy: 0.9152542  Vali weighted F1: 0.9022072  Vali macro F1 0.8588764 
new best score!!!!
Validation loss decreased (0.269450 --> 0.236810).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.3114128112792969
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.2792417  Vali Loss: 0.2182994 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9143637  Vali macro F1 0.8777777 
new best score!!!!
Validation loss decreased (0.236810 --> 0.218299).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.3032631874084473
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.2591122  Vali Loss: 0.1953712 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9263685  Vali macro F1 0.8873465 
new best score!!!!
Validation loss decreased (0.218299 --> 0.195371).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.3164103031158447
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.2412216  Vali Loss: 0.2041060 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9299540  Vali macro F1 0.9007851 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 1.31717848777771
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.2231196  Vali Loss: 0.1681140 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9504922  Vali macro F1 0.9267579 
new best score!!!!
Validation loss decreased (0.195371 --> 0.168114).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.300346851348877
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.2089492  Vali Loss: 0.1567920 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9483125  Vali macro F1 0.9268405 
new best score!!!!
Validation loss decreased (0.168114 --> 0.156792).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.2473430633544922
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.1935906  Vali Loss: 0.1567396 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9413803  Vali macro F1 0.9112359 
new best score!!!!
Validation loss decreased (0.156792 --> 0.156740).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.3055403232574463
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.1881762  Vali Loss: 0.1419017 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9491036  Vali macro F1 0.9258813 
new best score!!!!
Validation loss decreased (0.156740 --> 0.141902).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.3134949207305908
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.1743230  Vali Loss: 0.1467625 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9539755  Vali macro F1 0.9346477 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 1.2585091590881348
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.1627549  Vali Loss: 0.1230981 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9602436  Vali macro F1 0.9421446 
new best score!!!!
Validation loss decreased (0.141902 --> 0.123098).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 1.2442731857299805
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.1536251  Vali Loss: 0.1256475 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9598041  Vali macro F1 0.9429051 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 1.244124412536621
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.1400373  Vali Loss: 0.1041368 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9717157  Vali macro F1 0.9595081 
new best score!!!!
Validation loss decreased (0.123098 --> 0.104137).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.2445628643035889
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.1366180  Vali Loss: 0.0989639 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9687704  Vali macro F1 0.9545339 
new best score!!!!
Validation loss decreased (0.104137 --> 0.098964).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 1.2437691688537598
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.1261867  Vali Loss: 0.1118766 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9518393  Vali macro F1 0.9279773 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 1.2446041107177734
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.1243894  Vali Loss: 0.0867258 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9717242  Vali macro F1 0.9571173 
new best score!!!!
Validation loss decreased (0.098964 --> 0.086726).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 1.2442166805267334
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.1250189  Vali Loss: 0.0851843 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745710  Vali macro F1 0.9615086 
new best score!!!!
Validation loss decreased (0.086726 --> 0.085184).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 1.2482657432556152
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.1113959  Vali Loss: 0.0893104 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774062  Vali macro F1 0.9670807 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 1.2490408420562744
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.1032864  Vali Loss: 0.0787922 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9770722  Vali macro F1 0.9661325 
new best score!!!!
Validation loss decreased (0.085184 --> 0.078792).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 1.2526977062225342
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.1037707  Vali Loss: 0.0745504 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9709248  Vali macro F1 0.9557697 
new best score!!!!
Validation loss decreased (0.078792 --> 0.074550).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 1.245823621749878
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0954064  Vali Loss: 0.0694951 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887497  Vali macro F1 0.9882132 
new best score!!!!
Validation loss decreased (0.074550 --> 0.069495).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 1.2471225261688232
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0893544  Vali Loss: 0.0672072 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887497  Vali macro F1 0.9882132 
new best score!!!!
Validation loss decreased (0.069495 --> 0.067207).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 1.2462446689605713
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0847008  Vali Loss: 0.0720981 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9708753  Vali macro F1 0.9587221 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 1.2491421699523926
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0796006  Vali Loss: 0.0548184 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943551  Vali macro F1 0.9928746 
new best score!!!!
Validation loss decreased (0.067207 --> 0.054818).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 1.2457966804504395
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0764389  Vali Loss: 0.0514134 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915480  Vali macro F1 0.9905345 
new best score!!!!
Validation loss decreased (0.054818 --> 0.051413).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 1.2463922500610352
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0768854  Vali Loss: 0.0603771 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887233  Vali macro F1 0.9905341 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 1.2468326091766357
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0702730  Vali Loss: 0.0565587 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830204  Vali macro F1 0.9825359 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 1.2466800212860107
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0657188  Vali Loss: 0.0554923 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859258  Vali macro F1 0.9882133 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 1.247467279434204
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0632633  Vali Loss: 0.0450497 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887222  Vali macro F1 0.9885478 
new best score!!!!
Validation loss decreased (0.051413 --> 0.045050).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 1.2466766834259033
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0619456  Vali Loss: 0.0484424 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886391  Vali macro F1 0.9907050 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 1.2467849254608154
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0596758  Vali Loss: 0.0464000 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858384  Vali macro F1 0.9833149 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 48 cost time: 1.248349666595459
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0553547  Vali Loss: 0.0472711 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829362  Vali macro F1 0.9822499 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 49 cost time: 1.248126745223999
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0493649  Vali Loss: 0.0380009 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858495  Vali macro F1 0.9861096 
new best score!!!!
Validation loss decreased (0.045050 --> 0.038001).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 1.2484612464904785
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0549611  Vali Loss: 0.0401524 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915009  Vali macro F1 0.9928603 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 1.2466669082641602
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0552914  Vali Loss: 0.0413676 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830241  Vali macro F1 0.9833312 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 1.2468013763427734
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0519445  Vali Loss: 0.0573868 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886811  Vali macro F1 0.9882332 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 53 cost time: 1.2476270198822021
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0514717  Vali Loss: 0.0339956 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886745  Vali macro F1 0.9880957 
new best score!!!!
Validation loss decreased (0.038001 --> 0.033996).  Saving model ...
new best score!!!!
Epoch: 54 cost time: 1.2453720569610596
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0473527  Vali Loss: 0.0506546 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858587  Vali macro F1 0.9856896 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 1.244797706604004
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0454153  Vali Loss: 0.0383259 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915106  Vali macro F1 0.9932325 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 56 cost time: 1.2459704875946045
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0410306  Vali Loss: 0.0323627 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971822  Vali macro F1 0.9975983 
new best score!!!!
Validation loss decreased (0.033996 --> 0.032363).  Saving model ...
new best score!!!!
Epoch: 57 cost time: 1.250105381011963
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0476345  Vali Loss: 0.0329368 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915009  Vali macro F1 0.9928603 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 58 cost time: 1.2463569641113281
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0438308  Vali Loss: 0.0310219 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971746  Vali macro F1 0.9972217 
new best score!!!!
Validation loss decreased (0.032363 --> 0.031022).  Saving model ...
new best score!!!!
Epoch: 59 cost time: 1.2481515407562256
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0409969  Vali Loss: 0.0553119 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830724  Vali macro F1 0.9795195 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 60 cost time: 1.2632110118865967
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0453156  Vali Loss: 0.0380264 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886760  Vali macro F1 0.9908742 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 61 cost time: 1.2476582527160645
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0402210  Vali Loss: 0.0418222 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858482  Vali macro F1 0.9877413 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 62 cost time: 1.2519559860229492
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0395795  Vali Loss: 0.0350989 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886760  Vali macro F1 0.9908742 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 63 cost time: 1.2517824172973633
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0320034  Vali Loss: 0.0290750 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943559  Vali macro F1 0.9956113 
new best score!!!!
Validation loss decreased (0.031022 --> 0.029075).  Saving model ...
new best score!!!!
Epoch: 64 cost time: 1.2502222061157227
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0321072  Vali Loss: 0.0263820 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886841  Vali macro F1 0.9884679 
new best score!!!!
Validation loss decreased (0.029075 --> 0.026382).  Saving model ...
new best score!!!!
Epoch: 65 cost time: 1.25175142288208
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0347557  Vali Loss: 0.0255905 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943363  Vali macro F1 0.9952192 
new best score!!!!
Validation loss decreased (0.026382 --> 0.025591).  Saving model ...
new best score!!!!
Epoch: 66 cost time: 1.249161958694458
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0310599  Vali Loss: 0.0227552 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943559  Vali macro F1 0.9956113 
new best score!!!!
Validation loss decreased (0.025591 --> 0.022755).  Saving model ...
new best score!!!!
Epoch: 67 cost time: 1.2480504512786865
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0303427  Vali Loss: 0.0268844 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943559  Vali macro F1 0.9956113 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 68 cost time: 1.2481160163879395
VALI: Epoch: 68, Steps: 13 | Train Loss: 0.0313429  Vali Loss: 0.0369298 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943559  Vali macro F1 0.9956113 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 69 cost time: 1.2493810653686523
VALI: Epoch: 69, Steps: 13 | Train Loss: 0.0286781  Vali Loss: 0.0259985 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886760  Vali macro F1 0.9908742 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 70 cost time: 1.2500600814819336
VALI: Epoch: 70, Steps: 13 | Train Loss: 0.0245074  Vali Loss: 0.0302648 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915106  Vali macro F1 0.9932325 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 71 cost time: 1.2513866424560547
VALI: Epoch: 71, Steps: 13 | Train Loss: 0.0197291  Vali Loss: 0.0262379 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886760  Vali macro F1 0.9908742 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 72 cost time: 1.2497637271881104
VALI: Epoch: 72, Steps: 13 | Train Loss: 0.0241611  Vali Loss: 0.0254930 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886760  Vali macro F1 0.9908742 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 73 cost time: 1.2500460147857666
VALI: Epoch: 73, Steps: 13 | Train Loss: 0.0206657  Vali Loss: 0.0254054 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886760  Vali macro F1 0.9908742 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 74 cost time: 1.250192642211914
VALI: Epoch: 74, Steps: 13 | Train Loss: 0.0196843  Vali Loss: 0.0252326 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886760  Vali macro F1 0.9908742 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 75 cost time: 1.2496187686920166
VALI: Epoch: 75, Steps: 13 | Train Loss: 0.0190212  Vali Loss: 0.0247059 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915106  Vali macro F1 0.9932325 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 76 cost time: 1.2490651607513428
VALI: Epoch: 76, Steps: 13 | Train Loss: 0.0189369  Vali Loss: 0.0242258 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915106  Vali macro F1 0.9932325 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 77 cost time: 1.2495081424713135
VALI: Epoch: 77, Steps: 13 | Train Loss: 0.0203100  Vali Loss: 0.0241874 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915106  Vali macro F1 0.9932325 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 78 cost time: 1.2482917308807373
VALI: Epoch: 78, Steps: 13 | Train Loss: 0.0219572  Vali Loss: 0.0242221 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915106  Vali macro F1 0.9932325 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 79 cost time: 1.2498505115509033
VALI: Epoch: 79, Steps: 13 | Train Loss: 0.0206945  Vali Loss: 0.0244138 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943559  Vali macro F1 0.9956113 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 80 cost time: 1.2502405643463135
VALI: Epoch: 80, Steps: 13 | Train Loss: 0.0192407  Vali Loss: 0.0245303 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943559  Vali macro F1 0.9956113 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 81 cost time: 1.2496557235717773
VALI: Epoch: 81, Steps: 13 | Train Loss: 0.0204821  Vali Loss: 0.0243438 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943559  Vali macro F1 0.9956113 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9807692  Test weighted F1: 0.9807421  Test macro F1 0.9776347 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 73347
pruned model Parameter : 76626
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.26932954788208
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0303758  Vali Loss: 0.0225620 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971822  Vali macro F1 0.9975983 
Validation loss decreased (inf --> 0.022562).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.265897512435913
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0278947  Vali Loss: 0.0212217 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971822  Vali macro F1 0.9975983 
new best score!!!!
Validation loss decreased (0.022562 --> 0.021222).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 1.269209623336792
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0230306  Vali Loss: 0.0202964 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971822  Vali macro F1 0.9975983 
new best score!!!!
Validation loss decreased (0.021222 --> 0.020296).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 1.2687878608703613
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0263085  Vali Loss: 0.0205057 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971822  Vali macro F1 0.9975983 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 1.2686567306518555
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0231878  Vali Loss: 0.0201002 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971822  Vali macro F1 0.9975983 
new best score!!!!
Validation loss decreased (0.020296 --> 0.020100).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 1.2693710327148438
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0233598  Vali Loss: 0.0207557 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971822  Vali macro F1 0.9975983 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 1.2682812213897705
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0226195  Vali Loss: 0.0197809 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971822  Vali macro F1 0.9975983 
new best score!!!!
Validation loss decreased (0.020100 --> 0.019781).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 1.2743983268737793
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0257708  Vali Loss: 0.0188492 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971822  Vali macro F1 0.9975983 
new best score!!!!
Validation loss decreased (0.019781 --> 0.018849).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 1.269636869430542
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0235080  Vali Loss: 0.0190756 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943559  Vali macro F1 0.9956113 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 1.2705285549163818
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0226485  Vali Loss: 0.0182141 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943559  Vali macro F1 0.9956113 
new best score!!!!
Validation loss decreased (0.018849 --> 0.018214).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 1.2750723361968994
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0217194  Vali Loss: 0.0194013 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943559  Vali macro F1 0.9956113 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 1.2672507762908936
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0221170  Vali Loss: 0.0196405 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943559  Vali macro F1 0.9956113 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 1.2700262069702148
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0233971  Vali Loss: 0.0191040 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943559  Vali macro F1 0.9956113 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 1.2662086486816406
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0224028  Vali Loss: 0.0198320 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943559  Vali macro F1 0.9956113 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 1.2694110870361328
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0228364  Vali Loss: 0.0168560 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971822  Vali macro F1 0.9975983 
new best score!!!!
Validation loss decreased (0.018214 --> 0.016856).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 1.2683193683624268
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0209462  Vali Loss: 0.0181880 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943559  Vali macro F1 0.9956113 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 1.2665669918060303
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0223190  Vali Loss: 0.0178189 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943559  Vali macro F1 0.9956113 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 1.2655446529388428
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0207142  Vali Loss: 0.0171065 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943559  Vali macro F1 0.9956113 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 1.266408920288086
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0216482  Vali Loss: 0.0173365 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943559  Vali macro F1 0.9956113 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 1.2649528980255127
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0199802  Vali Loss: 0.0196996 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943559  Vali macro F1 0.9956113 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 21 cost time: 1.2676715850830078
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0193617  Vali Loss: 0.0177995 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943559  Vali macro F1 0.9956113 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 1.2692480087280273
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0194543  Vali Loss: 0.0198265 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943559  Vali macro F1 0.9956113 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 1.2697467803955078
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0205782  Vali Loss: 0.0183289 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943559  Vali macro F1 0.9956113 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 1.271559476852417
Fine Tuning VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0201725  Vali Loss: 0.0171608 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943559  Vali macro F1 0.9956113 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 25 cost time: 1.269958257675171
Fine Tuning VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0204442  Vali Loss: 0.0182735 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943559  Vali macro F1 0.9956113 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 26 cost time: 1.2734222412109375
Fine Tuning VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0194643  Vali Loss: 0.0186895 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943559  Vali macro F1 0.9956113 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 27 cost time: 1.2703256607055664
Fine Tuning VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0185271  Vali Loss: 0.0185788 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943559  Vali macro F1 0.9956113 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 28 cost time: 1.2700634002685547
Fine Tuning VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0197703  Vali Loss: 0.0182365 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943559  Vali macro F1 0.9956113 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 29 cost time: 1.271606206893921
Fine Tuning VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0185387  Vali Loss: 0.0182640 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943559  Vali macro F1 0.9956113 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 30 cost time: 1.2703731060028076
Fine Tuning VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0186935  Vali Loss: 0.0181084 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943559  Vali macro F1 0.9956113 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9886878  Test weighted F1: 0.9886837  Test macro F1 0.9862777 
================ the 4 th CV Experiment ================ 
Overlapping random Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.00275482 0.00243902 0.00239808 0.00322581 0.00564972 0.00588235
 0.00319489 0.00285714 0.00235294 0.00404858]
Train data number :  3182
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  887
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.2469077110290527
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.2924152  Vali Loss: 2.2504784 Vali Accuracy: 0.1468927  Vali weighted F1: 0.0376277  Vali macro F1 0.0256158 
Validation loss decreased (inf --> 2.250478).  Saving model ...
Epoch: 2 cost time: 1.2447004318237305
VALI: Epoch: 2, Steps: 13 | Train Loss: 2.2491360  Vali Loss: 2.1606672 Vali Accuracy: 0.1977401  Vali weighted F1: 0.1155069  Vali macro F1 0.0906504 
new best score!!!!
Validation loss decreased (2.250478 --> 2.160667).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.2441914081573486
VALI: Epoch: 3, Steps: 13 | Train Loss: 2.0615526  Vali Loss: 1.7932791 Vali Accuracy: 0.4604520  Vali weighted F1: 0.3893353  Vali macro F1 0.3309717 
new best score!!!!
Validation loss decreased (2.160667 --> 1.793279).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.245392084121704
VALI: Epoch: 4, Steps: 13 | Train Loss: 1.6678628  Vali Loss: 1.4217943 Vali Accuracy: 0.5649718  Vali weighted F1: 0.5529984  Vali macro F1 0.5116943 
new best score!!!!
Validation loss decreased (1.793279 --> 1.421794).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.2443211078643799
VALI: Epoch: 5, Steps: 13 | Train Loss: 1.3360039  Vali Loss: 1.1023237 Vali Accuracy: 0.6779661  Vali weighted F1: 0.6562681  Vali macro F1 0.6074242 
new best score!!!!
Validation loss decreased (1.421794 --> 1.102324).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.243722677230835
VALI: Epoch: 6, Steps: 13 | Train Loss: 1.0704756  Vali Loss: 0.8697461 Vali Accuracy: 0.7627119  Vali weighted F1: 0.7458248  Vali macro F1 0.6880982 
new best score!!!!
Validation loss decreased (1.102324 --> 0.869746).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.2448651790618896
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.8810337  Vali Loss: 0.6923223 Vali Accuracy: 0.8192090  Vali weighted F1: 0.8055379  Vali macro F1 0.7450190 
new best score!!!!
Validation loss decreased (0.869746 --> 0.692322).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.2434606552124023
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.7399686  Vali Loss: 0.5916588 Vali Accuracy: 0.8333333  Vali weighted F1: 0.8206653  Vali macro F1 0.7593322 
new best score!!!!
Validation loss decreased (0.692322 --> 0.591659).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.2448573112487793
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.6458388  Vali Loss: 0.5123928 Vali Accuracy: 0.8502825  Vali weighted F1: 0.8357345  Vali macro F1 0.7718043 
new best score!!!!
Validation loss decreased (0.591659 --> 0.512393).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.249908685684204
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.5699006  Vali Loss: 0.4427202 Vali Accuracy: 0.8728814  Vali weighted F1: 0.8662464  Vali macro F1 0.8123620 
new best score!!!!
Validation loss decreased (0.512393 --> 0.442720).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.2441623210906982
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.5067818  Vali Loss: 0.4007101 Vali Accuracy: 0.8559322  Vali weighted F1: 0.8423098  Vali macro F1 0.7752630 
new best score!!!!
Validation loss decreased (0.442720 --> 0.400710).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.2601840496063232
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.4549442  Vali Loss: 0.3525453 Vali Accuracy: 0.8870056  Vali weighted F1: 0.8743674  Vali macro F1 0.8180586 
new best score!!!!
Validation loss decreased (0.400710 --> 0.352545).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.2427992820739746
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.4131967  Vali Loss: 0.3257622 Vali Accuracy: 0.8841808  Vali weighted F1: 0.8785032  Vali macro F1 0.8217101 
new best score!!!!
Validation loss decreased (0.352545 --> 0.325762).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.2452759742736816
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.3825441  Vali Loss: 0.3112960 Vali Accuracy: 0.8954802  Vali weighted F1: 0.8838091  Vali macro F1 0.8181569 
new best score!!!!
Validation loss decreased (0.325762 --> 0.311296).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.2435383796691895
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.3611623  Vali Loss: 0.2819608 Vali Accuracy: 0.9039548  Vali weighted F1: 0.9012094  Vali macro F1 0.8489632 
new best score!!!!
Validation loss decreased (0.311296 --> 0.281961).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.2433748245239258
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.3253779  Vali Loss: 0.2600707 Vali Accuracy: 0.8983051  Vali weighted F1: 0.8881433  Vali macro F1 0.8323139 
new best score!!!!
Validation loss decreased (0.281961 --> 0.260071).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.2437150478363037
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.3044689  Vali Loss: 0.2493871 Vali Accuracy: 0.9011299  Vali weighted F1: 0.8920641  Vali macro F1 0.8330337 
new best score!!!!
Validation loss decreased (0.260071 --> 0.249387).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.2455036640167236
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.2849416  Vali Loss: 0.2309488 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9121634  Vali macro F1 0.8520696 
new best score!!!!
Validation loss decreased (0.249387 --> 0.230949).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.2441680431365967
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.2763998  Vali Loss: 0.2242618 Vali Accuracy: 0.9067797  Vali weighted F1: 0.9023299  Vali macro F1 0.8454779 
new best score!!!!
Validation loss decreased (0.230949 --> 0.224262).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.2440478801727295
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.2531051  Vali Loss: 0.2132821 Vali Accuracy: 0.9124294  Vali weighted F1: 0.9126636  Vali macro F1 0.8567349 
new best score!!!!
Validation loss decreased (0.224262 --> 0.213282).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.2469193935394287
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.2368741  Vali Loss: 0.1867890 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9322146  Vali macro F1 0.8898005 
new best score!!!!
Validation loss decreased (0.213282 --> 0.186789).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.2479071617126465
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.2127114  Vali Loss: 0.1730235 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9416692  Vali macro F1 0.8666209 
new best score!!!!
Validation loss decreased (0.186789 --> 0.173023).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.2448501586914062
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.2081618  Vali Loss: 0.1679186 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9498594  Vali macro F1 0.9092773 
new best score!!!!
Validation loss decreased (0.173023 --> 0.167919).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.248410940170288
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.1904716  Vali Loss: 0.1598435 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9488385  Vali macro F1 0.9025487 
new best score!!!!
Validation loss decreased (0.167919 --> 0.159843).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.247791051864624
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.1831716  Vali Loss: 0.1500247 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9463609  Vali macro F1 0.9005092 
new best score!!!!
Validation loss decreased (0.159843 --> 0.150025).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.2460739612579346
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.1744548  Vali Loss: 0.1597553 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9405164  Vali macro F1 0.9005066 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 1.2450454235076904
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.1642460  Vali Loss: 0.1466720 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9358773  Vali macro F1 0.8911134 
new best score!!!!
Validation loss decreased (0.150025 --> 0.146672).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 1.2464122772216797
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.1640757  Vali Loss: 0.1390731 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9349217  Vali macro F1 0.8668703 
new best score!!!!
Validation loss decreased (0.146672 --> 0.139073).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.245750904083252
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.1425530  Vali Loss: 0.1284596 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9441275  Vali macro F1 0.9026367 
new best score!!!!
Validation loss decreased (0.139073 --> 0.128460).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.2452726364135742
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.1352405  Vali Loss: 0.1345115 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9440659  Vali macro F1 0.9040132 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 1.246370792388916
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.1330902  Vali Loss: 0.1131771 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9528758  Vali macro F1 0.9043760 
new best score!!!!
Validation loss decreased (0.128460 --> 0.113177).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 1.2447996139526367
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.1306709  Vali Loss: 0.1185919 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9550054  Vali macro F1 0.9250539 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 1.2446568012237549
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.1265062  Vali Loss: 0.1080668 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9497622  Vali macro F1 0.9120547 
new best score!!!!
Validation loss decreased (0.113177 --> 0.108067).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 1.2428452968597412
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.1206974  Vali Loss: 0.1113915 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9521534  Vali macro F1 0.9194570 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 1.2439055442810059
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.1235345  Vali Loss: 0.1196283 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9522537  Vali macro F1 0.9224128 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 1.2498955726623535
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.1184514  Vali Loss: 0.1000868 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9539090  Vali macro F1 0.9197887 
new best score!!!!
Validation loss decreased (0.108067 --> 0.100087).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 1.244903326034546
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.1061848  Vali Loss: 0.0926526 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9720416  Vali macro F1 0.9536796 
new best score!!!!
Validation loss decreased (0.100087 --> 0.092653).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 1.2437100410461426
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.1072102  Vali Loss: 0.0859973 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9610048  Vali macro F1 0.9262287 
new best score!!!!
Validation loss decreased (0.092653 --> 0.085997).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 1.245758056640625
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0961962  Vali Loss: 0.0911068 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9692368  Vali macro F1 0.9492629 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 1.246530294418335
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0916285  Vali Loss: 0.0903925 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9692308  Vali macro F1 0.9544120 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 1.2428839206695557
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0851861  Vali Loss: 0.0731908 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9692683  Vali macro F1 0.9412726 
new best score!!!!
Validation loss decreased (0.085997 --> 0.073191).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 1.248058557510376
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0881463  Vali Loss: 0.0905721 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9720967  Vali macro F1 0.9565849 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 1.244570255279541
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0839102  Vali Loss: 0.0830301 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9716542  Vali macro F1 0.9541849 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 1.2439851760864258
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0834434  Vali Loss: 0.0835801 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9717145  Vali macro F1 0.9572558 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 1.2580618858337402
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0771335  Vali Loss: 0.0758529 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9622471  Vali macro F1 0.9425768 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 46 cost time: 1.2442572116851807
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0763540  Vali Loss: 0.1244388 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9547247  Vali macro F1 0.9239448 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 47 cost time: 1.2452380657196045
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0828947  Vali Loss: 0.0630211 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801177  Vali macro F1 0.9740844 
new best score!!!!
Validation loss decreased (0.073191 --> 0.063021).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 1.2444953918457031
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0676995  Vali Loss: 0.0592408 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831605  Vali macro F1 0.9771836 
new best score!!!!
Validation loss decreased (0.063021 --> 0.059241).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 1.2445392608642578
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0659950  Vali Loss: 0.0586163 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831605  Vali macro F1 0.9771836 
new best score!!!!
Validation loss decreased (0.059241 --> 0.058616).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 1.2428512573242188
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0636952  Vali Loss: 0.0565574 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829560  Vali macro F1 0.9762395 
new best score!!!!
Validation loss decreased (0.058616 --> 0.056557).  Saving model ...
new best score!!!!
Epoch: 51 cost time: 1.2437307834625244
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0603389  Vali Loss: 0.0566876 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859893  Vali macro F1 0.9793495 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 1.2440063953399658
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0596110  Vali Loss: 0.0537718 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887602  Vali macro F1 0.9856028 
new best score!!!!
Validation loss decreased (0.056557 --> 0.053772).  Saving model ...
new best score!!!!
Epoch: 53 cost time: 1.240713119506836
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0611472  Vali Loss: 0.0513597 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887096  Vali macro F1 0.9853684 
new best score!!!!
Validation loss decreased (0.053772 --> 0.051360).  Saving model ...
new best score!!!!
Epoch: 54 cost time: 1.2437126636505127
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0614742  Vali Loss: 0.0518618 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887602  Vali macro F1 0.9856028 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 1.2481741905212402
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0595397  Vali Loss: 0.0517364 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859313  Vali macro F1 0.9834369 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 56 cost time: 1.248671293258667
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0615606  Vali Loss: 0.0488751 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887341  Vali macro F1 0.9898759 
new best score!!!!
Validation loss decreased (0.051360 --> 0.048875).  Saving model ...
new best score!!!!
Epoch: 57 cost time: 1.2480506896972656
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0588866  Vali Loss: 0.0522587 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831605  Vali macro F1 0.9771836 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 58 cost time: 1.2491543292999268
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0610484  Vali Loss: 0.0508858 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859313  Vali macro F1 0.9834369 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 59 cost time: 1.2480041980743408
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0601083  Vali Loss: 0.0480759 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886742  Vali macro F1 0.9857750 
new best score!!!!
Validation loss decreased (0.048875 --> 0.048076).  Saving model ...
new best score!!!!
Epoch: 60 cost time: 1.2504773139953613
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0590042  Vali Loss: 0.0469171 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915276  Vali macro F1 0.9924484 
new best score!!!!
Validation loss decreased (0.048076 --> 0.046917).  Saving model ...
new best score!!!!
Epoch: 61 cost time: 1.2340991497039795
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0549182  Vali Loss: 0.0454188 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886742  Vali macro F1 0.9857750 
new best score!!!!
Validation loss decreased (0.046917 --> 0.045419).  Saving model ...
new best score!!!!
Epoch: 62 cost time: 1.23411226272583
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0537666  Vali Loss: 0.0464531 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886742  Vali macro F1 0.9857750 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 63 cost time: 1.2335288524627686
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0579798  Vali Loss: 0.0464764 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886742  Vali macro F1 0.9857750 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 64 cost time: 1.2333102226257324
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0552950  Vali Loss: 0.0465267 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886742  Vali macro F1 0.9857750 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 65 cost time: 1.2322471141815186
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0589798  Vali Loss: 0.0492230 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859540  Vali macro F1 0.9797561 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 66 cost time: 1.2327806949615479
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0569759  Vali Loss: 0.0445614 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915036  Vali macro F1 0.9879412 
new best score!!!!
Validation loss decreased (0.045419 --> 0.044561).  Saving model ...
new best score!!!!
Epoch: 67 cost time: 1.232285976409912
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0535710  Vali Loss: 0.0458349 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887833  Vali macro F1 0.9819223 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 68 cost time: 1.2305819988250732
VALI: Epoch: 68, Steps: 13 | Train Loss: 0.0558447  Vali Loss: 0.0436405 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886742  Vali macro F1 0.9857750 
new best score!!!!
Validation loss decreased (0.044561 --> 0.043640).  Saving model ...
new best score!!!!
Epoch: 69 cost time: 1.229081153869629
VALI: Epoch: 69, Steps: 13 | Train Loss: 0.0522859  Vali Loss: 0.0481208 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859313  Vali macro F1 0.9834369 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 70 cost time: 1.2323458194732666
VALI: Epoch: 70, Steps: 13 | Train Loss: 0.0543114  Vali Loss: 0.0420498 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915036  Vali macro F1 0.9879412 
new best score!!!!
Validation loss decreased (0.043640 --> 0.042050).  Saving model ...
new best score!!!!
Epoch: 71 cost time: 1.2306785583496094
VALI: Epoch: 71, Steps: 13 | Train Loss: 0.0512955  Vali Loss: 0.0437118 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915630  Vali macro F1 0.9920418 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 72 cost time: 1.2315893173217773
VALI: Epoch: 72, Steps: 13 | Train Loss: 0.0553786  Vali Loss: 0.0435592 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915276  Vali macro F1 0.9924484 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 73 cost time: 1.2337453365325928
VALI: Epoch: 73, Steps: 13 | Train Loss: 0.0574056  Vali Loss: 0.0468071 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858807  Vali macro F1 0.9832025 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 74 cost time: 1.2290019989013672
VALI: Epoch: 74, Steps: 13 | Train Loss: 0.0509528  Vali Loss: 0.0469072 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859313  Vali macro F1 0.9834369 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 75 cost time: 1.2346701622009277
VALI: Epoch: 75, Steps: 13 | Train Loss: 0.0532169  Vali Loss: 0.0439771 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887096  Vali macro F1 0.9853684 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 76 cost time: 1.2298996448516846
VALI: Epoch: 76, Steps: 13 | Train Loss: 0.0514173  Vali Loss: 0.0438108 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887096  Vali macro F1 0.9853684 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 77 cost time: 1.2461705207824707
VALI: Epoch: 77, Steps: 13 | Train Loss: 0.0518730  Vali Loss: 0.0436853 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887096  Vali macro F1 0.9853684 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 78 cost time: 1.2337028980255127
VALI: Epoch: 78, Steps: 13 | Train Loss: 0.0510480  Vali Loss: 0.0436583 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915630  Vali macro F1 0.9920418 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 79 cost time: 1.2328770160675049
VALI: Epoch: 79, Steps: 13 | Train Loss: 0.0523050  Vali Loss: 0.0437344 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915630  Vali macro F1 0.9920418 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 80 cost time: 1.237011194229126
VALI: Epoch: 80, Steps: 13 | Train Loss: 0.0487293  Vali Loss: 0.0438607 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915630  Vali macro F1 0.9920418 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 81 cost time: 1.2350118160247803
VALI: Epoch: 81, Steps: 13 | Train Loss: 0.0499164  Vali Loss: 0.0438594 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915630  Vali macro F1 0.9920418 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 82 cost time: 1.2348051071166992
VALI: Epoch: 82, Steps: 13 | Train Loss: 0.0471469  Vali Loss: 0.0438640 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915630  Vali macro F1 0.9920418 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 83 cost time: 1.2317893505096436
VALI: Epoch: 83, Steps: 13 | Train Loss: 0.0531250  Vali Loss: 0.0438789 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915630  Vali macro F1 0.9920418 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 84 cost time: 1.2346103191375732
VALI: Epoch: 84, Steps: 13 | Train Loss: 0.0514198  Vali Loss: 0.0439106 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915630  Vali macro F1 0.9920418 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 85 cost time: 1.232935905456543
VALI: Epoch: 85, Steps: 13 | Train Loss: 0.0522393  Vali Loss: 0.0439063 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915630  Vali macro F1 0.9920418 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9830891  Test weighted F1: 0.9830383  Test macro F1 0.9813202 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 73347
pruned model Parameter : 76626
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.2626938819885254
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0534116  Vali Loss: 0.0426542 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915036  Vali macro F1 0.9879412 
Validation loss decreased (inf --> 0.042654).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.2552735805511475
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0507003  Vali Loss: 0.0448150 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915630  Vali macro F1 0.9920418 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.2507116794586182
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0539875  Vali Loss: 0.0432668 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915630  Vali macro F1 0.9920418 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 1.2528705596923828
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0573422  Vali Loss: 0.0447750 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858807  Vali macro F1 0.9832025 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 1.2502501010894775
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0503910  Vali Loss: 0.0482652 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831605  Vali macro F1 0.9771836 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 1.2517244815826416
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0541629  Vali Loss: 0.0439235 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887096  Vali macro F1 0.9853684 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 1.2509472370147705
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0520983  Vali Loss: 0.0417131 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915630  Vali macro F1 0.9920418 
new best score!!!!
Validation loss decreased (0.042654 --> 0.041713).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 1.251988172531128
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0479466  Vali Loss: 0.0410646 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915036  Vali macro F1 0.9879412 
new best score!!!!
Validation loss decreased (0.041713 --> 0.041065).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 1.2513542175292969
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0511714  Vali Loss: 0.0416891 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915036  Vali macro F1 0.9879412 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 1.2533864974975586
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0494517  Vali Loss: 0.0428754 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887602  Vali macro F1 0.9856028 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 1.2542917728424072
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0501212  Vali Loss: 0.0409532 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915036  Vali macro F1 0.9879412 
new best score!!!!
Validation loss decreased (0.041065 --> 0.040953).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 1.2538228034973145
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0475563  Vali Loss: 0.0460123 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859893  Vali macro F1 0.9793495 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 1.2537312507629395
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0487737  Vali Loss: 0.0419296 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887096  Vali macro F1 0.9853684 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 1.2541210651397705
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0469568  Vali Loss: 0.0421667 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915630  Vali macro F1 0.9920418 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 1.2547345161437988
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0455520  Vali Loss: 0.0411503 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915630  Vali macro F1 0.9920418 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 1.2546942234039307
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0472152  Vali Loss: 0.0408130 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887096  Vali macro F1 0.9853684 
new best score!!!!
Validation loss decreased (0.040953 --> 0.040813).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 1.25581955909729
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0457074  Vali Loss: 0.0448281 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859313  Vali macro F1 0.9834369 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 1.2543323040008545
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0457395  Vali Loss: 0.0374298 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887096  Vali macro F1 0.9853684 
new best score!!!!
Validation loss decreased (0.040813 --> 0.037430).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 1.2584407329559326
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0436860  Vali Loss: 0.0384694 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915630  Vali macro F1 0.9920418 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 1.2584483623504639
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0464910  Vali Loss: 0.0379819 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915630  Vali macro F1 0.9920418 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 1.258042573928833
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0453349  Vali Loss: 0.0386835 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887096  Vali macro F1 0.9853684 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 1.266103982925415
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0421024  Vali Loss: 0.0383296 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887096  Vali macro F1 0.9853684 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 23 cost time: 1.2574031352996826
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0444836  Vali Loss: 0.0395769 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915630  Vali macro F1 0.9920418 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 24 cost time: 1.2707550525665283
Fine Tuning VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0440255  Vali Loss: 0.0380884 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915630  Vali macro F1 0.9920418 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 25 cost time: 1.2605078220367432
Fine Tuning VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0442219  Vali Loss: 0.0379067 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887096  Vali macro F1 0.9853684 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 26 cost time: 1.2586071491241455
Fine Tuning VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0452072  Vali Loss: 0.0377746 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887096  Vali macro F1 0.9853684 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 27 cost time: 1.2579174041748047
Fine Tuning VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0432244  Vali Loss: 0.0376131 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887096  Vali macro F1 0.9853684 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 28 cost time: 1.2565312385559082
Fine Tuning VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0412666  Vali Loss: 0.0376071 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915630  Vali macro F1 0.9920418 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 29 cost time: 1.2579283714294434
Fine Tuning VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0423753  Vali Loss: 0.0376127 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915630  Vali macro F1 0.9920418 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 30 cost time: 1.2571804523468018
Fine Tuning VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0430237  Vali Loss: 0.0375831 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915630  Vali macro F1 0.9920418 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 31 cost time: 1.257908821105957
Fine Tuning VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0390903  Vali Loss: 0.0375403 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915630  Vali macro F1 0.9920418 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 32 cost time: 1.2585980892181396
Fine Tuning VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0422683  Vali Loss: 0.0375097 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915630  Vali macro F1 0.9920418 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 33 cost time: 1.2609071731567383
Fine Tuning VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0421632  Vali Loss: 0.0374633 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915630  Vali macro F1 0.9920418 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9864713  Test weighted F1: 0.9864555  Test macro F1 0.9852221 
Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 73347
Set the seed as :  2
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
================ SOCV Mode ====================
================ 5 CV ======================
================ the 0 th CV Experiment ================ 
Overlapping random Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.002849   0.00238663 0.00242718 0.00324675 0.00552486 0.00552486
 0.00308642 0.00288184 0.00236407 0.0041841 ]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.2453868389129639
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.3039850  Vali Loss: 2.2762815 Vali Accuracy: 0.1610169  Vali weighted F1: 0.0639167  Vali macro F1 0.0519511 
Validation loss decreased (inf --> 2.276282).  Saving model ...
Epoch: 2 cost time: 1.2326905727386475
VALI: Epoch: 2, Steps: 13 | Train Loss: 2.2167123  Vali Loss: 2.0259200 Vali Accuracy: 0.2542373  Vali weighted F1: 0.1514539  Vali macro F1 0.1206761 
new best score!!!!
Validation loss decreased (2.276282 --> 2.025920).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.2309975624084473
VALI: Epoch: 3, Steps: 13 | Train Loss: 1.8544910  Vali Loss: 1.4475290 Vali Accuracy: 0.5367232  Vali weighted F1: 0.5115598  Vali macro F1 0.4670786 
new best score!!!!
Validation loss decreased (2.025920 --> 1.447529).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.2321877479553223
VALI: Epoch: 4, Steps: 13 | Train Loss: 1.4626345  Vali Loss: 1.1323523 Vali Accuracy: 0.6468927  Vali weighted F1: 0.6221310  Vali macro F1 0.5905656 
new best score!!!!
Validation loss decreased (1.447529 --> 1.132352).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.2313082218170166
VALI: Epoch: 5, Steps: 13 | Train Loss: 1.1839828  Vali Loss: 0.9019264 Vali Accuracy: 0.7570621  Vali weighted F1: 0.7520605  Vali macro F1 0.7254940 
new best score!!!!
Validation loss decreased (1.132352 --> 0.901926).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.2312283515930176
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.9860563  Vali Loss: 0.7235247 Vali Accuracy: 0.8220339  Vali weighted F1: 0.8125260  Vali macro F1 0.7670420 
new best score!!!!
Validation loss decreased (0.901926 --> 0.723525).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.23081636428833
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.8286929  Vali Loss: 0.5836251 Vali Accuracy: 0.8587571  Vali weighted F1: 0.8557843  Vali macro F1 0.8247459 
new best score!!!!
Validation loss decreased (0.723525 --> 0.583625).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.2317204475402832
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.6921290  Vali Loss: 0.4960917 Vali Accuracy: 0.8615819  Vali weighted F1: 0.8481044  Vali macro F1 0.7899948 
new best score!!!!
Validation loss decreased (0.583625 --> 0.496092).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.235424518585205
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.6038769  Vali Loss: 0.4284017 Vali Accuracy: 0.8531073  Vali weighted F1: 0.8380786  Vali macro F1 0.7815768 
new best score!!!!
Validation loss decreased (0.496092 --> 0.428402).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.2323706150054932
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.5097955  Vali Loss: 0.3687176 Vali Accuracy: 0.8728814  Vali weighted F1: 0.8661786  Vali macro F1 0.8205840 
new best score!!!!
Validation loss decreased (0.428402 --> 0.368718).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.232933521270752
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.4509473  Vali Loss: 0.3342584 Vali Accuracy: 0.8700565  Vali weighted F1: 0.8535378  Vali macro F1 0.7961002 
new best score!!!!
Validation loss decreased (0.368718 --> 0.334258).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.2314152717590332
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.4100992  Vali Loss: 0.2834522 Vali Accuracy: 0.9152542  Vali weighted F1: 0.9134436  Vali macro F1 0.8742872 
new best score!!!!
Validation loss decreased (0.334258 --> 0.283452).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.2323801517486572
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.3825987  Vali Loss: 0.2607211 Vali Accuracy: 0.9265537  Vali weighted F1: 0.9195347  Vali macro F1 0.8656702 
new best score!!!!
Validation loss decreased (0.283452 --> 0.260721).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.233290195465088
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.3576720  Vali Loss: 0.2349347 Vali Accuracy: 0.9067797  Vali weighted F1: 0.8961608  Vali macro F1 0.8434135 
new best score!!!!
Validation loss decreased (0.260721 --> 0.234935).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.231675624847412
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.3309404  Vali Loss: 0.2283110 Vali Accuracy: 0.9265537  Vali weighted F1: 0.9150291  Vali macro F1 0.8572453 
new best score!!!!
Validation loss decreased (0.234935 --> 0.228311).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.232346773147583
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.3152473  Vali Loss: 0.2132369 Vali Accuracy: 0.9096045  Vali weighted F1: 0.9044756  Vali macro F1 0.8674598 
new best score!!!!
Validation loss decreased (0.228311 --> 0.213237).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.2324135303497314
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.2971262  Vali Loss: 0.2072213 Vali Accuracy: 0.9152542  Vali weighted F1: 0.9035667  Vali macro F1 0.8504334 
new best score!!!!
Validation loss decreased (0.213237 --> 0.207221).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.232640027999878
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.2707427  Vali Loss: 0.1749355 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9344622  Vali macro F1 0.8857346 
new best score!!!!
Validation loss decreased (0.207221 --> 0.174936).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.2327048778533936
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.2537439  Vali Loss: 0.1701818 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9389483  Vali macro F1 0.8970048 
new best score!!!!
Validation loss decreased (0.174936 --> 0.170182).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.2367274761199951
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.2412338  Vali Loss: 0.1806180 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9361706  Vali macro F1 0.8934680 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 1.238097906112671
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.2369236  Vali Loss: 0.1466642 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9486942  Vali macro F1 0.9032503 
new best score!!!!
Validation loss decreased (0.170182 --> 0.146664).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.2348120212554932
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.2263360  Vali Loss: 0.1505738 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9402464  Vali macro F1 0.9009727 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 1.2533230781555176
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.2139408  Vali Loss: 0.1361624 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9451262  Vali macro F1 0.8992632 
new best score!!!!
Validation loss decreased (0.146664 --> 0.136162).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.2349143028259277
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.1943768  Vali Loss: 0.1208245 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9404733  Vali macro F1 0.8859681 
new best score!!!!
Validation loss decreased (0.136162 --> 0.120824).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.236647129058838
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.1812389  Vali Loss: 0.1402301 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9420976  Vali macro F1 0.9011007 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 1.2305991649627686
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.1779808  Vali Loss: 0.1138582 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9516391  Vali macro F1 0.8972313 
new best score!!!!
Validation loss decreased (0.120824 --> 0.113858).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.2305858135223389
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.1712965  Vali Loss: 0.1159720 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9458903  Vali macro F1 0.8949537 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 1.241490125656128
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.1786062  Vali Loss: 0.1115534 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9443815  Vali macro F1 0.8949498 
new best score!!!!
Validation loss decreased (0.113858 --> 0.111553).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.2511518001556396
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.1614334  Vali Loss: 0.1072721 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9485125  Vali macro F1 0.9008638 
new best score!!!!
Validation loss decreased (0.111553 --> 0.107272).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.2299282550811768
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.1547702  Vali Loss: 0.0997949 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9494783  Vali macro F1 0.9027752 
new best score!!!!
Validation loss decreased (0.107272 --> 0.099795).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 1.2307934761047363
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.1509676  Vali Loss: 0.1007546 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9503888  Vali macro F1 0.9022203 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 1.2285034656524658
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.1503919  Vali Loss: 0.0964682 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9527390  Vali macro F1 0.9074732 
new best score!!!!
Validation loss decreased (0.099795 --> 0.096468).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 1.230652093887329
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.1432771  Vali Loss: 0.0982867 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9578987  Vali macro F1 0.9146773 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 1.2294909954071045
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.1321756  Vali Loss: 0.0942700 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9517153  Vali macro F1 0.9066638 
new best score!!!!
Validation loss decreased (0.096468 --> 0.094270).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.2299063205718994
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.1318344  Vali Loss: 0.0942527 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9499115  Vali macro F1 0.9047898 
new best score!!!!
Validation loss decreased (0.094270 --> 0.094253).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 1.2279078960418701
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.1284264  Vali Loss: 0.0903387 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9513163  Vali macro F1 0.9055180 
new best score!!!!
Validation loss decreased (0.094253 --> 0.090339).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 1.2304248809814453
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.1300451  Vali Loss: 0.0857044 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9496421  Vali macro F1 0.8977896 
new best score!!!!
Validation loss decreased (0.090339 --> 0.085704).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 1.2321767807006836
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.1258249  Vali Loss: 0.0841991 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9576244  Vali macro F1 0.9153060 
new best score!!!!
Validation loss decreased (0.085704 --> 0.084199).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 1.2343976497650146
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.1291125  Vali Loss: 0.0874370 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9445405  Vali macro F1 0.8899477 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 1.2301909923553467
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.1273605  Vali Loss: 0.0841958 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9490691  Vali macro F1 0.9005161 
new best score!!!!
Validation loss decreased (0.084199 --> 0.084196).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 1.2279222011566162
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.1126890  Vali Loss: 0.0821035 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9490691  Vali macro F1 0.9005161 
new best score!!!!
Validation loss decreased (0.084196 --> 0.082103).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 1.2341458797454834
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.1171242  Vali Loss: 0.0856306 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9462417  Vali macro F1 0.8978326 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 1.2322254180908203
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.1106063  Vali Loss: 0.0828514 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9431191  Vali macro F1 0.8901240 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 1.229717493057251
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.1083407  Vali Loss: 0.0818539 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9527387  Vali macro F1 0.9071305 
new best score!!!!
Validation loss decreased (0.082103 --> 0.081854).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 1.230358362197876
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.1082442  Vali Loss: 0.0738600 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9555665  Vali macro F1 0.9098143 
new best score!!!!
Validation loss decreased (0.081854 --> 0.073860).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 1.2310004234313965
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.1071552  Vali Loss: 0.0733839 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9579096  Vali macro F1 0.9150000 
new best score!!!!
Validation loss decreased (0.073860 --> 0.073384).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 1.2315738201141357
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.1061284  Vali Loss: 0.0721290 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9532164  Vali macro F1 0.9045614 
new best score!!!!
Validation loss decreased (0.073384 --> 0.072129).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 1.2346336841583252
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.1015297  Vali Loss: 0.0740236 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9541439  Vali macro F1 0.9078591 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 1.2319281101226807
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.1008012  Vali Loss: 0.0697260 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9573703  Vali macro F1 0.9116883 
new best score!!!!
Validation loss decreased (0.072129 --> 0.069726).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 1.2302672863006592
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0973714  Vali Loss: 0.0651734 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9719496  Vali macro F1 0.9403509 
new best score!!!!
Validation loss decreased (0.069726 --> 0.065173).  Saving model ...
new best score!!!!
Epoch: 51 cost time: 1.2323758602142334
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0878832  Vali Loss: 0.0661545 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9630543  Vali macro F1 0.9234632 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 1.239689588546753
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0833076  Vali Loss: 0.0658161 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9590643  Vali macro F1 0.9164912 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 53 cost time: 1.2326617240905762
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0828578  Vali Loss: 0.0585819 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746887  Vali macro F1 0.9458886 
new best score!!!!
Validation loss decreased (0.065173 --> 0.058582).  Saving model ...
new best score!!!!
Epoch: 54 cost time: 1.2505395412445068
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0795543  Vali Loss: 0.0616864 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9634358  Vali macro F1 0.9234632 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 1.231208324432373
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0817221  Vali Loss: 0.0583407 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9691218  Vali macro F1 0.9376670 
new best score!!!!
Validation loss decreased (0.058582 --> 0.058341).  Saving model ...
new best score!!!!
Epoch: 56 cost time: 1.2306694984436035
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0807404  Vali Loss: 0.0730184 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9689713  Vali macro F1 0.9449379 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 57 cost time: 1.2311758995056152
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0844915  Vali Loss: 0.0643529 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9713591  Vali macro F1 0.9409722 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 58 cost time: 1.2341456413269043
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0761728  Vali Loss: 0.0497952 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9855210  Vali macro F1 0.9683721 
new best score!!!!
Validation loss decreased (0.058341 --> 0.049795).  Saving model ...
new best score!!!!
Epoch: 59 cost time: 1.2298274040222168
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0765223  Vali Loss: 0.0511382 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9818450  Vali macro F1 0.9596838 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 60 cost time: 1.231889009475708
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0783708  Vali Loss: 0.0518247 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803407  Vali macro F1 0.9618995 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 61 cost time: 1.2361204624176025
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0646555  Vali Loss: 0.0654189 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9685312  Vali macro F1 0.9382884 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 62 cost time: 1.2339117527008057
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0658439  Vali Loss: 0.0567290 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803407  Vali macro F1 0.9618995 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 63 cost time: 1.2325153350830078
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0617803  Vali Loss: 0.0400487 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9885350  Vali macro F1 0.9750916 
new best score!!!!
Validation loss decreased (0.049795 --> 0.040049).  Saving model ...
new best score!!!!
Epoch: 64 cost time: 1.2352027893066406
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0628045  Vali Loss: 0.0545134 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802823  Vali macro F1 0.9685715 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 65 cost time: 1.2374236583709717
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0548780  Vali Loss: 0.0327586 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
new best score!!!!
Validation loss decreased (0.040049 --> 0.032759).  Saving model ...
new best score!!!!
Epoch: 66 cost time: 1.234025001525879
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0579774  Vali Loss: 0.0377103 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887799  Vali macro F1 0.9761404 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 67 cost time: 1.2329010963439941
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0485134  Vali Loss: 0.0290794 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914400  Vali macro F1 0.9852047 
new best score!!!!
Validation loss decreased (0.032759 --> 0.029079).  Saving model ...
new best score!!!!
Epoch: 68 cost time: 1.2277791500091553
VALI: Epoch: 68, Steps: 13 | Train Loss: 0.0490445  Vali Loss: 0.0310569 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915224  Vali macro F1 0.9851733 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 69 cost time: 1.2316372394561768
VALI: Epoch: 69, Steps: 13 | Train Loss: 0.0614317  Vali Loss: 0.0481246 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859461  Vali macro F1 0.9769757 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 70 cost time: 1.2344002723693848
VALI: Epoch: 70, Steps: 13 | Train Loss: 0.0446360  Vali Loss: 0.0258309 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915629  Vali macro F1 0.9819629 
new best score!!!!
Validation loss decreased (0.029079 --> 0.025831).  Saving model ...
new best score!!!!
Epoch: 71 cost time: 1.2306015491485596
VALI: Epoch: 71, Steps: 13 | Train Loss: 0.0444568  Vali Loss: 0.0337543 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915629  Vali macro F1 0.9819629 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 72 cost time: 1.2300970554351807
VALI: Epoch: 72, Steps: 13 | Train Loss: 0.0529874  Vali Loss: 0.0285209 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9942675  Vali macro F1 0.9875458 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 73 cost time: 1.2316715717315674
VALI: Epoch: 73, Steps: 13 | Train Loss: 0.0451426  Vali Loss: 0.0293218 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887350  Vali macro F1 0.9792790 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 74 cost time: 1.2324938774108887
VALI: Epoch: 74, Steps: 13 | Train Loss: 0.0417877  Vali Loss: 0.0240552 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915629  Vali macro F1 0.9819629 
new best score!!!!
Validation loss decreased (0.025831 --> 0.024055).  Saving model ...
new best score!!!!
Epoch: 75 cost time: 1.2342278957366943
VALI: Epoch: 75, Steps: 13 | Train Loss: 0.0427113  Vali Loss: 0.0179582 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.024055 --> 0.017958).  Saving model ...
new best score!!!!
Epoch: 76 cost time: 1.2297587394714355
VALI: Epoch: 76, Steps: 13 | Train Loss: 0.0370065  Vali Loss: 0.0309979 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859079  Vali macro F1 0.9769383 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 77 cost time: 1.2328765392303467
VALI: Epoch: 77, Steps: 13 | Train Loss: 0.0380557  Vali Loss: 0.0178688 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.017958 --> 0.017869).  Saving model ...
new best score!!!!
Epoch: 78 cost time: 1.2310526371002197
VALI: Epoch: 78, Steps: 13 | Train Loss: 0.0393409  Vali Loss: 0.0219429 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 79 cost time: 1.23525071144104
VALI: Epoch: 79, Steps: 13 | Train Loss: 0.0468489  Vali Loss: 0.0326964 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886239  Vali macro F1 0.9828845 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 80 cost time: 1.2296783924102783
VALI: Epoch: 80, Steps: 13 | Train Loss: 0.0372344  Vali Loss: 0.0280277 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915224  Vali macro F1 0.9851733 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 81 cost time: 1.2306580543518066
VALI: Epoch: 81, Steps: 13 | Train Loss: 0.0320514  Vali Loss: 0.0281245 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887350  Vali macro F1 0.9792790 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 82 cost time: 1.2342653274536133
VALI: Epoch: 82, Steps: 13 | Train Loss: 0.0261780  Vali Loss: 0.0157067 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.017869 --> 0.015707).  Saving model ...
new best score!!!!
Epoch: 83 cost time: 1.2394609451293945
VALI: Epoch: 83, Steps: 13 | Train Loss: 0.0278921  Vali Loss: 0.0181245 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 84 cost time: 1.2319800853729248
VALI: Epoch: 84, Steps: 13 | Train Loss: 0.0313312  Vali Loss: 0.0232965 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943294  Vali macro F1 0.9911734 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 85 cost time: 1.2521188259124756
VALI: Epoch: 85, Steps: 13 | Train Loss: 0.0320976  Vali Loss: 0.0236212 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887399  Vali macro F1 0.9796294 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 86 cost time: 1.2350854873657227
VALI: Epoch: 86, Steps: 13 | Train Loss: 0.0284237  Vali Loss: 0.0197940 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887350  Vali macro F1 0.9792790 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 87 cost time: 1.2319262027740479
VALI: Epoch: 87, Steps: 13 | Train Loss: 0.0363414  Vali Loss: 0.0231188 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943343  Vali macro F1 0.9915238 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 88 cost time: 1.2325685024261475
VALI: Epoch: 88, Steps: 13 | Train Loss: 0.0325770  Vali Loss: 0.0196329 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915273  Vali macro F1 0.9855237 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 89 cost time: 1.231154441833496
VALI: Epoch: 89, Steps: 13 | Train Loss: 0.0215671  Vali Loss: 0.0208374 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887399  Vali macro F1 0.9796294 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 90 cost time: 1.2305266857147217
VALI: Epoch: 90, Steps: 13 | Train Loss: 0.0231474  Vali Loss: 0.0168587 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943343  Vali macro F1 0.9915238 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 91 cost time: 1.2313964366912842
VALI: Epoch: 91, Steps: 13 | Train Loss: 0.0238636  Vali Loss: 0.0179054 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915273  Vali macro F1 0.9855237 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 92 cost time: 1.230726957321167
VALI: Epoch: 92, Steps: 13 | Train Loss: 0.0208217  Vali Loss: 0.0190127 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887399  Vali macro F1 0.9796294 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 93 cost time: 1.2302770614624023
VALI: Epoch: 93, Steps: 13 | Train Loss: 0.0228565  Vali Loss: 0.0181244 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915273  Vali macro F1 0.9855237 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 94 cost time: 1.2298645973205566
VALI: Epoch: 94, Steps: 13 | Train Loss: 0.0186065  Vali Loss: 0.0174526 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915273  Vali macro F1 0.9855237 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 95 cost time: 1.2332475185394287
VALI: Epoch: 95, Steps: 13 | Train Loss: 0.0206266  Vali Loss: 0.0171957 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915273  Vali macro F1 0.9855237 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 96 cost time: 1.2349812984466553
VALI: Epoch: 96, Steps: 13 | Train Loss: 0.0192864  Vali Loss: 0.0169130 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943343  Vali macro F1 0.9915238 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 97 cost time: 1.234302282333374
VALI: Epoch: 97, Steps: 13 | Train Loss: 0.0176174  Vali Loss: 0.0167153 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943343  Vali macro F1 0.9915238 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9886878  Test weighted F1: 0.9886958  Test macro F1 0.9842352 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 73347
pruned model Parameter : 76626
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.2574918270111084
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0258997  Vali Loss: 0.0191071 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
Validation loss decreased (inf --> 0.019107).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.2509186267852783
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0236334  Vali Loss: 0.0164278 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.019107 --> 0.016428).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 1.2515168190002441
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0233845  Vali Loss: 0.0166225 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 1.2520959377288818
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0240249  Vali Loss: 0.0158167 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.016428 --> 0.015817).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 1.2554545402526855
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0220137  Vali Loss: 0.0155705 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.015817 --> 0.015571).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 1.2518694400787354
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0207016  Vali Loss: 0.0152251 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.015571 --> 0.015225).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 1.2535696029663086
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0217422  Vali Loss: 0.0153381 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 1.2524447441101074
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0213672  Vali Loss: 0.0164837 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 1.2593085765838623
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0201834  Vali Loss: 0.0149115 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.015225 --> 0.014912).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 1.253108263015747
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0192656  Vali Loss: 0.0194188 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915629  Vali macro F1 0.9819629 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 1.2528314590454102
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0213991  Vali Loss: 0.0153563 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 1.2516531944274902
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0196889  Vali Loss: 0.0156851 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 1.249295949935913
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0201815  Vali Loss: 0.0143743 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.014912 --> 0.014374).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 1.2486212253570557
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0236631  Vali Loss: 0.0147019 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 1.2522492408752441
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0204739  Vali Loss: 0.0146657 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 1.250854730606079
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0233649  Vali Loss: 0.0143132 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.014374 --> 0.014313).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 1.248408555984497
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0207973  Vali Loss: 0.0144963 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 1.2529337406158447
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0183877  Vali Loss: 0.0159491 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 1.260967493057251
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0195987  Vali Loss: 0.0151190 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 1.2514193058013916
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0199453  Vali Loss: 0.0152983 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 1.255202293395996
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0211218  Vali Loss: 0.0140804 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.014313 --> 0.014080).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 22 cost time: 1.2522048950195312
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0173572  Vali Loss: 0.0141223 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 1.2531788349151611
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0188041  Vali Loss: 0.0134345 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.014080 --> 0.013435).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 24 cost time: 1.2608084678649902
Fine Tuning VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0150339  Vali Loss: 0.0137146 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 25 cost time: 1.2601213455200195
Fine Tuning VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0204643  Vali Loss: 0.0146420 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 26 cost time: 1.2571194171905518
Fine Tuning VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0204345  Vali Loss: 0.0140796 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 27 cost time: 1.259598731994629
Fine Tuning VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0182769  Vali Loss: 0.0191741 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887350  Vali macro F1 0.9792790 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 28 cost time: 1.2657818794250488
Fine Tuning VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0175095  Vali Loss: 0.0134776 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 29 cost time: 1.255025863647461
Fine Tuning VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0178934  Vali Loss: 0.0130553 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.013435 --> 0.013055).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 30 cost time: 1.256131887435913
Fine Tuning VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0174906  Vali Loss: 0.0133989 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 31 cost time: 1.2571258544921875
Fine Tuning VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0212640  Vali Loss: 0.0170144 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915629  Vali macro F1 0.9819629 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 32 cost time: 1.2586889266967773
Fine Tuning VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0212230  Vali Loss: 0.0154333 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 33 cost time: 1.257810354232788
Fine Tuning VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0166996  Vali Loss: 0.0146174 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 34 cost time: 1.2563235759735107
Fine Tuning VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0172408  Vali Loss: 0.0141501 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 35 cost time: 1.2471797466278076
Fine Tuning VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0173587  Vali Loss: 0.0139300 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 36 cost time: 1.2459895610809326
Fine Tuning VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0171131  Vali Loss: 0.0136478 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 37 cost time: 1.2497224807739258
Fine Tuning VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0149896  Vali Loss: 0.0134932 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 38 cost time: 1.2487080097198486
Fine Tuning VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0184791  Vali Loss: 0.0135016 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 39 cost time: 1.2501928806304932
Fine Tuning VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0181701  Vali Loss: 0.0134789 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 40 cost time: 1.2507598400115967
Fine Tuning VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0161372  Vali Loss: 0.0134784 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 41 cost time: 1.2551014423370361
Fine Tuning VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0172388  Vali Loss: 0.0134598 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 42 cost time: 1.2509901523590088
Fine Tuning VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0178176  Vali Loss: 0.0134570 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 43 cost time: 1.247922658920288
Fine Tuning VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0163532  Vali Loss: 0.0134689 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 44 cost time: 1.2528061866760254
Fine Tuning VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0152504  Vali Loss: 0.0134674 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9920814  Test weighted F1: 0.9920905  Test macro F1 0.9895968 
================ the 1 th CV Experiment ================ 
Overlapping random Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00271739 0.002331   0.00242131 0.00326797 0.00595238 0.00578035
 0.00303951 0.00301205 0.00238095 0.00404858]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.2264680862426758
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.3029346  Vali Loss: 2.2758786 Vali Accuracy: 0.2344633  Vali weighted F1: 0.1380764  Vali macro F1 0.1103509 
Validation loss decreased (inf --> 2.275879).  Saving model ...
Epoch: 2 cost time: 1.2283258438110352
VALI: Epoch: 2, Steps: 13 | Train Loss: 2.2083783  Vali Loss: 2.0129688 Vali Accuracy: 0.2683616  Vali weighted F1: 0.1769678  Vali macro F1 0.1421408 
new best score!!!!
Validation loss decreased (2.275879 --> 2.012969).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.2352054119110107
VALI: Epoch: 3, Steps: 13 | Train Loss: 1.8325831  Vali Loss: 1.4075928 Vali Accuracy: 0.5564972  Vali weighted F1: 0.5155087  Vali macro F1 0.4524043 
new best score!!!!
Validation loss decreased (2.012969 --> 1.407593).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.2270019054412842
VALI: Epoch: 4, Steps: 13 | Train Loss: 1.4366277  Vali Loss: 1.0816803 Vali Accuracy: 0.7062147  Vali weighted F1: 0.6702141  Vali macro F1 0.6432011 
new best score!!!!
Validation loss decreased (1.407593 --> 1.081680).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.2517940998077393
VALI: Epoch: 5, Steps: 13 | Train Loss: 1.1488181  Vali Loss: 0.8587221 Vali Accuracy: 0.7853107  Vali weighted F1: 0.7822300  Vali macro F1 0.7504778 
new best score!!!!
Validation loss decreased (1.081680 --> 0.858722).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.2338197231292725
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.9626157  Vali Loss: 0.6829262 Vali Accuracy: 0.7966102  Vali weighted F1: 0.7835334  Vali macro F1 0.7315475 
new best score!!!!
Validation loss decreased (0.858722 --> 0.682926).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.2342617511749268
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.8054003  Vali Loss: 0.5878334 Vali Accuracy: 0.8531073  Vali weighted F1: 0.8400368  Vali macro F1 0.7913810 
new best score!!!!
Validation loss decreased (0.682926 --> 0.587833).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.2332096099853516
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.6816440  Vali Loss: 0.4853952 Vali Accuracy: 0.8672316  Vali weighted F1: 0.8598139  Vali macro F1 0.8137384 
new best score!!!!
Validation loss decreased (0.587833 --> 0.485395).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.2368991374969482
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.5948714  Vali Loss: 0.4277499 Vali Accuracy: 0.8559322  Vali weighted F1: 0.8512591  Vali macro F1 0.8195880 
new best score!!!!
Validation loss decreased (0.485395 --> 0.427750).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.2378699779510498
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.5139149  Vali Loss: 0.3644648 Vali Accuracy: 0.9067797  Vali weighted F1: 0.9033270  Vali macro F1 0.8741203 
new best score!!!!
Validation loss decreased (0.427750 --> 0.364465).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.2364511489868164
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.4640390  Vali Loss: 0.3313576 Vali Accuracy: 0.8813559  Vali weighted F1: 0.8816857  Vali macro F1 0.8357185 
new best score!!!!
Validation loss decreased (0.364465 --> 0.331358).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.2328314781188965
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.4172382  Vali Loss: 0.2934275 Vali Accuracy: 0.9180791  Vali weighted F1: 0.9119421  Vali macro F1 0.8684716 
new best score!!!!
Validation loss decreased (0.331358 --> 0.293427).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.2363739013671875
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.3866302  Vali Loss: 0.2678225 Vali Accuracy: 0.9067797  Vali weighted F1: 0.8964528  Vali macro F1 0.8403879 
new best score!!!!
Validation loss decreased (0.293427 --> 0.267822).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.2371244430541992
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.3626964  Vali Loss: 0.2451136 Vali Accuracy: 0.9039548  Vali weighted F1: 0.8918561  Vali macro F1 0.8323917 
new best score!!!!
Validation loss decreased (0.267822 --> 0.245114).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.234431505203247
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.3327019  Vali Loss: 0.2377027 Vali Accuracy: 0.9011299  Vali weighted F1: 0.9006317  Vali macro F1 0.8489671 
new best score!!!!
Validation loss decreased (0.245114 --> 0.237703).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.232832908630371
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.3143337  Vali Loss: 0.2031951 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9475303  Vali macro F1 0.9107912 
new best score!!!!
Validation loss decreased (0.237703 --> 0.203195).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.2305817604064941
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.2856948  Vali Loss: 0.1948720 Vali Accuracy: 0.9152542  Vali weighted F1: 0.9144363  Vali macro F1 0.8583762 
new best score!!!!
Validation loss decreased (0.203195 --> 0.194872).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.2300422191619873
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.2683378  Vali Loss: 0.1831409 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9229655  Vali macro F1 0.8649809 
new best score!!!!
Validation loss decreased (0.194872 --> 0.183141).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.229565143585205
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.2494248  Vali Loss: 0.1699866 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9177249  Vali macro F1 0.8493651 
new best score!!!!
Validation loss decreased (0.183141 --> 0.169987).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.2304651737213135
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.2370963  Vali Loss: 0.1655424 Vali Accuracy: 0.9180791  Vali weighted F1: 0.9159150  Vali macro F1 0.8525308 
new best score!!!!
Validation loss decreased (0.169987 --> 0.165542).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.230644702911377
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.2300597  Vali Loss: 0.1431254 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9382105  Vali macro F1 0.8868652 
new best score!!!!
Validation loss decreased (0.165542 --> 0.143125).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.2310311794281006
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.2161193  Vali Loss: 0.1390474 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9281649  Vali macro F1 0.8675318 
new best score!!!!
Validation loss decreased (0.143125 --> 0.139047).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.2345404624938965
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.1997066  Vali Loss: 0.1290624 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9493490  Vali macro F1 0.9021771 
new best score!!!!
Validation loss decreased (0.139047 --> 0.129062).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.2343266010284424
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.2017785  Vali Loss: 0.1267634 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9308025  Vali macro F1 0.8681584 
new best score!!!!
Validation loss decreased (0.129062 --> 0.126763).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.2321557998657227
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.1898263  Vali Loss: 0.1188690 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9462183  Vali macro F1 0.8838098 
new best score!!!!
Validation loss decreased (0.126763 --> 0.118869).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.2340517044067383
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.1823463  Vali Loss: 0.1097869 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9435028  Vali macro F1 0.8823529 
new best score!!!!
Validation loss decreased (0.118869 --> 0.109787).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.2347660064697266
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.1687813  Vali Loss: 0.1102196 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9364601  Vali macro F1 0.8728472 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 1.2339184284210205
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.1634732  Vali Loss: 0.1055944 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9339887  Vali macro F1 0.8733191 
new best score!!!!
Validation loss decreased (0.109787 --> 0.105594).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.2366139888763428
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.1681041  Vali Loss: 0.1080651 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9455214  Vali macro F1 0.8921502 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 1.233201265335083
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.1660689  Vali Loss: 0.1069114 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9456234  Vali macro F1 0.8914165 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 1.2350373268127441
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.1530295  Vali Loss: 0.1038327 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9445222  Vali macro F1 0.8953787 
new best score!!!!
Validation loss decreased (0.105594 --> 0.103833).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 1.2345261573791504
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.1453616  Vali Loss: 0.1047663 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9286227  Vali macro F1 0.8629586 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 1.232367992401123
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.1479838  Vali Loss: 0.0925741 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9494783  Vali macro F1 0.9027752 
new best score!!!!
Validation loss decreased (0.103833 --> 0.092574).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 1.2422361373901367
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.1373007  Vali Loss: 0.0930423 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9354722  Vali macro F1 0.8767103 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 1.2330470085144043
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.1378793  Vali Loss: 0.0918951 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9507468  Vali macro F1 0.9078253 
new best score!!!!
Validation loss decreased (0.092574 --> 0.091895).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 1.249579668045044
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.1280148  Vali Loss: 0.0903398 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9528140  Vali macro F1 0.9110302 
new best score!!!!
Validation loss decreased (0.091895 --> 0.090340).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 1.2327919006347656
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.1262551  Vali Loss: 0.0834728 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9513163  Vali macro F1 0.9055180 
new best score!!!!
Validation loss decreased (0.090340 --> 0.083473).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 1.2336347103118896
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.1176352  Vali Loss: 0.0827123 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9562368  Vali macro F1 0.9141501 
new best score!!!!
Validation loss decreased (0.083473 --> 0.082712).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 1.232342004776001
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.1236977  Vali Loss: 0.0820104 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9574305  Vali macro F1 0.9178034 
new best score!!!!
Validation loss decreased (0.082712 --> 0.082010).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 1.232255458831787
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.1198887  Vali Loss: 0.0827442 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9563958  Vali macro F1 0.9128205 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 1.2343637943267822
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.1205487  Vali Loss: 0.0786464 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9649123  Vali macro F1 0.9284211 
new best score!!!!
Validation loss decreased (0.082010 --> 0.078646).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 1.2355988025665283
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.1187793  Vali Loss: 0.0833668 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9528202  Vali macro F1 0.9107172 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 1.2357118129730225
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.1161156  Vali Loss: 0.0762726 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9649869  Vali macro F1 0.9299962 
new best score!!!!
Validation loss decreased (0.078646 --> 0.076273).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 1.236466646194458
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.1178055  Vali Loss: 0.0803402 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9593380  Vali macro F1 0.9250010 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 1.2356476783752441
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.1137984  Vali Loss: 0.0826272 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9543737  Vali macro F1 0.9132732 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 1.2345986366271973
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.1062610  Vali Loss: 0.0787703 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9647423  Vali macro F1 0.9333220 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 1.2367303371429443
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.1045740  Vali Loss: 0.0692315 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9713591  Vali macro F1 0.9409722 
new best score!!!!
Validation loss decreased (0.076273 --> 0.069231).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 1.2351627349853516
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.1020974  Vali Loss: 0.0720562 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9607876  Vali macro F1 0.9225182 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 1.234041452407837
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0948591  Vali Loss: 0.0699215 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9681951  Vali macro F1 0.9347864 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 1.2346007823944092
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0992356  Vali Loss: 0.0701078 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9614910  Vali macro F1 0.9218391 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 1.2339155673980713
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0928836  Vali Loss: 0.0745961 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9653675  Vali macro F1 0.9324453 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 52 cost time: 1.2334461212158203
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0895626  Vali Loss: 0.0675765 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9713591  Vali macro F1 0.9409722 
new best score!!!!
Validation loss decreased (0.069231 --> 0.067577).  Saving model ...
new best score!!!!
Epoch: 53 cost time: 1.2345600128173828
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0911151  Vali Loss: 0.0660850 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9675698  Vali macro F1 0.9356631 
new best score!!!!
Validation loss decreased (0.067577 --> 0.066085).  Saving model ...
new best score!!!!
Epoch: 54 cost time: 1.2327237129211426
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0854448  Vali Loss: 0.0672582 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9647423  Vali macro F1 0.9333220 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 1.234205961227417
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0888084  Vali Loss: 0.0564889 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831685  Vali macro F1 0.9645833 
new best score!!!!
Validation loss decreased (0.066085 --> 0.056489).  Saving model ...
new best score!!!!
Epoch: 56 cost time: 1.2330427169799805
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0829235  Vali Loss: 0.0606952 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745736  Vali macro F1 0.9506001 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 57 cost time: 1.2324488162994385
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0740790  Vali Loss: 0.0575001 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803116  Vali macro F1 0.9587879 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 58 cost time: 1.2311711311340332
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0808775  Vali Loss: 0.0681594 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9681951  Vali macro F1 0.9347864 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 59 cost time: 1.2369070053100586
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0709622  Vali Loss: 0.0634033 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9611214  Vali macro F1 0.9185555 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 60 cost time: 1.231621265411377
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0792422  Vali Loss: 0.0469312 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859523  Vali macro F1 0.9737993 
new best score!!!!
Validation loss decreased (0.056489 --> 0.046931).  Saving model ...
new best score!!!!
Epoch: 61 cost time: 1.2337429523468018
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0724463  Vali Loss: 0.0460627 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887362  Vali macro F1 0.9796828 
new best score!!!!
Validation loss decreased (0.046931 --> 0.046063).  Saving model ...
new best score!!!!
Epoch: 62 cost time: 1.2330646514892578
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0703197  Vali Loss: 0.0484278 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9770605  Vali macro F1 0.9578336 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 63 cost time: 1.2354393005371094
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0642556  Vali Loss: 0.0402235 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914856  Vali macro F1 0.9878799 
new best score!!!!
Validation loss decreased (0.046063 --> 0.040223).  Saving model ...
new best score!!!!
Epoch: 64 cost time: 1.2346932888031006
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0659281  Vali Loss: 0.0432689 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9885645  Vali macro F1 0.9780536 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 65 cost time: 1.241699457168579
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0637854  Vali Loss: 0.0537935 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803429  Vali macro F1 0.9656962 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 66 cost time: 1.2394044399261475
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0719870  Vali Loss: 0.0654812 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9722798  Vali macro F1 0.9469884 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 67 cost time: 1.2566125392913818
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0688608  Vali Loss: 0.0320213 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915629  Vali macro F1 0.9819629 
new best score!!!!
Validation loss decreased (0.040223 --> 0.032021).  Saving model ...
new best score!!!!
Epoch: 68 cost time: 1.2397918701171875
VALI: Epoch: 68, Steps: 13 | Train Loss: 0.0596628  Vali Loss: 0.0368597 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831685  Vali macro F1 0.9645833 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 69 cost time: 1.239980936050415
VALI: Epoch: 69, Steps: 13 | Train Loss: 0.0572038  Vali Loss: 0.0271566 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.032021 --> 0.027157).  Saving model ...
new best score!!!!
Epoch: 70 cost time: 1.2374274730682373
VALI: Epoch: 70, Steps: 13 | Train Loss: 0.0683134  Vali Loss: 0.0339815 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914414  Vali macro F1 0.9851035 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 71 cost time: 1.233532428741455
VALI: Epoch: 71, Steps: 13 | Train Loss: 0.0611328  Vali Loss: 0.0308599 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887799  Vali macro F1 0.9761404 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 72 cost time: 1.2336719036102295
VALI: Epoch: 72, Steps: 13 | Train Loss: 0.0519995  Vali Loss: 0.0280371 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 73 cost time: 1.233598232269287
VALI: Epoch: 73, Steps: 13 | Train Loss: 0.0513069  Vali Loss: 0.0289699 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 74 cost time: 1.2371068000793457
VALI: Epoch: 74, Steps: 13 | Train Loss: 0.0544206  Vali Loss: 0.0209489 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.027157 --> 0.020949).  Saving model ...
new best score!!!!
Epoch: 75 cost time: 1.2359843254089355
VALI: Epoch: 75, Steps: 13 | Train Loss: 0.0478097  Vali Loss: 0.0229564 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 76 cost time: 1.2343266010284424
VALI: Epoch: 76, Steps: 13 | Train Loss: 0.0421884  Vali Loss: 0.0206199 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
new best score!!!!
Validation loss decreased (0.020949 --> 0.020620).  Saving model ...
new best score!!!!
Epoch: 77 cost time: 1.2369189262390137
VALI: Epoch: 77, Steps: 13 | Train Loss: 0.0388754  Vali Loss: 0.0170744 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.020620 --> 0.017074).  Saving model ...
new best score!!!!
Epoch: 78 cost time: 1.2371740341186523
VALI: Epoch: 78, Steps: 13 | Train Loss: 0.0387892  Vali Loss: 0.0198555 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 79 cost time: 1.2345032691955566
VALI: Epoch: 79, Steps: 13 | Train Loss: 0.0393180  Vali Loss: 0.0183964 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 80 cost time: 1.2331018447875977
VALI: Epoch: 80, Steps: 13 | Train Loss: 0.0384523  Vali Loss: 0.0197127 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915273  Vali macro F1 0.9855237 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 81 cost time: 1.2314534187316895
VALI: Epoch: 81, Steps: 13 | Train Loss: 0.0383187  Vali Loss: 0.0295609 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887644  Vali macro F1 0.9798734 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 82 cost time: 1.241823673248291
VALI: Epoch: 82, Steps: 13 | Train Loss: 0.0401778  Vali Loss: 0.0426974 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858701  Vali macro F1 0.9845499 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 83 cost time: 1.2349133491516113
VALI: Epoch: 83, Steps: 13 | Train Loss: 0.0417878  Vali Loss: 0.0204519 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915227  Vali macro F1 0.9855161 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 84 cost time: 1.2336947917938232
VALI: Epoch: 84, Steps: 13 | Train Loss: 0.0334854  Vali Loss: 0.0199703 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915227  Vali macro F1 0.9855161 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 85 cost time: 1.2337241172790527
VALI: Epoch: 85, Steps: 13 | Train Loss: 0.0296898  Vali Loss: 0.0194709 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 86 cost time: 1.234332799911499
VALI: Epoch: 86, Steps: 13 | Train Loss: 0.0290778  Vali Loss: 0.0194690 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915227  Vali macro F1 0.9855161 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 87 cost time: 1.2341117858886719
VALI: Epoch: 87, Steps: 13 | Train Loss: 0.0293268  Vali Loss: 0.0202106 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915227  Vali macro F1 0.9855161 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 88 cost time: 1.2331287860870361
VALI: Epoch: 88, Steps: 13 | Train Loss: 0.0262533  Vali Loss: 0.0200337 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915227  Vali macro F1 0.9855161 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 89 cost time: 1.232778787612915
VALI: Epoch: 89, Steps: 13 | Train Loss: 0.0296510  Vali Loss: 0.0199419 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915227  Vali macro F1 0.9855161 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 90 cost time: 1.2428867816925049
VALI: Epoch: 90, Steps: 13 | Train Loss: 0.0294478  Vali Loss: 0.0198523 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915227  Vali macro F1 0.9855161 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 91 cost time: 1.2379887104034424
VALI: Epoch: 91, Steps: 13 | Train Loss: 0.0306095  Vali Loss: 0.0197569 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915227  Vali macro F1 0.9855161 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 92 cost time: 1.2425670623779297
VALI: Epoch: 92, Steps: 13 | Train Loss: 0.0296010  Vali Loss: 0.0197277 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915227  Vali macro F1 0.9855161 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9898190  Test weighted F1: 0.9898106  Test macro F1 0.9888912 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 73347
pruned model Parameter : 76626
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.2618868350982666
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0347794  Vali Loss: 0.0172385 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
Validation loss decreased (inf --> 0.017239).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.2599399089813232
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0327029  Vali Loss: 0.0172628 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.2575042247772217
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0349713  Vali Loss: 0.0167699 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.017239 --> 0.016770).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 1.2656095027923584
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0367183  Vali Loss: 0.0163428 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.016770 --> 0.016343).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 1.261155605316162
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0360848  Vali Loss: 0.0163519 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 1.2768542766571045
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0318424  Vali Loss: 0.0171725 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 7 cost time: 1.2585842609405518
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0341877  Vali Loss: 0.0161619 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.016343 --> 0.016162).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 1.2658162117004395
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0323997  Vali Loss: 0.0167256 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 1.2567601203918457
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0319637  Vali Loss: 0.0158577 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.016162 --> 0.015858).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 1.2579052448272705
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0313645  Vali Loss: 0.0158866 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 1.2561867237091064
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0286991  Vali Loss: 0.0154691 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.015858 --> 0.015469).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 1.2581467628479004
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0289052  Vali Loss: 0.0158963 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 1.256803274154663
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0286727  Vali Loss: 0.0160954 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 1.2581698894500732
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0327063  Vali Loss: 0.0153783 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.015469 --> 0.015378).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 1.2616496086120605
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0315035  Vali Loss: 0.0157976 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 1.2580597400665283
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0304133  Vali Loss: 0.0157443 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 1.2580442428588867
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0312302  Vali Loss: 0.0160835 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 1.259129285812378
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0263156  Vali Loss: 0.0153895 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 1.2598798274993896
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0302715  Vali Loss: 0.0154873 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 20 cost time: 1.254274606704712
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0291996  Vali Loss: 0.0152001 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.015378 --> 0.015200).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 21 cost time: 1.251035213470459
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0310163  Vali Loss: 0.0152769 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 1.2503530979156494
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0322239  Vali Loss: 0.0147361 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.015200 --> 0.014736).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 23 cost time: 1.2501659393310547
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0295141  Vali Loss: 0.0161977 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 1.2513751983642578
Fine Tuning VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0314203  Vali Loss: 0.0150608 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 1.2507500648498535
Fine Tuning VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0288240  Vali Loss: 0.0157762 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 1.2542674541473389
Fine Tuning VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0295028  Vali Loss: 0.0150943 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 1.2526936531066895
Fine Tuning VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0251706  Vali Loss: 0.0144911 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.014736 --> 0.014491).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 28 cost time: 1.2539429664611816
Fine Tuning VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0265615  Vali Loss: 0.0144089 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.014491 --> 0.014409).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 29 cost time: 1.2515473365783691
Fine Tuning VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0250619  Vali Loss: 0.0151275 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 30 cost time: 1.2530431747436523
Fine Tuning VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0294097  Vali Loss: 0.0149504 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 31 cost time: 1.2568941116333008
Fine Tuning VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0266849  Vali Loss: 0.0152707 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 32 cost time: 1.2536225318908691
Fine Tuning VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0258265  Vali Loss: 0.0151276 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 33 cost time: 1.2525780200958252
Fine Tuning VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0247813  Vali Loss: 0.0145825 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 34 cost time: 1.2557497024536133
Fine Tuning VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0266077  Vali Loss: 0.0145402 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 35 cost time: 1.2568912506103516
Fine Tuning VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0252028  Vali Loss: 0.0145711 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 36 cost time: 1.255147933959961
Fine Tuning VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0258191  Vali Loss: 0.0145947 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 37 cost time: 1.26507568359375
Fine Tuning VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0272039  Vali Loss: 0.0146012 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 38 cost time: 1.2517218589782715
Fine Tuning VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0277485  Vali Loss: 0.0145777 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 39 cost time: 1.261030912399292
Fine Tuning VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0282618  Vali Loss: 0.0145725 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 40 cost time: 1.2553136348724365
Fine Tuning VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0236774  Vali Loss: 0.0145769 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 41 cost time: 1.2603423595428467
Fine Tuning VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0286187  Vali Loss: 0.0145758 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 42 cost time: 1.2509739398956299
Fine Tuning VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0262295  Vali Loss: 0.0145632 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 43 cost time: 1.2559609413146973
Fine Tuning VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0269995  Vali Loss: 0.0145562 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9909502  Test weighted F1: 0.9909414  Test macro F1 0.9899351 
================ the 2 th CV Experiment ================ 
Overlapping random Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.00280112 0.00239808 0.00241546 0.00322581 0.00549451 0.00552486
 0.00324675 0.00292398 0.00236967 0.00396825]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.2323920726776123
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.3034078  Vali Loss: 2.2752682 Vali Accuracy: 0.1949153  Vali weighted F1: 0.0988419  Vali macro F1 0.0795614 
Validation loss decreased (inf --> 2.275268).  Saving model ...
Epoch: 2 cost time: 1.2312767505645752
VALI: Epoch: 2, Steps: 13 | Train Loss: 2.2110420  Vali Loss: 2.0229933 Vali Accuracy: 0.2627119  Vali weighted F1: 0.1655435  Vali macro F1 0.1317854 
new best score!!!!
Validation loss decreased (2.275268 --> 2.022993).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.2306041717529297
VALI: Epoch: 3, Steps: 13 | Train Loss: 1.8359183  Vali Loss: 1.4011911 Vali Accuracy: 0.6214689  Vali weighted F1: 0.5809169  Vali macro F1 0.5342723 
new best score!!!!
Validation loss decreased (2.022993 --> 1.401191).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.230738639831543
VALI: Epoch: 4, Steps: 13 | Train Loss: 1.4236943  Vali Loss: 1.0593937 Vali Accuracy: 0.6836158  Vali weighted F1: 0.6546434  Vali macro F1 0.6072789 
new best score!!!!
Validation loss decreased (1.401191 --> 1.059394).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.2285182476043701
VALI: Epoch: 5, Steps: 13 | Train Loss: 1.1402751  Vali Loss: 0.8394396 Vali Accuracy: 0.7542373  Vali weighted F1: 0.7406932  Vali macro F1 0.6880646 
new best score!!!!
Validation loss decreased (1.059394 --> 0.839440).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.2295784950256348
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.9388415  Vali Loss: 0.6776314 Vali Accuracy: 0.8333333  Vali weighted F1: 0.8220530  Vali macro F1 0.7656242 
new best score!!!!
Validation loss decreased (0.839440 --> 0.677631).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.2285127639770508
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.7752919  Vali Loss: 0.5343936 Vali Accuracy: 0.8700565  Vali weighted F1: 0.8571779  Vali macro F1 0.7970146 
new best score!!!!
Validation loss decreased (0.677631 --> 0.534394).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.23291015625
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.6489044  Vali Loss: 0.4510659 Vali Accuracy: 0.8785311  Vali weighted F1: 0.8635176  Vali macro F1 0.8031306 
new best score!!!!
Validation loss decreased (0.534394 --> 0.451066).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.2273855209350586
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.5657774  Vali Loss: 0.3963853 Vali Accuracy: 0.9039548  Vali weighted F1: 0.8995965  Vali macro F1 0.8631278 
new best score!!!!
Validation loss decreased (0.451066 --> 0.396385).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.2290666103363037
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.4892971  Vali Loss: 0.3422232 Vali Accuracy: 0.9011299  Vali weighted F1: 0.8984831  Vali macro F1 0.8541340 
new best score!!!!
Validation loss decreased (0.396385 --> 0.342223).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.2279999256134033
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.4347098  Vali Loss: 0.3101530 Vali Accuracy: 0.9152542  Vali weighted F1: 0.9099784  Vali macro F1 0.8642377 
new best score!!!!
Validation loss decreased (0.342223 --> 0.310153).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.2320711612701416
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.3993096  Vali Loss: 0.2784399 Vali Accuracy: 0.9180791  Vali weighted F1: 0.9143505  Vali macro F1 0.8741221 
new best score!!!!
Validation loss decreased (0.310153 --> 0.278440).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.2270193099975586
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.3630274  Vali Loss: 0.2611360 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9343334  Vali macro F1 0.9009202 
new best score!!!!
Validation loss decreased (0.278440 --> 0.261136).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.227154016494751
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.3353268  Vali Loss: 0.2300256 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9283264  Vali macro F1 0.8783954 
new best score!!!!
Validation loss decreased (0.261136 --> 0.230026).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.2283377647399902
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.3046981  Vali Loss: 0.2167415 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9400561  Vali macro F1 0.8929383 
new best score!!!!
Validation loss decreased (0.230026 --> 0.216742).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.2311112880706787
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.2866022  Vali Loss: 0.1863284 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9442789  Vali macro F1 0.8998442 
new best score!!!!
Validation loss decreased (0.216742 --> 0.186328).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.2278149127960205
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.2657584  Vali Loss: 0.1779799 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9465007  Vali macro F1 0.9085109 
new best score!!!!
Validation loss decreased (0.186328 --> 0.177980).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.2285852432250977
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.2600361  Vali Loss: 0.1617281 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9543352  Vali macro F1 0.9168472 
new best score!!!!
Validation loss decreased (0.177980 --> 0.161728).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.230367660522461
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.2362657  Vali Loss: 0.1575874 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9558742  Vali macro F1 0.9168519 
new best score!!!!
Validation loss decreased (0.161728 --> 0.157587).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.2425007820129395
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.2241411  Vali Loss: 0.1378537 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9593969  Vali macro F1 0.9113844 
new best score!!!!
Validation loss decreased (0.157587 --> 0.137854).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.237250566482544
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.2093047  Vali Loss: 0.1366791 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9402969  Vali macro F1 0.8877912 
new best score!!!!
Validation loss decreased (0.137854 --> 0.136679).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.2437336444854736
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.2045650  Vali Loss: 0.1328572 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9462689  Vali macro F1 0.8980869 
new best score!!!!
Validation loss decreased (0.136679 --> 0.132857).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.2373344898223877
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.1889493  Vali Loss: 0.1195976 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9578106  Vali macro F1 0.9116883 
new best score!!!!
Validation loss decreased (0.132857 --> 0.119598).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.2603282928466797
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.1813868  Vali Loss: 0.1131530 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9620847  Vali macro F1 0.9260800 
new best score!!!!
Validation loss decreased (0.119598 --> 0.113153).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.2460319995880127
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.1706302  Vali Loss: 0.1086577 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9791752  Vali macro F1 0.9540097 
new best score!!!!
Validation loss decreased (0.113153 --> 0.108658).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.2480733394622803
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.1720183  Vali Loss: 0.1079302 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9634019  Vali macro F1 0.9291721 
new best score!!!!
Validation loss decreased (0.108658 --> 0.107930).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.244340419769287
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.1636697  Vali Loss: 0.1106633 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9545854  Vali macro F1 0.9164628 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 1.245408296585083
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.1594553  Vali Loss: 0.1027694 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9606645  Vali macro F1 0.9277324 
new best score!!!!
Validation loss decreased (0.107930 --> 0.102769).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.247748851776123
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.1566233  Vali Loss: 0.1050421 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9606645  Vali macro F1 0.9277324 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 1.2460412979125977
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.1606319  Vali Loss: 0.1008376 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9771405  Vali macro F1 0.9579456 
new best score!!!!
Validation loss decreased (0.102769 --> 0.100838).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 1.246021032333374
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.1482930  Vali Loss: 0.0956833 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9595848  Vali macro F1 0.9205883 
new best score!!!!
Validation loss decreased (0.100838 --> 0.095683).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 1.2475183010101318
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.1410549  Vali Loss: 0.0954086 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9717391  Vali macro F1 0.9467368 
new best score!!!!
Validation loss decreased (0.095683 --> 0.095409).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 1.247093677520752
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.1423787  Vali Loss: 0.0896005 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9818450  Vali macro F1 0.9596838 
new best score!!!!
Validation loss decreased (0.095409 --> 0.089600).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 1.2465910911560059
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.1324653  Vali Loss: 0.0891647 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9662335  Vali macro F1 0.9328970 
new best score!!!!
Validation loss decreased (0.089600 --> 0.089165).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.2468702793121338
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.1326295  Vali Loss: 0.0895168 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9717514  Vali macro F1 0.9411765 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 1.2474110126495361
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.1297888  Vali Loss: 0.0882719 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9659154  Vali macro F1 0.9325638 
new best score!!!!
Validation loss decreased (0.089165 --> 0.088272).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 1.244459867477417
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.1254969  Vali Loss: 0.0886955 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9718634  Vali macro F1 0.9446795 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 1.245189905166626
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.1183364  Vali Loss: 0.0881262 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9550821  Vali macro F1 0.9126589 
new best score!!!!
Validation loss decreased (0.088272 --> 0.088126).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 1.2458446025848389
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.1208287  Vali Loss: 0.0784901 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9790174  Vali macro F1 0.9573427 
new best score!!!!
Validation loss decreased (0.088126 --> 0.078490).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 1.246227502822876
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.1216107  Vali Loss: 0.0749032 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9913126  Vali macro F1 0.9810233 
new best score!!!!
Validation loss decreased (0.078490 --> 0.074903).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 1.2465481758117676
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.1198276  Vali Loss: 0.0828749 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9639080  Vali macro F1 0.9217903 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 1.2418534755706787
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.1174732  Vali Loss: 0.0797819 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9747305  Vali macro F1 0.9504367 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 1.2455863952636719
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.1163442  Vali Loss: 0.0736017 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9851251  Vali macro F1 0.9671498 
new best score!!!!
Validation loss decreased (0.074903 --> 0.073602).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 1.2499308586120605
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.1107694  Vali Loss: 0.0737831 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858730  Vali macro F1 0.9733732 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 1.2460412979125977
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.1103175  Vali Loss: 0.0715774 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9884850  Vali macro F1 0.9786822 
new best score!!!!
Validation loss decreased (0.073602 --> 0.071577).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 1.2434813976287842
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.1055994  Vali Loss: 0.0771765 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803315  Vali macro F1 0.9653329 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 1.245915174484253
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.1051036  Vali Loss: 0.0640406 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9913126  Vali macro F1 0.9810233 
new best score!!!!
Validation loss decreased (0.071577 --> 0.064041).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 1.2465837001800537
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0953975  Vali Loss: 0.0612176 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
new best score!!!!
Validation loss decreased (0.064041 --> 0.061218).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 1.2453992366790771
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0952597  Vali Loss: 0.0573206 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9913126  Vali macro F1 0.9810233 
new best score!!!!
Validation loss decreased (0.061218 --> 0.057321).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 1.2468552589416504
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0964695  Vali Loss: 0.0651336 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887026  Vali macro F1 0.9830090 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 1.2450487613677979
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0970732  Vali Loss: 0.0741579 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858597  Vali macro F1 0.9801969 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 1.2455530166625977
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0954821  Vali Loss: 0.0496931 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.057321 --> 0.049693).  Saving model ...
new best score!!!!
Epoch: 53 cost time: 1.2521090507507324
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0861121  Vali Loss: 0.0464657 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.049693 --> 0.046466).  Saving model ...
new best score!!!!
Epoch: 54 cost time: 1.2458200454711914
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0820635  Vali Loss: 0.0490161 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915629  Vali macro F1 0.9819629 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 1.263460636138916
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0757203  Vali Loss: 0.0449212 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887067  Vali macro F1 0.9831959 
new best score!!!!
Validation loss decreased (0.046466 --> 0.044921).  Saving model ...
new best score!!!!
Epoch: 56 cost time: 1.2455344200134277
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0820458  Vali Loss: 0.0423233 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9913126  Vali macro F1 0.9810233 
new best score!!!!
Validation loss decreased (0.044921 --> 0.042323).  Saving model ...
new best score!!!!
Epoch: 57 cost time: 1.2423675060272217
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0785922  Vali Loss: 0.0468469 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 58 cost time: 1.2428059577941895
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0761918  Vali Loss: 0.0584470 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831363  Vali macro F1 0.9714791 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 59 cost time: 1.2449638843536377
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0719088  Vali Loss: 0.0395111 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
new best score!!!!
Validation loss decreased (0.042323 --> 0.039511).  Saving model ...
new best score!!!!
Epoch: 60 cost time: 1.2469186782836914
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0640797  Vali Loss: 0.0352170 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
new best score!!!!
Validation loss decreased (0.039511 --> 0.035217).  Saving model ...
new best score!!!!
Epoch: 61 cost time: 1.245274543762207
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0628538  Vali Loss: 0.0333031 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
new best score!!!!
Validation loss decreased (0.035217 --> 0.033303).  Saving model ...
new best score!!!!
Epoch: 62 cost time: 1.2451839447021484
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0596582  Vali Loss: 0.0308950 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.033303 --> 0.030895).  Saving model ...
new best score!!!!
Epoch: 63 cost time: 1.245157241821289
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0556009  Vali Loss: 0.0399860 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971876  Vali macro F1 0.9939876 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 64 cost time: 1.2455735206604004
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0550657  Vali Loss: 0.0310466 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 65 cost time: 1.2455463409423828
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0511872  Vali Loss: 0.0347901 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915023  Vali macro F1 0.9888327 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 66 cost time: 1.2454986572265625
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0557004  Vali Loss: 0.0272907 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.030895 --> 0.027291).  Saving model ...
new best score!!!!
Epoch: 67 cost time: 1.2459797859191895
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0546923  Vali Loss: 0.0370805 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 68 cost time: 1.245025396347046
VALI: Epoch: 68, Steps: 13 | Train Loss: 0.0645654  Vali Loss: 0.0317550 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915227  Vali macro F1 0.9855161 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 69 cost time: 1.2452890872955322
VALI: Epoch: 69, Steps: 13 | Train Loss: 0.0508328  Vali Loss: 0.0274031 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915227  Vali macro F1 0.9855161 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 70 cost time: 1.245983362197876
VALI: Epoch: 70, Steps: 13 | Train Loss: 0.0456424  Vali Loss: 0.0233173 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
new best score!!!!
Validation loss decreased (0.027291 --> 0.023317).  Saving model ...
new best score!!!!
Epoch: 71 cost time: 1.2446134090423584
VALI: Epoch: 71, Steps: 13 | Train Loss: 0.0441687  Vali Loss: 0.0218400 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915227  Vali macro F1 0.9855161 
new best score!!!!
Validation loss decreased (0.023317 --> 0.021840).  Saving model ...
new best score!!!!
Epoch: 72 cost time: 1.2447431087493896
VALI: Epoch: 72, Steps: 13 | Train Loss: 0.0388667  Vali Loss: 0.0279893 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914669  Vali macro F1 0.9890414 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 73 cost time: 1.2459616661071777
VALI: Epoch: 73, Steps: 13 | Train Loss: 0.0381304  Vali Loss: 0.0225657 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 74 cost time: 1.2466216087341309
VALI: Epoch: 74, Steps: 13 | Train Loss: 0.0419417  Vali Loss: 0.0221400 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 75 cost time: 1.2453069686889648
VALI: Epoch: 75, Steps: 13 | Train Loss: 0.0381626  Vali Loss: 0.0201792 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
new best score!!!!
Validation loss decreased (0.021840 --> 0.020179).  Saving model ...
new best score!!!!
Epoch: 76 cost time: 1.246462345123291
VALI: Epoch: 76, Steps: 13 | Train Loss: 0.0356645  Vali Loss: 0.0196882 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.020179 --> 0.019688).  Saving model ...
new best score!!!!
Epoch: 77 cost time: 1.245560646057129
VALI: Epoch: 77, Steps: 13 | Train Loss: 0.0362057  Vali Loss: 0.0204871 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 78 cost time: 1.2463927268981934
VALI: Epoch: 78, Steps: 13 | Train Loss: 0.0342547  Vali Loss: 0.0167824 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
new best score!!!!
Validation loss decreased (0.019688 --> 0.016782).  Saving model ...
new best score!!!!
Epoch: 79 cost time: 1.2446622848510742
VALI: Epoch: 79, Steps: 13 | Train Loss: 0.0324638  Vali Loss: 0.0200242 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 80 cost time: 1.2455894947052002
VALI: Epoch: 80, Steps: 13 | Train Loss: 0.0309705  Vali Loss: 0.0220521 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 81 cost time: 1.2463295459747314
VALI: Epoch: 81, Steps: 13 | Train Loss: 0.0330087  Vali Loss: 0.0211984 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943368  Vali macro F1 0.9913499 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 82 cost time: 1.2458481788635254
VALI: Epoch: 82, Steps: 13 | Train Loss: 0.0263954  Vali Loss: 0.0189332 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943368  Vali macro F1 0.9913499 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 83 cost time: 1.246610403060913
VALI: Epoch: 83, Steps: 13 | Train Loss: 0.0304650  Vali Loss: 0.0178727 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 84 cost time: 1.2532963752746582
VALI: Epoch: 84, Steps: 13 | Train Loss: 0.0289890  Vali Loss: 0.0157724 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.016782 --> 0.015772).  Saving model ...
new best score!!!!
Epoch: 85 cost time: 1.2482500076293945
VALI: Epoch: 85, Steps: 13 | Train Loss: 0.0226587  Vali Loss: 0.0165885 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 86 cost time: 1.2464196681976318
VALI: Epoch: 86, Steps: 13 | Train Loss: 0.0262155  Vali Loss: 0.0165716 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 87 cost time: 1.2658982276916504
VALI: Epoch: 87, Steps: 13 | Train Loss: 0.0266207  Vali Loss: 0.0164257 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 88 cost time: 1.2400243282318115
VALI: Epoch: 88, Steps: 13 | Train Loss: 0.0222794  Vali Loss: 0.0153187 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.015772 --> 0.015319).  Saving model ...
new best score!!!!
Epoch: 89 cost time: 1.241168737411499
VALI: Epoch: 89, Steps: 13 | Train Loss: 0.0221155  Vali Loss: 0.0158900 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 90 cost time: 1.2407829761505127
VALI: Epoch: 90, Steps: 13 | Train Loss: 0.0207524  Vali Loss: 0.0165278 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 91 cost time: 1.2374753952026367
VALI: Epoch: 91, Steps: 13 | Train Loss: 0.0213871  Vali Loss: 0.0158123 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 92 cost time: 1.2341639995574951
VALI: Epoch: 92, Steps: 13 | Train Loss: 0.0236044  Vali Loss: 0.0159119 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 93 cost time: 1.2331788539886475
VALI: Epoch: 93, Steps: 13 | Train Loss: 0.0233096  Vali Loss: 0.0158356 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 94 cost time: 1.2324938774108887
VALI: Epoch: 94, Steps: 13 | Train Loss: 0.0215444  Vali Loss: 0.0157804 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 95 cost time: 1.2343227863311768
VALI: Epoch: 95, Steps: 13 | Train Loss: 0.0228392  Vali Loss: 0.0157673 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 96 cost time: 1.233224868774414
VALI: Epoch: 96, Steps: 13 | Train Loss: 0.0223503  Vali Loss: 0.0157623 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 97 cost time: 1.2339723110198975
VALI: Epoch: 97, Steps: 13 | Train Loss: 0.0203413  Vali Loss: 0.0158188 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 98 cost time: 1.23409104347229
VALI: Epoch: 98, Steps: 13 | Train Loss: 0.0227948  Vali Loss: 0.0158198 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 99 cost time: 1.2331674098968506
VALI: Epoch: 99, Steps: 13 | Train Loss: 0.0227953  Vali Loss: 0.0158200 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 100 cost time: 1.2336225509643555
VALI: Epoch: 100, Steps: 13 | Train Loss: 0.0222560  Vali Loss: 0.0158232 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 101 cost time: 1.232785940170288
VALI: Epoch: 101, Steps: 13 | Train Loss: 0.0212525  Vali Loss: 0.0158248 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 102 cost time: 1.2315037250518799
VALI: Epoch: 102, Steps: 13 | Train Loss: 0.0221204  Vali Loss: 0.0158175 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 103 cost time: 1.2312588691711426
VALI: Epoch: 103, Steps: 13 | Train Loss: 0.0199822  Vali Loss: 0.0158126 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9898190  Test weighted F1: 0.9898294  Test macro F1 0.9865041 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 73347
pruned model Parameter : 76626
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.2586994171142578
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0226836  Vali Loss: 0.0162812 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
Validation loss decreased (inf --> 0.016281).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.2536168098449707
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0239926  Vali Loss: 0.0156821 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.016281 --> 0.015682).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 1.253676176071167
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0222617  Vali Loss: 0.0149983 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.015682 --> 0.014998).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 1.2547399997711182
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0239599  Vali Loss: 0.0149170 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.014998 --> 0.014917).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 1.2546722888946533
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0223011  Vali Loss: 0.0157894 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 1.2568962574005127
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0223910  Vali Loss: 0.0147650 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.014917 --> 0.014765).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 1.2563836574554443
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0213469  Vali Loss: 0.0145955 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.014765 --> 0.014595).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 1.2552783489227295
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0215862  Vali Loss: 0.0143188 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.014595 --> 0.014319).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 1.2546172142028809
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0204400  Vali Loss: 0.0148744 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 1.2536730766296387
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0196504  Vali Loss: 0.0142217 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.014319 --> 0.014222).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 1.2555370330810547
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0189485  Vali Loss: 0.0138371 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.014222 --> 0.013837).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 1.2546977996826172
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0198382  Vali Loss: 0.0132540 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.013837 --> 0.013254).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 1.2613592147827148
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0203855  Vali Loss: 0.0149236 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 1.2605185508728027
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0195153  Vali Loss: 0.0140001 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 1.2595951557159424
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0209924  Vali Loss: 0.0139304 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 1.2676327228546143
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0183066  Vali Loss: 0.0139023 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 1.260068416595459
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0204978  Vali Loss: 0.0133162 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 18 cost time: 1.2625951766967773
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0197726  Vali Loss: 0.0142674 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 1.2610909938812256
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0213663  Vali Loss: 0.0133419 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 1.2634315490722656
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0200613  Vali Loss: 0.0132025 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.013254 --> 0.013202).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 21 cost time: 1.2602813243865967
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0199772  Vali Loss: 0.0143633 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 1.2588698863983154
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0190021  Vali Loss: 0.0136582 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 1.2569043636322021
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0191216  Vali Loss: 0.0137515 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 1.261157751083374
Fine Tuning VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0208729  Vali Loss: 0.0149237 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 25 cost time: 1.2584784030914307
Fine Tuning VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0210014  Vali Loss: 0.0133964 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 26 cost time: 1.2597134113311768
Fine Tuning VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0210132  Vali Loss: 0.0133556 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 27 cost time: 1.2607343196868896
Fine Tuning VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0170068  Vali Loss: 0.0133727 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 28 cost time: 1.2636654376983643
Fine Tuning VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0182545  Vali Loss: 0.0132756 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 29 cost time: 1.2604424953460693
Fine Tuning VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0188155  Vali Loss: 0.0132324 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 30 cost time: 1.2628369331359863
Fine Tuning VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0187165  Vali Loss: 0.0132909 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 31 cost time: 1.2618827819824219
Fine Tuning VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0188267  Vali Loss: 0.0132959 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 32 cost time: 1.2643897533416748
Fine Tuning VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0162760  Vali Loss: 0.0132964 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 33 cost time: 1.2673630714416504
Fine Tuning VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0173072  Vali Loss: 0.0132983 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 34 cost time: 1.2615633010864258
Fine Tuning VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0171726  Vali Loss: 0.0133099 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 35 cost time: 1.261509895324707
Fine Tuning VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0186441  Vali Loss: 0.0133196 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9898190  Test weighted F1: 0.9898294  Test macro F1 0.9865239 
================ the 3 th CV Experiment ================ 
Overlapping random Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00271003 0.00234742 0.00247525 0.00337838 0.00540541 0.00584795
 0.00310559 0.00282486 0.00240964 0.00411523]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.2360353469848633
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.3014316  Vali Loss: 2.2748700 Vali Accuracy: 0.1694915  Vali weighted F1: 0.0679390  Vali macro F1 0.0551821 
Validation loss decreased (inf --> 2.274870).  Saving model ...
Epoch: 2 cost time: 1.2341375350952148
VALI: Epoch: 2, Steps: 13 | Train Loss: 2.2063465  Vali Loss: 2.0050877 Vali Accuracy: 0.2655367  Vali weighted F1: 0.1637324  Vali macro F1 0.1301669 
new best score!!!!
Validation loss decreased (2.274870 --> 2.005088).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.2324252128601074
VALI: Epoch: 3, Steps: 13 | Train Loss: 1.8328669  Vali Loss: 1.4391397 Vali Accuracy: 0.5819209  Vali weighted F1: 0.5254709  Vali macro F1 0.4791896 
new best score!!!!
Validation loss decreased (2.005088 --> 1.439140).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.2331819534301758
VALI: Epoch: 4, Steps: 13 | Train Loss: 1.4369399  Vali Loss: 1.1061417 Vali Accuracy: 0.7062147  Vali weighted F1: 0.6902548  Vali macro F1 0.6703248 
new best score!!!!
Validation loss decreased (1.439140 --> 1.106142).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.2360799312591553
VALI: Epoch: 5, Steps: 13 | Train Loss: 1.1601267  Vali Loss: 0.8823962 Vali Accuracy: 0.7146893  Vali weighted F1: 0.6955491  Vali macro F1 0.6471595 
new best score!!!!
Validation loss decreased (1.106142 --> 0.882396).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.2337169647216797
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.9590047  Vali Loss: 0.6989541 Vali Accuracy: 0.8022599  Vali weighted F1: 0.7846951  Vali macro F1 0.7313124 
new best score!!!!
Validation loss decreased (0.882396 --> 0.698954).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.231989860534668
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.7926050  Vali Loss: 0.5787265 Vali Accuracy: 0.8361582  Vali weighted F1: 0.8212358  Vali macro F1 0.7658835 
new best score!!!!
Validation loss decreased (0.698954 --> 0.578727).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.2359042167663574
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.6606112  Vali Loss: 0.4799603 Vali Accuracy: 0.8700565  Vali weighted F1: 0.8542993  Vali macro F1 0.7947985 
new best score!!!!
Validation loss decreased (0.578727 --> 0.479960).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.238795518875122
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.5757891  Vali Loss: 0.4133526 Vali Accuracy: 0.8644068  Vali weighted F1: 0.8503863  Vali macro F1 0.7904353 
new best score!!!!
Validation loss decreased (0.479960 --> 0.413353).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.2365190982818604
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.4961267  Vali Loss: 0.3460700 Vali Accuracy: 0.8926554  Vali weighted F1: 0.8795858  Vali macro F1 0.8169742 
new best score!!!!
Validation loss decreased (0.413353 --> 0.346070).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.2535207271575928
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.4407900  Vali Loss: 0.3188780 Vali Accuracy: 0.8870056  Vali weighted F1: 0.8741812  Vali macro F1 0.8124008 
new best score!!!!
Validation loss decreased (0.346070 --> 0.318878).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.2446117401123047
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.4026854  Vali Loss: 0.2802120 Vali Accuracy: 0.9011299  Vali weighted F1: 0.8895584  Vali macro F1 0.8241536 
new best score!!!!
Validation loss decreased (0.318878 --> 0.280212).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.2391705513000488
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.3682265  Vali Loss: 0.2617460 Vali Accuracy: 0.9152542  Vali weighted F1: 0.9005710  Vali macro F1 0.8356791 
new best score!!!!
Validation loss decreased (0.280212 --> 0.261746).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.2363648414611816
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.3463578  Vali Loss: 0.2341049 Vali Accuracy: 0.9124294  Vali weighted F1: 0.9008749  Vali macro F1 0.8335929 
new best score!!!!
Validation loss decreased (0.261746 --> 0.234105).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.241649866104126
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.3194999  Vali Loss: 0.2180851 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9192525  Vali macro F1 0.8506017 
new best score!!!!
Validation loss decreased (0.234105 --> 0.218085).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.238250732421875
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.3048957  Vali Loss: 0.2029953 Vali Accuracy: 0.9180791  Vali weighted F1: 0.9078642  Vali macro F1 0.8494365 
new best score!!!!
Validation loss decreased (0.218085 --> 0.202995).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.2410666942596436
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.2799245  Vali Loss: 0.1846910 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9163841  Vali macro F1 0.8482944 
new best score!!!!
Validation loss decreased (0.202995 --> 0.184691).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.2387917041778564
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.2634376  Vali Loss: 0.1753605 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9303732  Vali macro F1 0.8595432 
new best score!!!!
Validation loss decreased (0.184691 --> 0.175360).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.2396371364593506
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.2431878  Vali Loss: 0.1625988 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9276360  Vali macro F1 0.8572890 
new best score!!!!
Validation loss decreased (0.175360 --> 0.162599).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.2393429279327393
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.2378146  Vali Loss: 0.1511591 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9332282  Vali macro F1 0.8617431 
new best score!!!!
Validation loss decreased (0.162599 --> 0.151159).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.2394096851348877
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.2205013  Vali Loss: 0.1455127 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9302210  Vali macro F1 0.8597806 
new best score!!!!
Validation loss decreased (0.151159 --> 0.145513).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.2408688068389893
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.2098714  Vali Loss: 0.1351371 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9545313  Vali macro F1 0.9051752 
new best score!!!!
Validation loss decreased (0.145513 --> 0.135137).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.2446095943450928
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.1929296  Vali Loss: 0.1295502 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9388186  Vali macro F1 0.8670369 
new best score!!!!
Validation loss decreased (0.135137 --> 0.129550).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.2395386695861816
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.1919465  Vali Loss: 0.1233364 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9417159  Vali macro F1 0.8785765 
new best score!!!!
Validation loss decreased (0.129550 --> 0.123336).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.2373988628387451
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.1869653  Vali Loss: 0.1180210 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9416417  Vali macro F1 0.8691908 
new best score!!!!
Validation loss decreased (0.123336 --> 0.118021).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.237633228302002
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.1766461  Vali Loss: 0.1081892 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9416393  Vali macro F1 0.8693646 
new best score!!!!
Validation loss decreased (0.118021 --> 0.108189).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.2411162853240967
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.1685638  Vali Loss: 0.1121959 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9424204  Vali macro F1 0.8866686 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 1.2393426895141602
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.1572104  Vali Loss: 0.1031301 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9428443  Vali macro F1 0.8776917 
new best score!!!!
Validation loss decreased (0.108189 --> 0.103130).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.2390809059143066
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.1488634  Vali Loss: 0.1003132 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9577738  Vali macro F1 0.9187714 
new best score!!!!
Validation loss decreased (0.103130 --> 0.100313).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.2410173416137695
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.1595764  Vali Loss: 0.0963266 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9525479  Vali macro F1 0.8991082 
new best score!!!!
Validation loss decreased (0.100313 --> 0.096327).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 1.2402286529541016
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.1454460  Vali Loss: 0.0934702 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9551242  Vali macro F1 0.9027072 
new best score!!!!
Validation loss decreased (0.096327 --> 0.093470).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 1.2415962219238281
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.1398968  Vali Loss: 0.1013979 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9406467  Vali macro F1 0.8836603 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 1.2383341789245605
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.1387312  Vali Loss: 0.0912084 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9480584  Vali macro F1 0.8919648 
new best score!!!!
Validation loss decreased (0.093470 --> 0.091208).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 1.240166425704956
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.1377443  Vali Loss: 0.0899769 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9579518  Vali macro F1 0.9050483 
new best score!!!!
Validation loss decreased (0.091208 --> 0.089977).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.2389507293701172
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.1336285  Vali Loss: 0.0887192 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9519747  Vali macro F1 0.9005161 
new best score!!!!
Validation loss decreased (0.089977 --> 0.088719).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 1.2387688159942627
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.1327859  Vali Loss: 0.0901512 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9595848  Vali macro F1 0.9205883 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 1.2368464469909668
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.1218778  Vali Loss: 0.0811346 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9600753  Vali macro F1 0.9093333 
new best score!!!!
Validation loss decreased (0.088719 --> 0.081135).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 1.2389168739318848
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.1194890  Vali Loss: 0.0849240 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9606751  Vali macro F1 0.9244749 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 1.2379405498504639
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.1147804  Vali Loss: 0.0773415 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9635095  Vali macro F1 0.9268256 
new best score!!!!
Validation loss decreased (0.081135 --> 0.077341).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 1.2427101135253906
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.1164804  Vali Loss: 0.0787350 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9689239  Vali macro F1 0.9388354 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 1.2396550178527832
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.1140385  Vali Loss: 0.0783682 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9620847  Vali macro F1 0.9260800 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 1.2576403617858887
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.1109420  Vali Loss: 0.0777534 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9645879  Vali macro F1 0.9315227 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 1.242560863494873
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.1115539  Vali Loss: 0.0717484 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9691221  Vali macro F1 0.9380098 
new best score!!!!
Validation loss decreased (0.077341 --> 0.071748).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 1.2402253150939941
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.1054642  Vali Loss: 0.0701479 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9717514  Vali macro F1 0.9411765 
new best score!!!!
Validation loss decreased (0.071748 --> 0.070148).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 1.2407186031341553
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.1101938  Vali Loss: 0.0790522 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9574305  Vali macro F1 0.9178034 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 1.2375292778015137
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.1134537  Vali Loss: 0.0791282 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9592573  Vali macro F1 0.9233965 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 1.2358534336090088
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.1009793  Vali Loss: 0.0757376 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9571882  Vali macro F1 0.9218398 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 1.2367286682128906
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0957290  Vali Loss: 0.0683390 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9681951  Vali macro F1 0.9347864 
new best score!!!!
Validation loss decreased (0.070148 --> 0.068339).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 1.2367870807647705
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0947374  Vali Loss: 0.0646814 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9719496  Vali macro F1 0.9403509 
new best score!!!!
Validation loss decreased (0.068339 --> 0.064681).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 1.2381207942962646
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0950075  Vali Loss: 0.0612595 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746863  Vali macro F1 0.9470130 
new best score!!!!
Validation loss decreased (0.064681 --> 0.061260).  Saving model ...
new best score!!!!
Epoch: 51 cost time: 1.2383365631103516
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0973409  Vali Loss: 0.0734928 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9574301  Vali macro F1 0.9174607 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 1.236140489578247
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0994004  Vali Loss: 0.0603314 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746863  Vali macro F1 0.9470130 
new best score!!!!
Validation loss decreased (0.061260 --> 0.060331).  Saving model ...
new best score!!!!
Epoch: 53 cost time: 1.2377307415008545
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0857518  Vali Loss: 0.0572443 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746863  Vali macro F1 0.9470130 
new best score!!!!
Validation loss decreased (0.060331 --> 0.057244).  Saving model ...
new best score!!!!
Epoch: 54 cost time: 1.237410306930542
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0853492  Vali Loss: 0.0550700 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746863  Vali macro F1 0.9470130 
new best score!!!!
Validation loss decreased (0.057244 --> 0.055070).  Saving model ...
new best score!!!!
Epoch: 55 cost time: 1.2380800247192383
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0843669  Vali Loss: 0.0537957 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746863  Vali macro F1 0.9470130 
new best score!!!!
Validation loss decreased (0.055070 --> 0.053796).  Saving model ...
new best score!!!!
Epoch: 56 cost time: 1.2394437789916992
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0828639  Vali Loss: 0.0584016 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9689960  Vali macro F1 0.9421971 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 57 cost time: 1.237912893295288
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0860703  Vali Loss: 0.0784228 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9605329  Vali macro F1 0.9349605 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 58 cost time: 1.2377543449401855
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0851791  Vali Loss: 0.0506278 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859381  Vali macro F1 0.9699381 
new best score!!!!
Validation loss decreased (0.053796 --> 0.050628).  Saving model ...
new best score!!!!
Epoch: 59 cost time: 1.2397873401641846
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0798336  Vali Loss: 0.0533084 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829660  Vali macro F1 0.9745178 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 60 cost time: 1.2378077507019043
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0718802  Vali Loss: 0.0487832 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887399  Vali macro F1 0.9796294 
new best score!!!!
Validation loss decreased (0.050628 --> 0.048783).  Saving model ...
new best score!!!!
Epoch: 61 cost time: 1.2386114597320557
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0682755  Vali Loss: 0.0443899 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887353  Vali macro F1 0.9796218 
new best score!!!!
Validation loss decreased (0.048783 --> 0.044390).  Saving model ...
new best score!!!!
Epoch: 62 cost time: 1.2379472255706787
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0660299  Vali Loss: 0.0467085 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9854450  Vali macro F1 0.9719013 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 63 cost time: 1.2370660305023193
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0719091  Vali Loss: 0.0537617 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859520  Vali macro F1 0.9734565 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 64 cost time: 1.2390294075012207
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0664371  Vali Loss: 0.0550100 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831249  Vali macro F1 0.9711158 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 65 cost time: 1.236835241317749
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0584181  Vali Loss: 0.0321803 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
new best score!!!!
Validation loss decreased (0.044390 --> 0.032180).  Saving model ...
new best score!!!!
Epoch: 66 cost time: 1.2382915019989014
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0516689  Vali Loss: 0.0313520 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914400  Vali macro F1 0.9852047 
new best score!!!!
Validation loss decreased (0.032180 --> 0.031352).  Saving model ...
new best score!!!!
Epoch: 67 cost time: 1.2387733459472656
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0551594  Vali Loss: 0.0369660 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915273  Vali macro F1 0.9855237 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 68 cost time: 1.2409110069274902
VALI: Epoch: 68, Steps: 13 | Train Loss: 0.0579532  Vali Loss: 0.0292238 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
new best score!!!!
Validation loss decreased (0.031352 --> 0.029224).  Saving model ...
new best score!!!!
Epoch: 69 cost time: 1.2447915077209473
VALI: Epoch: 69, Steps: 13 | Train Loss: 0.0543384  Vali Loss: 0.0282232 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
new best score!!!!
Validation loss decreased (0.029224 --> 0.028223).  Saving model ...
new best score!!!!
Epoch: 70 cost time: 1.2438032627105713
VALI: Epoch: 70, Steps: 13 | Train Loss: 0.0456264  Vali Loss: 0.0275450 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
new best score!!!!
Validation loss decreased (0.028223 --> 0.027545).  Saving model ...
new best score!!!!
Epoch: 71 cost time: 1.2506983280181885
VALI: Epoch: 71, Steps: 13 | Train Loss: 0.0447839  Vali Loss: 0.0251999 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943294  Vali macro F1 0.9911734 
new best score!!!!
Validation loss decreased (0.027545 --> 0.025200).  Saving model ...
new best score!!!!
Epoch: 72 cost time: 1.246474266052246
VALI: Epoch: 72, Steps: 13 | Train Loss: 0.0428134  Vali Loss: 0.0255856 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 73 cost time: 1.264460802078247
VALI: Epoch: 73, Steps: 13 | Train Loss: 0.0370159  Vali Loss: 0.0237847 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
new best score!!!!
Validation loss decreased (0.025200 --> 0.023785).  Saving model ...
new best score!!!!
Epoch: 74 cost time: 1.2473158836364746
VALI: Epoch: 74, Steps: 13 | Train Loss: 0.0395193  Vali Loss: 0.0228650 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9942675  Vali macro F1 0.9875458 
new best score!!!!
Validation loss decreased (0.023785 --> 0.022865).  Saving model ...
new best score!!!!
Epoch: 75 cost time: 1.248943567276001
VALI: Epoch: 75, Steps: 13 | Train Loss: 0.0391191  Vali Loss: 0.0260891 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915227  Vali macro F1 0.9855161 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 76 cost time: 1.2482597827911377
VALI: Epoch: 76, Steps: 13 | Train Loss: 0.0438528  Vali Loss: 0.0295433 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859461  Vali macro F1 0.9769757 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 77 cost time: 1.2444126605987549
VALI: Epoch: 77, Steps: 13 | Train Loss: 0.0469945  Vali Loss: 0.0236649 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914400  Vali macro F1 0.9852047 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 78 cost time: 1.2449512481689453
VALI: Epoch: 78, Steps: 13 | Train Loss: 0.0452773  Vali Loss: 0.0219682 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9942675  Vali macro F1 0.9875458 
new best score!!!!
Validation loss decreased (0.022865 --> 0.021968).  Saving model ...
new best score!!!!
Epoch: 79 cost time: 1.2456448078155518
VALI: Epoch: 79, Steps: 13 | Train Loss: 0.0378011  Vali Loss: 0.0232114 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9942675  Vali macro F1 0.9875458 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 80 cost time: 1.2459132671356201
VALI: Epoch: 80, Steps: 13 | Train Loss: 0.0329447  Vali Loss: 0.0179151 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.021968 --> 0.017915).  Saving model ...
new best score!!!!
Epoch: 81 cost time: 1.2473089694976807
VALI: Epoch: 81, Steps: 13 | Train Loss: 0.0338477  Vali Loss: 0.0282337 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914400  Vali macro F1 0.9852047 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 82 cost time: 1.2460429668426514
VALI: Epoch: 82, Steps: 13 | Train Loss: 0.0315427  Vali Loss: 0.0180714 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 83 cost time: 1.2450518608093262
VALI: Epoch: 83, Steps: 13 | Train Loss: 0.0286626  Vali Loss: 0.0131504 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.017915 --> 0.013150).  Saving model ...
new best score!!!!
Epoch: 84 cost time: 1.2462828159332275
VALI: Epoch: 84, Steps: 13 | Train Loss: 0.0304721  Vali Loss: 0.0196079 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943343  Vali macro F1 0.9915238 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 85 cost time: 1.2457399368286133
VALI: Epoch: 85, Steps: 13 | Train Loss: 0.0289670  Vali Loss: 0.0170546 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 86 cost time: 1.2462875843048096
VALI: Epoch: 86, Steps: 13 | Train Loss: 0.0288409  Vali Loss: 0.0272367 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915624  Vali macro F1 0.9857291 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 87 cost time: 1.2463626861572266
VALI: Epoch: 87, Steps: 13 | Train Loss: 0.0529944  Vali Loss: 0.0431967 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9856505  Vali macro F1 0.9763315 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 88 cost time: 1.2398333549499512
VALI: Epoch: 88, Steps: 13 | Train Loss: 0.0548557  Vali Loss: 0.0249173 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9942675  Vali macro F1 0.9875458 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 89 cost time: 1.2437846660614014
VALI: Epoch: 89, Steps: 13 | Train Loss: 0.0341353  Vali Loss: 0.0163990 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 90 cost time: 1.2432012557983398
VALI: Epoch: 90, Steps: 13 | Train Loss: 0.0275341  Vali Loss: 0.0158980 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 91 cost time: 1.2409298419952393
VALI: Epoch: 91, Steps: 13 | Train Loss: 0.0245434  Vali Loss: 0.0146617 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 92 cost time: 1.2435317039489746
VALI: Epoch: 92, Steps: 13 | Train Loss: 0.0255757  Vali Loss: 0.0163936 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 93 cost time: 1.2393124103546143
VALI: Epoch: 93, Steps: 13 | Train Loss: 0.0230164  Vali Loss: 0.0159967 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 94 cost time: 1.2415125370025635
VALI: Epoch: 94, Steps: 13 | Train Loss: 0.0204114  Vali Loss: 0.0157874 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 95 cost time: 1.2416117191314697
VALI: Epoch: 95, Steps: 13 | Train Loss: 0.0237386  Vali Loss: 0.0157010 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 96 cost time: 1.241901159286499
VALI: Epoch: 96, Steps: 13 | Train Loss: 0.0228901  Vali Loss: 0.0156437 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 97 cost time: 1.2406063079833984
VALI: Epoch: 97, Steps: 13 | Train Loss: 0.0217315  Vali Loss: 0.0156360 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 98 cost time: 1.2384123802185059
VALI: Epoch: 98, Steps: 13 | Train Loss: 0.0231460  Vali Loss: 0.0157162 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9807692  Test weighted F1: 0.9807036  Test macro F1 0.9773580 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 73347
pruned model Parameter : 76626
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.2656400203704834
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0244919  Vali Loss: 0.0173187 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
Validation loss decreased (inf --> 0.017319).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.2616922855377197
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0251868  Vali Loss: 0.0167907 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.017319 --> 0.016791).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 1.2672483921051025
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0212872  Vali Loss: 0.0123886 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971876  Vali macro F1 0.9939876 
new best score!!!!
Validation loss decreased (0.016791 --> 0.012389).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 1.260122537612915
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0236498  Vali Loss: 0.0166524 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 1.2793829441070557
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0231029  Vali Loss: 0.0144376 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 1.2656352519989014
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0231535  Vali Loss: 0.0167144 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 1.264716386795044
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0227512  Vali Loss: 0.0151720 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 8 cost time: 1.2639203071594238
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0229295  Vali Loss: 0.0158029 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 9 cost time: 1.2563071250915527
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0215319  Vali Loss: 0.0138506 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 1.2594053745269775
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0209768  Vali Loss: 0.0150864 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 1.258152723312378
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0188800  Vali Loss: 0.0139081 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 1.2651340961456299
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0208457  Vali Loss: 0.0150900 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 1.260425329208374
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0224498  Vali Loss: 0.0131721 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 14 cost time: 1.2597129344940186
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0250064  Vali Loss: 0.0148279 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 1.2588489055633545
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0212135  Vali Loss: 0.0151942 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 1.2572999000549316
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0212959  Vali Loss: 0.0151894 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 1.2577629089355469
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0190685  Vali Loss: 0.0151621 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 1.2629342079162598
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0270188  Vali Loss: 0.0151065 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9796380  Test weighted F1: 0.9795723  Test macro F1 0.9762110 
================ the 4 th CV Experiment ================ 
Overlapping random Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.00265252 0.00243309 0.00246305 0.00332226 0.00571429 0.00568182
 0.00314465 0.0028169  0.00238663 0.00409836]
Train data number :  3182
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  887
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.2417337894439697
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.3024756  Vali Loss: 2.2888216 Vali Accuracy: 0.1779661  Vali weighted F1: 0.1026305  Vali macro F1 0.0976064 
Validation loss decreased (inf --> 2.288822).  Saving model ...
Epoch: 2 cost time: 1.2407450675964355
VALI: Epoch: 2, Steps: 13 | Train Loss: 2.2160788  Vali Loss: 2.0716676 Vali Accuracy: 0.2146893  Vali weighted F1: 0.1428190  Vali macro F1 0.1189729 
new best score!!!!
Validation loss decreased (2.288822 --> 2.071668).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.239896297454834
VALI: Epoch: 3, Steps: 13 | Train Loss: 1.8598886  Vali Loss: 1.5685313 Vali Accuracy: 0.4435028  Vali weighted F1: 0.3885469  Vali macro F1 0.3830695 
new best score!!!!
Validation loss decreased (2.071668 --> 1.568531).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.241424322128296
VALI: Epoch: 4, Steps: 13 | Train Loss: 1.4519585  Vali Loss: 1.2049727 Vali Accuracy: 0.7005650  Vali weighted F1: 0.6805656  Vali macro F1 0.6708247 
new best score!!!!
Validation loss decreased (1.568531 --> 1.204973).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.2430832386016846
VALI: Epoch: 5, Steps: 13 | Train Loss: 1.1746083  Vali Loss: 0.9933634 Vali Accuracy: 0.7457627  Vali weighted F1: 0.7422570  Vali macro F1 0.7212648 
new best score!!!!
Validation loss decreased (1.204973 --> 0.993363).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.2394640445709229
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.9689906  Vali Loss: 0.8388988 Vali Accuracy: 0.7655367  Vali weighted F1: 0.7489927  Vali macro F1 0.7230871 
new best score!!!!
Validation loss decreased (0.993363 --> 0.838899).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.2414460182189941
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.8027654  Vali Loss: 0.6882980 Vali Accuracy: 0.7909605  Vali weighted F1: 0.7733434  Vali macro F1 0.7407831 
new best score!!!!
Validation loss decreased (0.838899 --> 0.688298).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.2425100803375244
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.6792906  Vali Loss: 0.5653550 Vali Accuracy: 0.8446328  Vali weighted F1: 0.8354053  Vali macro F1 0.8127066 
new best score!!!!
Validation loss decreased (0.688298 --> 0.565355).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.2437691688537598
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.5737077  Vali Loss: 0.4917504 Vali Accuracy: 0.8502825  Vali weighted F1: 0.8363480  Vali macro F1 0.8036507 
new best score!!!!
Validation loss decreased (0.565355 --> 0.491750).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.2407500743865967
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.5153397  Vali Loss: 0.4426870 Vali Accuracy: 0.8559322  Vali weighted F1: 0.8363083  Vali macro F1 0.7964702 
new best score!!!!
Validation loss decreased (0.491750 --> 0.442687).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.2433347702026367
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.4607523  Vali Loss: 0.4016260 Vali Accuracy: 0.8728814  Vali weighted F1: 0.8534287  Vali macro F1 0.8108151 
new best score!!!!
Validation loss decreased (0.442687 --> 0.401626).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.242201566696167
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.4176518  Vali Loss: 0.3633777 Vali Accuracy: 0.8785311  Vali weighted F1: 0.8624837  Vali macro F1 0.8222885 
new best score!!!!
Validation loss decreased (0.401626 --> 0.363378).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.2388670444488525
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.3834991  Vali Loss: 0.3387601 Vali Accuracy: 0.8841808  Vali weighted F1: 0.8678071  Vali macro F1 0.8253772 
new best score!!!!
Validation loss decreased (0.363378 --> 0.338760).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.2417752742767334
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.3595183  Vali Loss: 0.3068030 Vali Accuracy: 0.9039548  Vali weighted F1: 0.8866288  Vali macro F1 0.8448093 
new best score!!!!
Validation loss decreased (0.338760 --> 0.306803).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.2459638118743896
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.3386912  Vali Loss: 0.2993899 Vali Accuracy: 0.9096045  Vali weighted F1: 0.9091483  Vali macro F1 0.8835464 
new best score!!!!
Validation loss decreased (0.306803 --> 0.299390).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.2409098148345947
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.3183246  Vali Loss: 0.2776367 Vali Accuracy: 0.8898305  Vali weighted F1: 0.8692165  Vali macro F1 0.8242982 
new best score!!!!
Validation loss decreased (0.299390 --> 0.277637).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.254633903503418
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.3027831  Vali Loss: 0.2555629 Vali Accuracy: 0.9067797  Vali weighted F1: 0.9061804  Vali macro F1 0.8744364 
new best score!!!!
Validation loss decreased (0.277637 --> 0.255563).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.2444968223571777
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.2811431  Vali Loss: 0.2476074 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9178795  Vali macro F1 0.8903131 
new best score!!!!
Validation loss decreased (0.255563 --> 0.247607).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.237401008605957
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.2573681  Vali Loss: 0.2233574 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9196057  Vali macro F1 0.8841585 
new best score!!!!
Validation loss decreased (0.247607 --> 0.223357).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.235762357711792
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.2520625  Vali Loss: 0.2311179 Vali Accuracy: 0.9039548  Vali weighted F1: 0.8921615  Vali macro F1 0.8479928 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 1.2383737564086914
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.2347954  Vali Loss: 0.2109082 Vali Accuracy: 0.9180791  Vali weighted F1: 0.9177532  Vali macro F1 0.8830814 
new best score!!!!
Validation loss decreased (0.223357 --> 0.210908).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.2390778064727783
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.2180608  Vali Loss: 0.2024234 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9210132  Vali macro F1 0.8922707 
new best score!!!!
Validation loss decreased (0.210908 --> 0.202423).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.2375307083129883
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.2069348  Vali Loss: 0.1977129 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9214726  Vali macro F1 0.8929824 
new best score!!!!
Validation loss decreased (0.202423 --> 0.197713).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.238070011138916
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.1962729  Vali Loss: 0.1932983 Vali Accuracy: 0.9067797  Vali weighted F1: 0.9073217  Vali macro F1 0.8775858 
new best score!!!!
Validation loss decreased (0.197713 --> 0.193298).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.2397487163543701
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.1846779  Vali Loss: 0.1768807 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9454149  Vali macro F1 0.9275325 
new best score!!!!
Validation loss decreased (0.193298 --> 0.176881).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.2375855445861816
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.1759671  Vali Loss: 0.1723681 Vali Accuracy: 0.9067797  Vali weighted F1: 0.8889978  Vali macro F1 0.8387057 
new best score!!!!
Validation loss decreased (0.176881 --> 0.172368).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.2389953136444092
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.1685669  Vali Loss: 0.1578294 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9249930  Vali macro F1 0.8900931 
new best score!!!!
Validation loss decreased (0.172368 --> 0.157829).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 1.2367475032806396
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.1617093  Vali Loss: 0.1563622 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9321583  Vali macro F1 0.9030415 
new best score!!!!
Validation loss decreased (0.157829 --> 0.156362).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.2396831512451172
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.1583853  Vali Loss: 0.1591137 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9377893  Vali macro F1 0.9178355 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 1.2417078018188477
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.1589900  Vali Loss: 0.1514568 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9280334  Vali macro F1 0.8978380 
new best score!!!!
Validation loss decreased (0.156362 --> 0.151457).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 1.2391977310180664
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.1520315  Vali Loss: 0.1600686 Vali Accuracy: 0.9096045  Vali weighted F1: 0.8947885  Vali macro F1 0.8484113 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 1.2386338710784912
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.1541233  Vali Loss: 0.1396727 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9233404  Vali macro F1 0.8833419 
new best score!!!!
Validation loss decreased (0.151457 --> 0.139673).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 1.240044355392456
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.1441927  Vali Loss: 0.1341345 Vali Accuracy: 0.9265537  Vali weighted F1: 0.9136017  Vali macro F1 0.8692499 
new best score!!!!
Validation loss decreased (0.139673 --> 0.134134).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 1.2401094436645508
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.1362314  Vali Loss: 0.1364399 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9419151  Vali macro F1 0.9234640 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 1.2421135902404785
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.1330574  Vali Loss: 0.1330066 Vali Accuracy: 0.9265537  Vali weighted F1: 0.9148887  Vali macro F1 0.8762764 
new best score!!!!
Validation loss decreased (0.134134 --> 0.133007).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 1.2421889305114746
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.1343673  Vali Loss: 0.1247790 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9467618  Vali macro F1 0.9274384 
new best score!!!!
Validation loss decreased (0.133007 --> 0.124779).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 1.2430753707885742
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.1289890  Vali Loss: 0.1384839 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9366315  Vali macro F1 0.9128761 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 1.241600751876831
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.1271073  Vali Loss: 0.1291083 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9432133  Vali macro F1 0.9215096 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 1.2393362522125244
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.1231707  Vali Loss: 0.1336505 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9394997  Vali macro F1 0.9142708 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 40 cost time: 1.2427730560302734
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.1218181  Vali Loss: 0.1238562 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9423238  Vali macro F1 0.9169921 
new best score!!!!
Validation loss decreased (0.124779 --> 0.123856).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 1.2418220043182373
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.1251624  Vali Loss: 0.1270768 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9366547  Vali macro F1 0.9120795 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 1.2450008392333984
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.1154077  Vali Loss: 0.1265375 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9488425  Vali macro F1 0.9255504 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 1.2461676597595215
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.1143416  Vali Loss: 0.1188070 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9422962  Vali macro F1 0.9171921 
new best score!!!!
Validation loss decreased (0.123856 --> 0.118807).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 1.2459115982055664
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.1213478  Vali Loss: 0.1291453 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9467804  Vali macro F1 0.9269863 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 1.2455432415008545
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.1143286  Vali Loss: 0.1252433 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9463335  Vali macro F1 0.9197640 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 1.2512211799621582
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.1275914  Vali Loss: 0.1212136 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9498597  Vali macro F1 0.9272764 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 1.24607253074646
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.1170265  Vali Loss: 0.1215157 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9445036  Vali macro F1 0.9193786 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 1.2575454711914062
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.1097151  Vali Loss: 0.1162731 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9524368  Vali macro F1 0.9315147 
new best score!!!!
Validation loss decreased (0.118807 --> 0.116273).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 1.2557272911071777
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0990190  Vali Loss: 0.1112278 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9496112  Vali macro F1 0.9291428 
new best score!!!!
Validation loss decreased (0.116273 --> 0.111228).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 1.2462589740753174
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.1015106  Vali Loss: 0.1041420 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9384283  Vali macro F1 0.9104887 
new best score!!!!
Validation loss decreased (0.111228 --> 0.104142).  Saving model ...
new best score!!!!
Epoch: 51 cost time: 1.2498109340667725
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.1069896  Vali Loss: 0.1210335 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9439173  Vali macro F1 0.9242136 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 1.2472660541534424
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.1084845  Vali Loss: 0.1162697 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9271723  Vali macro F1 0.8936645 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 53 cost time: 1.2487080097198486
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.1005953  Vali Loss: 0.1068655 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9412539  Vali macro F1 0.9128607 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 54 cost time: 1.247359275817871
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0956403  Vali Loss: 0.1048850 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9412539  Vali macro F1 0.9128607 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 55 cost time: 1.2407779693603516
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0938497  Vali Loss: 0.0960634 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9565169  Vali macro F1 0.9383561 
new best score!!!!
Validation loss decreased (0.104142 --> 0.096063).  Saving model ...
new best score!!!!
Epoch: 56 cost time: 1.2432518005371094
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0908836  Vali Loss: 0.1002743 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9558333  Vali macro F1 0.9380018 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 57 cost time: 1.2435572147369385
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0865838  Vali Loss: 0.0943787 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9573576  Vali macro F1 0.9398495 
new best score!!!!
Validation loss decreased (0.096063 --> 0.094379).  Saving model ...
new best score!!!!
Epoch: 58 cost time: 1.2408735752105713
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0881771  Vali Loss: 0.0959833 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9504117  Vali macro F1 0.9307532 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 1.2437431812286377
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0877215  Vali Loss: 0.0825115 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9593130  Vali macro F1 0.9412852 
new best score!!!!
Validation loss decreased (0.094379 --> 0.082511).  Saving model ...
new best score!!!!
Epoch: 60 cost time: 1.2415266036987305
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0796357  Vali Loss: 0.0788782 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9714299  Vali macro F1 0.9582577 
new best score!!!!
Validation loss decreased (0.082511 --> 0.078878).  Saving model ...
new best score!!!!
Epoch: 61 cost time: 1.2447154521942139
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0763546  Vali Loss: 0.0800213 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9712386  Vali macro F1 0.9564236 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 62 cost time: 1.243891954421997
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0749107  Vali Loss: 0.0788890 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9716687  Vali macro F1 0.9640961 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 63 cost time: 1.244018793106079
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0724379  Vali Loss: 0.0772407 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746165  Vali macro F1 0.9683839 
new best score!!!!
Validation loss decreased (0.078878 --> 0.077241).  Saving model ...
new best score!!!!
Epoch: 64 cost time: 1.243882656097412
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0765430  Vali Loss: 0.0786770 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9627897  Vali macro F1 0.9487764 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 65 cost time: 1.2439470291137695
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0691344  Vali Loss: 0.0689783 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9687452  Vali macro F1 0.9594809 
new best score!!!!
Validation loss decreased (0.077241 --> 0.068978).  Saving model ...
new best score!!!!
Epoch: 66 cost time: 1.2423288822174072
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0708965  Vali Loss: 0.0743495 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9717243  Vali macro F1 0.9661371 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 67 cost time: 1.2431375980377197
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0656368  Vali Loss: 0.0849437 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9564865  Vali macro F1 0.9389124 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 68 cost time: 1.241109848022461
VALI: Epoch: 68, Steps: 13 | Train Loss: 0.0575495  Vali Loss: 0.0755894 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9660376  Vali macro F1 0.9575642 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 69 cost time: 1.2431678771972656
VALI: Epoch: 69, Steps: 13 | Train Loss: 0.0598922  Vali Loss: 0.0668261 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745439  Vali macro F1 0.9690747 
new best score!!!!
Validation loss decreased (0.068978 --> 0.066826).  Saving model ...
new best score!!!!
Epoch: 70 cost time: 1.2548539638519287
VALI: Epoch: 70, Steps: 13 | Train Loss: 0.0550322  Vali Loss: 0.0587161 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773757  Vali macro F1 0.9712320 
new best score!!!!
Validation loss decreased (0.066826 --> 0.058716).  Saving model ...
new best score!!!!
Epoch: 71 cost time: 1.2527132034301758
VALI: Epoch: 71, Steps: 13 | Train Loss: 0.0472992  Vali Loss: 0.0617525 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774050  Vali macro F1 0.9740090 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 72 cost time: 1.2496898174285889
VALI: Epoch: 72, Steps: 13 | Train Loss: 0.0452293  Vali Loss: 0.0717592 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9687452  Vali macro F1 0.9594809 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 73 cost time: 1.2515978813171387
VALI: Epoch: 73, Steps: 13 | Train Loss: 0.0485712  Vali Loss: 0.0781402 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9631577  Vali macro F1 0.9570434 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 74 cost time: 1.2515511512756348
VALI: Epoch: 74, Steps: 13 | Train Loss: 0.0401378  Vali Loss: 0.0567344 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802401  Vali macro F1 0.9734665 
new best score!!!!
Validation loss decreased (0.058716 --> 0.056734).  Saving model ...
new best score!!!!
Epoch: 75 cost time: 1.2518384456634521
VALI: Epoch: 75, Steps: 13 | Train Loss: 0.0397715  Vali Loss: 0.0616157 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774048  Vali macro F1 0.9732048 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 76 cost time: 1.249870777130127
VALI: Epoch: 76, Steps: 13 | Train Loss: 0.0464519  Vali Loss: 0.0535097 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745727  Vali macro F1 0.9710260 
new best score!!!!
Validation loss decreased (0.056734 --> 0.053510).  Saving model ...
new best score!!!!
Epoch: 77 cost time: 1.2570886611938477
VALI: Epoch: 77, Steps: 13 | Train Loss: 0.0588285  Vali Loss: 0.0572996 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774056  Vali macro F1 0.9738169 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 78 cost time: 1.251610517501831
VALI: Epoch: 78, Steps: 13 | Train Loss: 0.0477759  Vali Loss: 0.0647613 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773734  Vali macro F1 0.9762929 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 79 cost time: 1.2668066024780273
VALI: Epoch: 79, Steps: 13 | Train Loss: 0.0404561  Vali Loss: 0.0494286 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802048  Vali macro F1 0.9788574 
new best score!!!!
Validation loss decreased (0.053510 --> 0.049429).  Saving model ...
new best score!!!!
Epoch: 80 cost time: 1.2524745464324951
VALI: Epoch: 80, Steps: 13 | Train Loss: 0.0434249  Vali Loss: 0.0531678 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745807  Vali macro F1 0.9691556 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 81 cost time: 1.2546570301055908
VALI: Epoch: 81, Steps: 13 | Train Loss: 0.0341084  Vali Loss: 0.0507430 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802374  Vali macro F1 0.9759742 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 82 cost time: 1.2526321411132812
VALI: Epoch: 82, Steps: 13 | Train Loss: 0.0318799  Vali Loss: 0.0514849 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802374  Vali macro F1 0.9759742 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 83 cost time: 1.2533655166625977
VALI: Epoch: 83, Steps: 13 | Train Loss: 0.0342992  Vali Loss: 0.0489982 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745439  Vali macro F1 0.9690747 
new best score!!!!
Validation loss decreased (0.049429 --> 0.048998).  Saving model ...
new best score!!!!
Epoch: 84 cost time: 1.2521166801452637
VALI: Epoch: 84, Steps: 13 | Train Loss: 0.0346692  Vali Loss: 0.0576664 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9744568  Vali macro F1 0.9689107 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 85 cost time: 1.2523961067199707
VALI: Epoch: 85, Steps: 13 | Train Loss: 0.0345745  Vali Loss: 0.0662389 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773964  Vali macro F1 0.9737866 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 86 cost time: 1.2515349388122559
VALI: Epoch: 86, Steps: 13 | Train Loss: 0.0345228  Vali Loss: 0.0597988 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774178  Vali macro F1 0.9730366 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 87 cost time: 1.2526543140411377
VALI: Epoch: 87, Steps: 13 | Train Loss: 0.0320976  Vali Loss: 0.0460787 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802243  Vali macro F1 0.9784630 
new best score!!!!
Validation loss decreased (0.048998 --> 0.046079).  Saving model ...
new best score!!!!
Epoch: 88 cost time: 1.2544012069702148
VALI: Epoch: 88, Steps: 13 | Train Loss: 0.0303260  Vali Loss: 0.0435754 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774056  Vali macro F1 0.9738169 
new best score!!!!
Validation loss decreased (0.046079 --> 0.043575).  Saving model ...
new best score!!!!
Epoch: 89 cost time: 1.254927635192871
VALI: Epoch: 89, Steps: 13 | Train Loss: 0.0336901  Vali Loss: 0.0463473 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802401  Vali macro F1 0.9734665 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 90 cost time: 1.2520575523376465
VALI: Epoch: 90, Steps: 13 | Train Loss: 0.0301531  Vali Loss: 0.0399196 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802401  Vali macro F1 0.9734665 
new best score!!!!
Validation loss decreased (0.043575 --> 0.039920).  Saving model ...
new best score!!!!
Epoch: 91 cost time: 1.2547054290771484
VALI: Epoch: 91, Steps: 13 | Train Loss: 0.0354086  Vali Loss: 0.0394613 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802243  Vali macro F1 0.9784630 
new best score!!!!
Validation loss decreased (0.039920 --> 0.039461).  Saving model ...
new best score!!!!
Epoch: 92 cost time: 1.2558984756469727
VALI: Epoch: 92, Steps: 13 | Train Loss: 0.0340916  Vali Loss: 0.0362025 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858530  Vali macro F1 0.9827513 
new best score!!!!
Validation loss decreased (0.039461 --> 0.036202).  Saving model ...
new best score!!!!
Epoch: 93 cost time: 1.2553198337554932
VALI: Epoch: 93, Steps: 13 | Train Loss: 0.0383489  Vali Loss: 0.0389958 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858809  Vali macro F1 0.9802488 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 94 cost time: 1.2568070888519287
VALI: Epoch: 94, Steps: 13 | Train Loss: 0.0298797  Vali Loss: 0.0371486 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830649  Vali macro F1 0.9781278 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 95 cost time: 1.257819652557373
VALI: Epoch: 95, Steps: 13 | Train Loss: 0.0261086  Vali Loss: 0.0417931 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802282  Vali macro F1 0.9759440 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 96 cost time: 1.2554931640625
VALI: Epoch: 96, Steps: 13 | Train Loss: 0.0243399  Vali Loss: 0.0424222 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802282  Vali macro F1 0.9759440 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 97 cost time: 1.2538130283355713
VALI: Epoch: 97, Steps: 13 | Train Loss: 0.0284403  Vali Loss: 0.0481237 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802282  Vali macro F1 0.9759440 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 98 cost time: 1.2553715705871582
VALI: Epoch: 98, Steps: 13 | Train Loss: 0.0212750  Vali Loss: 0.0451793 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802282  Vali macro F1 0.9759440 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 99 cost time: 1.2542874813079834
VALI: Epoch: 99, Steps: 13 | Train Loss: 0.0235359  Vali Loss: 0.0407215 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802282  Vali macro F1 0.9759440 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 100 cost time: 1.2531826496124268
VALI: Epoch: 100, Steps: 13 | Train Loss: 0.0212739  Vali Loss: 0.0390280 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802282  Vali macro F1 0.9759440 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 101 cost time: 1.2537808418273926
VALI: Epoch: 101, Steps: 13 | Train Loss: 0.0186441  Vali Loss: 0.0373419 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830623  Vali macro F1 0.9806203 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 102 cost time: 1.2544162273406982
VALI: Epoch: 102, Steps: 13 | Train Loss: 0.0183527  Vali Loss: 0.0382612 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830623  Vali macro F1 0.9806203 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 103 cost time: 1.2535765171051025
VALI: Epoch: 103, Steps: 13 | Train Loss: 0.0187160  Vali Loss: 0.0380194 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830623  Vali macro F1 0.9806203 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 104 cost time: 1.254188060760498
VALI: Epoch: 104, Steps: 13 | Train Loss: 0.0181371  Vali Loss: 0.0379831 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802374  Vali macro F1 0.9759742 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 105 cost time: 1.2536253929138184
VALI: Epoch: 105, Steps: 13 | Train Loss: 0.0210941  Vali Loss: 0.0379675 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802374  Vali macro F1 0.9759742 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 106 cost time: 1.2565529346466064
VALI: Epoch: 106, Steps: 13 | Train Loss: 0.0183469  Vali Loss: 0.0380205 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802374  Vali macro F1 0.9759742 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 107 cost time: 1.2534747123718262
VALI: Epoch: 107, Steps: 13 | Train Loss: 0.0215137  Vali Loss: 0.0378862 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802374  Vali macro F1 0.9759742 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9898534  Test weighted F1: 0.9898559  Test macro F1 0.9874959 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 73347
pruned model Parameter : 76626
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.335294246673584
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0258527  Vali Loss: 0.0304388 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858809  Vali macro F1 0.9802488 
Validation loss decreased (inf --> 0.030439).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.37300705909729
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0236988  Vali Loss: 0.0298050 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858901  Vali macro F1 0.9802791 
new best score!!!!
Validation loss decreased (0.030439 --> 0.029805).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 1.364762306213379
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0219645  Vali Loss: 0.0332465 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830652  Vali macro F1 0.9756178 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 1.3674087524414062
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0210394  Vali Loss: 0.0329763 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802374  Vali macro F1 0.9759742 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 1.3738131523132324
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0219100  Vali Loss: 0.0330970 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802374  Vali macro F1 0.9759742 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 1.3637089729309082
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0215930  Vali Loss: 0.0347373 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802401  Vali macro F1 0.9734665 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 1.365962266921997
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0183938  Vali Loss: 0.0346075 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830649  Vali macro F1 0.9781278 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 8 cost time: 1.3528311252593994
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0208094  Vali Loss: 0.0357865 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830649  Vali macro F1 0.9781278 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 1.3156604766845703
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0203876  Vali Loss: 0.0359691 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830649  Vali macro F1 0.9781278 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 1.3467562198638916
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0202802  Vali Loss: 0.0347205 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830649  Vali macro F1 0.9781278 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 1.3126444816589355
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0193535  Vali Loss: 0.0355244 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830649  Vali macro F1 0.9781278 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 1.3498284816741943
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0192950  Vali Loss: 0.0365317 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802401  Vali macro F1 0.9734665 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 13 cost time: 1.36765718460083
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0170621  Vali Loss: 0.0366376 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802401  Vali macro F1 0.9734665 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 1.3661017417907715
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0215705  Vali Loss: 0.0361826 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802401  Vali macro F1 0.9734665 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 1.3650903701782227
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0189960  Vali Loss: 0.0363526 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802401  Vali macro F1 0.9734665 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 1.3598260879516602
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0201472  Vali Loss: 0.0368082 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802401  Vali macro F1 0.9734665 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 1.3442115783691406
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0194577  Vali Loss: 0.0359713 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802401  Vali macro F1 0.9734665 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9921082  Test weighted F1: 0.9921121  Test macro F1 0.9897613 
Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 73347
Set the seed as :  3
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
================ SOCV Mode ====================
================ 5 CV ======================
================ the 0 th CV Experiment ================ 
Overlapping random Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.00269542 0.00226757 0.00255102 0.0031348  0.00578035 0.00578035
 0.00319489 0.00290698 0.0023753  0.00420168]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.328932762145996
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.2824574  Vali Loss: 2.2698675 Vali Accuracy: 0.2090395  Vali weighted F1: 0.0863624  Vali macro F1 0.0736134 
Validation loss decreased (inf --> 2.269868).  Saving model ...
Epoch: 2 cost time: 1.2358882427215576
VALI: Epoch: 2, Steps: 13 | Train Loss: 2.2048898  Vali Loss: 2.0631063 Vali Accuracy: 0.2372881  Vali weighted F1: 0.1665668  Vali macro F1 0.1415390 
new best score!!!!
Validation loss decreased (2.269868 --> 2.063106).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.2374708652496338
VALI: Epoch: 3, Steps: 13 | Train Loss: 1.9213736  Vali Loss: 1.5855635 Vali Accuracy: 0.4887006  Vali weighted F1: 0.4532008  Vali macro F1 0.4271575 
new best score!!!!
Validation loss decreased (2.063106 --> 1.585564).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.2376556396484375
VALI: Epoch: 4, Steps: 13 | Train Loss: 1.5454100  Vali Loss: 1.2915493 Vali Accuracy: 0.5536723  Vali weighted F1: 0.5131751  Vali macro F1 0.5020991 
new best score!!!!
Validation loss decreased (1.585564 --> 1.291549).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.2413544654846191
VALI: Epoch: 5, Steps: 13 | Train Loss: 1.2717412  Vali Loss: 1.1080494 Vali Accuracy: 0.6214689  Vali weighted F1: 0.5983680  Vali macro F1 0.5751916 
new best score!!!!
Validation loss decreased (1.291549 --> 1.108049).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.2418510913848877
VALI: Epoch: 6, Steps: 13 | Train Loss: 1.0532411  Vali Loss: 0.8947374 Vali Accuracy: 0.6779661  Vali weighted F1: 0.6589275  Vali macro F1 0.6338342 
new best score!!!!
Validation loss decreased (1.108049 --> 0.894737).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.2436723709106445
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.8882250  Vali Loss: 0.7680960 Vali Accuracy: 0.7485876  Vali weighted F1: 0.7206798  Vali macro F1 0.6920243 
new best score!!!!
Validation loss decreased (0.894737 --> 0.768096).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.2379052639007568
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.7652550  Vali Loss: 0.6776595 Vali Accuracy: 0.7598870  Vali weighted F1: 0.7298118  Vali macro F1 0.7002789 
new best score!!!!
Validation loss decreased (0.768096 --> 0.677659).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.2390773296356201
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.6670221  Vali Loss: 0.5860118 Vali Accuracy: 0.8305085  Vali weighted F1: 0.8248909  Vali macro F1 0.8072826 
new best score!!!!
Validation loss decreased (0.677659 --> 0.586012).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.2371666431427002
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.5898068  Vali Loss: 0.5338441 Vali Accuracy: 0.8248588  Vali weighted F1: 0.8241908  Vali macro F1 0.8015847 
new best score!!!!
Validation loss decreased (0.586012 --> 0.533844).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.2438654899597168
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.5343063  Vali Loss: 0.4724997 Vali Accuracy: 0.8418079  Vali weighted F1: 0.8398744  Vali macro F1 0.8168309 
new best score!!!!
Validation loss decreased (0.533844 --> 0.472500).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.2384793758392334
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.4777961  Vali Loss: 0.4403045 Vali Accuracy: 0.8333333  Vali weighted F1: 0.8149353  Vali macro F1 0.7812216 
new best score!!!!
Validation loss decreased (0.472500 --> 0.440304).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.2332842350006104
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.4367200  Vali Loss: 0.3916628 Vali Accuracy: 0.8785311  Vali weighted F1: 0.8786118  Vali macro F1 0.8544852 
new best score!!!!
Validation loss decreased (0.440304 --> 0.391663).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.248746395111084
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.4061795  Vali Loss: 0.3561745 Vali Accuracy: 0.8954802  Vali weighted F1: 0.8882393  Vali macro F1 0.8559623 
new best score!!!!
Validation loss decreased (0.391663 --> 0.356174).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.2331264019012451
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.3702668  Vali Loss: 0.3344402 Vali Accuracy: 0.8926554  Vali weighted F1: 0.8789060  Vali macro F1 0.8457408 
new best score!!!!
Validation loss decreased (0.356174 --> 0.334440).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.2361328601837158
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.3556626  Vali Loss: 0.3095720 Vali Accuracy: 0.9152542  Vali weighted F1: 0.9130708  Vali macro F1 0.8866422 
new best score!!!!
Validation loss decreased (0.334440 --> 0.309572).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.235227108001709
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.3142155  Vali Loss: 0.2870395 Vali Accuracy: 0.8983051  Vali weighted F1: 0.8761226  Vali macro F1 0.8348952 
new best score!!!!
Validation loss decreased (0.309572 --> 0.287039).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.2393853664398193
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.2849978  Vali Loss: 0.2691151 Vali Accuracy: 0.9265537  Vali weighted F1: 0.9268202  Vali macro F1 0.9001744 
new best score!!!!
Validation loss decreased (0.287039 --> 0.269115).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.2337028980255127
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.2667575  Vali Loss: 0.2664130 Vali Accuracy: 0.9152542  Vali weighted F1: 0.9123099  Vali macro F1 0.8846570 
new best score!!!!
Validation loss decreased (0.269115 --> 0.266413).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.2342100143432617
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.2579817  Vali Loss: 0.2242865 Vali Accuracy: 0.9180791  Vali weighted F1: 0.9126432  Vali macro F1 0.8830042 
new best score!!!!
Validation loss decreased (0.266413 --> 0.224287).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.2361729145050049
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.2284624  Vali Loss: 0.2271670 Vali Accuracy: 0.9180791  Vali weighted F1: 0.9169717  Vali macro F1 0.8939856 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 1.2424240112304688
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.2103390  Vali Loss: 0.2010552 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9405092  Vali macro F1 0.9181407 
new best score!!!!
Validation loss decreased (0.224287 --> 0.201055).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.2374529838562012
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.1999210  Vali Loss: 0.2023539 Vali Accuracy: 0.9180791  Vali weighted F1: 0.9099396  Vali macro F1 0.8806967 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 1.2378098964691162
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.1851761  Vali Loss: 0.1952245 Vali Accuracy: 0.9265537  Vali weighted F1: 0.9263735  Vali macro F1 0.9037540 
new best score!!!!
Validation loss decreased (0.201055 --> 0.195224).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.2376344203948975
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.1819664  Vali Loss: 0.2045919 Vali Accuracy: 0.9152542  Vali weighted F1: 0.9126026  Vali macro F1 0.8892366 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 1.241523027420044
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.1730016  Vali Loss: 0.2005937 Vali Accuracy: 0.9180791  Vali weighted F1: 0.9114324  Vali macro F1 0.8836718 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 1.2400128841400146
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.1603422  Vali Loss: 0.1799445 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9240661  Vali macro F1 0.8951989 
new best score!!!!
Validation loss decreased (0.195224 --> 0.179944).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 1.240036964416504
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.1556190  Vali Loss: 0.1729757 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9371753  Vali macro F1 0.9175533 
new best score!!!!
Validation loss decreased (0.179944 --> 0.172976).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.2449414730072021
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.1508152  Vali Loss: 0.1651541 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9296592  Vali macro F1 0.9046578 
new best score!!!!
Validation loss decreased (0.172976 --> 0.165154).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.2395243644714355
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.1474569  Vali Loss: 0.1650363 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9365921  Vali macro F1 0.9162374 
new best score!!!!
Validation loss decreased (0.165154 --> 0.165036).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 1.2410309314727783
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.1418260  Vali Loss: 0.1600750 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9296559  Vali macro F1 0.9039983 
new best score!!!!
Validation loss decreased (0.165036 --> 0.160075).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 1.243875503540039
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.1317697  Vali Loss: 0.1700485 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9398200  Vali macro F1 0.9209630 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 1.2465846538543701
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.1275870  Vali Loss: 0.1584879 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9391692  Vali macro F1 0.9202989 
new best score!!!!
Validation loss decreased (0.160075 --> 0.158488).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 1.24556565284729
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.1207796  Vali Loss: 0.1565365 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9345311  Vali macro F1 0.9133596 
new best score!!!!
Validation loss decreased (0.158488 --> 0.156536).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.2390475273132324
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.1238855  Vali Loss: 0.1523981 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9434267  Vali macro F1 0.9246911 
new best score!!!!
Validation loss decreased (0.156536 --> 0.152398).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 1.240717887878418
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.1173963  Vali Loss: 0.1488155 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9424374  Vali macro F1 0.9250836 
new best score!!!!
Validation loss decreased (0.152398 --> 0.148815).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 1.247746229171753
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.1151716  Vali Loss: 0.1572776 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9453380  Vali macro F1 0.9261996 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 1.2414937019348145
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.1074435  Vali Loss: 0.1533117 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9457274  Vali macro F1 0.9286681 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 1.2429466247558594
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.1066297  Vali Loss: 0.1714729 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9429394  Vali macro F1 0.9267733 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 40 cost time: 1.2425076961517334
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.1072314  Vali Loss: 0.1832718 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9277377  Vali macro F1 0.9027661 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 41 cost time: 1.2476050853729248
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.1047366  Vali Loss: 0.1437597 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9436705  Vali macro F1 0.9261307 
new best score!!!!
Validation loss decreased (0.148815 --> 0.143760).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 1.2462549209594727
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0997279  Vali Loss: 0.1691769 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9315472  Vali macro F1 0.9083686 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 1.2403407096862793
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.1004887  Vali Loss: 0.1565225 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9424374  Vali macro F1 0.9250836 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 1.2419440746307373
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0982598  Vali Loss: 0.1568428 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9547988  Vali macro F1 0.9434561 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 1.259263515472412
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0885407  Vali Loss: 0.1436785 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9487225  Vali macro F1 0.9343510 
new best score!!!!
Validation loss decreased (0.143760 --> 0.143679).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 1.2412388324737549
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0833879  Vali Loss: 0.1316568 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9518088  Vali macro F1 0.9376789 
new best score!!!!
Validation loss decreased (0.143679 --> 0.131657).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 1.2435634136199951
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0791843  Vali Loss: 0.1220794 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9547636  Vali macro F1 0.9420906 
new best score!!!!
Validation loss decreased (0.131657 --> 0.122079).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 1.2442877292633057
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0795353  Vali Loss: 0.1411810 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9487225  Vali macro F1 0.9343510 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 1.2392055988311768
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0701673  Vali Loss: 0.1189141 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9578196  Vali macro F1 0.9475957 
new best score!!!!
Validation loss decreased (0.122079 --> 0.118914).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 1.2419605255126953
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0680715  Vali Loss: 0.1161273 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9631080  Vali macro F1 0.9556264 
new best score!!!!
Validation loss decreased (0.118914 --> 0.116127).  Saving model ...
new best score!!!!
Epoch: 51 cost time: 1.2394375801086426
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0741142  Vali Loss: 0.1069093 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9658961  Vali macro F1 0.9599768 
new best score!!!!
Validation loss decreased (0.116127 --> 0.106909).  Saving model ...
new best score!!!!
Epoch: 52 cost time: 1.2391431331634521
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0740156  Vali Loss: 0.1237322 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9604099  Vali macro F1 0.9519989 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 1.2433910369873047
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0645622  Vali Loss: 0.1379778 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9636026  Vali macro F1 0.9552140 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 1.2490482330322266
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0581983  Vali Loss: 0.1305276 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9576462  Vali macro F1 0.9499240 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 55 cost time: 1.244105577468872
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0541530  Vali Loss: 0.1206508 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9717705  Vali macro F1 0.9659728 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 56 cost time: 1.2501544952392578
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0524979  Vali Loss: 0.1077146 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9744865  Vali macro F1 0.9714815 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 57 cost time: 1.240670919418335
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0482577  Vali Loss: 0.1140019 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9744865  Vali macro F1 0.9714815 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 58 cost time: 1.2406647205352783
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0510453  Vali Loss: 0.1158599 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9660999  Vali macro F1 0.9597455 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 59 cost time: 1.2423663139343262
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0452650  Vali Loss: 0.1163444 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9604074  Vali macro F1 0.9510828 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 60 cost time: 1.2512319087982178
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0477440  Vali Loss: 0.1110782 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9688875  Vali macro F1 0.9629371 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 61 cost time: 1.2435550689697266
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0432809  Vali Loss: 0.1082765 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9717057  Vali macro F1 0.9672622 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 62 cost time: 1.2463953495025635
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0430527  Vali Loss: 0.1084534 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9689466  Vali macro F1 0.9641876 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 63 cost time: 1.2438058853149414
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0431377  Vali Loss: 0.1087495 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9689466  Vali macro F1 0.9641876 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 64 cost time: 1.2428598403930664
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0457753  Vali Loss: 0.1087397 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9689466  Vali macro F1 0.9641876 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 65 cost time: 1.2418460845947266
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0458377  Vali Loss: 0.1091093 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9689466  Vali macro F1 0.9641876 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 66 cost time: 1.2417702674865723
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0450437  Vali Loss: 0.1087345 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9689466  Vali macro F1 0.9641876 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9864253  Test weighted F1: 0.9864082  Test macro F1 0.9802755 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 73347
pruned model Parameter : 76626
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.2557730674743652
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0636236  Vali Loss: 0.1129572 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9604706  Vali macro F1 0.9521438 
Validation loss decreased (inf --> 0.112957).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.2519831657409668
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0616064  Vali Loss: 0.1152791 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9633558  Vali macro F1 0.9563988 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.2522294521331787
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0559946  Vali Loss: 0.1215128 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9577114  Vali macro F1 0.9490693 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 1.2544593811035156
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0597799  Vali Loss: 0.1184219 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9605348  Vali macro F1 0.9520944 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 1.2580163478851318
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0592233  Vali Loss: 0.1146203 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9633288  Vali macro F1 0.9564814 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 1.2549095153808594
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0573988  Vali Loss: 0.1116580 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9605348  Vali macro F1 0.9520944 
new best score!!!!
Validation loss decreased (0.112957 --> 0.111658).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 1.257528305053711
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0562873  Vali Loss: 0.1165171 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9633288  Vali macro F1 0.9564814 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 1.2522947788238525
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0582439  Vali Loss: 0.1164284 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9632592  Vali macro F1 0.9542250 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 1.268120288848877
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0534089  Vali Loss: 0.1151096 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9605348  Vali macro F1 0.9520944 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 1.2515923976898193
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0521944  Vali Loss: 0.1160291 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9633288  Vali macro F1 0.9564814 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 11 cost time: 1.2528812885284424
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0551868  Vali Loss: 0.1147763 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9633288  Vali macro F1 0.9564814 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 12 cost time: 1.2567427158355713
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0511149  Vali Loss: 0.1150942 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9633288  Vali macro F1 0.9564814 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 1.2521302700042725
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0521842  Vali Loss: 0.1155586 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9633288  Vali macro F1 0.9564814 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 1.2527174949645996
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0515489  Vali Loss: 0.1152050 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9633558  Vali macro F1 0.9563988 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 1.2517900466918945
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0523534  Vali Loss: 0.1156433 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9633558  Vali macro F1 0.9563988 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 1.252267599105835
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0551683  Vali Loss: 0.1159415 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9661631  Vali macro F1 0.9608066 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 17 cost time: 1.2540464401245117
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0514106  Vali Loss: 0.1159997 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9661631  Vali macro F1 0.9608066 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 1.2534880638122559
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0518584  Vali Loss: 0.1160668 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9661631  Vali macro F1 0.9608066 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 1.2515666484832764
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0521065  Vali Loss: 0.1161783 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9633288  Vali macro F1 0.9564814 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 1.2514915466308594
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0542721  Vali Loss: 0.1161197 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9633288  Vali macro F1 0.9564814 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 1.2553935050964355
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0526463  Vali Loss: 0.1159547 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9633288  Vali macro F1 0.9564814 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9886878  Test weighted F1: 0.9886646  Test macro F1 0.9842068 
================ the 1 th CV Experiment ================ 
Overlapping random Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00289855 0.0023753  0.00243309 0.00328947 0.00584795 0.00581395
 0.00306748 0.00289855 0.002331   0.00383142]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.2340285778045654
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.2818803  Vali Loss: 2.2694514 Vali Accuracy: 0.1666667  Vali weighted F1: 0.0621971  Vali macro F1 0.0537019 
Validation loss decreased (inf --> 2.269451).  Saving model ...
Epoch: 2 cost time: 1.2324793338775635
VALI: Epoch: 2, Steps: 13 | Train Loss: 2.2054158  Vali Loss: 2.0619764 Vali Accuracy: 0.2231638  Vali weighted F1: 0.1521608  Vali macro F1 0.1293941 
new best score!!!!
Validation loss decreased (2.269451 --> 2.061976).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.2343266010284424
VALI: Epoch: 3, Steps: 13 | Train Loss: 1.9318503  Vali Loss: 1.6153378 Vali Accuracy: 0.4632768  Vali weighted F1: 0.4406648  Vali macro F1 0.4273274 
new best score!!!!
Validation loss decreased (2.061976 --> 1.615338).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.232680320739746
VALI: Epoch: 4, Steps: 13 | Train Loss: 1.5407781  Vali Loss: 1.3076319 Vali Accuracy: 0.5875706  Vali weighted F1: 0.5429003  Vali macro F1 0.5075525 
new best score!!!!
Validation loss decreased (1.615338 --> 1.307632).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.2327611446380615
VALI: Epoch: 5, Steps: 13 | Train Loss: 1.2370672  Vali Loss: 1.0747776 Vali Accuracy: 0.6299435  Vali weighted F1: 0.5907907  Vali macro F1 0.5598438 
new best score!!!!
Validation loss decreased (1.307632 --> 1.074778).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.2379202842712402
VALI: Epoch: 6, Steps: 13 | Train Loss: 1.0395075  Vali Loss: 0.8617666 Vali Accuracy: 0.7175141  Vali weighted F1: 0.6921467  Vali macro F1 0.6618852 
new best score!!!!
Validation loss decreased (1.074778 --> 0.861767).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.2352800369262695
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.8900777  Vali Loss: 0.7470063 Vali Accuracy: 0.7655367  Vali weighted F1: 0.7464964  Vali macro F1 0.7191919 
new best score!!!!
Validation loss decreased (0.861767 --> 0.747006).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.2360012531280518
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.7872759  Vali Loss: 0.6773212 Vali Accuracy: 0.7768362  Vali weighted F1: 0.7533802  Vali macro F1 0.7214687 
new best score!!!!
Validation loss decreased (0.747006 --> 0.677321).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.2407793998718262
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.6901614  Vali Loss: 0.5963607 Vali Accuracy: 0.7768362  Vali weighted F1: 0.7689297  Vali macro F1 0.7366211 
new best score!!!!
Validation loss decreased (0.677321 --> 0.596361).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.2389211654663086
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.6250216  Vali Loss: 0.5273105 Vali Accuracy: 0.7994350  Vali weighted F1: 0.7782245  Vali macro F1 0.7454431 
new best score!!!!
Validation loss decreased (0.596361 --> 0.527310).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.2435402870178223
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.5669893  Vali Loss: 0.5006728 Vali Accuracy: 0.8050847  Vali weighted F1: 0.7961319  Vali macro F1 0.7643504 
new best score!!!!
Validation loss decreased (0.527310 --> 0.500673).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.2319257259368896
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.5135657  Vali Loss: 0.4594503 Vali Accuracy: 0.8135593  Vali weighted F1: 0.7921437  Vali macro F1 0.7585463 
new best score!!!!
Validation loss decreased (0.500673 --> 0.459450).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.240382194519043
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.4790222  Vali Loss: 0.4217510 Vali Accuracy: 0.8276836  Vali weighted F1: 0.8277576  Vali macro F1 0.8003915 
new best score!!!!
Validation loss decreased (0.459450 --> 0.421751).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.2347660064697266
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.4428829  Vali Loss: 0.3962704 Vali Accuracy: 0.8305085  Vali weighted F1: 0.8087160  Vali macro F1 0.7753125 
new best score!!!!
Validation loss decreased (0.421751 --> 0.396270).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.266143560409546
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.4151389  Vali Loss: 0.3600179 Vali Accuracy: 0.8757062  Vali weighted F1: 0.8553897  Vali macro F1 0.8181979 
new best score!!!!
Validation loss decreased (0.396270 --> 0.360018).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.238248348236084
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.3798151  Vali Loss: 0.3325447 Vali Accuracy: 0.8672316  Vali weighted F1: 0.8513080  Vali macro F1 0.8166866 
new best score!!!!
Validation loss decreased (0.360018 --> 0.332545).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.2331819534301758
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.3548980  Vali Loss: 0.3124557 Vali Accuracy: 0.8785311  Vali weighted F1: 0.8653300  Vali macro F1 0.8305743 
new best score!!!!
Validation loss decreased (0.332545 --> 0.312456).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.241077184677124
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.3308524  Vali Loss: 0.3020715 Vali Accuracy: 0.8898305  Vali weighted F1: 0.8720204  Vali macro F1 0.8346616 
new best score!!!!
Validation loss decreased (0.312456 --> 0.302071).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.2363581657409668
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.3187486  Vali Loss: 0.2786813 Vali Accuracy: 0.8926554  Vali weighted F1: 0.8737220  Vali macro F1 0.8361834 
new best score!!!!
Validation loss decreased (0.302071 --> 0.278681).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.2327399253845215
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.2972943  Vali Loss: 0.2605986 Vali Accuracy: 0.9096045  Vali weighted F1: 0.9102902  Vali macro F1 0.8825430 
new best score!!!!
Validation loss decreased (0.278681 --> 0.260599).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.2366514205932617
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.2727852  Vali Loss: 0.2471203 Vali Accuracy: 0.9039548  Vali weighted F1: 0.8923715  Vali macro F1 0.8607908 
new best score!!!!
Validation loss decreased (0.260599 --> 0.247120).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.235994577407837
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.2593579  Vali Loss: 0.2364077 Vali Accuracy: 0.9011299  Vali weighted F1: 0.8905130  Vali macro F1 0.8577096 
new best score!!!!
Validation loss decreased (0.247120 --> 0.236408).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.2340087890625
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.2436986  Vali Loss: 0.2192410 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9276604  Vali macro F1 0.9022852 
new best score!!!!
Validation loss decreased (0.236408 --> 0.219241).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.2343840599060059
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.2364530  Vali Loss: 0.2179902 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9182023  Vali macro F1 0.8933455 
new best score!!!!
Validation loss decreased (0.219241 --> 0.217990).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.2326161861419678
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.2251769  Vali Loss: 0.2044824 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9236909  Vali macro F1 0.8991056 
new best score!!!!
Validation loss decreased (0.217990 --> 0.204482).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.2319977283477783
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.2107789  Vali Loss: 0.1976673 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9237926  Vali macro F1 0.8974014 
new best score!!!!
Validation loss decreased (0.204482 --> 0.197667).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.2350599765777588
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.1974080  Vali Loss: 0.1979399 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9148350  Vali macro F1 0.8821424 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 1.2364914417266846
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.1936469  Vali Loss: 0.1855474 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9220342  Vali macro F1 0.8973293 
new best score!!!!
Validation loss decreased (0.197667 --> 0.185547).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.2330005168914795
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.1869710  Vali Loss: 0.1701379 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9380526  Vali macro F1 0.9123351 
new best score!!!!
Validation loss decreased (0.185547 --> 0.170138).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.2332847118377686
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.1678278  Vali Loss: 0.1895030 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9201912  Vali macro F1 0.8932856 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 1.2435386180877686
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.1675847  Vali Loss: 0.1610210 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9285612  Vali macro F1 0.9034898 
new best score!!!!
Validation loss decreased (0.170138 --> 0.161021).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 1.2425615787506104
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.1576485  Vali Loss: 0.1663934 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9348408  Vali macro F1 0.9094491 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 1.2438831329345703
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.1597035  Vali Loss: 0.1567849 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9380689  Vali macro F1 0.9161020 
new best score!!!!
Validation loss decreased (0.161021 --> 0.156785).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 1.2378745079040527
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.1471198  Vali Loss: 0.1528195 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9380488  Vali macro F1 0.9178707 
new best score!!!!
Validation loss decreased (0.156785 --> 0.152819).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.2370972633361816
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.1392562  Vali Loss: 0.1488093 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9464715  Vali macro F1 0.9268920 
new best score!!!!
Validation loss decreased (0.152819 --> 0.148809).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 1.2340259552001953
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.1322883  Vali Loss: 0.1424010 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9436062  Vali macro F1 0.9206478 
new best score!!!!
Validation loss decreased (0.148809 --> 0.142401).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 1.235959768295288
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.1287610  Vali Loss: 0.1456273 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9318731  Vali macro F1 0.9066857 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 1.2360591888427734
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.1220856  Vali Loss: 0.1379504 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9517801  Vali macro F1 0.9310831 
new best score!!!!
Validation loss decreased (0.142401 --> 0.137950).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 1.2351839542388916
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.1221958  Vali Loss: 0.1353052 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9489979  Vali macro F1 0.9314914 
new best score!!!!
Validation loss decreased (0.137950 --> 0.135305).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 1.237614631652832
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.1095344  Vali Loss: 0.1300613 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9632953  Vali macro F1 0.9498189 
new best score!!!!
Validation loss decreased (0.135305 --> 0.130061).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 1.2378582954406738
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.1057691  Vali Loss: 0.1227822 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9604976  Vali macro F1 0.9444664 
new best score!!!!
Validation loss decreased (0.130061 --> 0.122782).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 1.2349724769592285
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.1069087  Vali Loss: 0.1185095 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9605827  Vali macro F1 0.9514894 
new best score!!!!
Validation loss decreased (0.122782 --> 0.118510).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 1.2354624271392822
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.1085520  Vali Loss: 0.1287824 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9634083  Vali macro F1 0.9520941 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 1.2386560440063477
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.1042974  Vali Loss: 0.1303187 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9570834  Vali macro F1 0.9427543 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 1.2366738319396973
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0987505  Vali Loss: 0.1407685 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9446699  Vali macro F1 0.9264499 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 46 cost time: 1.2352054119110107
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0964569  Vali Loss: 0.1464356 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9355632  Vali macro F1 0.9132560 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 47 cost time: 1.2405126094818115
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0931333  Vali Loss: 0.1179506 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9661215  Vali macro F1 0.9578298 
new best score!!!!
Validation loss decreased (0.118510 --> 0.117951).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 1.2377984523773193
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0890381  Vali Loss: 0.1116860 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9602171  Vali macro F1 0.9475153 
new best score!!!!
Validation loss decreased (0.117951 --> 0.111686).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 1.2350060939788818
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0830530  Vali Loss: 0.0947668 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9716686  Vali macro F1 0.9641914 
new best score!!!!
Validation loss decreased (0.111686 --> 0.094767).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 1.252716064453125
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0770742  Vali Loss: 0.1187852 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9659626  Vali macro F1 0.9574115 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 1.2355420589447021
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0835054  Vali Loss: 0.1125733 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745702  Vali macro F1 0.9695219 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 1.2384846210479736
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0845740  Vali Loss: 0.1030072 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9719641  Vali macro F1 0.9635047 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 53 cost time: 1.236844539642334
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0715589  Vali Loss: 0.1009274 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830251  Vali macro F1 0.9807075 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 54 cost time: 1.2360143661499023
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0685445  Vali Loss: 0.0983153 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803562  Vali macro F1 0.9766176 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 55 cost time: 1.236445426940918
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0618002  Vali Loss: 0.0974028 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803562  Vali macro F1 0.9766176 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 1.2353253364562988
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0644998  Vali Loss: 0.0961857 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803562  Vali macro F1 0.9766176 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 57 cost time: 1.2355093955993652
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0611926  Vali Loss: 0.0978386 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9776029  Vali macro F1 0.9723810 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 58 cost time: 1.2371304035186768
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0623418  Vali Loss: 0.0943664 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803562  Vali macro F1 0.9766176 
new best score!!!!
Validation loss decreased (0.094767 --> 0.094366).  Saving model ...
new best score!!!!
Epoch: 59 cost time: 1.2363426685333252
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0596517  Vali Loss: 0.0947671 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803562  Vali macro F1 0.9766176 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 60 cost time: 1.235443115234375
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0629904  Vali Loss: 0.0954313 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803562  Vali macro F1 0.9766176 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 61 cost time: 1.2371306419372559
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0597675  Vali Loss: 0.0982959 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9776029  Vali macro F1 0.9723810 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 62 cost time: 1.235788106918335
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0605843  Vali Loss: 0.0950877 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9776029  Vali macro F1 0.9723810 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 63 cost time: 1.2331340312957764
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0597371  Vali Loss: 0.0940036 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803562  Vali macro F1 0.9766176 
new best score!!!!
Validation loss decreased (0.094366 --> 0.094004).  Saving model ...
new best score!!!!
Epoch: 64 cost time: 1.232950210571289
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0602252  Vali Loss: 0.0932946 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803562  Vali macro F1 0.9766176 
new best score!!!!
Validation loss decreased (0.094004 --> 0.093295).  Saving model ...
new best score!!!!
Epoch: 65 cost time: 1.2336528301239014
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0605281  Vali Loss: 0.0990362 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9748377  Vali macro F1 0.9681499 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 66 cost time: 1.2338075637817383
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0596026  Vali Loss: 0.0918450 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803562  Vali macro F1 0.9766176 
new best score!!!!
Validation loss decreased (0.093295 --> 0.091845).  Saving model ...
new best score!!!!
Epoch: 67 cost time: 1.236760139465332
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0564940  Vali Loss: 0.0924334 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803562  Vali macro F1 0.9766176 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 68 cost time: 1.235128402709961
VALI: Epoch: 68, Steps: 13 | Train Loss: 0.0566546  Vali Loss: 0.0918945 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9776029  Vali macro F1 0.9723810 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 69 cost time: 1.2397572994232178
VALI: Epoch: 69, Steps: 13 | Train Loss: 0.0593492  Vali Loss: 0.0907763 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803562  Vali macro F1 0.9766176 
new best score!!!!
Validation loss decreased (0.091845 --> 0.090776).  Saving model ...
new best score!!!!
Epoch: 70 cost time: 1.2367677688598633
VALI: Epoch: 70, Steps: 13 | Train Loss: 0.0583509  Vali Loss: 0.0934831 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803562  Vali macro F1 0.9766176 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 71 cost time: 1.2346830368041992
VALI: Epoch: 71, Steps: 13 | Train Loss: 0.0582776  Vali Loss: 0.0921887 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803562  Vali macro F1 0.9766176 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 72 cost time: 1.23667573928833
VALI: Epoch: 72, Steps: 13 | Train Loss: 0.0546262  Vali Loss: 0.0952839 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9748377  Vali macro F1 0.9681499 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 73 cost time: 1.2371437549591064
VALI: Epoch: 73, Steps: 13 | Train Loss: 0.0561725  Vali Loss: 0.0915623 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803562  Vali macro F1 0.9766176 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 74 cost time: 1.2351689338684082
VALI: Epoch: 74, Steps: 13 | Train Loss: 0.0556580  Vali Loss: 0.0928402 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9775426  Vali macro F1 0.9735688 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 75 cost time: 1.2393240928649902
VALI: Epoch: 75, Steps: 13 | Train Loss: 0.0572606  Vali Loss: 0.0931070 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9775426  Vali macro F1 0.9735688 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 76 cost time: 1.2376155853271484
VALI: Epoch: 76, Steps: 13 | Train Loss: 0.0603074  Vali Loss: 0.0924710 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9775426  Vali macro F1 0.9735688 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 77 cost time: 1.268517255783081
VALI: Epoch: 77, Steps: 13 | Train Loss: 0.0585992  Vali Loss: 0.0916881 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9775426  Vali macro F1 0.9735688 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 78 cost time: 1.246669054031372
VALI: Epoch: 78, Steps: 13 | Train Loss: 0.0554622  Vali Loss: 0.0915047 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803562  Vali macro F1 0.9766176 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 79 cost time: 1.2350449562072754
VALI: Epoch: 79, Steps: 13 | Train Loss: 0.0563928  Vali Loss: 0.0918869 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9775426  Vali macro F1 0.9735688 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 80 cost time: 1.282897710800171
VALI: Epoch: 80, Steps: 13 | Train Loss: 0.0586091  Vali Loss: 0.0918834 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9775426  Vali macro F1 0.9735688 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 81 cost time: 1.3211472034454346
VALI: Epoch: 81, Steps: 13 | Train Loss: 0.0561619  Vali Loss: 0.0918482 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9775426  Vali macro F1 0.9735688 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 82 cost time: 1.2837541103363037
VALI: Epoch: 82, Steps: 13 | Train Loss: 0.0560290  Vali Loss: 0.0917885 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9775426  Vali macro F1 0.9735688 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 83 cost time: 1.2371869087219238
VALI: Epoch: 83, Steps: 13 | Train Loss: 0.0549553  Vali Loss: 0.0917652 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9775426  Vali macro F1 0.9735688 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 84 cost time: 1.2364816665649414
VALI: Epoch: 84, Steps: 13 | Train Loss: 0.0562209  Vali Loss: 0.0917257 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9775426  Vali macro F1 0.9735688 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9864253  Test weighted F1: 0.9864238  Test macro F1 0.9803551 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 73347
pruned model Parameter : 76626
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.2570655345916748
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0579239  Vali Loss: 0.0881053 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803562  Vali macro F1 0.9766176 
Validation loss decreased (inf --> 0.088105).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.2529535293579102
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0561306  Vali Loss: 0.0891572 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803562  Vali macro F1 0.9766176 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.2549831867218018
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0595256  Vali Loss: 0.0879555 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803562  Vali macro F1 0.9766176 
new best score!!!!
Validation loss decreased (0.088105 --> 0.087956).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 1.2530333995819092
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0567663  Vali Loss: 0.0935119 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803562  Vali macro F1 0.9766176 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 1.2655885219573975
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0551672  Vali Loss: 0.0934336 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9776029  Vali macro F1 0.9723810 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 1.2486414909362793
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0537067  Vali Loss: 0.0907856 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831052  Vali macro F1 0.9808716 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 1.2539384365081787
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0578913  Vali Loss: 0.0896042 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803562  Vali macro F1 0.9766176 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 8 cost time: 1.2490592002868652
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0551369  Vali Loss: 0.0904010 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803562  Vali macro F1 0.9766176 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 9 cost time: 1.2541654109954834
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0549111  Vali Loss: 0.0940027 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9776029  Vali macro F1 0.9723810 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 1.2526426315307617
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0563530  Vali Loss: 0.0902310 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831052  Vali macro F1 0.9808716 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 1.3089947700500488
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0552860  Vali Loss: 0.0884197 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9776005  Vali macro F1 0.9744600 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 1.3172147274017334
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0522718  Vali Loss: 0.0910204 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9719301  Vali macro F1 0.9690006 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 1.3077011108398438
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0525433  Vali Loss: 0.0912031 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829992  Vali macro F1 0.9827433 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 14 cost time: 1.2678661346435547
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0537840  Vali Loss: 0.0913089 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802467  Vali macro F1 0.9784596 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 1.258427619934082
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0512457  Vali Loss: 0.0912008 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774927  Vali macro F1 0.9763034 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 1.256948471069336
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0522531  Vali Loss: 0.0907687 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774927  Vali macro F1 0.9763034 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 1.2576937675476074
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0499553  Vali Loss: 0.0904582 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9747437  Vali macro F1 0.9720494 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 1.2925338745117188
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0498223  Vali Loss: 0.0896077 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9747437  Vali macro F1 0.9720494 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9852941  Test weighted F1: 0.9852947  Test macro F1 0.9783423 
================ the 2 th CV Experiment ================ 
Overlapping random Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.00274725 0.00243309 0.00232558 0.00318471 0.00578035 0.00609756
 0.00320513 0.00299401 0.002331   0.00393701]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.2362089157104492
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.2805095  Vali Loss: 2.2697283 Vali Accuracy: 0.2231638  Vali weighted F1: 0.1406821  Vali macro F1 0.1203117 
Validation loss decreased (inf --> 2.269728).  Saving model ...
Epoch: 2 cost time: 1.2386813163757324
VALI: Epoch: 2, Steps: 13 | Train Loss: 2.1999065  Vali Loss: 2.0505848 Vali Accuracy: 0.2316384  Vali weighted F1: 0.1566841  Vali macro F1 0.1331904 
new best score!!!!
Validation loss decreased (2.269728 --> 2.050585).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.2394917011260986
VALI: Epoch: 3, Steps: 13 | Train Loss: 1.9029976  Vali Loss: 1.5853757 Vali Accuracy: 0.4858757  Vali weighted F1: 0.4622237  Vali macro F1 0.4318230 
new best score!!!!
Validation loss decreased (2.050585 --> 1.585376).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.237182378768921
VALI: Epoch: 4, Steps: 13 | Train Loss: 1.5299313  Vali Loss: 1.2602573 Vali Accuracy: 0.6129944  Vali weighted F1: 0.5839429  Vali macro F1 0.5518716 
new best score!!!!
Validation loss decreased (1.585376 --> 1.260257).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.2393152713775635
VALI: Epoch: 5, Steps: 13 | Train Loss: 1.2428185  Vali Loss: 1.0680379 Vali Accuracy: 0.6666667  Vali weighted F1: 0.6466791  Vali macro F1 0.6152012 
new best score!!!!
Validation loss decreased (1.260257 --> 1.068038).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.2439863681793213
VALI: Epoch: 6, Steps: 13 | Train Loss: 1.0369178  Vali Loss: 0.9127558 Vali Accuracy: 0.6553672  Vali weighted F1: 0.6386262  Vali macro F1 0.6105360 
new best score!!!!
Validation loss decreased (1.068038 --> 0.912756).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.2368016242980957
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.8905362  Vali Loss: 0.7491993 Vali Accuracy: 0.7655367  Vali weighted F1: 0.7525042  Vali macro F1 0.7258568 
new best score!!!!
Validation loss decreased (0.912756 --> 0.749199).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.2583708763122559
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.7806920  Vali Loss: 0.6715460 Vali Accuracy: 0.7768362  Vali weighted F1: 0.7661946  Vali macro F1 0.7426218 
new best score!!!!
Validation loss decreased (0.749199 --> 0.671546).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.2445619106292725
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.6837661  Vali Loss: 0.5785750 Vali Accuracy: 0.8135593  Vali weighted F1: 0.7995251  Vali macro F1 0.7665161 
new best score!!!!
Validation loss decreased (0.671546 --> 0.578575).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.2403264045715332
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.6166317  Vali Loss: 0.5272208 Vali Accuracy: 0.8220339  Vali weighted F1: 0.8222948  Vali macro F1 0.7934310 
new best score!!!!
Validation loss decreased (0.578575 --> 0.527221).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.2373950481414795
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.5515227  Vali Loss: 0.4750038 Vali Accuracy: 0.8248588  Vali weighted F1: 0.8203850  Vali macro F1 0.7898622 
new best score!!!!
Validation loss decreased (0.527221 --> 0.475004).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.2371501922607422
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.4920054  Vali Loss: 0.4404395 Vali Accuracy: 0.8531073  Vali weighted F1: 0.8316803  Vali macro F1 0.7942599 
new best score!!!!
Validation loss decreased (0.475004 --> 0.440440).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.2374584674835205
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.4498828  Vali Loss: 0.4101428 Vali Accuracy: 0.8615819  Vali weighted F1: 0.8427556  Vali macro F1 0.8000362 
new best score!!!!
Validation loss decreased (0.440440 --> 0.410143).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.2360844612121582
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.4138004  Vali Loss: 0.3562594 Vali Accuracy: 0.8644068  Vali weighted F1: 0.8608645  Vali macro F1 0.8305530 
new best score!!!!
Validation loss decreased (0.410143 --> 0.356259).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.2374582290649414
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.3818282  Vali Loss: 0.3320329 Vali Accuracy: 0.9152542  Vali weighted F1: 0.9141839  Vali macro F1 0.8945656 
new best score!!!!
Validation loss decreased (0.356259 --> 0.332033).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.2382891178131104
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.3494541  Vali Loss: 0.3023988 Vali Accuracy: 0.8983051  Vali weighted F1: 0.8981380  Vali macro F1 0.8687023 
new best score!!!!
Validation loss decreased (0.332033 --> 0.302399).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.2361960411071777
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.3287474  Vali Loss: 0.2705292 Vali Accuracy: 0.9096045  Vali weighted F1: 0.8969027  Vali macro F1 0.8610522 
new best score!!!!
Validation loss decreased (0.302399 --> 0.270529).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.2361953258514404
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.2976335  Vali Loss: 0.2639290 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9148402  Vali macro F1 0.8863903 
new best score!!!!
Validation loss decreased (0.270529 --> 0.263929).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.2375130653381348
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.2703626  Vali Loss: 0.2549906 Vali Accuracy: 0.9152542  Vali weighted F1: 0.9112892  Vali macro F1 0.8880104 
new best score!!!!
Validation loss decreased (0.263929 --> 0.254991).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.2359743118286133
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.2537973  Vali Loss: 0.2337894 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9176565  Vali macro F1 0.8889157 
new best score!!!!
Validation loss decreased (0.254991 --> 0.233789).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.2402491569519043
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.2393375  Vali Loss: 0.2375710 Vali Accuracy: 0.9180791  Vali weighted F1: 0.9144415  Vali macro F1 0.8888696 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 1.2388153076171875
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.2200787  Vali Loss: 0.2150193 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9319378  Vali macro F1 0.9077265 
new best score!!!!
Validation loss decreased (0.233789 --> 0.215019).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.2382431030273438
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.2056057  Vali Loss: 0.2001491 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9309939  Vali macro F1 0.9045705 
new best score!!!!
Validation loss decreased (0.215019 --> 0.200149).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.238229751586914
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.1921589  Vali Loss: 0.2126764 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9307326  Vali macro F1 0.9088918 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 1.2351343631744385
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.1847807  Vali Loss: 0.1958580 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9367085  Vali macro F1 0.9159402 
new best score!!!!
Validation loss decreased (0.200149 --> 0.195858).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.236257791519165
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.1808069  Vali Loss: 0.1968837 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9170437  Vali macro F1 0.8900952 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 1.2370333671569824
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.1734669  Vali Loss: 0.1851731 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9407921  Vali macro F1 0.9223327 
new best score!!!!
Validation loss decreased (0.195858 --> 0.185173).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 1.2384040355682373
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.1677571  Vali Loss: 0.1909644 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9348330  Vali macro F1 0.9133728 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 1.237438440322876
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.1698507  Vali Loss: 0.1702200 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9427495  Vali macro F1 0.9230001 
new best score!!!!
Validation loss decreased (0.185173 --> 0.170220).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.238027811050415
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.1457167  Vali Loss: 0.1644722 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9304376  Vali macro F1 0.9091322 
new best score!!!!
Validation loss decreased (0.170220 --> 0.164472).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 1.239349603652954
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.1453222  Vali Loss: 0.1582067 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9486427  Vali macro F1 0.9298264 
new best score!!!!
Validation loss decreased (0.164472 --> 0.158207).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 1.2387511730194092
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.1294389  Vali Loss: 0.1628832 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9359499  Vali macro F1 0.9142483 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 1.237743854522705
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.1250437  Vali Loss: 0.1640839 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9413157  Vali macro F1 0.9206291 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 1.2409281730651855
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.1249752  Vali Loss: 0.1538782 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9453609  Vali macro F1 0.9271585 
new best score!!!!
Validation loss decreased (0.158207 --> 0.153878).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.23872971534729
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.1209034  Vali Loss: 0.1565946 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9491389  Vali macro F1 0.9321821 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 1.238246202468872
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.1147662  Vali Loss: 0.1670088 Vali Accuracy: 0.9265537  Vali weighted F1: 0.9198599  Vali macro F1 0.8924708 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 1.245116949081421
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.1145183  Vali Loss: 0.1445251 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9365537  Vali macro F1 0.9163255 
new best score!!!!
Validation loss decreased (0.153878 --> 0.144525).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 1.2379491329193115
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.1097375  Vali Loss: 0.1420588 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9357020  Vali macro F1 0.9162707 
new best score!!!!
Validation loss decreased (0.144525 --> 0.142059).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 1.2356784343719482
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.1051286  Vali Loss: 0.1370388 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9544713  Vali macro F1 0.9389344 
new best score!!!!
Validation loss decreased (0.142059 --> 0.137039).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 1.2366688251495361
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0989915  Vali Loss: 0.1385575 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9604158  Vali macro F1 0.9453496 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 1.2497565746307373
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0994249  Vali Loss: 0.1382897 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9515848  Vali macro F1 0.9356790 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 1.238180160522461
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0936049  Vali Loss: 0.1327296 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9365300  Vali macro F1 0.9169325 
new best score!!!!
Validation loss decreased (0.137039 --> 0.132730).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 1.2415440082550049
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0902373  Vali Loss: 0.1440821 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9456900  Vali macro F1 0.9287570 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 1.2439403533935547
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0893442  Vali Loss: 0.1283066 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9547234  Vali macro F1 0.9421746 
new best score!!!!
Validation loss decreased (0.132730 --> 0.128307).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 1.2504897117614746
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0802183  Vali Loss: 0.1398228 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9511648  Vali macro F1 0.9354058 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 1.2382285594940186
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0809156  Vali Loss: 0.1270026 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9604505  Vali macro F1 0.9466911 
new best score!!!!
Validation loss decreased (0.128307 --> 0.127003).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 1.238799810409546
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0738584  Vali Loss: 0.1262147 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9660868  Vali macro F1 0.9590997 
new best score!!!!
Validation loss decreased (0.127003 --> 0.126215).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 1.2408556938171387
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0770522  Vali Loss: 0.1101790 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9660289  Vali macro F1 0.9587627 
new best score!!!!
Validation loss decreased (0.126215 --> 0.110179).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 1.2452526092529297
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0696245  Vali Loss: 0.1257594 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9633098  Vali macro F1 0.9560271 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 1.2389416694641113
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0625608  Vali Loss: 0.1140187 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9689583  Vali macro F1 0.9615651 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 1.2379155158996582
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0608151  Vali Loss: 0.1164339 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9717719  Vali macro F1 0.9646139 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 1.2392349243164062
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0619105  Vali Loss: 0.1073570 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9690271  Vali macro F1 0.9646501 
new best score!!!!
Validation loss decreased (0.110179 --> 0.107357).  Saving model ...
new best score!!!!
Epoch: 53 cost time: 1.2395472526550293
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0655856  Vali Loss: 0.1104030 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9686707  Vali macro F1 0.9630017 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 1.2412948608398438
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0545470  Vali Loss: 0.1261324 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9661680  Vali macro F1 0.9596048 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 1.2400219440460205
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0541302  Vali Loss: 0.1242421 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9661307  Vali macro F1 0.9586567 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 56 cost time: 1.2471415996551514
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0545025  Vali Loss: 0.1340212 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9605056  Vali macro F1 0.9529077 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 57 cost time: 1.2392644882202148
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0567281  Vali Loss: 0.0990191 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830087  Vali macro F1 0.9794445 
new best score!!!!
Validation loss decreased (0.107357 --> 0.099019).  Saving model ...
new best score!!!!
Epoch: 58 cost time: 1.2399473190307617
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0500177  Vali Loss: 0.1049855 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9717140  Vali macro F1 0.9664783 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 1.23988676071167
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0441553  Vali Loss: 0.1262595 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9662101  Vali macro F1 0.9582916 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 60 cost time: 1.2470159530639648
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0449169  Vali Loss: 0.1234001 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9718242  Vali macro F1 0.9663906 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 61 cost time: 1.2382018566131592
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0397822  Vali Loss: 0.1064208 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774443  Vali macro F1 0.9756410 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 62 cost time: 1.2391271591186523
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0380648  Vali Loss: 0.0965221 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773968  Vali macro F1 0.9768727 
new best score!!!!
Validation loss decreased (0.099019 --> 0.096522).  Saving model ...
new best score!!!!
Epoch: 63 cost time: 1.2467732429504395
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0406667  Vali Loss: 0.0995905 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745303  Vali macro F1 0.9743523 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 64 cost time: 1.2387468814849854
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0388485  Vali Loss: 0.1036329 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801715  Vali macro F1 0.9790862 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 65 cost time: 1.2374250888824463
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0338109  Vali Loss: 0.0960377 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801636  Vali macro F1 0.9770218 
new best score!!!!
Validation loss decreased (0.096522 --> 0.096038).  Saving model ...
new best score!!!!
Epoch: 66 cost time: 1.2406611442565918
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0348481  Vali Loss: 0.1047523 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802332  Vali macro F1 0.9754239 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 67 cost time: 1.2453222274780273
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0300223  Vali Loss: 0.1064950 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774287  Vali macro F1 0.9749002 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 68 cost time: 1.2381467819213867
VALI: Epoch: 68, Steps: 13 | Train Loss: 0.0363607  Vali Loss: 0.0896909 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802154  Vali macro F1 0.9786918 
new best score!!!!
Validation loss decreased (0.096038 --> 0.089691).  Saving model ...
new best score!!!!
Epoch: 69 cost time: 1.238490343093872
VALI: Epoch: 69, Steps: 13 | Train Loss: 0.0326526  Vali Loss: 0.0838523 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858804  Vali macro F1 0.9862119 
new best score!!!!
Validation loss decreased (0.089691 --> 0.083852).  Saving model ...
new best score!!!!
Epoch: 70 cost time: 1.2451543807983398
VALI: Epoch: 70, Steps: 13 | Train Loss: 0.0290225  Vali Loss: 0.0925655 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774715  Vali macro F1 0.9771039 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 71 cost time: 1.2469415664672852
VALI: Epoch: 71, Steps: 13 | Train Loss: 0.0303552  Vali Loss: 0.1021969 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773968  Vali macro F1 0.9768727 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 72 cost time: 1.25248384475708
VALI: Epoch: 72, Steps: 13 | Train Loss: 0.0261455  Vali Loss: 0.0974857 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774154  Vali macro F1 0.9768020 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 73 cost time: 1.240196704864502
VALI: Epoch: 73, Steps: 13 | Train Loss: 0.0259364  Vali Loss: 0.0921395 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801640  Vali macro F1 0.9790813 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 74 cost time: 1.2467052936553955
VALI: Epoch: 74, Steps: 13 | Train Loss: 0.0248638  Vali Loss: 0.0852288 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773968  Vali macro F1 0.9768727 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 75 cost time: 1.2377851009368896
VALI: Epoch: 75, Steps: 13 | Train Loss: 0.0281841  Vali Loss: 0.0873483 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802312  Vali macro F1 0.9813236 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 76 cost time: 1.2388370037078857
VALI: Epoch: 76, Steps: 13 | Train Loss: 0.0217832  Vali Loss: 0.0906872 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802356  Vali macro F1 0.9793047 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 77 cost time: 1.2400257587432861
VALI: Epoch: 77, Steps: 13 | Train Loss: 0.0235938  Vali Loss: 0.0930593 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774255  Vali macro F1 0.9749426 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 78 cost time: 1.2469141483306885
VALI: Epoch: 78, Steps: 13 | Train Loss: 0.0212431  Vali Loss: 0.0870888 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858074  Vali macro F1 0.9846108 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 79 cost time: 1.2379491329193115
VALI: Epoch: 79, Steps: 13 | Train Loss: 0.0204049  Vali Loss: 0.0910492 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830506  Vali macro F1 0.9824523 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 80 cost time: 1.2383975982666016
VALI: Epoch: 80, Steps: 13 | Train Loss: 0.0194506  Vali Loss: 0.0912909 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830506  Vali macro F1 0.9824523 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 81 cost time: 1.2388825416564941
VALI: Epoch: 81, Steps: 13 | Train Loss: 0.0201351  Vali Loss: 0.0907198 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830506  Vali macro F1 0.9824523 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 82 cost time: 1.2437775135040283
VALI: Epoch: 82, Steps: 13 | Train Loss: 0.0218833  Vali Loss: 0.0896852 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830506  Vali macro F1 0.9824523 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 83 cost time: 1.2366197109222412
VALI: Epoch: 83, Steps: 13 | Train Loss: 0.0199725  Vali Loss: 0.0894088 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830506  Vali macro F1 0.9824523 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 84 cost time: 1.2386283874511719
VALI: Epoch: 84, Steps: 13 | Train Loss: 0.0228887  Vali Loss: 0.0895372 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830506  Vali macro F1 0.9824523 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9796380  Test weighted F1: 0.9797074  Test macro F1 0.9756281 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 73347
pruned model Parameter : 76626
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.2718334197998047
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0305689  Vali Loss: 0.0856806 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858804  Vali macro F1 0.9862119 
Validation loss decreased (inf --> 0.085681).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.259040117263794
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0251387  Vali Loss: 0.0915356 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802522  Vali macro F1 0.9774500 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.2572462558746338
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0255113  Vali Loss: 0.0903240 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802413  Vali macro F1 0.9781162 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 1.267516851425171
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0254324  Vali Loss: 0.0875515 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858695  Vali macro F1 0.9868781 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 1.2576987743377686
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0231171  Vali Loss: 0.0947593 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830623  Vali macro F1 0.9818121 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 1.259453296661377
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0234990  Vali Loss: 0.0914711 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830623  Vali macro F1 0.9818121 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 1.2602653503417969
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0235245  Vali Loss: 0.0906375 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830306  Vali macro F1 0.9817568 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 1.267784833908081
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0225689  Vali Loss: 0.0901168 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830306  Vali macro F1 0.9817568 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 1.2597169876098633
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0206712  Vali Loss: 0.0881951 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858438  Vali macro F1 0.9848052 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 1.2622342109680176
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0209609  Vali Loss: 0.0937228 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830337  Vali macro F1 0.9804431 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 11 cost time: 1.2568004131317139
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0217718  Vali Loss: 0.0930193 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830337  Vali macro F1 0.9804431 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 1.263465166091919
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0213594  Vali Loss: 0.0918496 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830337  Vali macro F1 0.9804431 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 1.2560005187988281
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0219655  Vali Loss: 0.0914683 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802206  Vali macro F1 0.9773947 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 1.2581684589385986
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0232446  Vali Loss: 0.0893447 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830306  Vali macro F1 0.9817568 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 1.2671756744384766
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0216122  Vali Loss: 0.0886719 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830306  Vali macro F1 0.9817568 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 16 cost time: 1.258530855178833
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0230447  Vali Loss: 0.0886736 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830306  Vali macro F1 0.9817568 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9841629  Test weighted F1: 0.9841711  Test macro F1 0.9799760 
================ the 3 th CV Experiment ================ 
Overlapping random Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00280899 0.0023753  0.00248139 0.00325733 0.00568182 0.00568182
 0.00302115 0.00291545 0.00233645 0.00409836]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.2404451370239258
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.2832872  Vali Loss: 2.2703619 Vali Accuracy: 0.2005650  Vali weighted F1: 0.1163914  Vali macro F1 0.0994100 
Validation loss decreased (inf --> 2.270362).  Saving model ...
Epoch: 2 cost time: 1.265122413635254
VALI: Epoch: 2, Steps: 13 | Train Loss: 2.2095701  Vali Loss: 2.0623869 Vali Accuracy: 0.2175141  Vali weighted F1: 0.1408738  Vali macro F1 0.1197587 
new best score!!!!
Validation loss decreased (2.270362 --> 2.062387).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.232600212097168
VALI: Epoch: 3, Steps: 13 | Train Loss: 1.9152005  Vali Loss: 1.5867970 Vali Accuracy: 0.4604520  Vali weighted F1: 0.3940416  Vali macro F1 0.3524360 
new best score!!!!
Validation loss decreased (2.062387 --> 1.586797).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.2470948696136475
VALI: Epoch: 4, Steps: 13 | Train Loss: 1.5179845  Vali Loss: 1.2580142 Vali Accuracy: 0.6016949  Vali weighted F1: 0.5627646  Vali macro F1 0.5252364 
new best score!!!!
Validation loss decreased (1.586797 --> 1.258014).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.3014743328094482
VALI: Epoch: 5, Steps: 13 | Train Loss: 1.2217037  Vali Loss: 1.0395303 Vali Accuracy: 0.6807910  Vali weighted F1: 0.6665771  Vali macro F1 0.6512366 
new best score!!!!
Validation loss decreased (1.258014 --> 1.039530).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.2391817569732666
VALI: Epoch: 6, Steps: 13 | Train Loss: 1.0215265  Vali Loss: 0.8809186 Vali Accuracy: 0.6920904  Vali weighted F1: 0.6777039  Vali macro F1 0.6518368 
new best score!!!!
Validation loss decreased (1.039530 --> 0.880919).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.23173189163208
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.8716925  Vali Loss: 0.7608063 Vali Accuracy: 0.7146893  Vali weighted F1: 0.6916311  Vali macro F1 0.6665739 
new best score!!!!
Validation loss decreased (0.880919 --> 0.760806).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.2406835556030273
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.7472655  Vali Loss: 0.6347450 Vali Accuracy: 0.8050847  Vali weighted F1: 0.7995507  Vali macro F1 0.7798682 
new best score!!!!
Validation loss decreased (0.760806 --> 0.634745).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.23936128616333
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.6620373  Vali Loss: 0.5733943 Vali Accuracy: 0.7881356  Vali weighted F1: 0.7654330  Vali macro F1 0.7319351 
new best score!!!!
Validation loss decreased (0.634745 --> 0.573394).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.2324316501617432
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.5853618  Vali Loss: 0.5158391 Vali Accuracy: 0.8135593  Vali weighted F1: 0.7939904  Vali macro F1 0.7544523 
new best score!!!!
Validation loss decreased (0.573394 --> 0.515839).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.2775835990905762
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.5322910  Vali Loss: 0.4520220 Vali Accuracy: 0.8163842  Vali weighted F1: 0.7968937  Vali macro F1 0.7630043 
new best score!!!!
Validation loss decreased (0.515839 --> 0.452022).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.288149118423462
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.4813738  Vali Loss: 0.4218164 Vali Accuracy: 0.8474576  Vali weighted F1: 0.8267012  Vali macro F1 0.7897643 
new best score!!!!
Validation loss decreased (0.452022 --> 0.421816).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.2419850826263428
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.4403559  Vali Loss: 0.3827351 Vali Accuracy: 0.8870056  Vali weighted F1: 0.8873180  Vali macro F1 0.8666337 
new best score!!!!
Validation loss decreased (0.421816 --> 0.382735).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.234196424484253
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.4117900  Vali Loss: 0.3613117 Vali Accuracy: 0.8700565  Vali weighted F1: 0.8558228  Vali macro F1 0.8190060 
new best score!!!!
Validation loss decreased (0.382735 --> 0.361312).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.2319056987762451
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.3792297  Vali Loss: 0.3431056 Vali Accuracy: 0.8813559  Vali weighted F1: 0.8810574  Vali macro F1 0.8530322 
new best score!!!!
Validation loss decreased (0.361312 --> 0.343106).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.2324345111846924
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.3597042  Vali Loss: 0.3085495 Vali Accuracy: 0.8785311  Vali weighted F1: 0.8580387  Vali macro F1 0.8172283 
new best score!!!!
Validation loss decreased (0.343106 --> 0.308550).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.2406466007232666
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.3378714  Vali Loss: 0.2866072 Vali Accuracy: 0.8926554  Vali weighted F1: 0.8783874  Vali macro F1 0.8387264 
new best score!!!!
Validation loss decreased (0.308550 --> 0.286607).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.2331600189208984
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.3162889  Vali Loss: 0.2956274 Vali Accuracy: 0.8926554  Vali weighted F1: 0.8852895  Vali macro F1 0.8575445 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 1.2315318584442139
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.2858691  Vali Loss: 0.2721842 Vali Accuracy: 0.8728814  Vali weighted F1: 0.8524173  Vali macro F1 0.8128624 
new best score!!!!
Validation loss decreased (0.286607 --> 0.272184).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.2463278770446777
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.2687491  Vali Loss: 0.2362395 Vali Accuracy: 0.8898305  Vali weighted F1: 0.8693506  Vali macro F1 0.8288619 
new best score!!!!
Validation loss decreased (0.272184 --> 0.236239).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.2324490547180176
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.2691542  Vali Loss: 0.2307071 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9327829  Vali macro F1 0.9109560 
new best score!!!!
Validation loss decreased (0.236239 --> 0.230707).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.2336301803588867
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.2469044  Vali Loss: 0.2272519 Vali Accuracy: 0.9067797  Vali weighted F1: 0.9046390  Vali macro F1 0.8728291 
new best score!!!!
Validation loss decreased (0.230707 --> 0.227252).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.233703851699829
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.2284549  Vali Loss: 0.2139054 Vali Accuracy: 0.8954802  Vali weighted F1: 0.8830843  Vali macro F1 0.8438963 
new best score!!!!
Validation loss decreased (0.227252 --> 0.213905).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.2404568195343018
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.2137883  Vali Loss: 0.1987133 Vali Accuracy: 0.8983051  Vali weighted F1: 0.8910365  Vali macro F1 0.8517724 
new best score!!!!
Validation loss decreased (0.213905 --> 0.198713).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.2364509105682373
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.2035323  Vali Loss: 0.1901611 Vali Accuracy: 0.9039548  Vali weighted F1: 0.8816791  Vali macro F1 0.8401695 
new best score!!!!
Validation loss decreased (0.198713 --> 0.190161).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.2375402450561523
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.2026195  Vali Loss: 0.1879827 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9434837  Vali macro F1 0.9266194 
new best score!!!!
Validation loss decreased (0.190161 --> 0.187983).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.2421178817749023
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.1806896  Vali Loss: 0.1804423 Vali Accuracy: 0.9152542  Vali weighted F1: 0.9107331  Vali macro F1 0.8739974 
new best score!!!!
Validation loss decreased (0.187983 --> 0.180442).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 1.2470903396606445
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.1744295  Vali Loss: 0.1791369 Vali Accuracy: 0.9124294  Vali weighted F1: 0.9059070  Vali macro F1 0.8691293 
new best score!!!!
Validation loss decreased (0.180442 --> 0.179137).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.2453281879425049
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.1642667  Vali Loss: 0.1645172 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9268249  Vali macro F1 0.8963531 
new best score!!!!
Validation loss decreased (0.179137 --> 0.164517).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.2436373233795166
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.1514383  Vali Loss: 0.1596547 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9436966  Vali macro F1 0.9222872 
new best score!!!!
Validation loss decreased (0.164517 --> 0.159655).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 1.25608491897583
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.1600615  Vali Loss: 0.1583030 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9436822  Vali macro F1 0.9201501 
new best score!!!!
Validation loss decreased (0.159655 --> 0.158303).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 1.2439210414886475
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.1420826  Vali Loss: 0.1648369 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9324720  Vali macro F1 0.9081584 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 1.2418053150177002
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.1388055  Vali Loss: 0.1509924 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9436583  Vali macro F1 0.9225302 
new best score!!!!
Validation loss decreased (0.158303 --> 0.150992).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 1.2442688941955566
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.1440249  Vali Loss: 0.1656929 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9505240  Vali macro F1 0.9340077 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 1.265303134918213
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.1380061  Vali Loss: 0.1533456 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9571339  Vali macro F1 0.9411355 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 1.242682933807373
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.1252760  Vali Loss: 0.1539792 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9306110  Vali macro F1 0.9050245 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 1.2419440746307373
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.1213679  Vali Loss: 0.1609185 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9267287  Vali macro F1 0.8997817 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 1.2427022457122803
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.1154965  Vali Loss: 0.1502889 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9456666  Vali macro F1 0.9254628 
new best score!!!!
Validation loss decreased (0.150992 --> 0.150289).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 1.2479112148284912
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.1079329  Vali Loss: 0.1324846 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9603170  Vali macro F1 0.9478413 
new best score!!!!
Validation loss decreased (0.150289 --> 0.132485).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 1.2388825416564941
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.1055176  Vali Loss: 0.1366892 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9490030  Vali macro F1 0.9293179 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 1.2434632778167725
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.1049205  Vali Loss: 0.1589660 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9428021  Vali macro F1 0.9260496 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 1.236161708831787
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0996475  Vali Loss: 0.1142641 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9662174  Vali macro F1 0.9563934 
new best score!!!!
Validation loss decreased (0.132485 --> 0.114264).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 1.234811544418335
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0976555  Vali Loss: 0.1191063 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9606745  Vali macro F1 0.9477718 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 1.2402794361114502
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0888456  Vali Loss: 0.0976936 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9662157  Vali macro F1 0.9542907 
new best score!!!!
Validation loss decreased (0.114264 --> 0.097694).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 1.2385642528533936
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0881712  Vali Loss: 0.1057931 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9571897  Vali macro F1 0.9408847 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 1.2363498210906982
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0829584  Vali Loss: 0.1130568 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9717103  Vali macro F1 0.9666192 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 1.23681640625
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0760900  Vali Loss: 0.0998971 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9775378  Vali macro F1 0.9724918 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 1.2393462657928467
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0652022  Vali Loss: 0.0984289 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9744105  Vali macro F1 0.9695096 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 1.2383549213409424
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0620107  Vali Loss: 0.1141416 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9633791  Vali macro F1 0.9541907 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 50 cost time: 1.2445120811462402
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0654736  Vali Loss: 0.0983366 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9775309  Vali macro F1 0.9743387 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 1.239861249923706
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0580507  Vali Loss: 0.0957349 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9832161  Vali macro F1 0.9832915 
new best score!!!!
Validation loss decreased (0.097694 --> 0.095735).  Saving model ...
new best score!!!!
Epoch: 52 cost time: 1.2391047477722168
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0556064  Vali Loss: 0.0981287 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9775958  Vali macro F1 0.9745921 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 1.2387535572052002
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0582026  Vali Loss: 0.0956676 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9804060  Vali macro F1 0.9789294 
new best score!!!!
Validation loss decreased (0.095735 --> 0.095668).  Saving model ...
new best score!!!!
Epoch: 54 cost time: 1.2412724494934082
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0566466  Vali Loss: 0.0922388 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803845  Vali macro F1 0.9788452 
new best score!!!!
Validation loss decreased (0.095668 --> 0.092239).  Saving model ...
new best score!!!!
Epoch: 55 cost time: 1.2388136386871338
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0532459  Vali Loss: 0.0981297 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9775958  Vali macro F1 0.9745921 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 1.2366900444030762
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0571019  Vali Loss: 0.1002856 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9719197  Vali macro F1 0.9679171 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 57 cost time: 1.2369396686553955
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0496097  Vali Loss: 0.0958254 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9832270  Vali macro F1 0.9813091 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 58 cost time: 1.250129222869873
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0550765  Vali Loss: 0.0962961 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9832270  Vali macro F1 0.9813091 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 59 cost time: 1.2376980781555176
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0541040  Vali Loss: 0.1004176 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9747108  Vali macro F1 0.9735433 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 60 cost time: 1.2376554012298584
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0581771  Vali Loss: 0.0994450 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9747611  Vali macro F1 0.9715990 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 61 cost time: 1.2417051792144775
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0526607  Vali Loss: 0.0978692 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9775872  Vali macro F1 0.9760365 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 62 cost time: 1.2389099597930908
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0557782  Vali Loss: 0.0959725 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9804113  Vali macro F1 0.9782576 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 63 cost time: 1.2363910675048828
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0510082  Vali Loss: 0.0943619 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9804113  Vali macro F1 0.9782576 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 64 cost time: 1.2459490299224854
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0512755  Vali Loss: 0.0937299 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9832270  Vali macro F1 0.9813091 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 65 cost time: 1.2424864768981934
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0520751  Vali Loss: 0.0937011 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9832270  Vali macro F1 0.9813091 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 66 cost time: 1.2585713863372803
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0519257  Vali Loss: 0.0936907 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9832270  Vali macro F1 0.9813091 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 67 cost time: 1.2387146949768066
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0517177  Vali Loss: 0.0936072 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9832270  Vali macro F1 0.9813091 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 68 cost time: 1.238605260848999
VALI: Epoch: 68, Steps: 13 | Train Loss: 0.0524156  Vali Loss: 0.0935439 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9832270  Vali macro F1 0.9813091 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 69 cost time: 1.2407641410827637
VALI: Epoch: 69, Steps: 13 | Train Loss: 0.0543878  Vali Loss: 0.0935842 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9832270  Vali macro F1 0.9813091 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9819005  Test weighted F1: 0.9818151  Test macro F1 0.9733556 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 73347
pruned model Parameter : 76626
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.2577095031738281
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0568704  Vali Loss: 0.1046904 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9747829  Vali macro F1 0.9695953 
Validation loss decreased (inf --> 0.104690).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.2576215267181396
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0552455  Vali Loss: 0.0942061 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9804113  Vali macro F1 0.9782576 
new best score!!!!
Validation loss decreased (0.104690 --> 0.094206).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 1.2587103843688965
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0548030  Vali Loss: 0.0995574 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9747829  Vali macro F1 0.9695953 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 1.2534165382385254
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0523109  Vali Loss: 0.0940559 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9775767  Vali macro F1 0.9746505 
new best score!!!!
Validation loss decreased (0.094206 --> 0.094056).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 1.2568836212158203
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0533028  Vali Loss: 0.0933553 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9804113  Vali macro F1 0.9782576 
new best score!!!!
Validation loss decreased (0.094056 --> 0.093355).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 1.256371021270752
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0527990  Vali Loss: 0.0931538 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859892  Vali macro F1 0.9836353 
new best score!!!!
Validation loss decreased (0.093355 --> 0.093154).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 1.2527074813842773
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0532880  Vali Loss: 0.0954539 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9776011  Vali macro F1 0.9739203 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 1.257929801940918
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0483399  Vali Loss: 0.0938127 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831736  Vali macro F1 0.9805838 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 1.2567322254180908
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0505558  Vali Loss: 0.0846235 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831444  Vali macro F1 0.9811695 
new best score!!!!
Validation loss decreased (0.093154 --> 0.084623).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 1.2605645656585693
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0493025  Vali Loss: 0.0935357 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803558  Vali macro F1 0.9769164 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 1.2599859237670898
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0516726  Vali Loss: 0.0864475 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831660  Vali macro F1 0.9812537 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 1.2563705444335938
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0475244  Vali Loss: 0.0842107 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831660  Vali macro F1 0.9812537 
new best score!!!!
Validation loss decreased (0.084623 --> 0.084211).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 1.2514162063598633
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0487912  Vali Loss: 0.0852177 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831441  Vali macro F1 0.9825132 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 1.2585158348083496
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0497352  Vali Loss: 0.0894018 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831660  Vali macro F1 0.9812537 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 1.2587532997131348
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0467219  Vali Loss: 0.0827898 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859761  Vali macro F1 0.9856158 
new best score!!!!
Validation loss decreased (0.084211 --> 0.082790).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 1.2577521800994873
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0448991  Vali Loss: 0.0839755 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859761  Vali macro F1 0.9856158 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 1.2580151557922363
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0438036  Vali Loss: 0.0825401 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831444  Vali macro F1 0.9811695 
new best score!!!!
Validation loss decreased (0.082790 --> 0.082540).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 18 cost time: 1.2566556930541992
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0443861  Vali Loss: 0.0870708 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803558  Vali macro F1 0.9769164 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 1.2579536437988281
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0461675  Vali Loss: 0.0820453 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831160  Vali macro F1 0.9833637 
new best score!!!!
Validation loss decreased (0.082540 --> 0.082045).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 20 cost time: 1.2623083591461182
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0435322  Vali Loss: 0.0890433 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9775401  Vali macro F1 0.9738649 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 1.2645313739776611
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0437743  Vali Loss: 0.0810424 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831736  Vali macro F1 0.9805838 
new best score!!!!
Validation loss decreased (0.082045 --> 0.081042).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 22 cost time: 1.2551240921020508
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0422314  Vali Loss: 0.0857811 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9775378  Vali macro F1 0.9740242 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 1.2564241886138916
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0438219  Vali Loss: 0.0813021 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774958  Vali macro F1 0.9746643 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 1.2629563808441162
Fine Tuning VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0407498  Vali Loss: 0.0818012 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774958  Vali macro F1 0.9746643 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 1.2609593868255615
Fine Tuning VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0419119  Vali Loss: 0.0843741 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803558  Vali macro F1 0.9769164 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 1.2548863887786865
Fine Tuning VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0416776  Vali Loss: 0.0779451 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859785  Vali macro F1 0.9869641 
new best score!!!!
Validation loss decreased (0.081042 --> 0.077945).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 27 cost time: 1.2624430656433105
Fine Tuning VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0388571  Vali Loss: 0.0872651 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746801  Vali macro F1 0.9716129 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 28 cost time: 1.2620689868927002
Fine Tuning VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0402479  Vali Loss: 0.0779269 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803059  Vali macro F1 0.9790016 
new best score!!!!
Validation loss decreased (0.077945 --> 0.077927).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 29 cost time: 1.256758451461792
Fine Tuning VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0401396  Vali Loss: 0.0800903 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859341  Vali macro F1 0.9877635 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 30 cost time: 1.2571759223937988
Fine Tuning VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0395907  Vali Loss: 0.0852902 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774958  Vali macro F1 0.9746643 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 31 cost time: 1.2559874057769775
Fine Tuning VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0463664  Vali Loss: 0.0811585 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802841  Vali macro F1 0.9802612 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 32 cost time: 1.2567589282989502
Fine Tuning VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0393835  Vali Loss: 0.0927892 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746801  Vali macro F1 0.9716129 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 33 cost time: 1.2546570301055908
Fine Tuning VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0419654  Vali Loss: 0.0803972 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831185  Vali macro F1 0.9847121 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 34 cost time: 1.2564442157745361
Fine Tuning VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0395457  Vali Loss: 0.0788405 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774958  Vali macro F1 0.9746643 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 35 cost time: 1.2568931579589844
Fine Tuning VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0391998  Vali Loss: 0.0853546 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803059  Vali macro F1 0.9790016 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 36 cost time: 1.257641077041626
Fine Tuning VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0407553  Vali Loss: 0.0803325 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831160  Vali macro F1 0.9833637 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 37 cost time: 1.2562201023101807
Fine Tuning VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0355346  Vali Loss: 0.0876996 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746801  Vali macro F1 0.9716129 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 38 cost time: 1.2620325088500977
Fine Tuning VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0364979  Vali Loss: 0.0875386 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774903  Vali macro F1 0.9759501 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 39 cost time: 1.257164478302002
Fine Tuning VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0381922  Vali Loss: 0.0874506 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774903  Vali macro F1 0.9759501 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 40 cost time: 1.2575337886810303
Fine Tuning VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0380890  Vali Loss: 0.0874425 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746801  Vali macro F1 0.9716129 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 41 cost time: 1.2559962272644043
Fine Tuning VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0389722  Vali Loss: 0.0863595 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746801  Vali macro F1 0.9716129 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 42 cost time: 1.2550604343414307
Fine Tuning VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0345821  Vali Loss: 0.0855259 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746801  Vali macro F1 0.9716129 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 43 cost time: 1.255815029144287
Fine Tuning VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0342673  Vali Loss: 0.0855741 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746801  Vali macro F1 0.9716129 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9864253  Test weighted F1: 0.9864045  Test macro F1 0.9797425 
================ the 4 th CV Experiment ================ 
Overlapping random Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.00282486 0.00235294 0.00242718 0.00328947 0.00549451 0.00552486
 0.00319489 0.00276243 0.00244499 0.00416667]
Train data number :  3182
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  887
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.2344646453857422
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.2787753  Vali Loss: 2.2598517 Vali Accuracy: 0.1694915  Vali weighted F1: 0.0649053  Vali macro F1 0.0567647 
Validation loss decreased (inf --> 2.259852).  Saving model ...
Epoch: 2 cost time: 1.235809564590454
VALI: Epoch: 2, Steps: 13 | Train Loss: 2.1877533  Vali Loss: 2.0703124 Vali Accuracy: 0.1977401  Vali weighted F1: 0.1096126  Vali macro F1 0.0916912 
new best score!!!!
Validation loss decreased (2.259852 --> 2.070312).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.2339653968811035
VALI: Epoch: 3, Steps: 13 | Train Loss: 1.9161035  Vali Loss: 1.5938883 Vali Accuracy: 0.4519774  Vali weighted F1: 0.4394569  Vali macro F1 0.4031720 
new best score!!!!
Validation loss decreased (2.070312 --> 1.593888).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.236910343170166
VALI: Epoch: 4, Steps: 13 | Train Loss: 1.5166203  Vali Loss: 1.1909666 Vali Accuracy: 0.6553672  Vali weighted F1: 0.6366547  Vali macro F1 0.5970970 
new best score!!!!
Validation loss decreased (1.593888 --> 1.190967).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.235973834991455
VALI: Epoch: 5, Steps: 13 | Train Loss: 1.1908746  Vali Loss: 0.9715987 Vali Accuracy: 0.7005650  Vali weighted F1: 0.6836810  Vali macro F1 0.6350584 
new best score!!!!
Validation loss decreased (1.190967 --> 0.971599).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.2387809753417969
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.9974832  Vali Loss: 0.8223722 Vali Accuracy: 0.7570621  Vali weighted F1: 0.7447203  Vali macro F1 0.7153520 
new best score!!!!
Validation loss decreased (0.971599 --> 0.822372).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.2387316226959229
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.8540627  Vali Loss: 0.7115554 Vali Accuracy: 0.7740113  Vali weighted F1: 0.7538732  Vali macro F1 0.6965691 
new best score!!!!
Validation loss decreased (0.822372 --> 0.711555).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.2410526275634766
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.7502894  Vali Loss: 0.6360157 Vali Accuracy: 0.7853107  Vali weighted F1: 0.7720244  Vali macro F1 0.7200167 
new best score!!!!
Validation loss decreased (0.711555 --> 0.636016).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.235318660736084
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.6691535  Vali Loss: 0.5667192 Vali Accuracy: 0.8135593  Vali weighted F1: 0.7999524  Vali macro F1 0.7371634 
new best score!!!!
Validation loss decreased (0.636016 --> 0.566719).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.2347381114959717
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.5928901  Vali Loss: 0.4849865 Vali Accuracy: 0.8361582  Vali weighted F1: 0.8223577  Vali macro F1 0.7567027 
new best score!!!!
Validation loss decreased (0.566719 --> 0.484986).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.2359981536865234
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.5330849  Vali Loss: 0.4434534 Vali Accuracy: 0.8559322  Vali weighted F1: 0.8432446  Vali macro F1 0.7753684 
new best score!!!!
Validation loss decreased (0.484986 --> 0.443453).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.2387380599975586
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.4791917  Vali Loss: 0.4053346 Vali Accuracy: 0.8700565  Vali weighted F1: 0.8568972  Vali macro F1 0.7874017 
new best score!!!!
Validation loss decreased (0.443453 --> 0.405335).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.2361514568328857
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.4564471  Vali Loss: 0.3721713 Vali Accuracy: 0.8785311  Vali weighted F1: 0.8658600  Vali macro F1 0.7953720 
new best score!!!!
Validation loss decreased (0.405335 --> 0.372171).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.2351579666137695
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.4179204  Vali Loss: 0.3347524 Vali Accuracy: 0.8926554  Vali weighted F1: 0.8798093  Vali macro F1 0.8067767 
new best score!!!!
Validation loss decreased (0.372171 --> 0.334752).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.2370390892028809
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.3822728  Vali Loss: 0.3148739 Vali Accuracy: 0.8898305  Vali weighted F1: 0.8777193  Vali macro F1 0.8054119 
new best score!!!!
Validation loss decreased (0.334752 --> 0.314874).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.2367331981658936
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.3563250  Vali Loss: 0.2917622 Vali Accuracy: 0.9011299  Vali weighted F1: 0.8917500  Vali macro F1 0.8291528 
new best score!!!!
Validation loss decreased (0.314874 --> 0.291762).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.2574231624603271
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.3342016  Vali Loss: 0.2608961 Vali Accuracy: 0.9124294  Vali weighted F1: 0.9001501  Vali macro F1 0.8254807 
new best score!!!!
Validation loss decreased (0.291762 --> 0.260896).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.2377145290374756
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.3104319  Vali Loss: 0.2404575 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9252306  Vali macro F1 0.8672455 
new best score!!!!
Validation loss decreased (0.260896 --> 0.240457).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.236393928527832
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.2945404  Vali Loss: 0.2317897 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9080473  Vali macro F1 0.8309361 
new best score!!!!
Validation loss decreased (0.240457 --> 0.231790).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.2337703704833984
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.2719227  Vali Loss: 0.2006948 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9440704  Vali macro F1 0.8924393 
new best score!!!!
Validation loss decreased (0.231790 --> 0.200695).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.2306420803070068
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.2617218  Vali Loss: 0.1769810 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9526194  Vali macro F1 0.8995981 
new best score!!!!
Validation loss decreased (0.200695 --> 0.176981).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.2331287860870361
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.2352215  Vali Loss: 0.1655369 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9525133  Vali macro F1 0.8990128 
new best score!!!!
Validation loss decreased (0.176981 --> 0.165537).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.237084150314331
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.2213871  Vali Loss: 0.1652290 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9468666  Vali macro F1 0.8947136 
new best score!!!!
Validation loss decreased (0.165537 --> 0.165229).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.233306646347046
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.2139117  Vali Loss: 0.1456248 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9526123  Vali macro F1 0.8993080 
new best score!!!!
Validation loss decreased (0.165229 --> 0.145625).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.2338151931762695
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.2068668  Vali Loss: 0.1290024 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9591068  Vali macro F1 0.9072269 
new best score!!!!
Validation loss decreased (0.145625 --> 0.129002).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.2400894165039062
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.1858867  Vali Loss: 0.1239370 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9609925  Vali macro F1 0.9064777 
new best score!!!!
Validation loss decreased (0.129002 --> 0.123937).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.2332415580749512
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.1710799  Vali Loss: 0.1351457 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9569981  Vali macro F1 0.9108939 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 1.231626033782959
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.1676672  Vali Loss: 0.1114088 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9647091  Vali macro F1 0.9266534 
new best score!!!!
Validation loss decreased (0.123937 --> 0.111409).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.2316443920135498
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.1617945  Vali Loss: 0.1032765 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9769212  Vali macro F1 0.9492707 
new best score!!!!
Validation loss decreased (0.111409 --> 0.103277).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.2386693954467773
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.1550124  Vali Loss: 0.1012428 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9652928  Vali macro F1 0.9176219 
new best score!!!!
Validation loss decreased (0.103277 --> 0.101243).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 1.2400550842285156
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.1433602  Vali Loss: 0.1002429 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9692404  Vali macro F1 0.9286216 
new best score!!!!
Validation loss decreased (0.101243 --> 0.100243).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 1.2404003143310547
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.1411881  Vali Loss: 0.0932341 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9692420  Vali macro F1 0.9286268 
new best score!!!!
Validation loss decreased (0.100243 --> 0.093234).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 1.232830286026001
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.1354275  Vali Loss: 0.0972787 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9635871  Vali macro F1 0.9236143 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 1.234407901763916
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.1350608  Vali Loss: 0.0860551 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9720661  Vali macro F1 0.9309791 
new best score!!!!
Validation loss decreased (0.093234 --> 0.086055).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.2323431968688965
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.1275803  Vali Loss: 0.0791245 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9696112  Vali macro F1 0.9245630 
new best score!!!!
Validation loss decreased (0.086055 --> 0.079125).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 1.231041431427002
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.1369836  Vali Loss: 0.0950396 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9635849  Vali macro F1 0.9234397 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 1.2327866554260254
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.1250759  Vali Loss: 0.0752624 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9720661  Vali macro F1 0.9309791 
new best score!!!!
Validation loss decreased (0.079125 --> 0.075262).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 1.2359380722045898
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.1175361  Vali Loss: 0.0809199 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9681145  Vali macro F1 0.9203803 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 1.2355868816375732
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.1224614  Vali Loss: 0.0763766 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9720661  Vali macro F1 0.9309791 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 1.2357993125915527
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.1170330  Vali Loss: 0.0753951 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9701502  Vali macro F1 0.9358945 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 1.2356934547424316
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.1143433  Vali Loss: 0.0758530 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9599181  Vali macro F1 0.9050612 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 42 cost time: 1.2326385974884033
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.1089940  Vali Loss: 0.0649130 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9797453  Vali macro F1 0.9516230 
new best score!!!!
Validation loss decreased (0.075262 --> 0.064913).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 1.2330591678619385
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.1022188  Vali Loss: 0.0609002 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9791799  Vali macro F1 0.9499987 
new best score!!!!
Validation loss decreased (0.064913 --> 0.060900).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 1.2334620952606201
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0981207  Vali Loss: 0.0613590 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9797453  Vali macro F1 0.9516230 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 1.2345242500305176
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0969932  Vali Loss: 0.0589524 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9828139  Vali macro F1 0.9597776 
new best score!!!!
Validation loss decreased (0.060900 --> 0.058952).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 1.2431020736694336
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.1013230  Vali Loss: 0.0596117 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9800855  Vali macro F1 0.9526458 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 1.233095645904541
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0956702  Vali Loss: 0.0660507 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9739648  Vali macro F1 0.9512024 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 48 cost time: 1.23270845413208
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0929510  Vali Loss: 0.0604838 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9741587  Vali macro F1 0.9467138 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 49 cost time: 1.2352209091186523
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0892886  Vali Loss: 0.0529720 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9800855  Vali macro F1 0.9526458 
new best score!!!!
Validation loss decreased (0.058952 --> 0.052972).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 1.252269983291626
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0913106  Vali Loss: 0.0592403 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9826554  Vali macro F1 0.9597776 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 1.238271951675415
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0853509  Vali Loss: 0.0469691 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9852643  Vali macro F1 0.9610390 
new best score!!!!
Validation loss decreased (0.052972 --> 0.046969).  Saving model ...
new best score!!!!
Epoch: 52 cost time: 1.2384753227233887
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0782123  Vali Loss: 0.0474689 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887013  Vali macro F1 0.9754235 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 1.2411658763885498
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0783101  Vali Loss: 0.0431682 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9925926 
new best score!!!!
Validation loss decreased (0.046969 --> 0.043168).  Saving model ...
new best score!!!!
Epoch: 54 cost time: 1.2357473373413086
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0715592  Vali Loss: 0.0419667 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943348  Vali macro F1 0.9851648 
new best score!!!!
Validation loss decreased (0.043168 --> 0.041967).  Saving model ...
new best score!!!!
Epoch: 55 cost time: 1.2358453273773193
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0708748  Vali Loss: 0.0446001 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886850  Vali macro F1 0.9804531 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 1.235072374343872
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0751606  Vali Loss: 0.0477725 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858367  Vali macro F1 0.9727163 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 57 cost time: 1.2374424934387207
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0704528  Vali Loss: 0.0360857 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943348  Vali macro F1 0.9851648 
new best score!!!!
Validation loss decreased (0.041967 --> 0.036086).  Saving model ...
new best score!!!!
Epoch: 58 cost time: 1.2352209091186523
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0617212  Vali Loss: 0.0367977 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914791  Vali macro F1 0.9826458 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 1.2343292236328125
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0639042  Vali Loss: 0.0364410 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9855555  Vali macro F1 0.9669639 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 60 cost time: 1.239924430847168
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0633896  Vali Loss: 0.0407256 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915107  Vali macro F1 0.9828106 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 61 cost time: 1.2350242137908936
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0645776  Vali Loss: 0.0372321 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915107  Vali macro F1 0.9828106 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 62 cost time: 1.2326915264129639
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0613200  Vali Loss: 0.0430090 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9856882  Vali macro F1 0.9676458 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 63 cost time: 1.2349894046783447
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0561689  Vali Loss: 0.0301924 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943348  Vali macro F1 0.9851648 
new best score!!!!
Validation loss decreased (0.036086 --> 0.030192).  Saving model ...
new best score!!!!
Epoch: 64 cost time: 1.237661600112915
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0472000  Vali Loss: 0.0283153 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943348  Vali macro F1 0.9851648 
new best score!!!!
Validation loss decreased (0.030192 --> 0.028315).  Saving model ...
new best score!!!!
Epoch: 65 cost time: 1.237363338470459
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0471027  Vali Loss: 0.0288813 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943348  Vali macro F1 0.9851648 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 66 cost time: 1.2348179817199707
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0471742  Vali Loss: 0.0278327 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943348  Vali macro F1 0.9851648 
new best score!!!!
Validation loss decreased (0.028315 --> 0.027833).  Saving model ...
new best score!!!!
Epoch: 67 cost time: 1.2347509860992432
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0466688  Vali Loss: 0.0289162 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915107  Vali macro F1 0.9828106 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 68 cost time: 1.242021083831787
VALI: Epoch: 68, Steps: 13 | Train Loss: 0.0464023  Vali Loss: 0.0285980 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915107  Vali macro F1 0.9828106 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 69 cost time: 1.23583984375
VALI: Epoch: 69, Steps: 13 | Train Loss: 0.0460657  Vali Loss: 0.0279096 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915107  Vali macro F1 0.9828106 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 70 cost time: 1.2380683422088623
VALI: Epoch: 70, Steps: 13 | Train Loss: 0.0463783  Vali Loss: 0.0267163 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943348  Vali macro F1 0.9851648 
new best score!!!!
Validation loss decreased (0.027833 --> 0.026716).  Saving model ...
new best score!!!!
Epoch: 71 cost time: 1.236036777496338
VALI: Epoch: 71, Steps: 13 | Train Loss: 0.0481067  Vali Loss: 0.0288128 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915107  Vali macro F1 0.9828106 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 72 cost time: 1.2369296550750732
VALI: Epoch: 72, Steps: 13 | Train Loss: 0.0444049  Vali Loss: 0.0273112 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943348  Vali macro F1 0.9851648 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 73 cost time: 1.2371459007263184
VALI: Epoch: 73, Steps: 13 | Train Loss: 0.0416421  Vali Loss: 0.0270168 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915107  Vali macro F1 0.9828106 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 74 cost time: 1.2375929355621338
VALI: Epoch: 74, Steps: 13 | Train Loss: 0.0447589  Vali Loss: 0.0266515 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915107  Vali macro F1 0.9828106 
new best score!!!!
Validation loss decreased (0.026716 --> 0.026651).  Saving model ...
new best score!!!!
Epoch: 75 cost time: 1.2338614463806152
VALI: Epoch: 75, Steps: 13 | Train Loss: 0.0452107  Vali Loss: 0.0260532 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943348  Vali macro F1 0.9851648 
new best score!!!!
Validation loss decreased (0.026651 --> 0.026053).  Saving model ...
new best score!!!!
Epoch: 76 cost time: 1.232738733291626
VALI: Epoch: 76, Steps: 13 | Train Loss: 0.0432831  Vali Loss: 0.0272267 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915107  Vali macro F1 0.9828106 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 77 cost time: 1.2317471504211426
VALI: Epoch: 77, Steps: 13 | Train Loss: 0.0431940  Vali Loss: 0.0265385 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915107  Vali macro F1 0.9828106 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 78 cost time: 1.2328307628631592
VALI: Epoch: 78, Steps: 13 | Train Loss: 0.0411595  Vali Loss: 0.0262494 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915107  Vali macro F1 0.9828106 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 79 cost time: 1.2383761405944824
VALI: Epoch: 79, Steps: 13 | Train Loss: 0.0435412  Vali Loss: 0.0263419 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915107  Vali macro F1 0.9828106 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 80 cost time: 1.2315678596496582
VALI: Epoch: 80, Steps: 13 | Train Loss: 0.0419026  Vali Loss: 0.0257006 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943348  Vali macro F1 0.9851648 
new best score!!!!
Validation loss decreased (0.026053 --> 0.025701).  Saving model ...
new best score!!!!
Epoch: 81 cost time: 1.2415804862976074
VALI: Epoch: 81, Steps: 13 | Train Loss: 0.0428417  Vali Loss: 0.0246874 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943348  Vali macro F1 0.9851648 
new best score!!!!
Validation loss decreased (0.025701 --> 0.024687).  Saving model ...
new best score!!!!
Epoch: 82 cost time: 1.239492416381836
VALI: Epoch: 82, Steps: 13 | Train Loss: 0.0452123  Vali Loss: 0.0264886 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915107  Vali macro F1 0.9828106 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 83 cost time: 1.2372798919677734
VALI: Epoch: 83, Steps: 13 | Train Loss: 0.0398317  Vali Loss: 0.0239361 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943348  Vali macro F1 0.9851648 
new best score!!!!
Validation loss decreased (0.024687 --> 0.023936).  Saving model ...
new best score!!!!
Epoch: 84 cost time: 1.2322773933410645
VALI: Epoch: 84, Steps: 13 | Train Loss: 0.0405868  Vali Loss: 0.0238590 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943511  Vali macro F1 0.9902383 
new best score!!!!
Validation loss decreased (0.023936 --> 0.023859).  Saving model ...
new best score!!!!
Epoch: 85 cost time: 1.233726978302002
VALI: Epoch: 85, Steps: 13 | Train Loss: 0.0423311  Vali Loss: 0.0245884 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915107  Vali macro F1 0.9828106 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 86 cost time: 1.233882188796997
VALI: Epoch: 86, Steps: 13 | Train Loss: 0.0403549  Vali Loss: 0.0256132 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943348  Vali macro F1 0.9851648 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 87 cost time: 1.2353782653808594
VALI: Epoch: 87, Steps: 13 | Train Loss: 0.0392717  Vali Loss: 0.0243615 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915107  Vali macro F1 0.9828106 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 88 cost time: 1.2348132133483887
VALI: Epoch: 88, Steps: 13 | Train Loss: 0.0403439  Vali Loss: 0.0241752 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943348  Vali macro F1 0.9851648 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 89 cost time: 1.2332427501678467
VALI: Epoch: 89, Steps: 13 | Train Loss: 0.0410768  Vali Loss: 0.0243350 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915107  Vali macro F1 0.9828106 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 90 cost time: 1.2324955463409424
VALI: Epoch: 90, Steps: 13 | Train Loss: 0.0413721  Vali Loss: 0.0243844 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915107  Vali macro F1 0.9828106 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 91 cost time: 1.231351375579834
VALI: Epoch: 91, Steps: 13 | Train Loss: 0.0379961  Vali Loss: 0.0243175 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915107  Vali macro F1 0.9828106 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 92 cost time: 1.2319011688232422
VALI: Epoch: 92, Steps: 13 | Train Loss: 0.0405363  Vali Loss: 0.0242633 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943348  Vali macro F1 0.9851648 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 93 cost time: 1.2323181629180908
VALI: Epoch: 93, Steps: 13 | Train Loss: 0.0408980  Vali Loss: 0.0241084 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943348  Vali macro F1 0.9851648 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 94 cost time: 1.2325787544250488
VALI: Epoch: 94, Steps: 13 | Train Loss: 0.0376204  Vali Loss: 0.0239846 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943348  Vali macro F1 0.9851648 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 95 cost time: 1.2331552505493164
VALI: Epoch: 95, Steps: 13 | Train Loss: 0.0389476  Vali Loss: 0.0239749 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943348  Vali macro F1 0.9851648 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 96 cost time: 1.2361869812011719
VALI: Epoch: 96, Steps: 13 | Train Loss: 0.0361887  Vali Loss: 0.0239818 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943348  Vali macro F1 0.9851648 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 97 cost time: 1.2368438243865967
VALI: Epoch: 97, Steps: 13 | Train Loss: 0.0379373  Vali Loss: 0.0239908 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943348  Vali macro F1 0.9851648 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 98 cost time: 1.2378692626953125
VALI: Epoch: 98, Steps: 13 | Train Loss: 0.0373652  Vali Loss: 0.0240089 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943348  Vali macro F1 0.9851648 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 99 cost time: 1.2383005619049072
VALI: Epoch: 99, Steps: 13 | Train Loss: 0.0410841  Vali Loss: 0.0240294 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943348  Vali macro F1 0.9851648 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9875986  Test weighted F1: 0.9876152  Test macro F1 0.9839242 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 73347
pruned model Parameter : 76626
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.2605741024017334
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0440786  Vali Loss: 0.0285703 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915107  Vali macro F1 0.9828106 
Validation loss decreased (inf --> 0.028570).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.2575526237487793
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0396556  Vali Loss: 0.0268878 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915107  Vali macro F1 0.9828106 
new best score!!!!
Validation loss decreased (0.028570 --> 0.026888).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 1.2544963359832764
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0422720  Vali Loss: 0.0235386 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943348  Vali macro F1 0.9851648 
new best score!!!!
Validation loss decreased (0.026888 --> 0.023539).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 1.2579972743988037
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0414011  Vali Loss: 0.0236984 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943348  Vali macro F1 0.9851648 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 1.2557787895202637
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0396534  Vali Loss: 0.0229811 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943348  Vali macro F1 0.9851648 
new best score!!!!
Validation loss decreased (0.023539 --> 0.022981).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 1.2574286460876465
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0383254  Vali Loss: 0.0229076 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943348  Vali macro F1 0.9851648 
new best score!!!!
Validation loss decreased (0.022981 --> 0.022908).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 1.2539076805114746
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0396998  Vali Loss: 0.0224747 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943348  Vali macro F1 0.9851648 
new best score!!!!
Validation loss decreased (0.022908 --> 0.022475).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 1.2563180923461914
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0401546  Vali Loss: 0.0217951 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9925926 
new best score!!!!
Validation loss decreased (0.022475 --> 0.021795).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 1.2512598037719727
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0381425  Vali Loss: 0.0233583 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943348  Vali macro F1 0.9851648 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 1.254964828491211
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0381387  Vali Loss: 0.0223474 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943348  Vali macro F1 0.9851648 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 1.2552249431610107
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0379254  Vali Loss: 0.0209918 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943348  Vali macro F1 0.9851648 
new best score!!!!
Validation loss decreased (0.021795 --> 0.020992).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 1.2497429847717285
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0373659  Vali Loss: 0.0228355 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943348  Vali macro F1 0.9851648 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 1.2692961692810059
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0375295  Vali Loss: 0.0219853 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943348  Vali macro F1 0.9851648 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 1.2562131881713867
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0353402  Vali Loss: 0.0225166 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915107  Vali macro F1 0.9828106 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 1.2517547607421875
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0353279  Vali Loss: 0.0267425 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886866  Vali macro F1 0.9804583 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 1.253779649734497
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0346558  Vali Loss: 0.0218734 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886866  Vali macro F1 0.9804583 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 17 cost time: 1.2505872249603271
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0343610  Vali Loss: 0.0203903 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943511  Vali macro F1 0.9902383 
new best score!!!!
Validation loss decreased (0.020992 --> 0.020390).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 18 cost time: 1.2532868385314941
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0343509  Vali Loss: 0.0212670 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943348  Vali macro F1 0.9851648 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 1.2528138160705566
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0341799  Vali Loss: 0.0196017 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943348  Vali macro F1 0.9851648 
new best score!!!!
Validation loss decreased (0.020390 --> 0.019602).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 20 cost time: 1.2543861865997314
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0355491  Vali Loss: 0.0212158 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915107  Vali macro F1 0.9828106 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 1.2557392120361328
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0330636  Vali Loss: 0.0270378 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915107  Vali macro F1 0.9828106 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 1.2580370903015137
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0395015  Vali Loss: 0.0190411 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.019602 --> 0.019041).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 23 cost time: 1.252988576889038
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0339728  Vali Loss: 0.0229892 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915107  Vali macro F1 0.9828106 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 1.2523791790008545
Fine Tuning VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0334585  Vali Loss: 0.0193046 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9925926 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 1.2574081420898438
Fine Tuning VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0348513  Vali Loss: 0.0199677 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943348  Vali macro F1 0.9851648 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 1.2571251392364502
Fine Tuning VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0348974  Vali Loss: 0.0192664 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943348  Vali macro F1 0.9851648 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 1.2557344436645508
Fine Tuning VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0322761  Vali Loss: 0.0212120 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915107  Vali macro F1 0.9828106 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 28 cost time: 1.2557587623596191
Fine Tuning VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0311130  Vali Loss: 0.0206703 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915107  Vali macro F1 0.9828106 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 29 cost time: 1.2551393508911133
Fine Tuning VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0318842  Vali Loss: 0.0203296 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915107  Vali macro F1 0.9828106 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 30 cost time: 1.2546179294586182
Fine Tuning VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0297793  Vali Loss: 0.0202348 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915107  Vali macro F1 0.9828106 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 31 cost time: 1.2532689571380615
Fine Tuning VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0339953  Vali Loss: 0.0196885 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943348  Vali macro F1 0.9851648 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 32 cost time: 1.2546002864837646
Fine Tuning VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0306323  Vali Loss: 0.0200169 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943348  Vali macro F1 0.9851648 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 33 cost time: 1.266772747039795
Fine Tuning VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0313189  Vali Loss: 0.0199970 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943348  Vali macro F1 0.9851648 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 34 cost time: 1.256758689880371
Fine Tuning VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0317557  Vali Loss: 0.0199699 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943348  Vali macro F1 0.9851648 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 35 cost time: 1.249419927597046
Fine Tuning VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0324211  Vali Loss: 0.0199679 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943348  Vali macro F1 0.9851648 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 36 cost time: 1.253404140472412
Fine Tuning VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0283335  Vali Loss: 0.0199698 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943348  Vali macro F1 0.9851648 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 37 cost time: 1.2525584697723389
Fine Tuning VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0284656  Vali Loss: 0.0199588 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943348  Vali macro F1 0.9851648 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9864713  Test weighted F1: 0.9864991  Test macro F1 0.9833587 
Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 73347
Set the seed as :  4
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
================ SOCV Mode ====================
================ 5 CV ======================
================ the 0 th CV Experiment ================ 
Overlapping random Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.00278552 0.00240385 0.00239808 0.00333333 0.00561798 0.00591716
 0.003125   0.00287356 0.00234192 0.00398406]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.261988878250122
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.2835089  Vali Loss: 2.2842308 Vali Accuracy: 0.1242938  Vali weighted F1: 0.0274820  Vali macro F1 0.0221106 
Validation loss decreased (inf --> 2.284231).  Saving model ...
Epoch: 2 cost time: 1.2425274848937988
VALI: Epoch: 2, Steps: 13 | Train Loss: 2.2220084  Vali Loss: 2.1528512 Vali Accuracy: 0.3502825  Vali weighted F1: 0.2715667  Vali macro F1 0.2337386 
new best score!!!!
Validation loss decreased (2.284231 --> 2.152851).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.2478666305541992
VALI: Epoch: 3, Steps: 13 | Train Loss: 1.9943756  Vali Loss: 1.7447773 Vali Accuracy: 0.5084746  Vali weighted F1: 0.4777391  Vali macro F1 0.4409967 
new best score!!!!
Validation loss decreased (2.152851 --> 1.744777).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.243032693862915
VALI: Epoch: 4, Steps: 13 | Train Loss: 1.6149452  Vali Loss: 1.3172174 Vali Accuracy: 0.6468927  Vali weighted F1: 0.6276547  Vali macro F1 0.6146812 
new best score!!!!
Validation loss decreased (1.744777 --> 1.317217).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.243744134902954
VALI: Epoch: 5, Steps: 13 | Train Loss: 1.2820088  Vali Loss: 1.1172098 Vali Accuracy: 0.6553672  Vali weighted F1: 0.6279776  Vali macro F1 0.6172316 
new best score!!!!
Validation loss decreased (1.317217 --> 1.117210).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.2419302463531494
VALI: Epoch: 6, Steps: 13 | Train Loss: 1.0676993  Vali Loss: 0.9330859 Vali Accuracy: 0.6751412  Vali weighted F1: 0.6364082  Vali macro F1 0.6313221 
new best score!!!!
Validation loss decreased (1.117210 --> 0.933086).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.2399935722351074
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.8987872  Vali Loss: 0.8099205 Vali Accuracy: 0.7429379  Vali weighted F1: 0.7194435  Vali macro F1 0.7047266 
new best score!!!!
Validation loss decreased (0.933086 --> 0.809921).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.260922908782959
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.7683648  Vali Loss: 0.7104370 Vali Accuracy: 0.7768362  Vali weighted F1: 0.7544785  Vali macro F1 0.7359514 
new best score!!!!
Validation loss decreased (0.809921 --> 0.710437).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.2390499114990234
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.6654080  Vali Loss: 0.6259734 Vali Accuracy: 0.8022599  Vali weighted F1: 0.8010521  Vali macro F1 0.7975742 
new best score!!!!
Validation loss decreased (0.710437 --> 0.625973).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.247182846069336
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.5906862  Vali Loss: 0.5637593 Vali Accuracy: 0.8333333  Vali weighted F1: 0.8307295  Vali macro F1 0.8234911 
new best score!!!!
Validation loss decreased (0.625973 --> 0.563759).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.2453429698944092
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.5415709  Vali Loss: 0.5209880 Vali Accuracy: 0.8079096  Vali weighted F1: 0.7959669  Vali macro F1 0.7818803 
new best score!!!!
Validation loss decreased (0.563759 --> 0.520988).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.2422263622283936
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.5074722  Vali Loss: 0.4725598 Vali Accuracy: 0.8305085  Vali weighted F1: 0.8248676  Vali macro F1 0.8145247 
new best score!!!!
Validation loss decreased (0.520988 --> 0.472560).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.242377519607544
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.4568113  Vali Loss: 0.4346605 Vali Accuracy: 0.8644068  Vali weighted F1: 0.8631198  Vali macro F1 0.8516479 
new best score!!!!
Validation loss decreased (0.472560 --> 0.434660).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.243354082107544
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.4248735  Vali Loss: 0.4283367 Vali Accuracy: 0.8446328  Vali weighted F1: 0.8418954  Vali macro F1 0.8234423 
new best score!!!!
Validation loss decreased (0.434660 --> 0.428337).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.2400341033935547
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.3995484  Vali Loss: 0.3977031 Vali Accuracy: 0.8474576  Vali weighted F1: 0.8365569  Vali macro F1 0.8161107 
new best score!!!!
Validation loss decreased (0.428337 --> 0.397703).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.2434210777282715
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.3778267  Vali Loss: 0.3807761 Vali Accuracy: 0.8615819  Vali weighted F1: 0.8383517  Vali macro F1 0.8078228 
new best score!!!!
Validation loss decreased (0.397703 --> 0.380776).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.246253490447998
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.3569450  Vali Loss: 0.3452503 Vali Accuracy: 0.8813559  Vali weighted F1: 0.8761674  Vali macro F1 0.8530127 
new best score!!!!
Validation loss decreased (0.380776 --> 0.345250).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.2418723106384277
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.3352159  Vali Loss: 0.3442257 Vali Accuracy: 0.8785311  Vali weighted F1: 0.8662862  Vali macro F1 0.8394651 
new best score!!!!
Validation loss decreased (0.345250 --> 0.344226).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.240227222442627
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.3213677  Vali Loss: 0.3195697 Vali Accuracy: 0.8728814  Vali weighted F1: 0.8540507  Vali macro F1 0.8239284 
new best score!!!!
Validation loss decreased (0.344226 --> 0.319570).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.2423946857452393
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.3040090  Vali Loss: 0.3191593 Vali Accuracy: 0.8785311  Vali weighted F1: 0.8751916  Vali macro F1 0.8575041 
new best score!!!!
Validation loss decreased (0.319570 --> 0.319159).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.2436332702636719
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.2908233  Vali Loss: 0.2856403 Vali Accuracy: 0.9011299  Vali weighted F1: 0.8971744  Vali macro F1 0.8742020 
new best score!!!!
Validation loss decreased (0.319159 --> 0.285640).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.2412025928497314
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.2736627  Vali Loss: 0.2758351 Vali Accuracy: 0.9039548  Vali weighted F1: 0.9037707  Vali macro F1 0.8820940 
new best score!!!!
Validation loss decreased (0.285640 --> 0.275835).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.2412009239196777
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.2581244  Vali Loss: 0.2652008 Vali Accuracy: 0.8983051  Vali weighted F1: 0.8796751  Vali macro F1 0.8476748 
new best score!!!!
Validation loss decreased (0.275835 --> 0.265201).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.243152141571045
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.2483310  Vali Loss: 0.2628236 Vali Accuracy: 0.9152542  Vali weighted F1: 0.9074401  Vali macro F1 0.8825521 
new best score!!!!
Validation loss decreased (0.265201 --> 0.262824).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.2414562702178955
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.2392768  Vali Loss: 0.2481088 Vali Accuracy: 0.9039548  Vali weighted F1: 0.8808505  Vali macro F1 0.8468376 
new best score!!!!
Validation loss decreased (0.262824 --> 0.248109).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.2447917461395264
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.2196466  Vali Loss: 0.2418393 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9091276  Vali macro F1 0.8825357 
new best score!!!!
Validation loss decreased (0.248109 --> 0.241839).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.2427573204040527
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.2091968  Vali Loss: 0.2101955 Vali Accuracy: 0.9180791  Vali weighted F1: 0.9158532  Vali macro F1 0.8913608 
new best score!!!!
Validation loss decreased (0.241839 --> 0.210196).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 1.2416906356811523
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.2012213  Vali Loss: 0.2101349 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9037193  Vali macro F1 0.8735743 
new best score!!!!
Validation loss decreased (0.210196 --> 0.210135).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.2403874397277832
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.1901972  Vali Loss: 0.1995772 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9236280  Vali macro F1 0.9034132 
new best score!!!!
Validation loss decreased (0.210135 --> 0.199577).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.2414720058441162
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.1834135  Vali Loss: 0.2071674 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9314430  Vali macro F1 0.9107690 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 1.2469286918640137
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.1755159  Vali Loss: 0.1823776 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9278680  Vali macro F1 0.9032551 
new best score!!!!
Validation loss decreased (0.199577 --> 0.182378).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 1.2453806400299072
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.1619526  Vali Loss: 0.1963860 Vali Accuracy: 0.9265537  Vali weighted F1: 0.9129817  Vali macro F1 0.8866217 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 1.2417421340942383
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.1643025  Vali Loss: 0.1761036 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9325296  Vali macro F1 0.9143985 
new best score!!!!
Validation loss decreased (0.182378 --> 0.176104).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 1.24265456199646
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.1559149  Vali Loss: 0.1740985 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9109936  Vali macro F1 0.8845567 
new best score!!!!
Validation loss decreased (0.176104 --> 0.174099).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.243807077407837
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.1490498  Vali Loss: 0.1694801 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9328930  Vali macro F1 0.9126282 
new best score!!!!
Validation loss decreased (0.174099 --> 0.169480).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 1.244913101196289
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.1484017  Vali Loss: 0.1631955 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9604787  Vali macro F1 0.9471594 
new best score!!!!
Validation loss decreased (0.169480 --> 0.163196).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 1.2442805767059326
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.1420475  Vali Loss: 0.1666966 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9423178  Vali macro F1 0.9270591 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 1.2442476749420166
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.1355234  Vali Loss: 0.1512009 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9660862  Vali macro F1 0.9552907 
new best score!!!!
Validation loss decreased (0.163196 --> 0.151201).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 1.242628574371338
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.1281955  Vali Loss: 0.1635492 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9267522  Vali macro F1 0.9029208 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 1.2414236068725586
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.1272446  Vali Loss: 0.1496878 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9483576  Vali macro F1 0.9319209 
new best score!!!!
Validation loss decreased (0.151201 --> 0.149688).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 1.261430263519287
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.1217905  Vali Loss: 0.1467029 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9514758  Vali macro F1 0.9360794 
new best score!!!!
Validation loss decreased (0.149688 --> 0.146703).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 1.2434406280517578
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.1202400  Vali Loss: 0.1394077 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9366102  Vali macro F1 0.9144443 
new best score!!!!
Validation loss decreased (0.146703 --> 0.139408).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 1.2457084655761719
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.1147187  Vali Loss: 0.1360146 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9716351  Vali macro F1 0.9635124 
new best score!!!!
Validation loss decreased (0.139408 --> 0.136015).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 1.2425825595855713
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.1103088  Vali Loss: 0.1268974 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9604363  Vali macro F1 0.9504454 
new best score!!!!
Validation loss decreased (0.136015 --> 0.126897).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 1.2421329021453857
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.1186275  Vali Loss: 0.1296198 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9614004  Vali macro F1 0.9469489 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 1.2435758113861084
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.1071048  Vali Loss: 0.1199966 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9559029  Vali macro F1 0.9430246 
new best score!!!!
Validation loss decreased (0.126897 --> 0.119997).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 1.244300127029419
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.1051941  Vali Loss: 0.1150430 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802009  Vali macro F1 0.9742915 
new best score!!!!
Validation loss decreased (0.119997 --> 0.115043).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 1.2432103157043457
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.1056884  Vali Loss: 0.1499543 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9313416  Vali macro F1 0.9105158 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 1.244023084640503
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0984218  Vali Loss: 0.1178778 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9591806  Vali macro F1 0.9451753 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 1.2485761642456055
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0972348  Vali Loss: 0.1132317 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773812  Vali macro F1 0.9714213 
new best score!!!!
Validation loss decreased (0.115043 --> 0.113232).  Saving model ...
new best score!!!!
Epoch: 51 cost time: 1.2492187023162842
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0894694  Vali Loss: 0.0953019 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745378  Vali macro F1 0.9662883 
new best score!!!!
Validation loss decreased (0.113232 --> 0.095302).  Saving model ...
new best score!!!!
Epoch: 52 cost time: 1.2499933242797852
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0889036  Vali Loss: 0.1009490 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745117  Vali macro F1 0.9692623 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 1.2535996437072754
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0914925  Vali Loss: 0.1118265 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9585406  Vali macro F1 0.9460797 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 1.249391794204712
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0880599  Vali Loss: 0.0914199 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774064  Vali macro F1 0.9699904 
new best score!!!!
Validation loss decreased (0.095302 --> 0.091420).  Saving model ...
new best score!!!!
Epoch: 55 cost time: 1.250171184539795
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0801264  Vali Loss: 0.0799967 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887278  Vali macro F1 0.9841562 
new best score!!!!
Validation loss decreased (0.091420 --> 0.079997).  Saving model ...
new best score!!!!
Epoch: 56 cost time: 1.2466695308685303
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0729941  Vali Loss: 0.0967267 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746526  Vali macro F1 0.9670601 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 57 cost time: 1.2456095218658447
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0780252  Vali Loss: 0.1002147 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9688690  Vali macro F1 0.9602459 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 58 cost time: 1.245398759841919
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0724066  Vali Loss: 0.0615410 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829500  Vali macro F1 0.9767857 
new best score!!!!
Validation loss decreased (0.079997 --> 0.061541).  Saving model ...
new best score!!!!
Epoch: 59 cost time: 1.2471246719360352
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0697682  Vali Loss: 0.0871221 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773779  Vali macro F1 0.9716206 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 60 cost time: 1.2464029788970947
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0645140  Vali Loss: 0.0641147 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859802  Vali macro F1 0.9829793 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 61 cost time: 1.2539401054382324
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0582053  Vali Loss: 0.0533921 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886838  Vali macro F1 0.9845926 
new best score!!!!
Validation loss decreased (0.061541 --> 0.053392).  Saving model ...
new best score!!!!
Epoch: 62 cost time: 1.24658203125
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0526570  Vali Loss: 0.0629766 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801223  Vali macro F1 0.9743881 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 63 cost time: 1.242285966873169
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0673530  Vali Loss: 0.0599768 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887970  Vali macro F1 0.9868145 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 64 cost time: 1.246755838394165
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0763824  Vali Loss: 0.0606143 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773381  Vali macro F1 0.9717735 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 65 cost time: 1.2464649677276611
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0607732  Vali Loss: 0.0548739 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829500  Vali macro F1 0.9767857 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 66 cost time: 1.2461209297180176
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0578739  Vali Loss: 0.0453401 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9923077 
new best score!!!!
Validation loss decreased (0.053392 --> 0.045340).  Saving model ...
new best score!!!!
Epoch: 67 cost time: 1.2520828247070312
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0584795  Vali Loss: 0.0572179 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886694  Vali macro F1 0.9860254 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 68 cost time: 1.2519347667694092
VALI: Epoch: 68, Steps: 13 | Train Loss: 0.0536324  Vali Loss: 0.0681581 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803827  Vali macro F1 0.9769394 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 69 cost time: 1.2472004890441895
VALI: Epoch: 69, Steps: 13 | Train Loss: 0.0482386  Vali Loss: 0.0417047 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886838  Vali macro F1 0.9845926 
new best score!!!!
Validation loss decreased (0.045340 --> 0.041705).  Saving model ...
new best score!!!!
Epoch: 70 cost time: 1.2444987297058105
VALI: Epoch: 70, Steps: 13 | Train Loss: 0.0472780  Vali Loss: 0.0479914 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830009  Vali macro F1 0.9783074 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 71 cost time: 1.2493712902069092
VALI: Epoch: 71, Steps: 13 | Train Loss: 0.0465878  Vali Loss: 0.0448498 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886946  Vali macro F1 0.9860597 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 72 cost time: 1.248875379562378
VALI: Epoch: 72, Steps: 13 | Train Loss: 0.0531391  Vali Loss: 0.0439015 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829500  Vali macro F1 0.9767857 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 73 cost time: 1.247283935546875
VALI: Epoch: 73, Steps: 13 | Train Loss: 0.0451508  Vali Loss: 0.0590977 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746609  Vali macro F1 0.9686526 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 74 cost time: 1.2436981201171875
VALI: Epoch: 74, Steps: 13 | Train Loss: 0.0403397  Vali Loss: 0.0336305 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915223  Vali macro F1 0.9884573 
new best score!!!!
Validation loss decreased (0.041705 --> 0.033630).  Saving model ...
new best score!!!!
Epoch: 75 cost time: 1.2442479133605957
VALI: Epoch: 75, Steps: 13 | Train Loss: 0.0399105  Vali Loss: 0.0327228 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886838  Vali macro F1 0.9845926 
new best score!!!!
Validation loss decreased (0.033630 --> 0.032723).  Saving model ...
new best score!!!!
Epoch: 76 cost time: 1.2599046230316162
VALI: Epoch: 76, Steps: 13 | Train Loss: 0.0401340  Vali Loss: 0.0318914 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
new best score!!!!
Validation loss decreased (0.032723 --> 0.031891).  Saving model ...
new best score!!!!
Epoch: 77 cost time: 1.2420721054077148
VALI: Epoch: 77, Steps: 13 | Train Loss: 0.0396098  Vali Loss: 0.0451404 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802076  Vali macro F1 0.9737013 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 78 cost time: 1.24290132522583
VALI: Epoch: 78, Steps: 13 | Train Loss: 0.0391796  Vali Loss: 0.0327063 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 79 cost time: 1.2409353256225586
VALI: Epoch: 79, Steps: 13 | Train Loss: 0.0354308  Vali Loss: 0.0320825 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 80 cost time: 1.2432217597961426
VALI: Epoch: 80, Steps: 13 | Train Loss: 0.0343069  Vali Loss: 0.0255770 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943419  Vali macro F1 0.9922963 
new best score!!!!
Validation loss decreased (0.031891 --> 0.025577).  Saving model ...
new best score!!!!
Epoch: 81 cost time: 1.2411112785339355
VALI: Epoch: 81, Steps: 13 | Train Loss: 0.0390280  Vali Loss: 0.0336025 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915870  Vali macro F1 0.9891948 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 82 cost time: 1.2431361675262451
VALI: Epoch: 82, Steps: 13 | Train Loss: 0.0307570  Vali Loss: 0.0236179 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9923077 
new best score!!!!
Validation loss decreased (0.025577 --> 0.023618).  Saving model ...
new best score!!!!
Epoch: 83 cost time: 1.244999885559082
VALI: Epoch: 83, Steps: 13 | Train Loss: 0.0304605  Vali Loss: 0.0237162 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 84 cost time: 1.2427096366882324
VALI: Epoch: 84, Steps: 13 | Train Loss: 0.0297167  Vali Loss: 0.0243824 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 85 cost time: 1.2418618202209473
VALI: Epoch: 85, Steps: 13 | Train Loss: 0.0312287  Vali Loss: 0.0223971 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915223  Vali macro F1 0.9884573 
new best score!!!!
Validation loss decreased (0.023618 --> 0.022397).  Saving model ...
new best score!!!!
Epoch: 86 cost time: 1.2418546676635742
VALI: Epoch: 86, Steps: 13 | Train Loss: 0.0257820  Vali Loss: 0.0257677 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9923077 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 87 cost time: 1.2406013011932373
VALI: Epoch: 87, Steps: 13 | Train Loss: 0.0274609  Vali Loss: 0.0204638 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
new best score!!!!
Validation loss decreased (0.022397 --> 0.020464).  Saving model ...
new best score!!!!
Epoch: 88 cost time: 1.2404367923736572
VALI: Epoch: 88, Steps: 13 | Train Loss: 0.0202536  Vali Loss: 0.0186898 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
new best score!!!!
Validation loss decreased (0.020464 --> 0.018690).  Saving model ...
new best score!!!!
Epoch: 89 cost time: 1.2440311908721924
VALI: Epoch: 89, Steps: 13 | Train Loss: 0.0263818  Vali Loss: 0.0403062 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802076  Vali macro F1 0.9737013 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 90 cost time: 1.2434356212615967
VALI: Epoch: 90, Steps: 13 | Train Loss: 0.0247608  Vali Loss: 0.0288120 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9944089  Vali macro F1 0.9930368 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 91 cost time: 1.2460834980010986
VALI: Epoch: 91, Steps: 13 | Train Loss: 0.0258771  Vali Loss: 0.0257004 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915254  Vali macro F1 0.9897103 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 92 cost time: 1.2423746585845947
VALI: Epoch: 92, Steps: 13 | Train Loss: 0.0225676  Vali Loss: 0.0333252 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829500  Vali macro F1 0.9767857 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 93 cost time: 1.2419002056121826
VALI: Epoch: 93, Steps: 13 | Train Loss: 0.0272933  Vali Loss: 0.0260693 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886838  Vali macro F1 0.9845926 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 94 cost time: 1.2418887615203857
VALI: Epoch: 94, Steps: 13 | Train Loss: 0.0272814  Vali Loss: 0.0191727 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9923077 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 95 cost time: 1.244727373123169
VALI: Epoch: 95, Steps: 13 | Train Loss: 0.0191539  Vali Loss: 0.0180800 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
new best score!!!!
Validation loss decreased (0.018690 --> 0.018080).  Saving model ...
new best score!!!!
Epoch: 96 cost time: 1.2425665855407715
VALI: Epoch: 96, Steps: 13 | Train Loss: 0.0190057  Vali Loss: 0.0177397 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9923077 
new best score!!!!
Validation loss decreased (0.018080 --> 0.017740).  Saving model ...
new best score!!!!
Epoch: 97 cost time: 1.2484235763549805
VALI: Epoch: 97, Steps: 13 | Train Loss: 0.0184182  Vali Loss: 0.0188069 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915223  Vali macro F1 0.9884573 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 98 cost time: 1.245607614517212
VALI: Epoch: 98, Steps: 13 | Train Loss: 0.0212004  Vali Loss: 0.0182696 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9923077 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 99 cost time: 1.2483539581298828
VALI: Epoch: 99, Steps: 13 | Train Loss: 0.0166994  Vali Loss: 0.0174013 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9923077 
new best score!!!!
Validation loss decreased (0.017740 --> 0.017401).  Saving model ...
new best score!!!!
Epoch: 100 cost time: 1.2457380294799805
VALI: Epoch: 100, Steps: 13 | Train Loss: 0.0187100  Vali Loss: 0.0172710 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9923077 
new best score!!!!
Validation loss decreased (0.017401 --> 0.017271).  Saving model ...
new best score!!!!
Epoch: 101 cost time: 1.2412481307983398
VALI: Epoch: 101, Steps: 13 | Train Loss: 0.0178670  Vali Loss: 0.0176981 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9923077 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 102 cost time: 1.2404818534851074
VALI: Epoch: 102, Steps: 13 | Train Loss: 0.0162309  Vali Loss: 0.0186540 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915223  Vali macro F1 0.9884573 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 103 cost time: 1.2415599822998047
VALI: Epoch: 103, Steps: 13 | Train Loss: 0.0216611  Vali Loss: 0.0171852 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
new best score!!!!
Validation loss decreased (0.017271 --> 0.017185).  Saving model ...
new best score!!!!
Epoch: 104 cost time: 1.2466747760772705
VALI: Epoch: 104, Steps: 13 | Train Loss: 0.0168183  Vali Loss: 0.0169951 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
new best score!!!!
Validation loss decreased (0.017185 --> 0.016995).  Saving model ...
new best score!!!!
Epoch: 105 cost time: 1.249751091003418
VALI: Epoch: 105, Steps: 13 | Train Loss: 0.0193259  Vali Loss: 0.0169203 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
new best score!!!!
Validation loss decreased (0.016995 --> 0.016920).  Saving model ...
new best score!!!!
Epoch: 106 cost time: 1.244272232055664
VALI: Epoch: 106, Steps: 13 | Train Loss: 0.0180168  Vali Loss: 0.0166806 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
new best score!!!!
Validation loss decreased (0.016920 --> 0.016681).  Saving model ...
new best score!!!!
Epoch: 107 cost time: 1.242743968963623
VALI: Epoch: 107, Steps: 13 | Train Loss: 0.0179906  Vali Loss: 0.0167037 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 108 cost time: 1.2422418594360352
VALI: Epoch: 108, Steps: 13 | Train Loss: 0.0168016  Vali Loss: 0.0169023 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 109 cost time: 1.2586407661437988
VALI: Epoch: 109, Steps: 13 | Train Loss: 0.0186287  Vali Loss: 0.0170174 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 110 cost time: 1.2451112270355225
VALI: Epoch: 110, Steps: 13 | Train Loss: 0.0181402  Vali Loss: 0.0178516 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915223  Vali macro F1 0.9884573 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 111 cost time: 1.2435085773468018
VALI: Epoch: 111, Steps: 13 | Train Loss: 0.0181745  Vali Loss: 0.0169083 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 112 cost time: 1.243175745010376
VALI: Epoch: 112, Steps: 13 | Train Loss: 0.0167088  Vali Loss: 0.0168388 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 113 cost time: 1.245265007019043
VALI: Epoch: 113, Steps: 13 | Train Loss: 0.0155448  Vali Loss: 0.0167466 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 114 cost time: 1.2470149993896484
VALI: Epoch: 114, Steps: 13 | Train Loss: 0.0176020  Vali Loss: 0.0166474 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
new best score!!!!
Validation loss decreased (0.016681 --> 0.016647).  Saving model ...
new best score!!!!
Epoch: 115 cost time: 1.2434985637664795
VALI: Epoch: 115, Steps: 13 | Train Loss: 0.0165907  Vali Loss: 0.0166059 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
new best score!!!!
Validation loss decreased (0.016647 --> 0.016606).  Saving model ...
new best score!!!!
Epoch: 116 cost time: 1.242506504058838
VALI: Epoch: 116, Steps: 13 | Train Loss: 0.0181102  Vali Loss: 0.0165547 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
new best score!!!!
Validation loss decreased (0.016606 --> 0.016555).  Saving model ...
new best score!!!!
Epoch: 117 cost time: 1.2423710823059082
VALI: Epoch: 117, Steps: 13 | Train Loss: 0.0184765  Vali Loss: 0.0165513 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
new best score!!!!
Validation loss decreased (0.016555 --> 0.016551).  Saving model ...
new best score!!!!
Epoch: 118 cost time: 1.242192268371582
VALI: Epoch: 118, Steps: 13 | Train Loss: 0.0147871  Vali Loss: 0.0166207 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 119 cost time: 1.2404067516326904
VALI: Epoch: 119, Steps: 13 | Train Loss: 0.0179535  Vali Loss: 0.0166381 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 120 cost time: 1.239713430404663
VALI: Epoch: 120, Steps: 13 | Train Loss: 0.0157424  Vali Loss: 0.0165983 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 121 cost time: 1.2401282787322998
VALI: Epoch: 121, Steps: 13 | Train Loss: 0.0164249  Vali Loss: 0.0167464 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 122 cost time: 1.2405664920806885
VALI: Epoch: 122, Steps: 13 | Train Loss: 0.0180730  Vali Loss: 0.0168044 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 123 cost time: 1.2410900592803955
VALI: Epoch: 123, Steps: 13 | Train Loss: 0.0162458  Vali Loss: 0.0167870 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 124 cost time: 1.2412998676300049
VALI: Epoch: 124, Steps: 13 | Train Loss: 0.0157673  Vali Loss: 0.0167857 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 125 cost time: 1.2402725219726562
VALI: Epoch: 125, Steps: 13 | Train Loss: 0.0165904  Vali Loss: 0.0167918 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 126 cost time: 1.2403151988983154
VALI: Epoch: 126, Steps: 13 | Train Loss: 0.0168376  Vali Loss: 0.0167847 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 127 cost time: 1.241708755493164
VALI: Epoch: 127, Steps: 13 | Train Loss: 0.0163746  Vali Loss: 0.0167863 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 128 cost time: 1.2412052154541016
VALI: Epoch: 128, Steps: 13 | Train Loss: 0.0168803  Vali Loss: 0.0167861 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 129 cost time: 1.2420728206634521
VALI: Epoch: 129, Steps: 13 | Train Loss: 0.0157270  Vali Loss: 0.0167857 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 130 cost time: 1.2395846843719482
VALI: Epoch: 130, Steps: 13 | Train Loss: 0.0148164  Vali Loss: 0.0167864 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 131 cost time: 1.2423429489135742
VALI: Epoch: 131, Steps: 13 | Train Loss: 0.0171373  Vali Loss: 0.0167864 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 132 cost time: 1.2409946918487549
VALI: Epoch: 132, Steps: 13 | Train Loss: 0.0160863  Vali Loss: 0.0167859 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9875566  Test weighted F1: 0.9875777  Test macro F1 0.9843176 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 73347
pruned model Parameter : 76626
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.257042646408081
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0173243  Vali Loss: 0.0156730 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
Validation loss decreased (inf --> 0.015673).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.25362229347229
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0174669  Vali Loss: 0.0156553 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
new best score!!!!
Validation loss decreased (0.015673 --> 0.015655).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 1.2537987232208252
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0156049  Vali Loss: 0.0158089 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 1.2540473937988281
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0181599  Vali Loss: 0.0202787 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943419  Vali macro F1 0.9922963 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 1.2548832893371582
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0164579  Vali Loss: 0.0167974 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9923077 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 1.2542102336883545
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0184283  Vali Loss: 0.0170514 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 1.2552769184112549
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0151368  Vali Loss: 0.0201372 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915223  Vali macro F1 0.9884573 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 8 cost time: 1.2582294940948486
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0205849  Vali Loss: 0.0168025 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 1.2545151710510254
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0171882  Vali Loss: 0.0180242 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9923077 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 1.273669958114624
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0131398  Vali Loss: 0.0174814 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 1.2549552917480469
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0189700  Vali Loss: 0.0175566 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915223  Vali macro F1 0.9884573 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 1.2571916580200195
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0174741  Vali Loss: 0.0186656 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915223  Vali macro F1 0.9884573 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 13 cost time: 1.2528514862060547
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0159885  Vali Loss: 0.0179319 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9923077 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 1.2520027160644531
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0170445  Vali Loss: 0.0170926 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 1.25284743309021
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0155513  Vali Loss: 0.0165938 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 1.2514755725860596
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0139489  Vali Loss: 0.0166529 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 1.2529795169830322
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0164436  Vali Loss: 0.0169410 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9923077 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9898190  Test weighted F1: 0.9898246  Test macro F1 0.9860955 
================ the 1 th CV Experiment ================ 
Overlapping random Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00275482 0.00232558 0.00247525 0.00333333 0.00561798 0.00617284
 0.0031348  0.00288184 0.00239234 0.00378788]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.2317147254943848
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.2840910  Vali Loss: 2.2877699 Vali Accuracy: 0.1327684  Vali weighted F1: 0.0511484  Vali macro F1 0.0407141 
Validation loss decreased (inf --> 2.287770).  Saving model ...
Epoch: 2 cost time: 1.2307326793670654
VALI: Epoch: 2, Steps: 13 | Train Loss: 2.2240071  Vali Loss: 2.1749681 Vali Accuracy: 0.2485876  Vali weighted F1: 0.1664063  Vali macro F1 0.1394547 
new best score!!!!
Validation loss decreased (2.287770 --> 2.174968).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.2325308322906494
VALI: Epoch: 3, Steps: 13 | Train Loss: 2.0036317  Vali Loss: 1.7938615 Vali Accuracy: 0.4519774  Vali weighted F1: 0.4316955  Vali macro F1 0.4041704 
new best score!!!!
Validation loss decreased (2.174968 --> 1.793862).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.231973648071289
VALI: Epoch: 4, Steps: 13 | Train Loss: 1.6240401  Vali Loss: 1.3543087 Vali Accuracy: 0.6412429  Vali weighted F1: 0.6374983  Vali macro F1 0.6334421 
new best score!!!!
Validation loss decreased (1.793862 --> 1.354309).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.230147361755371
VALI: Epoch: 5, Steps: 13 | Train Loss: 1.2921075  Vali Loss: 1.1126467 Vali Accuracy: 0.6271186  Vali weighted F1: 0.6253151  Vali macro F1 0.6118250 
new best score!!!!
Validation loss decreased (1.354309 --> 1.112647).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.231572151184082
VALI: Epoch: 6, Steps: 13 | Train Loss: 1.0755784  Vali Loss: 0.9375693 Vali Accuracy: 0.7090395  Vali weighted F1: 0.7028925  Vali macro F1 0.6940903 
new best score!!!!
Validation loss decreased (1.112647 --> 0.937569).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.2309465408325195
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.9220833  Vali Loss: 0.8338071 Vali Accuracy: 0.7231638  Vali weighted F1: 0.7203007  Vali macro F1 0.7147870 
new best score!!!!
Validation loss decreased (0.937569 --> 0.833807).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.2343659400939941
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.7832327  Vali Loss: 0.7361333 Vali Accuracy: 0.7570621  Vali weighted F1: 0.7343859  Vali macro F1 0.7187009 
new best score!!!!
Validation loss decreased (0.833807 --> 0.736133).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.2311112880706787
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.6919680  Vali Loss: 0.6464360 Vali Accuracy: 0.7853107  Vali weighted F1: 0.7766131  Vali macro F1 0.7646472 
new best score!!!!
Validation loss decreased (0.736133 --> 0.646436).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.232469081878662
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.6092333  Vali Loss: 0.5807160 Vali Accuracy: 0.7994350  Vali weighted F1: 0.7916503  Vali macro F1 0.7753291 
new best score!!!!
Validation loss decreased (0.646436 --> 0.580716).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.2313714027404785
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.5444938  Vali Loss: 0.5213885 Vali Accuracy: 0.8135593  Vali weighted F1: 0.7884602  Vali macro F1 0.7648451 
new best score!!!!
Validation loss decreased (0.580716 --> 0.521389).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.2330222129821777
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.5057267  Vali Loss: 0.4782392 Vali Accuracy: 0.8361582  Vali weighted F1: 0.8214906  Vali macro F1 0.8026165 
new best score!!!!
Validation loss decreased (0.521389 --> 0.478239).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.2306785583496094
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.4640582  Vali Loss: 0.4422627 Vali Accuracy: 0.8474576  Vali weighted F1: 0.8442424  Vali macro F1 0.8257432 
new best score!!!!
Validation loss decreased (0.478239 --> 0.442263).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.2303998470306396
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.4274317  Vali Loss: 0.4140234 Vali Accuracy: 0.8474576  Vali weighted F1: 0.8232639  Vali macro F1 0.7966467 
new best score!!!!
Validation loss decreased (0.442263 --> 0.414023).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.2332606315612793
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.3935234  Vali Loss: 0.3888964 Vali Accuracy: 0.8757062  Vali weighted F1: 0.8536852  Vali macro F1 0.8288855 
new best score!!!!
Validation loss decreased (0.414023 --> 0.388896).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.23069167137146
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.3648579  Vali Loss: 0.3584486 Vali Accuracy: 0.8870056  Vali weighted F1: 0.8764535  Vali macro F1 0.8572316 
new best score!!!!
Validation loss decreased (0.388896 --> 0.358449).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.2313153743743896
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.3411732  Vali Loss: 0.3347567 Vali Accuracy: 0.9067797  Vali weighted F1: 0.8982478  Vali macro F1 0.8752378 
new best score!!!!
Validation loss decreased (0.358449 --> 0.334757).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.2343509197235107
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.3268967  Vali Loss: 0.3427245 Vali Accuracy: 0.8644068  Vali weighted F1: 0.8422090  Vali macro F1 0.8156664 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 1.2343614101409912
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.3000840  Vali Loss: 0.3020813 Vali Accuracy: 0.8926554  Vali weighted F1: 0.8707778  Vali macro F1 0.8432986 
new best score!!!!
Validation loss decreased (0.334757 --> 0.302081).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.2329943180084229
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.2720039  Vali Loss: 0.2746129 Vali Accuracy: 0.9096045  Vali weighted F1: 0.8947273  Vali macro F1 0.8683431 
new best score!!!!
Validation loss decreased (0.302081 --> 0.274613).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.2412543296813965
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.2547642  Vali Loss: 0.2624367 Vali Accuracy: 0.9096045  Vali weighted F1: 0.9030414  Vali macro F1 0.8806162 
new best score!!!!
Validation loss decreased (0.274613 --> 0.262437).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.2354357242584229
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.2457431  Vali Loss: 0.2521257 Vali Accuracy: 0.9180791  Vali weighted F1: 0.9022177  Vali macro F1 0.8755315 
new best score!!!!
Validation loss decreased (0.262437 --> 0.252126).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.2397689819335938
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.2259736  Vali Loss: 0.2426173 Vali Accuracy: 0.9265537  Vali weighted F1: 0.9225993  Vali macro F1 0.9043635 
new best score!!!!
Validation loss decreased (0.252126 --> 0.242617).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.2341992855072021
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.2201798  Vali Loss: 0.2286517 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9352092  Vali macro F1 0.9205826 
new best score!!!!
Validation loss decreased (0.242617 --> 0.228652).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.234398603439331
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.1975430  Vali Loss: 0.2117382 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9079204  Vali macro F1 0.8808920 
new best score!!!!
Validation loss decreased (0.228652 --> 0.211738).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.2504057884216309
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.1954952  Vali Loss: 0.2099103 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9025051  Vali macro F1 0.8731861 
new best score!!!!
Validation loss decreased (0.211738 --> 0.209910).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.2365036010742188
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.1843191  Vali Loss: 0.1963883 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9573304  Vali macro F1 0.9477049 
new best score!!!!
Validation loss decreased (0.209910 --> 0.196388).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 1.237414836883545
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.1737774  Vali Loss: 0.2155083 Vali Accuracy: 0.9180791  Vali weighted F1: 0.9032937  Vali macro F1 0.8757295 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 1.2359716892242432
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.1657951  Vali Loss: 0.1924146 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9202317  Vali macro F1 0.8971936 
new best score!!!!
Validation loss decreased (0.196388 --> 0.192415).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.237281084060669
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.1643576  Vali Loss: 0.1726119 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9594893  Vali macro F1 0.9490444 
new best score!!!!
Validation loss decreased (0.192415 --> 0.172612).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 1.2376465797424316
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.1569455  Vali Loss: 0.1880266 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9513139  Vali macro F1 0.9420439 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 1.2365891933441162
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.1506416  Vali Loss: 0.1894152 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9506298  Vali macro F1 0.9398464 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 1.236459732055664
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.1442062  Vali Loss: 0.1589869 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9601589  Vali macro F1 0.9499561 
new best score!!!!
Validation loss decreased (0.172612 --> 0.158987).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 1.2385892868041992
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.1440653  Vali Loss: 0.1546359 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9604514  Vali macro F1 0.9520863 
new best score!!!!
Validation loss decreased (0.158987 --> 0.154636).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.2363505363464355
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.1296436  Vali Loss: 0.1579461 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9353621  Vali macro F1 0.9163273 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 1.2366864681243896
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.1234405  Vali Loss: 0.1550881 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9687414  Vali macro F1 0.9633736 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 1.2364795207977295
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.1183158  Vali Loss: 0.1430580 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9491534  Vali macro F1 0.9335061 
new best score!!!!
Validation loss decreased (0.154636 --> 0.143058).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 1.2364685535430908
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.1143674  Vali Loss: 0.1299288 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9658660  Vali macro F1 0.9578595 
new best score!!!!
Validation loss decreased (0.143058 --> 0.129929).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 1.236009120941162
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.1190603  Vali Loss: 0.1276868 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9658648  Vali macro F1 0.9575074 
new best score!!!!
Validation loss decreased (0.129929 --> 0.127687).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 1.2366344928741455
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.1161243  Vali Loss: 0.1535730 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9716438  Vali macro F1 0.9671931 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 1.237422227859497
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.1121719  Vali Loss: 0.1212033 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9715642  Vali macro F1 0.9656190 
new best score!!!!
Validation loss decreased (0.127687 --> 0.121203).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 1.236405372619629
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.1031672  Vali Loss: 0.1117034 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830349  Vali macro F1 0.9796371 
new best score!!!!
Validation loss decreased (0.121203 --> 0.111703).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 1.2359833717346191
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0939996  Vali Loss: 0.1098264 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9743926  Vali macro F1 0.9678702 
new best score!!!!
Validation loss decreased (0.111703 --> 0.109826).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 1.236224889755249
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0890112  Vali Loss: 0.0971690 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773769  Vali macro F1 0.9719334 
new best score!!!!
Validation loss decreased (0.109826 --> 0.097169).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 1.2366201877593994
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0907829  Vali Loss: 0.1345088 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9631275  Vali macro F1 0.9550435 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 1.2362611293792725
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0833795  Vali Loss: 0.0975729 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773011  Vali macro F1 0.9718302 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 1.2371759414672852
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0795172  Vali Loss: 0.0936871 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802473  Vali macro F1 0.9739893 
new best score!!!!
Validation loss decreased (0.097169 --> 0.093687).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 1.2380256652832031
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0847172  Vali Loss: 0.0857553 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858934  Vali macro F1 0.9829247 
new best score!!!!
Validation loss decreased (0.093687 --> 0.085755).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 1.2363691329956055
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0744126  Vali Loss: 0.1037134 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802103  Vali macro F1 0.9770395 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 1.2366671562194824
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0761703  Vali Loss: 0.0927986 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802061  Vali macro F1 0.9772511 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 1.2359511852264404
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0704620  Vali Loss: 0.0795716 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858991  Vali macro F1 0.9816844 
new best score!!!!
Validation loss decreased (0.085755 --> 0.079572).  Saving model ...
new best score!!!!
Epoch: 52 cost time: 1.2370479106903076
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0661101  Vali Loss: 0.0931064 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9772953  Vali macro F1 0.9712182 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 1.235931396484375
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0639251  Vali Loss: 0.0948612 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9654434  Vali macro F1 0.9538332 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 1.2381446361541748
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0724114  Vali Loss: 0.0628356 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915252  Vali macro F1 0.9911969 
new best score!!!!
Validation loss decreased (0.079572 --> 0.062836).  Saving model ...
new best score!!!!
Epoch: 55 cost time: 1.2384147644042969
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0679322  Vali Loss: 0.0853236 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858664  Vali macro F1 0.9849443 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 1.2405521869659424
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0580188  Vali Loss: 0.0735296 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801591  Vali macro F1 0.9769696 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 57 cost time: 1.2380008697509766
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0529850  Vali Loss: 0.0720160 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830229  Vali macro F1 0.9808688 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 58 cost time: 1.2371242046356201
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0564454  Vali Loss: 0.0631153 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915252  Vali macro F1 0.9911969 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 59 cost time: 1.2563557624816895
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0490046  Vali Loss: 0.0599641 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915509  Vali macro F1 0.9893796 
new best score!!!!
Validation loss decreased (0.062836 --> 0.059964).  Saving model ...
new best score!!!!
Epoch: 60 cost time: 1.2385618686676025
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0469883  Vali Loss: 0.0857875 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801847  Vali macro F1 0.9751522 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 61 cost time: 1.2369580268859863
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0506691  Vali Loss: 0.0673190 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858761  Vali macro F1 0.9847535 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 62 cost time: 1.237623929977417
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0570351  Vali Loss: 0.0570571 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887014  Vali macro F1 0.9873522 
new best score!!!!
Validation loss decreased (0.059964 --> 0.057057).  Saving model ...
new best score!!!!
Epoch: 63 cost time: 1.238224983215332
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0492101  Vali Loss: 0.0595550 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858324  Vali macro F1 0.9861762 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 64 cost time: 1.2373101711273193
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0536004  Vali Loss: 0.0607967 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830229  Vali macro F1 0.9808688 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 65 cost time: 1.2354178428649902
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0540648  Vali Loss: 0.0512665 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915509  Vali macro F1 0.9893796 
new best score!!!!
Validation loss decreased (0.057057 --> 0.051267).  Saving model ...
new best score!!!!
Epoch: 66 cost time: 1.2351622581481934
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0411974  Vali Loss: 0.0602562 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886999  Vali macro F1 0.9885982 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 67 cost time: 1.2346858978271484
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0379578  Vali Loss: 0.0476537 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886933  Vali macro F1 0.9869904 
new best score!!!!
Validation loss decreased (0.051267 --> 0.047654).  Saving model ...
new best score!!!!
Epoch: 68 cost time: 1.2347300052642822
VALI: Epoch: 68, Steps: 13 | Train Loss: 0.0439821  Vali Loss: 0.0398991 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915237  Vali macro F1 0.9913067 
new best score!!!!
Validation loss decreased (0.047654 --> 0.039899).  Saving model ...
new best score!!!!
Epoch: 69 cost time: 1.2343883514404297
VALI: Epoch: 69, Steps: 13 | Train Loss: 0.0319828  Vali Loss: 0.0448455 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886999  Vali macro F1 0.9885982 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 70 cost time: 1.2353630065917969
VALI: Epoch: 70, Steps: 13 | Train Loss: 0.0393953  Vali Loss: 0.0530278 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886999  Vali macro F1 0.9885982 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 71 cost time: 1.2354378700256348
VALI: Epoch: 71, Steps: 13 | Train Loss: 0.0462411  Vali Loss: 0.0586906 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830389  Vali macro F1 0.9821393 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 72 cost time: 1.235698938369751
VALI: Epoch: 72, Steps: 13 | Train Loss: 0.0399906  Vali Loss: 0.0482328 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886999  Vali macro F1 0.9885982 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 73 cost time: 1.235598087310791
VALI: Epoch: 73, Steps: 13 | Train Loss: 0.0372972  Vali Loss: 0.0438959 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886999  Vali macro F1 0.9885982 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 74 cost time: 1.234961986541748
VALI: Epoch: 74, Steps: 13 | Train Loss: 0.0302280  Vali Loss: 0.0416710 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886999  Vali macro F1 0.9885982 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 75 cost time: 1.234142541885376
VALI: Epoch: 75, Steps: 13 | Train Loss: 0.0258877  Vali Loss: 0.0426765 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886999  Vali macro F1 0.9885982 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 76 cost time: 1.2351458072662354
VALI: Epoch: 76, Steps: 13 | Train Loss: 0.0257182  Vali Loss: 0.0413409 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886999  Vali macro F1 0.9885982 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 77 cost time: 1.2371909618377686
VALI: Epoch: 77, Steps: 13 | Train Loss: 0.0262055  Vali Loss: 0.0416396 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915252  Vali macro F1 0.9911969 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 78 cost time: 1.237130880355835
VALI: Epoch: 78, Steps: 13 | Train Loss: 0.0279685  Vali Loss: 0.0423134 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915252  Vali macro F1 0.9911969 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 79 cost time: 1.2356879711151123
VALI: Epoch: 79, Steps: 13 | Train Loss: 0.0270640  Vali Loss: 0.0423436 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915252  Vali macro F1 0.9911969 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 80 cost time: 1.2353878021240234
VALI: Epoch: 80, Steps: 13 | Train Loss: 0.0254685  Vali Loss: 0.0423935 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915252  Vali macro F1 0.9911969 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 81 cost time: 1.2351632118225098
VALI: Epoch: 81, Steps: 13 | Train Loss: 0.0244291  Vali Loss: 0.0424764 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915252  Vali macro F1 0.9911969 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 82 cost time: 1.236260175704956
VALI: Epoch: 82, Steps: 13 | Train Loss: 0.0276384  Vali Loss: 0.0426645 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915252  Vali macro F1 0.9911969 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 83 cost time: 1.2376015186309814
VALI: Epoch: 83, Steps: 13 | Train Loss: 0.0270223  Vali Loss: 0.0428126 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915252  Vali macro F1 0.9911969 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9830317  Test weighted F1: 0.9830201  Test macro F1 0.9832656 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 73347
pruned model Parameter : 76626
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.2605061531066895
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0334671  Vali Loss: 0.0468262 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886988  Vali macro F1 0.9887084 
Validation loss decreased (inf --> 0.046826).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.2576210498809814
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0344741  Vali Loss: 0.0448894 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915509  Vali macro F1 0.9893796 
new best score!!!!
Validation loss decreased (0.046826 --> 0.044889).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 1.2584118843078613
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0362546  Vali Loss: 0.0467296 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915509  Vali macro F1 0.9893796 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 1.2636725902557373
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0311363  Vali Loss: 0.0491960 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887255  Vali macro F1 0.9867809 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 1.2587618827819824
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0314965  Vali Loss: 0.0477042 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915509  Vali macro F1 0.9893796 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 1.2610387802124023
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0342930  Vali Loss: 0.0491457 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887255  Vali macro F1 0.9867809 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 1.2559797763824463
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0326846  Vali Loss: 0.0515759 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887255  Vali macro F1 0.9867809 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 8 cost time: 1.2566516399383545
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0311264  Vali Loss: 0.0464086 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915252  Vali macro F1 0.9911969 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 1.2760381698608398
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0294480  Vali Loss: 0.0477617 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915252  Vali macro F1 0.9911969 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 1.2554497718811035
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0259989  Vali Loss: 0.0467828 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915252  Vali macro F1 0.9911969 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 1.2561655044555664
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0304486  Vali Loss: 0.0482065 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915252  Vali macro F1 0.9911969 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 1.2553415298461914
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0305459  Vali Loss: 0.0505102 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886999  Vali macro F1 0.9885982 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 13 cost time: 1.2557106018066406
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0255043  Vali Loss: 0.0501555 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886999  Vali macro F1 0.9885982 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 1.254387378692627
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0282352  Vali Loss: 0.0499209 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886999  Vali macro F1 0.9885982 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 1.2548210620880127
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0263498  Vali Loss: 0.0498467 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886999  Vali macro F1 0.9885982 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 1.2565908432006836
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0251933  Vali Loss: 0.0497603 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886999  Vali macro F1 0.9885982 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 1.25575852394104
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0299570  Vali Loss: 0.0489267 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886999  Vali macro F1 0.9885982 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9841629  Test weighted F1: 0.9841698  Test macro F1 0.9822086 
================ the 2 th CV Experiment ================ 
Overlapping random Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.00268097 0.00233645 0.0025     0.00338983 0.00584795 0.00595238
 0.0030581  0.00294118 0.00234742 0.00389105]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.236833095550537
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.2826555  Vali Loss: 2.2848617 Vali Accuracy: 0.1242938  Vali weighted F1: 0.0412960  Vali macro F1 0.0323362 
Validation loss decreased (inf --> 2.284862).  Saving model ...
Epoch: 2 cost time: 1.2368128299713135
VALI: Epoch: 2, Steps: 13 | Train Loss: 2.2198350  Vali Loss: 2.1520585 Vali Accuracy: 0.3446328  Vali weighted F1: 0.2622887  Vali macro F1 0.2262090 
new best score!!!!
Validation loss decreased (2.284862 --> 2.152058).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.2335565090179443
VALI: Epoch: 3, Steps: 13 | Train Loss: 1.9803103  Vali Loss: 1.7621118 Vali Accuracy: 0.4717514  Vali weighted F1: 0.4340933  Vali macro F1 0.4079006 
new best score!!!!
Validation loss decreased (2.152058 --> 1.762112).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.235236644744873
VALI: Epoch: 4, Steps: 13 | Train Loss: 1.6089529  Vali Loss: 1.3510552 Vali Accuracy: 0.6073446  Vali weighted F1: 0.5814396  Vali macro F1 0.5709426 
new best score!!!!
Validation loss decreased (1.762112 --> 1.351055).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.236037015914917
VALI: Epoch: 5, Steps: 13 | Train Loss: 1.2848087  Vali Loss: 1.0989165 Vali Accuracy: 0.6073446  Vali weighted F1: 0.5844498  Vali macro F1 0.5851729 
new best score!!!!
Validation loss decreased (1.351055 --> 1.098917).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.2355382442474365
VALI: Epoch: 6, Steps: 13 | Train Loss: 1.0551369  Vali Loss: 0.9334678 Vali Accuracy: 0.6694915  Vali weighted F1: 0.6282142  Vali macro F1 0.6213773 
new best score!!!!
Validation loss decreased (1.098917 --> 0.933468).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.2341172695159912
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.8870263  Vali Loss: 0.8054645 Vali Accuracy: 0.7429379  Vali weighted F1: 0.7203335  Vali macro F1 0.7049939 
new best score!!!!
Validation loss decreased (0.933468 --> 0.805465).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.2355551719665527
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.7600347  Vali Loss: 0.7184268 Vali Accuracy: 0.7655367  Vali weighted F1: 0.7649100  Vali macro F1 0.7583545 
new best score!!!!
Validation loss decreased (0.805465 --> 0.718427).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.235175609588623
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.6675015  Vali Loss: 0.6289016 Vali Accuracy: 0.8022599  Vali weighted F1: 0.7989969  Vali macro F1 0.7895080 
new best score!!!!
Validation loss decreased (0.718427 --> 0.628902).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.234837293624878
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.5911550  Vali Loss: 0.5652345 Vali Accuracy: 0.8192090  Vali weighted F1: 0.8168197  Vali macro F1 0.8042184 
new best score!!!!
Validation loss decreased (0.628902 --> 0.565234).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.2385098934173584
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.5303197  Vali Loss: 0.5044706 Vali Accuracy: 0.8418079  Vali weighted F1: 0.8345280  Vali macro F1 0.8139722 
new best score!!!!
Validation loss decreased (0.565234 --> 0.504471).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.2382326126098633
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.4865513  Vali Loss: 0.4694290 Vali Accuracy: 0.8502825  Vali weighted F1: 0.8419905  Vali macro F1 0.8234063 
new best score!!!!
Validation loss decreased (0.504471 --> 0.469429).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.236767053604126
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.4489196  Vali Loss: 0.4411198 Vali Accuracy: 0.8672316  Vali weighted F1: 0.8470023  Vali macro F1 0.8187972 
new best score!!!!
Validation loss decreased (0.469429 --> 0.441120).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.2366924285888672
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.4170081  Vali Loss: 0.4287209 Vali Accuracy: 0.8502825  Vali weighted F1: 0.8433276  Vali macro F1 0.8275776 
new best score!!!!
Validation loss decreased (0.441120 --> 0.428721).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.23771333694458
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.3951974  Vali Loss: 0.3956869 Vali Accuracy: 0.8757062  Vali weighted F1: 0.8510148  Vali macro F1 0.8192647 
new best score!!!!
Validation loss decreased (0.428721 --> 0.395687).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.2366886138916016
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.3578029  Vali Loss: 0.3725528 Vali Accuracy: 0.8841808  Vali weighted F1: 0.8594008  Vali macro F1 0.8284039 
new best score!!!!
Validation loss decreased (0.395687 --> 0.372553).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.236889362335205
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.3374164  Vali Loss: 0.3362763 Vali Accuracy: 0.8983051  Vali weighted F1: 0.8834221  Vali macro F1 0.8572855 
new best score!!!!
Validation loss decreased (0.372553 --> 0.336276).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.237285852432251
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.3197551  Vali Loss: 0.3299194 Vali Accuracy: 0.8870056  Vali weighted F1: 0.8656071  Vali macro F1 0.8362721 
new best score!!!!
Validation loss decreased (0.336276 --> 0.329919).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.2346715927124023
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.2960162  Vali Loss: 0.3144041 Vali Accuracy: 0.8926554  Vali weighted F1: 0.8863769  Vali macro F1 0.8577495 
new best score!!!!
Validation loss decreased (0.329919 --> 0.314404).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.2423896789550781
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.2767474  Vali Loss: 0.2899495 Vali Accuracy: 0.8983051  Vali weighted F1: 0.8737163  Vali macro F1 0.8413347 
new best score!!!!
Validation loss decreased (0.314404 --> 0.289949).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.2390570640563965
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.2536743  Vali Loss: 0.2672876 Vali Accuracy: 0.9039548  Vali weighted F1: 0.8792946  Vali macro F1 0.8457680 
new best score!!!!
Validation loss decreased (0.289949 --> 0.267288).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.240020990371704
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.2437554  Vali Loss: 0.2641059 Vali Accuracy: 0.9124294  Vali weighted F1: 0.9006434  Vali macro F1 0.8733548 
new best score!!!!
Validation loss decreased (0.267288 --> 0.264106).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.2374041080474854
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.2232960  Vali Loss: 0.2621658 Vali Accuracy: 0.8926554  Vali weighted F1: 0.8694359  Vali macro F1 0.8370071 
new best score!!!!
Validation loss decreased (0.264106 --> 0.262166).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.2545619010925293
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.2221818  Vali Loss: 0.2368924 Vali Accuracy: 0.9039548  Vali weighted F1: 0.8866793  Vali macro F1 0.8570739 
new best score!!!!
Validation loss decreased (0.262166 --> 0.236892).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.2417714595794678
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.2021077  Vali Loss: 0.2341285 Vali Accuracy: 0.9096045  Vali weighted F1: 0.8896621  Vali macro F1 0.8564698 
new best score!!!!
Validation loss decreased (0.236892 --> 0.234128).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.2406456470489502
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.1925723  Vali Loss: 0.1999669 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9326919  Vali macro F1 0.9155797 
new best score!!!!
Validation loss decreased (0.234128 --> 0.199967).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.2408874034881592
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.1863454  Vali Loss: 0.2068976 Vali Accuracy: 0.9180791  Vali weighted F1: 0.9009302  Vali macro F1 0.8688175 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 1.238466739654541
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.1819735  Vali Loss: 0.1953807 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9434626  Vali macro F1 0.9271886 
new best score!!!!
Validation loss decreased (0.199967 --> 0.195381).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.2415509223937988
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.1658906  Vali Loss: 0.2042141 Vali Accuracy: 0.9124294  Vali weighted F1: 0.8960310  Vali macro F1 0.8646062 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 1.2393128871917725
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.1678721  Vali Loss: 0.1766029 Vali Accuracy: 0.9265537  Vali weighted F1: 0.9174439  Vali macro F1 0.8934952 
new best score!!!!
Validation loss decreased (0.195381 --> 0.176603).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 1.2414600849151611
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.1512874  Vali Loss: 0.1789907 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9352799  Vali macro F1 0.9188770 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 1.2402501106262207
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.1464936  Vali Loss: 0.1891589 Vali Accuracy: 0.9124294  Vali weighted F1: 0.8952619  Vali macro F1 0.8649000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 1.2383508682250977
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.1556875  Vali Loss: 0.1627656 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9452305  Vali macro F1 0.9279454 
new best score!!!!
Validation loss decreased (0.176603 --> 0.162766).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 1.2397806644439697
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.1485573  Vali Loss: 0.1551201 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9504890  Vali macro F1 0.9352900 
new best score!!!!
Validation loss decreased (0.162766 --> 0.155120).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.238670825958252
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.1405813  Vali Loss: 0.1694801 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9158496  Vali macro F1 0.8961278 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 1.2393016815185547
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.1256619  Vali Loss: 0.1563544 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9391703  Vali macro F1 0.9198804 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 1.2395362854003906
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.1242107  Vali Loss: 0.1558517 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9463538  Vali macro F1 0.9296610 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 1.239241600036621
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.1230160  Vali Loss: 0.1406924 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9544779  Vali macro F1 0.9434632 
new best score!!!!
Validation loss decreased (0.155120 --> 0.140692).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 1.2399044036865234
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.1205789  Vali Loss: 0.1471834 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9435311  Vali macro F1 0.9274155 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 1.2370877265930176
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.1185802  Vali Loss: 0.1379043 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9543743  Vali macro F1 0.9418282 
new best score!!!!
Validation loss decreased (0.140692 --> 0.137904).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 1.2358946800231934
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.1108046  Vali Loss: 0.1283990 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9571958  Vali macro F1 0.9444228 
new best score!!!!
Validation loss decreased (0.137904 --> 0.128399).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 1.2376799583435059
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.1057892  Vali Loss: 0.1378395 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9329860  Vali macro F1 0.9103567 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 1.237558126449585
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.1077760  Vali Loss: 0.1161465 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9657502  Vali macro F1 0.9544701 
new best score!!!!
Validation loss decreased (0.128399 --> 0.116147).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 1.2367331981658936
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0986939  Vali Loss: 0.1242610 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9655275  Vali macro F1 0.9546632 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 1.2359857559204102
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0945694  Vali Loss: 0.1039039 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9689220  Vali macro F1 0.9603892 
new best score!!!!
Validation loss decreased (0.116147 --> 0.103904).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 1.2345337867736816
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0969424  Vali Loss: 0.1041571 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9688181  Vali macro F1 0.9602470 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 1.2371892929077148
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0943694  Vali Loss: 0.1023257 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9688224  Vali macro F1 0.9602516 
new best score!!!!
Validation loss decreased (0.103904 --> 0.102326).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 1.2356352806091309
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0921632  Vali Loss: 0.1108728 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9657549  Vali macro F1 0.9541864 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 1.236583948135376
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0876647  Vali Loss: 0.1158838 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774100  Vali macro F1 0.9732275 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 1.2386183738708496
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0788580  Vali Loss: 0.0755069 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858705  Vali macro F1 0.9807621 
new best score!!!!
Validation loss decreased (0.102326 --> 0.075507).  Saving model ...
new best score!!!!
Epoch: 51 cost time: 1.2352871894836426
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0759534  Vali Loss: 0.0773572 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802253  Vali macro F1 0.9746748 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 1.2364792823791504
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0779955  Vali Loss: 0.0818200 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830760  Vali macro F1 0.9764610 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 53 cost time: 1.2413792610168457
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0795553  Vali Loss: 0.0760786 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773344  Vali macro F1 0.9707387 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 54 cost time: 1.2351605892181396
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0708849  Vali Loss: 0.0789779 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831961  Vali macro F1 0.9772740 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 55 cost time: 1.2351725101470947
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0677810  Vali Loss: 0.0802390 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9714490  Vali macro F1 0.9641206 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 56 cost time: 1.2374591827392578
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0628996  Vali Loss: 0.0748337 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858893  Vali macro F1 0.9802915 
new best score!!!!
Validation loss decreased (0.075507 --> 0.074834).  Saving model ...
new best score!!!!
Epoch: 57 cost time: 1.2366111278533936
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0579224  Vali Loss: 0.0694377 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887278  Vali macro F1 0.9841562 
new best score!!!!
Validation loss decreased (0.074834 --> 0.069438).  Saving model ...
new best score!!!!
Epoch: 58 cost time: 1.2489025592803955
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0566249  Vali Loss: 0.0669116 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887278  Vali macro F1 0.9841562 
new best score!!!!
Validation loss decreased (0.069438 --> 0.066912).  Saving model ...
new best score!!!!
Epoch: 59 cost time: 1.2353930473327637
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0560077  Vali Loss: 0.0655315 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887278  Vali macro F1 0.9841562 
new best score!!!!
Validation loss decreased (0.066912 --> 0.065531).  Saving model ...
new best score!!!!
Epoch: 60 cost time: 1.2374563217163086
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0541845  Vali Loss: 0.0648297 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887278  Vali macro F1 0.9841562 
new best score!!!!
Validation loss decreased (0.065531 --> 0.064830).  Saving model ...
new best score!!!!
Epoch: 61 cost time: 1.234187364578247
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0522783  Vali Loss: 0.0621218 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859061  Vali macro F1 0.9803143 
new best score!!!!
Validation loss decreased (0.064830 --> 0.062122).  Saving model ...
new best score!!!!
Epoch: 62 cost time: 1.2368354797363281
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0520997  Vali Loss: 0.0634851 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887278  Vali macro F1 0.9841562 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 63 cost time: 1.2355482578277588
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0535920  Vali Loss: 0.0613783 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830760  Vali macro F1 0.9764610 
new best score!!!!
Validation loss decreased (0.062122 --> 0.061378).  Saving model ...
new best score!!!!
Epoch: 64 cost time: 1.2354259490966797
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0551505  Vali Loss: 0.0595595 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830760  Vali macro F1 0.9764610 
new best score!!!!
Validation loss decreased (0.061378 --> 0.059559).  Saving model ...
new best score!!!!
Epoch: 65 cost time: 1.2363829612731934
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0533855  Vali Loss: 0.0620164 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887278  Vali macro F1 0.9841562 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 66 cost time: 1.2363970279693604
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0575714  Vali Loss: 0.0621718 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887278  Vali macro F1 0.9841562 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 67 cost time: 1.2363650798797607
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0568551  Vali Loss: 0.0639628 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859022  Vali macro F1 0.9819079 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 68 cost time: 1.2360689640045166
VALI: Epoch: 68, Steps: 13 | Train Loss: 0.0532035  Vali Loss: 0.0604357 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859061  Vali macro F1 0.9803143 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 69 cost time: 1.2356131076812744
VALI: Epoch: 69, Steps: 13 | Train Loss: 0.0496350  Vali Loss: 0.0619705 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859061  Vali macro F1 0.9803143 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 70 cost time: 1.234956979751587
VALI: Epoch: 70, Steps: 13 | Train Loss: 0.0555919  Vali Loss: 0.0618199 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859061  Vali macro F1 0.9803143 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 71 cost time: 1.2358720302581787
VALI: Epoch: 71, Steps: 13 | Train Loss: 0.0525770  Vali Loss: 0.0613126 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859061  Vali macro F1 0.9803143 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 72 cost time: 1.2356266975402832
VALI: Epoch: 72, Steps: 13 | Train Loss: 0.0508181  Vali Loss: 0.0610870 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859061  Vali macro F1 0.9803143 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 73 cost time: 1.2403450012207031
VALI: Epoch: 73, Steps: 13 | Train Loss: 0.0506064  Vali Loss: 0.0609013 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859061  Vali macro F1 0.9803143 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 74 cost time: 1.2398207187652588
VALI: Epoch: 74, Steps: 13 | Train Loss: 0.0484139  Vali Loss: 0.0604704 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859061  Vali macro F1 0.9803143 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 75 cost time: 1.24021577835083
VALI: Epoch: 75, Steps: 13 | Train Loss: 0.0510273  Vali Loss: 0.0604429 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859061  Vali macro F1 0.9803143 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 76 cost time: 1.2333807945251465
VALI: Epoch: 76, Steps: 13 | Train Loss: 0.0500059  Vali Loss: 0.0604119 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859061  Vali macro F1 0.9803143 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 77 cost time: 1.2336690425872803
VALI: Epoch: 77, Steps: 13 | Train Loss: 0.0525117  Vali Loss: 0.0603958 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859061  Vali macro F1 0.9803143 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 78 cost time: 1.2351958751678467
VALI: Epoch: 78, Steps: 13 | Train Loss: 0.0492782  Vali Loss: 0.0603707 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859061  Vali macro F1 0.9803143 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 79 cost time: 1.2346727848052979
VALI: Epoch: 79, Steps: 13 | Train Loss: 0.0505842  Vali Loss: 0.0603525 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859061  Vali macro F1 0.9803143 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9841629  Test weighted F1: 0.9841860  Test macro F1 0.9799303 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 73347
pruned model Parameter : 76626
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.264216661453247
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0543128  Vali Loss: 0.0731875 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830760  Vali macro F1 0.9764610 
Validation loss decreased (inf --> 0.073187).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.259932041168213
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0544227  Vali Loss: 0.0669711 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887219  Vali macro F1 0.9857469 
new best score!!!!
Validation loss decreased (0.073187 --> 0.066971).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 1.2589390277862549
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0568644  Vali Loss: 0.0625900 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830760  Vali macro F1 0.9764610 
new best score!!!!
Validation loss decreased (0.066971 --> 0.062590).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 1.2580780982971191
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0529422  Vali Loss: 0.0601510 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915474  Vali macro F1 0.9879952 
new best score!!!!
Validation loss decreased (0.062590 --> 0.060151).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 1.2592642307281494
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0518610  Vali Loss: 0.0612402 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887278  Vali macro F1 0.9841562 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 1.2625861167907715
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0489660  Vali Loss: 0.0590041 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887278  Vali macro F1 0.9841562 
new best score!!!!
Validation loss decreased (0.060151 --> 0.059004).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 1.2652785778045654
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0516988  Vali Loss: 0.0627387 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887278  Vali macro F1 0.9841562 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 1.2586660385131836
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0488945  Vali Loss: 0.0603887 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859061  Vali macro F1 0.9803143 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 1.264977216720581
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0472311  Vali Loss: 0.0541628 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887278  Vali macro F1 0.9841562 
new best score!!!!
Validation loss decreased (0.059004 --> 0.054163).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 1.2592356204986572
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0504986  Vali Loss: 0.0540842 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915474  Vali macro F1 0.9879952 
new best score!!!!
Validation loss decreased (0.054163 --> 0.054084).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 1.2558176517486572
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0468881  Vali Loss: 0.0538199 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915474  Vali macro F1 0.9879952 
new best score!!!!
Validation loss decreased (0.054084 --> 0.053820).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 1.25581955909729
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0461836  Vali Loss: 0.0559114 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887266  Vali macro F1 0.9854632 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 1.2687807083129883
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0447204  Vali Loss: 0.0596929 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830852  Vali macro F1 0.9777823 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 1.266770601272583
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0465851  Vali Loss: 0.0518464 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915474  Vali macro F1 0.9879952 
new best score!!!!
Validation loss decreased (0.053820 --> 0.051846).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 1.2623083591461182
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0498055  Vali Loss: 0.0534838 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887278  Vali macro F1 0.9841562 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 1.2620959281921387
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0450823  Vali Loss: 0.0539395 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887278  Vali macro F1 0.9841562 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 1.2615811824798584
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0464680  Vali Loss: 0.0616243 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830852  Vali macro F1 0.9777823 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 1.2654316425323486
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0444199  Vali Loss: 0.0560805 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915474  Vali macro F1 0.9879952 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 1.2628042697906494
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0425387  Vali Loss: 0.0517800 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915558  Vali macro F1 0.9880066 
new best score!!!!
Validation loss decreased (0.051846 --> 0.051780).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 20 cost time: 1.2596497535705566
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0459265  Vali Loss: 0.0470577 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887278  Vali macro F1 0.9841562 
new best score!!!!
Validation loss decreased (0.051780 --> 0.047058).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 21 cost time: 1.260730504989624
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0421721  Vali Loss: 0.0542143 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915558  Vali macro F1 0.9880066 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 1.2604784965515137
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0455420  Vali Loss: 0.0538144 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915558  Vali macro F1 0.9880066 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 1.260709524154663
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0435794  Vali Loss: 0.0501587 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915474  Vali macro F1 0.9879952 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 1.264460802078247
Fine Tuning VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0417203  Vali Loss: 0.0523887 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915558  Vali macro F1 0.9880066 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 25 cost time: 1.2634994983673096
Fine Tuning VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0387581  Vali Loss: 0.0505821 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915474  Vali macro F1 0.9879952 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 26 cost time: 1.2636289596557617
Fine Tuning VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0466027  Vali Loss: 0.0524280 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915558  Vali macro F1 0.9880066 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 27 cost time: 1.2684495449066162
Fine Tuning VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0433883  Vali Loss: 0.0518444 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887278  Vali macro F1 0.9841562 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 28 cost time: 1.2796094417572021
Fine Tuning VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0417428  Vali Loss: 0.0526178 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915474  Vali macro F1 0.9879952 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 29 cost time: 1.2630894184112549
Fine Tuning VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0427901  Vali Loss: 0.0493855 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915558  Vali macro F1 0.9880066 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 30 cost time: 1.2684168815612793
Fine Tuning VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0419882  Vali Loss: 0.0513672 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915558  Vali macro F1 0.9880066 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 31 cost time: 1.2655291557312012
Fine Tuning VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0371368  Vali Loss: 0.0518437 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915558  Vali macro F1 0.9880066 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 32 cost time: 1.2601947784423828
Fine Tuning VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0410358  Vali Loss: 0.0507665 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915558  Vali macro F1 0.9880066 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 33 cost time: 1.2588412761688232
Fine Tuning VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0407476  Vali Loss: 0.0504573 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915558  Vali macro F1 0.9880066 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 34 cost time: 1.2650582790374756
Fine Tuning VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0390388  Vali Loss: 0.0500555 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915558  Vali macro F1 0.9880066 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 35 cost time: 1.2660298347473145
Fine Tuning VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0403123  Vali Loss: 0.0501521 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915558  Vali macro F1 0.9880066 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9864253  Test weighted F1: 0.9864391  Test macro F1 0.9840512 
================ the 3 th CV Experiment ================ 
Overlapping random Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00263158 0.00242718 0.002457   0.003367   0.00598802 0.00571429
 0.00310559 0.002849   0.00240964 0.003861  ]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.240877389907837
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.2834185  Vali Loss: 2.2839175 Vali Accuracy: 0.1271186  Vali weighted F1: 0.0330782  Vali macro F1 0.0265141 
Validation loss decreased (inf --> 2.283918).  Saving model ...
Epoch: 2 cost time: 1.2385313510894775
VALI: Epoch: 2, Steps: 13 | Train Loss: 2.2205574  Vali Loss: 2.1362876 Vali Accuracy: 0.3813559  Vali weighted F1: 0.3273119  Vali macro F1 0.2821517 
new best score!!!!
Validation loss decreased (2.283918 --> 2.136288).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.2367749214172363
VALI: Epoch: 3, Steps: 13 | Train Loss: 1.9776413  Vali Loss: 1.7731200 Vali Accuracy: 0.4774011  Vali weighted F1: 0.4400320  Vali macro F1 0.4211359 
new best score!!!!
Validation loss decreased (2.136288 --> 1.773120).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.2428040504455566
VALI: Epoch: 4, Steps: 13 | Train Loss: 1.6251850  Vali Loss: 1.3906359 Vali Accuracy: 0.5649718  Vali weighted F1: 0.5283127  Vali macro F1 0.5319384 
new best score!!!!
Validation loss decreased (1.773120 --> 1.390636).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.241917610168457
VALI: Epoch: 5, Steps: 13 | Train Loss: 1.3109033  Vali Loss: 1.1339370 Vali Accuracy: 0.6468927  Vali weighted F1: 0.6191601  Vali macro F1 0.6058497 
new best score!!!!
Validation loss decreased (1.390636 --> 1.133937).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.2445614337921143
VALI: Epoch: 6, Steps: 13 | Train Loss: 1.0662243  Vali Loss: 0.9384416 Vali Accuracy: 0.6666667  Vali weighted F1: 0.6462324  Vali macro F1 0.6476822 
new best score!!!!
Validation loss decreased (1.133937 --> 0.938442).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.2383041381835938
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.8947942  Vali Loss: 0.8088065 Vali Accuracy: 0.7259887  Vali weighted F1: 0.7014951  Vali macro F1 0.6861745 
new best score!!!!
Validation loss decreased (0.938442 --> 0.808806).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.2384090423583984
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.7707947  Vali Loss: 0.7062387 Vali Accuracy: 0.7627119  Vali weighted F1: 0.7386660  Vali macro F1 0.7227822 
new best score!!!!
Validation loss decreased (0.808806 --> 0.706239).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.2374255657196045
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.6775844  Vali Loss: 0.6480788 Vali Accuracy: 0.7909605  Vali weighted F1: 0.7886410  Vali macro F1 0.7832223 
new best score!!!!
Validation loss decreased (0.706239 --> 0.648079).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.236893653869629
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.6014156  Vali Loss: 0.5673909 Vali Accuracy: 0.8248588  Vali weighted F1: 0.8229633  Vali macro F1 0.8153594 
new best score!!!!
Validation loss decreased (0.648079 --> 0.567391).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.2654531002044678
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.5493067  Vali Loss: 0.5192199 Vali Accuracy: 0.8418079  Vali weighted F1: 0.8401898  Vali macro F1 0.8269882 
new best score!!!!
Validation loss decreased (0.567391 --> 0.519220).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.2373106479644775
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.4901524  Vali Loss: 0.4789132 Vali Accuracy: 0.8531073  Vali weighted F1: 0.8276317  Vali macro F1 0.7985811 
new best score!!!!
Validation loss decreased (0.519220 --> 0.478913).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.2432310581207275
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.4529766  Vali Loss: 0.4457233 Vali Accuracy: 0.8615819  Vali weighted F1: 0.8545758  Vali macro F1 0.8403015 
new best score!!!!
Validation loss decreased (0.478913 --> 0.445723).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.2368874549865723
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.4270955  Vali Loss: 0.4104750 Vali Accuracy: 0.8644068  Vali weighted F1: 0.8623248  Vali macro F1 0.8436741 
new best score!!!!
Validation loss decreased (0.445723 --> 0.410475).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.243345022201538
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.3997889  Vali Loss: 0.3888264 Vali Accuracy: 0.8813559  Vali weighted F1: 0.8806016  Vali macro F1 0.8632179 
new best score!!!!
Validation loss decreased (0.410475 --> 0.388826).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.239229679107666
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.3667168  Vali Loss: 0.3603764 Vali Accuracy: 0.8841808  Vali weighted F1: 0.8825311  Vali macro F1 0.8641777 
new best score!!!!
Validation loss decreased (0.388826 --> 0.360376).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.2390477657318115
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.3488475  Vali Loss: 0.3305297 Vali Accuracy: 0.9039548  Vali weighted F1: 0.9035547  Vali macro F1 0.8908353 
new best score!!!!
Validation loss decreased (0.360376 --> 0.330530).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.238236665725708
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.3337596  Vali Loss: 0.3289178 Vali Accuracy: 0.8700565  Vali weighted F1: 0.8545044  Vali macro F1 0.8296167 
new best score!!!!
Validation loss decreased (0.330530 --> 0.328918).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.2404227256774902
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.3080707  Vali Loss: 0.3067166 Vali Accuracy: 0.8954802  Vali weighted F1: 0.8766615  Vali macro F1 0.8493835 
new best score!!!!
Validation loss decreased (0.328918 --> 0.306717).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.240170955657959
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.2879207  Vali Loss: 0.2909956 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9159526  Vali macro F1 0.8967884 
new best score!!!!
Validation loss decreased (0.306717 --> 0.290996).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.2423467636108398
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.2757985  Vali Loss: 0.2786656 Vali Accuracy: 0.9124294  Vali weighted F1: 0.9119471  Vali macro F1 0.8945742 
new best score!!!!
Validation loss decreased (0.290996 --> 0.278666).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.241464614868164
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.2731612  Vali Loss: 0.2942871 Vali Accuracy: 0.8898305  Vali weighted F1: 0.8789985  Vali macro F1 0.8559950 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 1.2421202659606934
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.2635352  Vali Loss: 0.2477535 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9268289  Vali macro F1 0.9090065 
new best score!!!!
Validation loss decreased (0.278666 --> 0.247753).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.240457534790039
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.2440738  Vali Loss: 0.2426397 Vali Accuracy: 0.9124294  Vali weighted F1: 0.8911571  Vali macro F1 0.8605816 
new best score!!!!
Validation loss decreased (0.247753 --> 0.242640).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.2424542903900146
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.2336309  Vali Loss: 0.2360085 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9229451  Vali macro F1 0.9046322 
new best score!!!!
Validation loss decreased (0.242640 --> 0.236009).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.2425310611724854
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.2168335  Vali Loss: 0.2221860 Vali Accuracy: 0.9180791  Vali weighted F1: 0.9178829  Vali macro F1 0.8981267 
new best score!!!!
Validation loss decreased (0.236009 --> 0.222186).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.241194248199463
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.2028061  Vali Loss: 0.2147162 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9079037  Vali macro F1 0.8797078 
new best score!!!!
Validation loss decreased (0.222186 --> 0.214716).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 1.2411460876464844
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.2065310  Vali Loss: 0.2203005 Vali Accuracy: 0.9152542  Vali weighted F1: 0.9140070  Vali macro F1 0.8924708 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 1.2435965538024902
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.1965022  Vali Loss: 0.2076637 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9349422  Vali macro F1 0.9159395 
new best score!!!!
Validation loss decreased (0.214716 --> 0.207664).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.2443249225616455
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.1808616  Vali Loss: 0.1931828 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9195215  Vali macro F1 0.8974550 
new best score!!!!
Validation loss decreased (0.207664 --> 0.193183).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 1.2443068027496338
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.1707187  Vali Loss: 0.1841140 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9397944  Vali macro F1 0.9268255 
new best score!!!!
Validation loss decreased (0.193183 --> 0.184114).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 1.2414488792419434
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.1669660  Vali Loss: 0.1831198 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9461412  Vali macro F1 0.9320990 
new best score!!!!
Validation loss decreased (0.184114 --> 0.183120).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 1.2452919483184814
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.1654954  Vali Loss: 0.1731124 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9445983  Vali macro F1 0.9332169 
new best score!!!!
Validation loss decreased (0.183120 --> 0.173112).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 1.2407050132751465
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.1444765  Vali Loss: 0.1723352 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9314596  Vali macro F1 0.9160514 
new best score!!!!
Validation loss decreased (0.173112 --> 0.172335).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.2451927661895752
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.1469043  Vali Loss: 0.1589337 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9497461  Vali macro F1 0.9357461 
new best score!!!!
Validation loss decreased (0.172335 --> 0.158934).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 1.2452280521392822
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.1401539  Vali Loss: 0.1505153 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9417632  Vali macro F1 0.9263274 
new best score!!!!
Validation loss decreased (0.158934 --> 0.150515).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 1.2426955699920654
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.1367967  Vali Loss: 0.1544298 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9481898  Vali macro F1 0.9350775 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 1.2412774562835693
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.1284155  Vali Loss: 0.1447145 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9631931  Vali macro F1 0.9554372 
new best score!!!!
Validation loss decreased (0.150515 --> 0.144715).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 1.2471365928649902
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.1346124  Vali Loss: 0.1359685 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9366167  Vali macro F1 0.9163876 
new best score!!!!
Validation loss decreased (0.144715 --> 0.135969).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 1.2433958053588867
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.1242299  Vali Loss: 0.1231242 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9628921  Vali macro F1 0.9534966 
new best score!!!!
Validation loss decreased (0.135969 --> 0.123124).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 1.2431700229644775
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.1150429  Vali Loss: 0.1216981 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9600669  Vali macro F1 0.9512485 
new best score!!!!
Validation loss decreased (0.123124 --> 0.121698).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 1.2434542179107666
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.1098753  Vali Loss: 0.1118744 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773330  Vali macro F1 0.9702390 
new best score!!!!
Validation loss decreased (0.121698 --> 0.111874).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 1.2415227890014648
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.1122355  Vali Loss: 0.1045719 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773371  Vali macro F1 0.9705976 
new best score!!!!
Validation loss decreased (0.111874 --> 0.104572).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 1.2613551616668701
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0998073  Vali Loss: 0.1031505 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9591501  Vali macro F1 0.9469363 
new best score!!!!
Validation loss decreased (0.104572 --> 0.103151).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 1.2414870262145996
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.1120285  Vali Loss: 0.1044292 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9627032  Vali macro F1 0.9517741 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 1.2418441772460938
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.1144669  Vali Loss: 0.0999902 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9623140  Vali macro F1 0.9514224 
new best score!!!!
Validation loss decreased (0.103151 --> 0.099990).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 1.2412590980529785
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.1054563  Vali Loss: 0.1030407 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9716122  Vali macro F1 0.9644133 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 1.243959665298462
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.1131981  Vali Loss: 0.0920255 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9630020  Vali macro F1 0.9566449 
new best score!!!!
Validation loss decreased (0.099990 --> 0.092026).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 1.2461533546447754
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0978971  Vali Loss: 0.1082197 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9659633  Vali macro F1 0.9594444 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 1.2465875148773193
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0977345  Vali Loss: 0.1108461 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9608286  Vali macro F1 0.9466667 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 1.24546480178833
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.1008352  Vali Loss: 0.0846582 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745695  Vali macro F1 0.9695441 
new best score!!!!
Validation loss decreased (0.092026 --> 0.084658).  Saving model ...
new best score!!!!
Epoch: 52 cost time: 1.2539033889770508
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.1041498  Vali Loss: 0.0823209 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9712801  Vali macro F1 0.9619978 
new best score!!!!
Validation loss decreased (0.084658 --> 0.082321).  Saving model ...
new best score!!!!
Epoch: 53 cost time: 1.2420880794525146
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0904284  Vali Loss: 0.1008212 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9545339  Vali macro F1 0.9392307 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 1.2412941455841064
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0811074  Vali Loss: 0.0728992 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9772140  Vali macro F1 0.9701106 
new best score!!!!
Validation loss decreased (0.082321 --> 0.072899).  Saving model ...
new best score!!!!
Epoch: 55 cost time: 1.2415297031402588
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0754258  Vali Loss: 0.0700394 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9770336  Vali macro F1 0.9698649 
new best score!!!!
Validation loss decreased (0.072899 --> 0.070039).  Saving model ...
new best score!!!!
Epoch: 56 cost time: 1.2413344383239746
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0743081  Vali Loss: 0.0729021 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773023  Vali macro F1 0.9715392 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 57 cost time: 1.2433221340179443
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0715488  Vali Loss: 0.0575671 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830430  Vali macro F1 0.9780470 
new best score!!!!
Validation loss decreased (0.070039 --> 0.057567).  Saving model ...
new best score!!!!
Epoch: 58 cost time: 1.2468361854553223
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0718239  Vali Loss: 0.0776622 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9712010  Vali macro F1 0.9631723 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 1.241363525390625
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0747711  Vali Loss: 0.0917686 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9744234  Vali macro F1 0.9706638 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 60 cost time: 1.2390122413635254
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0733767  Vali Loss: 0.0516777 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915223  Vali macro F1 0.9884573 
new best score!!!!
Validation loss decreased (0.057567 --> 0.051678).  Saving model ...
new best score!!!!
Epoch: 61 cost time: 1.243159294128418
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0663565  Vali Loss: 0.0465882 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915228  Vali macro F1 0.9895926 
new best score!!!!
Validation loss decreased (0.051678 --> 0.046588).  Saving model ...
new best score!!!!
Epoch: 62 cost time: 1.240004539489746
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0666528  Vali Loss: 0.0465448 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915211  Vali macro F1 0.9911890 
new best score!!!!
Validation loss decreased (0.046588 --> 0.046545).  Saving model ...
new best score!!!!
Epoch: 63 cost time: 1.248793125152588
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0644822  Vali Loss: 0.0527167 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858441  Vali macro F1 0.9834596 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 64 cost time: 1.240361213684082
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0636098  Vali Loss: 0.0739795 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9681389  Vali macro F1 0.9589690 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 65 cost time: 1.2430610656738281
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0705397  Vali Loss: 0.0694742 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802197  Vali macro F1 0.9762041 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 66 cost time: 1.2436151504516602
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0609580  Vali Loss: 0.0395075 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943466  Vali macro F1 0.9934373 
new best score!!!!
Validation loss decreased (0.046545 --> 0.039507).  Saving model ...
new best score!!!!
Epoch: 67 cost time: 1.2412559986114502
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0603433  Vali Loss: 0.0495917 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887265  Vali macro F1 0.9872234 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 68 cost time: 1.2413110733032227
VALI: Epoch: 68, Steps: 13 | Train Loss: 0.0560864  Vali Loss: 0.0468677 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858731  Vali macro F1 0.9847730 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 69 cost time: 1.2401998043060303
VALI: Epoch: 69, Steps: 13 | Train Loss: 0.0505024  Vali Loss: 0.0336492 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915228  Vali macro F1 0.9895926 
new best score!!!!
Validation loss decreased (0.039507 --> 0.033649).  Saving model ...
new best score!!!!
Epoch: 70 cost time: 1.2408154010772705
VALI: Epoch: 70, Steps: 13 | Train Loss: 0.0412521  Vali Loss: 0.0320391 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943466  Vali macro F1 0.9934373 
new best score!!!!
Validation loss decreased (0.033649 --> 0.032039).  Saving model ...
new best score!!!!
Epoch: 71 cost time: 1.246669054031372
VALI: Epoch: 71, Steps: 13 | Train Loss: 0.0485136  Vali Loss: 0.0328802 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943466  Vali macro F1 0.9934373 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 72 cost time: 1.2410533428192139
VALI: Epoch: 72, Steps: 13 | Train Loss: 0.0428234  Vali Loss: 0.0327556 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943466  Vali macro F1 0.9934373 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 73 cost time: 1.245643138885498
VALI: Epoch: 73, Steps: 13 | Train Loss: 0.0434388  Vali Loss: 0.0353187 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886697  Vali macro F1 0.9857079 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 74 cost time: 1.2459967136383057
VALI: Epoch: 74, Steps: 13 | Train Loss: 0.0436571  Vali Loss: 0.0326022 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943471  Vali macro F1 0.9934044 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 75 cost time: 1.24741530418396
VALI: Epoch: 75, Steps: 13 | Train Loss: 0.0438702  Vali Loss: 0.0311705 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914971  Vali macro F1 0.9884230 
new best score!!!!
Validation loss decreased (0.032039 --> 0.031171).  Saving model ...
new best score!!!!
Epoch: 76 cost time: 1.2477607727050781
VALI: Epoch: 76, Steps: 13 | Train Loss: 0.0420212  Vali Loss: 0.0318436 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915149  Vali macro F1 0.9895483 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 77 cost time: 1.2598066329956055
VALI: Epoch: 77, Steps: 13 | Train Loss: 0.0423131  Vali Loss: 0.0265494 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915228  Vali macro F1 0.9895926 
new best score!!!!
Validation loss decreased (0.031171 --> 0.026549).  Saving model ...
new best score!!!!
Epoch: 78 cost time: 1.2447741031646729
VALI: Epoch: 78, Steps: 13 | Train Loss: 0.0398854  Vali Loss: 0.0364629 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829169  Vali macro F1 0.9778418 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 79 cost time: 1.2419114112854004
VALI: Epoch: 79, Steps: 13 | Train Loss: 0.0433247  Vali Loss: 0.0273779 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886948  Vali macro F1 0.9857422 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 80 cost time: 1.2423310279846191
VALI: Epoch: 80, Steps: 13 | Train Loss: 0.0399472  Vali Loss: 0.0532523 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829972  Vali macro F1 0.9819483 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 81 cost time: 1.2407011985778809
VALI: Epoch: 81, Steps: 13 | Train Loss: 0.0393250  Vali Loss: 0.0225578 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943466  Vali macro F1 0.9934373 
new best score!!!!
Validation loss decreased (0.026549 --> 0.022558).  Saving model ...
new best score!!!!
Epoch: 82 cost time: 1.2564032077789307
VALI: Epoch: 82, Steps: 13 | Train Loss: 0.0337139  Vali Loss: 0.0258879 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915145  Vali macro F1 0.9895812 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 83 cost time: 1.2422592639923096
VALI: Epoch: 83, Steps: 13 | Train Loss: 0.0375479  Vali Loss: 0.0260377 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943436  Vali macro F1 0.9936505 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 84 cost time: 1.2413244247436523
VALI: Epoch: 84, Steps: 13 | Train Loss: 0.0357891  Vali Loss: 0.0242515 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914971  Vali macro F1 0.9884230 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 85 cost time: 1.2423725128173828
VALI: Epoch: 85, Steps: 13 | Train Loss: 0.0343321  Vali Loss: 0.0257616 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943471  Vali macro F1 0.9934044 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 86 cost time: 1.2422027587890625
VALI: Epoch: 86, Steps: 13 | Train Loss: 0.0319464  Vali Loss: 0.0195002 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
new best score!!!!
Validation loss decreased (0.022558 --> 0.019500).  Saving model ...
new best score!!!!
Epoch: 87 cost time: 1.2437026500701904
VALI: Epoch: 87, Steps: 13 | Train Loss: 0.0372282  Vali Loss: 0.0386703 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915580  Vali macro F1 0.9908403 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 88 cost time: 1.2437245845794678
VALI: Epoch: 88, Steps: 13 | Train Loss: 0.0415980  Vali Loss: 0.0403300 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829810  Vali macro F1 0.9795615 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 89 cost time: 1.241265058517456
VALI: Epoch: 89, Steps: 13 | Train Loss: 0.0460219  Vali Loss: 0.0255020 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886697  Vali macro F1 0.9857079 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 90 cost time: 1.2417082786560059
VALI: Epoch: 90, Steps: 13 | Train Loss: 0.0350883  Vali Loss: 0.0212740 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 91 cost time: 1.242483377456665
VALI: Epoch: 91, Steps: 13 | Train Loss: 0.0362671  Vali Loss: 0.0220107 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914971  Vali macro F1 0.9884230 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 92 cost time: 1.242840051651001
VALI: Epoch: 92, Steps: 13 | Train Loss: 0.0335027  Vali Loss: 0.0193453 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
new best score!!!!
Validation loss decreased (0.019500 --> 0.019345).  Saving model ...
new best score!!!!
Epoch: 93 cost time: 1.2424554824829102
VALI: Epoch: 93, Steps: 13 | Train Loss: 0.0265641  Vali Loss: 0.0170807 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
new best score!!!!
Validation loss decreased (0.019345 --> 0.017081).  Saving model ...
new best score!!!!
Epoch: 94 cost time: 1.2433719635009766
VALI: Epoch: 94, Steps: 13 | Train Loss: 0.0268415  Vali Loss: 0.0171038 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 95 cost time: 1.242908000946045
VALI: Epoch: 95, Steps: 13 | Train Loss: 0.0250644  Vali Loss: 0.0172867 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 96 cost time: 1.2465894222259521
VALI: Epoch: 96, Steps: 13 | Train Loss: 0.0231748  Vali Loss: 0.0171042 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 97 cost time: 1.241931676864624
VALI: Epoch: 97, Steps: 13 | Train Loss: 0.0267648  Vali Loss: 0.0169023 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
new best score!!!!
Validation loss decreased (0.017081 --> 0.016902).  Saving model ...
new best score!!!!
Epoch: 98 cost time: 1.2417101860046387
VALI: Epoch: 98, Steps: 13 | Train Loss: 0.0265057  Vali Loss: 0.0167699 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
new best score!!!!
Validation loss decreased (0.016902 --> 0.016770).  Saving model ...
new best score!!!!
Epoch: 99 cost time: 1.242506742477417
VALI: Epoch: 99, Steps: 13 | Train Loss: 0.0235316  Vali Loss: 0.0167623 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
new best score!!!!
Validation loss decreased (0.016770 --> 0.016762).  Saving model ...
new best score!!!!
Epoch: 100 cost time: 1.2464113235473633
VALI: Epoch: 100, Steps: 13 | Train Loss: 0.0229907  Vali Loss: 0.0169133 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 101 cost time: 1.2418146133422852
VALI: Epoch: 101, Steps: 13 | Train Loss: 0.0243707  Vali Loss: 0.0170281 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 102 cost time: 1.2415060997009277
VALI: Epoch: 102, Steps: 13 | Train Loss: 0.0259801  Vali Loss: 0.0169506 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 103 cost time: 1.2434461116790771
VALI: Epoch: 103, Steps: 13 | Train Loss: 0.0248432  Vali Loss: 0.0173336 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 104 cost time: 1.241976022720337
VALI: Epoch: 104, Steps: 13 | Train Loss: 0.0249714  Vali Loss: 0.0174255 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 105 cost time: 1.2450456619262695
VALI: Epoch: 105, Steps: 13 | Train Loss: 0.0240442  Vali Loss: 0.0174573 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 106 cost time: 1.2502567768096924
VALI: Epoch: 106, Steps: 13 | Train Loss: 0.0232436  Vali Loss: 0.0174484 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 107 cost time: 1.2411267757415771
VALI: Epoch: 107, Steps: 13 | Train Loss: 0.0273756  Vali Loss: 0.0174135 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 108 cost time: 1.2402727603912354
VALI: Epoch: 108, Steps: 13 | Train Loss: 0.0233606  Vali Loss: 0.0173496 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 109 cost time: 1.2474701404571533
VALI: Epoch: 109, Steps: 13 | Train Loss: 0.0252602  Vali Loss: 0.0173697 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 110 cost time: 1.2597839832305908
VALI: Epoch: 110, Steps: 13 | Train Loss: 0.0248473  Vali Loss: 0.0173716 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 111 cost time: 1.2448036670684814
VALI: Epoch: 111, Steps: 13 | Train Loss: 0.0211010  Vali Loss: 0.0173723 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 112 cost time: 1.2417774200439453
VALI: Epoch: 112, Steps: 13 | Train Loss: 0.0241452  Vali Loss: 0.0173719 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 113 cost time: 1.251514196395874
VALI: Epoch: 113, Steps: 13 | Train Loss: 0.0245346  Vali Loss: 0.0173699 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 114 cost time: 1.2476270198822021
VALI: Epoch: 114, Steps: 13 | Train Loss: 0.0233950  Vali Loss: 0.0173726 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9920814  Test weighted F1: 0.9920690  Test macro F1 0.9903741 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 73347
pruned model Parameter : 76626
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.2648868560791016
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0234069  Vali Loss: 0.0181212 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915233  Vali macro F1 0.9895597 
Validation loss decreased (inf --> 0.018121).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.25700044631958
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0231798  Vali Loss: 0.0168498 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
new best score!!!!
Validation loss decreased (0.018121 --> 0.016850).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 1.261021614074707
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0221781  Vali Loss: 0.0166377 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
new best score!!!!
Validation loss decreased (0.016850 --> 0.016638).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 1.258329153060913
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0224703  Vali Loss: 0.0171359 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 1.2571876049041748
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0225253  Vali Loss: 0.0169658 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943466  Vali macro F1 0.9934373 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 1.2560856342315674
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0248827  Vali Loss: 0.0165679 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943466  Vali macro F1 0.9934373 
new best score!!!!
Validation loss decreased (0.016638 --> 0.016568).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 1.260190486907959
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0245326  Vali Loss: 0.0189078 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943471  Vali macro F1 0.9934044 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 1.257326364517212
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0204614  Vali Loss: 0.0181052 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943471  Vali macro F1 0.9934044 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 1.258242130279541
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0200112  Vali Loss: 0.0165596 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943466  Vali macro F1 0.9934373 
new best score!!!!
Validation loss decreased (0.016568 --> 0.016560).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 1.2562615871429443
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0208620  Vali Loss: 0.0167716 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943466  Vali macro F1 0.9934373 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 1.2612025737762451
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0235506  Vali Loss: 0.0175236 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943466  Vali macro F1 0.9934373 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 1.2574222087860107
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0211515  Vali Loss: 0.0170260 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943466  Vali macro F1 0.9934373 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 1.2577931880950928
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0224487  Vali Loss: 0.0203915 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943471  Vali macro F1 0.9934044 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 14 cost time: 1.2583978176116943
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0236244  Vali Loss: 0.0228229 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943471  Vali macro F1 0.9934044 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 15 cost time: 1.2645533084869385
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0229889  Vali Loss: 0.0186098 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943471  Vali macro F1 0.9934044 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 1.2608282566070557
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0191498  Vali Loss: 0.0199125 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943471  Vali macro F1 0.9934044 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 1.2584505081176758
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0198982  Vali Loss: 0.0157105 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943466  Vali macro F1 0.9934373 
new best score!!!!
Validation loss decreased (0.016560 --> 0.015710).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 18 cost time: 1.2608613967895508
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0200820  Vali Loss: 0.0154414 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943466  Vali macro F1 0.9934373 
new best score!!!!
Validation loss decreased (0.015710 --> 0.015441).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 1.261960744857788
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0182937  Vali Loss: 0.0172351 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943471  Vali macro F1 0.9934044 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 1.2587218284606934
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0205068  Vali Loss: 0.0183466 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943471  Vali macro F1 0.9934044 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 1.2595486640930176
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0213085  Vali Loss: 0.0153743 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943466  Vali macro F1 0.9934373 
new best score!!!!
Validation loss decreased (0.015441 --> 0.015374).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 22 cost time: 1.2616581916809082
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0179117  Vali Loss: 0.0145879 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
new best score!!!!
Validation loss decreased (0.015374 --> 0.014588).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 23 cost time: 1.2595148086547852
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0199039  Vali Loss: 0.0176040 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943471  Vali macro F1 0.9934044 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 1.2658665180206299
Fine Tuning VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0215551  Vali Loss: 0.0152531 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943466  Vali macro F1 0.9934373 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 1.2600326538085938
Fine Tuning VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0154676  Vali Loss: 0.0168168 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943471  Vali macro F1 0.9934044 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 1.262361764907837
Fine Tuning VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0215031  Vali Loss: 0.0151460 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943466  Vali macro F1 0.9934373 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 1.261249303817749
Fine Tuning VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0205008  Vali Loss: 0.0136840 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943466  Vali macro F1 0.9934373 
new best score!!!!
Validation loss decreased (0.014588 --> 0.013684).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 28 cost time: 1.2614357471466064
Fine Tuning VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0174568  Vali Loss: 0.0134543 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
new best score!!!!
Validation loss decreased (0.013684 --> 0.013454).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 29 cost time: 1.2794947624206543
Fine Tuning VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0171444  Vali Loss: 0.0157039 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943466  Vali macro F1 0.9934373 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 30 cost time: 1.2656505107879639
Fine Tuning VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0186597  Vali Loss: 0.0146571 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 31 cost time: 1.271942138671875
Fine Tuning VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0186133  Vali Loss: 0.0164685 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943471  Vali macro F1 0.9934044 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 32 cost time: 1.2696855068206787
Fine Tuning VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0208589  Vali Loss: 0.0154869 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943466  Vali macro F1 0.9934373 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 33 cost time: 1.2704222202301025
Fine Tuning VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0204405  Vali Loss: 0.0153927 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943466  Vali macro F1 0.9934373 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 34 cost time: 1.261427640914917
Fine Tuning VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0166261  Vali Loss: 0.0156144 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943466  Vali macro F1 0.9934373 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 35 cost time: 1.2665538787841797
Fine Tuning VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0182445  Vali Loss: 0.0157881 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943466  Vali macro F1 0.9934373 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 36 cost time: 1.2646191120147705
Fine Tuning VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0162174  Vali Loss: 0.0157507 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943466  Vali macro F1 0.9934373 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 37 cost time: 1.2638027667999268
Fine Tuning VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0173277  Vali Loss: 0.0156873 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943466  Vali macro F1 0.9934373 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 38 cost time: 1.26450777053833
Fine Tuning VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0192543  Vali Loss: 0.0156372 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943466  Vali macro F1 0.9934373 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 39 cost time: 1.2640440464019775
Fine Tuning VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0174861  Vali Loss: 0.0156268 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943466  Vali macro F1 0.9934373 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 40 cost time: 1.262058973312378
Fine Tuning VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0179981  Vali Loss: 0.0155900 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943466  Vali macro F1 0.9934373 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 41 cost time: 1.2643730640411377
Fine Tuning VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0178049  Vali Loss: 0.0155623 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943466  Vali macro F1 0.9934373 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 42 cost time: 1.262260913848877
Fine Tuning VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0171850  Vali Loss: 0.0155457 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943466  Vali macro F1 0.9934373 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 43 cost time: 1.2634100914001465
Fine Tuning VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0186018  Vali Loss: 0.0155113 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943466  Vali macro F1 0.9934373 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9932127  Test weighted F1: 0.9932532  Test macro F1 0.9941840 
================ the 4 th CV Experiment ================ 
Overlapping random Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.0027027  0.00240385 0.00242131 0.00319489 0.00574713 0.00617284
 0.00315457 0.0028169  0.00246305 0.00390625]
Train data number :  3182
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  887
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.239795207977295
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.2846895  Vali Loss: 2.2667032 Vali Accuracy: 0.1101695  Vali weighted F1: 0.0218657  Vali macro F1 0.0198473 
Validation loss decreased (inf --> 2.266703).  Saving model ...
Epoch: 2 cost time: 1.2326736450195312
VALI: Epoch: 2, Steps: 13 | Train Loss: 2.2246102  Vali Loss: 2.1487698 Vali Accuracy: 0.3361582  Vali weighted F1: 0.2913696  Vali macro F1 0.2476982 
new best score!!!!
Validation loss decreased (2.266703 --> 2.148770).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.2322289943695068
VALI: Epoch: 3, Steps: 13 | Train Loss: 2.0169693  Vali Loss: 1.8132500 Vali Accuracy: 0.4180791  Vali weighted F1: 0.4058060  Vali macro F1 0.3624404 
new best score!!!!
Validation loss decreased (2.148770 --> 1.813250).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.2310938835144043
VALI: Epoch: 4, Steps: 13 | Train Loss: 1.6502384  Vali Loss: 1.3939296 Vali Accuracy: 0.6271186  Vali weighted F1: 0.6353772  Vali macro F1 0.6223439 
new best score!!!!
Validation loss decreased (1.813250 --> 1.393930).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.2308471202850342
VALI: Epoch: 5, Steps: 13 | Train Loss: 1.3295867  Vali Loss: 1.0836564 Vali Accuracy: 0.6892655  Vali weighted F1: 0.6921269  Vali macro F1 0.6624297 
new best score!!!!
Validation loss decreased (1.393930 --> 1.083656).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.2337329387664795
VALI: Epoch: 6, Steps: 13 | Train Loss: 1.0816712  Vali Loss: 0.9038676 Vali Accuracy: 0.7457627  Vali weighted F1: 0.7354852  Vali macro F1 0.7043607 
new best score!!!!
Validation loss decreased (1.083656 --> 0.903868).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.2340595722198486
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.9035084  Vali Loss: 0.7500207 Vali Accuracy: 0.7288136  Vali weighted F1: 0.7043911  Vali macro F1 0.6682857 
new best score!!!!
Validation loss decreased (0.903868 --> 0.750021).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.2342517375946045
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.7705768  Vali Loss: 0.6523610 Vali Accuracy: 0.7909605  Vali weighted F1: 0.7825771  Vali macro F1 0.7485580 
new best score!!!!
Validation loss decreased (0.750021 --> 0.652361).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.2369530200958252
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.6766619  Vali Loss: 0.5842546 Vali Accuracy: 0.8192090  Vali weighted F1: 0.8101448  Vali macro F1 0.7751212 
new best score!!!!
Validation loss decreased (0.652361 --> 0.584255).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.2330493927001953
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.6068427  Vali Loss: 0.5289448 Vali Accuracy: 0.8502825  Vali weighted F1: 0.8428114  Vali macro F1 0.8103142 
new best score!!!!
Validation loss decreased (0.584255 --> 0.528945).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.2349369525909424
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.5489728  Vali Loss: 0.4781347 Vali Accuracy: 0.8615819  Vali weighted F1: 0.8603670  Vali macro F1 0.8273444 
new best score!!!!
Validation loss decreased (0.528945 --> 0.478135).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.2332308292388916
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.4997303  Vali Loss: 0.4437854 Vali Accuracy: 0.8587571  Vali weighted F1: 0.8563541  Vali macro F1 0.8317761 
new best score!!!!
Validation loss decreased (0.478135 --> 0.443785).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.2381525039672852
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.4629097  Vali Loss: 0.4157977 Vali Accuracy: 0.8757062  Vali weighted F1: 0.8754161  Vali macro F1 0.8416946 
new best score!!!!
Validation loss decreased (0.443785 --> 0.415798).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.2389869689941406
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.4321688  Vali Loss: 0.3950934 Vali Accuracy: 0.8644068  Vali weighted F1: 0.8617268  Vali macro F1 0.8260112 
new best score!!!!
Validation loss decreased (0.415798 --> 0.395093).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.2365002632141113
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.4085466  Vali Loss: 0.3551323 Vali Accuracy: 0.9011299  Vali weighted F1: 0.8991227  Vali macro F1 0.8664028 
new best score!!!!
Validation loss decreased (0.395093 --> 0.355132).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.2359826564788818
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.3758078  Vali Loss: 0.3281608 Vali Accuracy: 0.8983051  Vali weighted F1: 0.8971549  Vali macro F1 0.8591655 
new best score!!!!
Validation loss decreased (0.355132 --> 0.328161).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.2450666427612305
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.3482165  Vali Loss: 0.3021239 Vali Accuracy: 0.9152542  Vali weighted F1: 0.9146908  Vali macro F1 0.8740624 
new best score!!!!
Validation loss decreased (0.328161 --> 0.302124).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.2543902397155762
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.3238574  Vali Loss: 0.2810303 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9138581  Vali macro F1 0.8722432 
new best score!!!!
Validation loss decreased (0.302124 --> 0.281030).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.2333216667175293
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.2924392  Vali Loss: 0.2447335 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9199691  Vali macro F1 0.8760479 
new best score!!!!
Validation loss decreased (0.281030 --> 0.244733).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.235243797302246
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.2736089  Vali Loss: 0.2296704 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9485691  Vali macro F1 0.9219823 
new best score!!!!
Validation loss decreased (0.244733 --> 0.229670).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.236217975616455
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.2533447  Vali Loss: 0.2131382 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9282091  Vali macro F1 0.8903005 
new best score!!!!
Validation loss decreased (0.229670 --> 0.213138).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.2400364875793457
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.2424252  Vali Loss: 0.2105089 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9330344  Vali macro F1 0.8984396 
new best score!!!!
Validation loss decreased (0.213138 --> 0.210509).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.2371487617492676
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.2209468  Vali Loss: 0.1972124 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9324030  Vali macro F1 0.8951442 
new best score!!!!
Validation loss decreased (0.210509 --> 0.197212).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.2366151809692383
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.2034174  Vali Loss: 0.1866699 Vali Accuracy: 0.9265537  Vali weighted F1: 0.9230854  Vali macro F1 0.8845217 
new best score!!!!
Validation loss decreased (0.197212 --> 0.186670).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.2365360260009766
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.1924934  Vali Loss: 0.1800607 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9462448  Vali macro F1 0.9206812 
new best score!!!!
Validation loss decreased (0.186670 --> 0.180061).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.2366788387298584
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.1846130  Vali Loss: 0.1771571 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9337952  Vali macro F1 0.8985203 
new best score!!!!
Validation loss decreased (0.180061 --> 0.177157).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.2390294075012207
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.1773921  Vali Loss: 0.1598821 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9334490  Vali macro F1 0.8903615 
new best score!!!!
Validation loss decreased (0.177157 --> 0.159882).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 1.2380523681640625
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.1649655  Vali Loss: 0.1553623 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9315211  Vali macro F1 0.8945302 
new best score!!!!
Validation loss decreased (0.159882 --> 0.155362).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.2386815547943115
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.1558437  Vali Loss: 0.1588878 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9401996  Vali macro F1 0.9077479 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 1.238396167755127
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.1621283  Vali Loss: 0.1610555 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9532990  Vali macro F1 0.9373673 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 1.24037504196167
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.1564732  Vali Loss: 0.1469647 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9473624  Vali macro F1 0.9249563 
new best score!!!!
Validation loss decreased (0.155362 --> 0.146965).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 1.2351977825164795
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.1510084  Vali Loss: 0.1338410 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9532901  Vali macro F1 0.9227594 
new best score!!!!
Validation loss decreased (0.146965 --> 0.133841).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 1.237605333328247
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.1317108  Vali Loss: 0.1330551 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9601666  Vali macro F1 0.9403667 
new best score!!!!
Validation loss decreased (0.133841 --> 0.133055).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 1.23484206199646
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.1252243  Vali Loss: 0.1247686 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9627222  Vali macro F1 0.9467504 
new best score!!!!
Validation loss decreased (0.133055 --> 0.124769).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.2372889518737793
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.1189282  Vali Loss: 0.1379575 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9448293  Vali macro F1 0.9144939 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 1.2380003929138184
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.1204632  Vali Loss: 0.1230170 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9632609  Vali macro F1 0.9458437 
new best score!!!!
Validation loss decreased (0.124769 --> 0.123017).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 1.2379631996154785
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.1186441  Vali Loss: 0.1140305 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9632877  Vali macro F1 0.9431722 
new best score!!!!
Validation loss decreased (0.123017 --> 0.114030).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 1.2361395359039307
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.1093748  Vali Loss: 0.1098785 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9660880  Vali macro F1 0.9502759 
new best score!!!!
Validation loss decreased (0.114030 --> 0.109879).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 1.2384004592895508
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.1100444  Vali Loss: 0.1193006 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9632025  Vali macro F1 0.9499975 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 1.235640048980713
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.1019850  Vali Loss: 0.1052250 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9683371  Vali macro F1 0.9547981 
new best score!!!!
Validation loss decreased (0.109879 --> 0.105225).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 1.237440586090088
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0958401  Vali Loss: 0.0895225 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9713613  Vali macro F1 0.9601813 
new best score!!!!
Validation loss decreased (0.105225 --> 0.089522).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 1.2369635105133057
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0883789  Vali Loss: 0.0978770 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9715788  Vali macro F1 0.9632258 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 1.237640142440796
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0845880  Vali Loss: 0.0914107 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9713715  Vali macro F1 0.9596240 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 1.2360239028930664
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0766577  Vali Loss: 0.0855650 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9714738  Vali macro F1 0.9631586 
new best score!!!!
Validation loss decreased (0.089522 --> 0.085565).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 1.2377712726593018
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0843451  Vali Loss: 0.0741124 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9743895  Vali macro F1 0.9654868 
new best score!!!!
Validation loss decreased (0.085565 --> 0.074112).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 1.2392313480377197
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0752169  Vali Loss: 0.0743092 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9744237  Vali macro F1 0.9677555 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 1.243016004562378
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0713436  Vali Loss: 0.0586922 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9954359 
new best score!!!!
Validation loss decreased (0.074112 --> 0.058692).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 1.2379076480865479
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0657882  Vali Loss: 0.0748751 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858993  Vali macro F1 0.9831669 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 1.2407915592193604
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0618701  Vali Loss: 0.0879745 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9744795  Vali macro F1 0.9675630 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 1.237168788909912
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0628433  Vali Loss: 0.0697837 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831007  Vali macro F1 0.9836195 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 1.2525229454040527
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0548654  Vali Loss: 0.0736364 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831007  Vali macro F1 0.9836195 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 52 cost time: 1.2410736083984375
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0516406  Vali Loss: 0.0519047 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887096  Vali macro F1 0.9881691 
new best score!!!!
Validation loss decreased (0.058692 --> 0.051905).  Saving model ...
new best score!!!!
Epoch: 53 cost time: 1.2431261539459229
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0518857  Vali Loss: 0.0620514 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802634  Vali macro F1 0.9785975 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 1.2368881702423096
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0490400  Vali Loss: 0.0500161 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858881  Vali macro F1 0.9826015 
new best score!!!!
Validation loss decreased (0.051905 --> 0.050016).  Saving model ...
new best score!!!!
Epoch: 55 cost time: 1.236433982849121
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0565965  Vali Loss: 0.0649590 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9739546  Vali macro F1 0.9587606 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 1.2356393337249756
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0569189  Vali Loss: 0.0789611 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9657626  Vali macro F1 0.9535269 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 57 cost time: 1.2344896793365479
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0575313  Vali Loss: 0.0460165 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915366  Vali macro F1 0.9904561 
new best score!!!!
Validation loss decreased (0.050016 --> 0.046016).  Saving model ...
new best score!!!!
Epoch: 58 cost time: 1.236738920211792
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0442804  Vali Loss: 0.0515228 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915363  Vali macro F1 0.9931722 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 1.235241174697876
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0444522  Vali Loss: 0.0549824 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830367  Vali macro F1 0.9808467 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 60 cost time: 1.2374775409698486
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0408060  Vali Loss: 0.0458362 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915366  Vali macro F1 0.9904561 
new best score!!!!
Validation loss decreased (0.046016 --> 0.045836).  Saving model ...
new best score!!!!
Epoch: 61 cost time: 1.2338910102844238
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0416844  Vali Loss: 0.0451450 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858881  Vali macro F1 0.9826015 
new best score!!!!
Validation loss decreased (0.045836 --> 0.045145).  Saving model ...
new best score!!!!
Epoch: 62 cost time: 1.2331864833831787
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0414615  Vali Loss: 0.0498392 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887112  Vali macro F1 0.9875983 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 63 cost time: 1.2341997623443604
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0339190  Vali Loss: 0.0474138 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887112  Vali macro F1 0.9875983 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 64 cost time: 1.2376468181610107
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0363074  Vali Loss: 0.0484126 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858751  Vali macro F1 0.9880141 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 65 cost time: 1.2349164485931396
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0352318  Vali Loss: 0.0464746 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802113  Vali macro F1 0.9779890 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 66 cost time: 1.2342031002044678
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0326145  Vali Loss: 0.0410763 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943533  Vali macro F1 0.9948664 
new best score!!!!
Validation loss decreased (0.045145 --> 0.041076).  Saving model ...
new best score!!!!
Epoch: 67 cost time: 1.2323668003082275
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0401699  Vali Loss: 0.0409187 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887108  Vali macro F1 0.9903145 
new best score!!!!
Validation loss decreased (0.041076 --> 0.040919).  Saving model ...
new best score!!!!
Epoch: 68 cost time: 1.2358129024505615
VALI: Epoch: 68, Steps: 13 | Train Loss: 0.0322541  Vali Loss: 0.0597199 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858707  Vali macro F1 0.9822910 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 69 cost time: 1.234210729598999
VALI: Epoch: 69, Steps: 13 | Train Loss: 0.0351599  Vali Loss: 0.0434151 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886894  Vali macro F1 0.9848413 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 70 cost time: 1.23274827003479
VALI: Epoch: 70, Steps: 13 | Train Loss: 0.0300755  Vali Loss: 0.0436159 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858603  Vali macro F1 0.9852727 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 71 cost time: 1.2341618537902832
VALI: Epoch: 71, Steps: 13 | Train Loss: 0.0261786  Vali Loss: 0.0412566 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886894  Vali macro F1 0.9848413 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 72 cost time: 1.237550973892212
VALI: Epoch: 72, Steps: 13 | Train Loss: 0.0235887  Vali Loss: 0.0441390 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858724  Vali macro F1 0.9831472 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 73 cost time: 1.235358476638794
VALI: Epoch: 73, Steps: 13 | Train Loss: 0.0294778  Vali Loss: 0.0401114 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886982  Vali macro F1 0.9875750 
new best score!!!!
Validation loss decreased (0.040919 --> 0.040111).  Saving model ...
new best score!!!!
Epoch: 74 cost time: 1.2343239784240723
VALI: Epoch: 74, Steps: 13 | Train Loss: 0.0236029  Vali Loss: 0.0415278 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886982  Vali macro F1 0.9875750 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 75 cost time: 1.2386527061462402
VALI: Epoch: 75, Steps: 13 | Train Loss: 0.0235088  Vali Loss: 0.0407027 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886982  Vali macro F1 0.9875750 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 76 cost time: 1.2372548580169678
VALI: Epoch: 76, Steps: 13 | Train Loss: 0.0210038  Vali Loss: 0.0391583 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886982  Vali macro F1 0.9875750 
new best score!!!!
Validation loss decreased (0.040111 --> 0.039158).  Saving model ...
new best score!!!!
Epoch: 77 cost time: 1.23362135887146
VALI: Epoch: 77, Steps: 13 | Train Loss: 0.0221504  Vali Loss: 0.0393620 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886982  Vali macro F1 0.9875750 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 78 cost time: 1.2335143089294434
VALI: Epoch: 78, Steps: 13 | Train Loss: 0.0247598  Vali Loss: 0.0405611 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886982  Vali macro F1 0.9875750 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 79 cost time: 1.2363605499267578
VALI: Epoch: 79, Steps: 13 | Train Loss: 0.0218188  Vali Loss: 0.0405746 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886982  Vali macro F1 0.9875750 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 80 cost time: 1.2422714233398438
VALI: Epoch: 80, Steps: 13 | Train Loss: 0.0244425  Vali Loss: 0.0397561 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886982  Vali macro F1 0.9875750 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 81 cost time: 1.23588228225708
VALI: Epoch: 81, Steps: 13 | Train Loss: 0.0228340  Vali Loss: 0.0382940 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886982  Vali macro F1 0.9875750 
new best score!!!!
Validation loss decreased (0.039158 --> 0.038294).  Saving model ...
new best score!!!!
Epoch: 82 cost time: 1.2339494228363037
VALI: Epoch: 82, Steps: 13 | Train Loss: 0.0235701  Vali Loss: 0.0393686 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886982  Vali macro F1 0.9875750 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 83 cost time: 1.235253095626831
VALI: Epoch: 83, Steps: 13 | Train Loss: 0.0204918  Vali Loss: 0.0404789 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886982  Vali macro F1 0.9875750 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 84 cost time: 1.234710931777954
VALI: Epoch: 84, Steps: 13 | Train Loss: 0.0201143  Vali Loss: 0.0392300 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886982  Vali macro F1 0.9875750 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 85 cost time: 1.254920482635498
VALI: Epoch: 85, Steps: 13 | Train Loss: 0.0199033  Vali Loss: 0.0400915 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886982  Vali macro F1 0.9875750 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 86 cost time: 1.23482346534729
VALI: Epoch: 86, Steps: 13 | Train Loss: 0.0203793  Vali Loss: 0.0393403 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886982  Vali macro F1 0.9875750 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 87 cost time: 1.237107753753662
VALI: Epoch: 87, Steps: 13 | Train Loss: 0.0203298  Vali Loss: 0.0393837 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886982  Vali macro F1 0.9875750 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 88 cost time: 1.232961893081665
VALI: Epoch: 88, Steps: 13 | Train Loss: 0.0220573  Vali Loss: 0.0393683 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886982  Vali macro F1 0.9875750 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 89 cost time: 1.2355797290802002
VALI: Epoch: 89, Steps: 13 | Train Loss: 0.0212081  Vali Loss: 0.0394338 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886982  Vali macro F1 0.9875750 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 90 cost time: 1.2359895706176758
VALI: Epoch: 90, Steps: 13 | Train Loss: 0.0203722  Vali Loss: 0.0394815 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886982  Vali macro F1 0.9875750 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 91 cost time: 1.2365169525146484
VALI: Epoch: 91, Steps: 13 | Train Loss: 0.0184766  Vali Loss: 0.0395343 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886982  Vali macro F1 0.9875750 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 92 cost time: 1.23543119430542
VALI: Epoch: 92, Steps: 13 | Train Loss: 0.0191739  Vali Loss: 0.0395282 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886982  Vali macro F1 0.9875750 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 93 cost time: 1.2354800701141357
VALI: Epoch: 93, Steps: 13 | Train Loss: 0.0205846  Vali Loss: 0.0395365 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886982  Vali macro F1 0.9875750 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 94 cost time: 1.2346770763397217
VALI: Epoch: 94, Steps: 13 | Train Loss: 0.0197328  Vali Loss: 0.0395219 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886982  Vali macro F1 0.9875750 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 95 cost time: 1.235520362854004
VALI: Epoch: 95, Steps: 13 | Train Loss: 0.0179939  Vali Loss: 0.0395125 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886982  Vali macro F1 0.9875750 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 96 cost time: 1.2342197895050049
VALI: Epoch: 96, Steps: 13 | Train Loss: 0.0243795  Vali Loss: 0.0394945 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886982  Vali macro F1 0.9875750 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9898534  Test weighted F1: 0.9898538  Test macro F1 0.9866517 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 73347
pruned model Parameter : 76626
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.2504920959472656
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0212846  Vali Loss: 0.0404070 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886982  Vali macro F1 0.9875750 
Validation loss decreased (inf --> 0.040407).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.2461495399475098
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0201752  Vali Loss: 0.0380795 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915267  Vali macro F1 0.9898632 
new best score!!!!
Validation loss decreased (0.040407 --> 0.038080).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 1.2449560165405273
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0226377  Vali Loss: 0.0373039 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915267  Vali macro F1 0.9898632 
new best score!!!!
Validation loss decreased (0.038080 --> 0.037304).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 1.2482731342315674
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0224250  Vali Loss: 0.0380198 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915267  Vali macro F1 0.9898632 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 1.2483863830566406
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0200765  Vali Loss: 0.0373922 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915267  Vali macro F1 0.9898632 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 1.2494516372680664
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0196754  Vali Loss: 0.0360888 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915267  Vali macro F1 0.9898632 
new best score!!!!
Validation loss decreased (0.037304 --> 0.036089).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 1.2480847835540771
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0208571  Vali Loss: 0.0348816 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943521  Vali macro F1 0.9927209 
new best score!!!!
Validation loss decreased (0.036089 --> 0.034882).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 1.2497355937957764
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0190784  Vali Loss: 0.0361451 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943533  Vali macro F1 0.9948664 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 1.2503104209899902
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0219091  Vali Loss: 0.0361177 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886894  Vali macro F1 0.9848413 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 1.24959135055542
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0183548  Vali Loss: 0.0348307 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915267  Vali macro F1 0.9898632 
new best score!!!!
Validation loss decreased (0.034882 --> 0.034831).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 1.2486746311187744
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0210978  Vali Loss: 0.0373511 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915267  Vali macro F1 0.9898632 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 1.24876070022583
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0194520  Vali Loss: 0.0363427 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915267  Vali macro F1 0.9898632 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 1.2484052181243896
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0184130  Vali Loss: 0.0353895 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915267  Vali macro F1 0.9898632 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 1.2489948272705078
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0197468  Vali Loss: 0.0336245 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915267  Vali macro F1 0.9898632 
new best score!!!!
Validation loss decreased (0.034831 --> 0.033625).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 1.2508509159088135
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0181083  Vali Loss: 0.0339222 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915267  Vali macro F1 0.9898632 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 1.2498862743377686
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0194542  Vali Loss: 0.0355399 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915267  Vali macro F1 0.9898632 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 1.2535338401794434
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0178596  Vali Loss: 0.0350811 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915267  Vali macro F1 0.9898632 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 1.2491285800933838
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0183889  Vali Loss: 0.0330006 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915267  Vali macro F1 0.9898632 
new best score!!!!
Validation loss decreased (0.033625 --> 0.033001).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 1.2499542236328125
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0209483  Vali Loss: 0.0349708 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915267  Vali macro F1 0.9898632 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 1.2488248348236084
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0206896  Vali Loss: 0.0375679 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915267  Vali macro F1 0.9898632 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 1.2584943771362305
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0168941  Vali Loss: 0.0332622 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943521  Vali macro F1 0.9927209 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 1.2574124336242676
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0193743  Vali Loss: 0.0320040 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971788  Vali macro F1 0.9977241 
new best score!!!!
Validation loss decreased (0.033001 --> 0.032004).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 23 cost time: 1.2506258487701416
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0158918  Vali Loss: 0.0337057 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886982  Vali macro F1 0.9875750 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 1.2539210319519043
Fine Tuning VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0187618  Vali Loss: 0.0378860 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886982  Vali macro F1 0.9875750 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 1.2514996528625488
Fine Tuning VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0163549  Vali Loss: 0.0359350 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886982  Vali macro F1 0.9875750 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 1.2536067962646484
Fine Tuning VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0181115  Vali Loss: 0.0353697 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915267  Vali macro F1 0.9898632 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 1.2519171237945557
Fine Tuning VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0167181  Vali Loss: 0.0348187 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915267  Vali macro F1 0.9898632 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 28 cost time: 1.2510161399841309
Fine Tuning VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0184311  Vali Loss: 0.0351337 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915267  Vali macro F1 0.9898632 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 29 cost time: 1.2511720657348633
Fine Tuning VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0153294  Vali Loss: 0.0355227 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915267  Vali macro F1 0.9898632 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 30 cost time: 1.2522668838500977
Fine Tuning VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0149471  Vali Loss: 0.0370192 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886982  Vali macro F1 0.9875750 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 31 cost time: 1.2504856586456299
Fine Tuning VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0176316  Vali Loss: 0.0388924 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886982  Vali macro F1 0.9875750 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 32 cost time: 1.2500982284545898
Fine Tuning VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0171833  Vali Loss: 0.0361618 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886982  Vali macro F1 0.9875750 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 33 cost time: 1.2536892890930176
Fine Tuning VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0158100  Vali Loss: 0.0361577 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886982  Vali macro F1 0.9875750 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 34 cost time: 1.2535228729248047
Fine Tuning VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0147143  Vali Loss: 0.0363394 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886982  Vali macro F1 0.9875750 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 35 cost time: 1.2532713413238525
Fine Tuning VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0166737  Vali Loss: 0.0364993 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886982  Vali macro F1 0.9875750 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 36 cost time: 1.2523932456970215
Fine Tuning VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0156263  Vali Loss: 0.0364777 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886982  Vali macro F1 0.9875750 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 37 cost time: 1.251298189163208
Fine Tuning VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0216851  Vali Loss: 0.0366041 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886982  Vali macro F1 0.9875750 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9864713  Test weighted F1: 0.9864546  Test macro F1 0.9812453 
Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 73347
Set the seed as :  5
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
================ SOCV Mode ====================
================ 5 CV ======================
================ the 0 th CV Experiment ================ 
Overlapping random Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.0025974  0.00241546 0.00248756 0.00307692 0.00561798 0.00621118
 0.0031746  0.00286533 0.00241546 0.00413223]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.2600445747375488
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.2853418  Vali Loss: 2.2713581 Vali Accuracy: 0.1327684  Vali weighted F1: 0.0311228  Vali macro F1 0.0234414 
Validation loss decreased (inf --> 2.271358).  Saving model ...
Epoch: 2 cost time: 1.238295316696167
VALI: Epoch: 2, Steps: 13 | Train Loss: 2.2506270  Vali Loss: 2.2115808 Vali Accuracy: 0.1129944  Vali weighted F1: 0.0494654  Vali macro F1 0.0370194 
new best score!!!!
Validation loss decreased (2.271358 --> 2.211581).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.2388591766357422
VALI: Epoch: 3, Steps: 13 | Train Loss: 2.1181973  Vali Loss: 1.9384052 Vali Accuracy: 0.2401130  Vali weighted F1: 0.1575275  Vali macro F1 0.1451883 
new best score!!!!
Validation loss decreased (2.211581 --> 1.938405).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.2387416362762451
VALI: Epoch: 4, Steps: 13 | Train Loss: 1.7480895  Vali Loss: 1.4378886 Vali Accuracy: 0.4548023  Vali weighted F1: 0.4521609  Vali macro F1 0.4366244 
new best score!!!!
Validation loss decreased (1.938405 --> 1.437889).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.23929762840271
VALI: Epoch: 5, Steps: 13 | Train Loss: 1.3816588  Vali Loss: 1.1539703 Vali Accuracy: 0.6242938  Vali weighted F1: 0.6012986  Vali macro F1 0.5618136 
new best score!!!!
Validation loss decreased (1.437889 --> 1.153970).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.2395787239074707
VALI: Epoch: 6, Steps: 13 | Train Loss: 1.1534844  Vali Loss: 0.9629142 Vali Accuracy: 0.6949153  Vali weighted F1: 0.6792007  Vali macro F1 0.6508067 
new best score!!!!
Validation loss decreased (1.153970 --> 0.962914).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.237185001373291
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.9839085  Vali Loss: 0.8054331 Vali Accuracy: 0.7909605  Vali weighted F1: 0.7832433  Vali macro F1 0.7591245 
new best score!!!!
Validation loss decreased (0.962914 --> 0.805433).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.2373487949371338
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.8371333  Vali Loss: 0.6851789 Vali Accuracy: 0.8248588  Vali weighted F1: 0.8051342  Vali macro F1 0.7631625 
new best score!!!!
Validation loss decreased (0.805433 --> 0.685179).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.2361738681793213
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.7221953  Vali Loss: 0.5911782 Vali Accuracy: 0.8248588  Vali weighted F1: 0.8031841  Vali macro F1 0.7625223 
new best score!!!!
Validation loss decreased (0.685179 --> 0.591178).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.2360095977783203
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.6340353  Vali Loss: 0.5129670 Vali Accuracy: 0.8474576  Vali weighted F1: 0.8263905  Vali macro F1 0.7830237 
new best score!!!!
Validation loss decreased (0.591178 --> 0.512967).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.2365810871124268
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.5531641  Vali Loss: 0.4538893 Vali Accuracy: 0.8559322  Vali weighted F1: 0.8360773  Vali macro F1 0.7920170 
new best score!!!!
Validation loss decreased (0.512967 --> 0.453889).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.2417187690734863
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.4940846  Vali Loss: 0.4172607 Vali Accuracy: 0.8870056  Vali weighted F1: 0.8862881  Vali macro F1 0.8570784 
new best score!!!!
Validation loss decreased (0.453889 --> 0.417261).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.2378873825073242
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.4570827  Vali Loss: 0.3644651 Vali Accuracy: 0.8926554  Vali weighted F1: 0.8727513  Vali macro F1 0.8239970 
new best score!!!!
Validation loss decreased (0.417261 --> 0.364465).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.242987871170044
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.4166898  Vali Loss: 0.3496721 Vali Accuracy: 0.9011299  Vali weighted F1: 0.8810525  Vali macro F1 0.8305433 
new best score!!!!
Validation loss decreased (0.364465 --> 0.349672).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.2400705814361572
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.3900578  Vali Loss: 0.3186840 Vali Accuracy: 0.9096045  Vali weighted F1: 0.9002490  Vali macro F1 0.8628812 
new best score!!!!
Validation loss decreased (0.349672 --> 0.318684).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.254575490951538
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.3632756  Vali Loss: 0.2951090 Vali Accuracy: 0.9180791  Vali weighted F1: 0.9042033  Vali macro F1 0.8599267 
new best score!!!!
Validation loss decreased (0.318684 --> 0.295109).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.2426598072052002
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.3251981  Vali Loss: 0.2862875 Vali Accuracy: 0.9152542  Vali weighted F1: 0.9037537  Vali macro F1 0.8636688 
new best score!!!!
Validation loss decreased (0.295109 --> 0.286288).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.2379052639007568
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.3088442  Vali Loss: 0.2429642 Vali Accuracy: 0.9265537  Vali weighted F1: 0.9202119  Vali macro F1 0.8882685 
new best score!!!!
Validation loss decreased (0.286288 --> 0.242964).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.2372615337371826
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.2852013  Vali Loss: 0.2420434 Vali Accuracy: 0.9152542  Vali weighted F1: 0.9012951  Vali macro F1 0.8573118 
new best score!!!!
Validation loss decreased (0.242964 --> 0.242043).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.2386269569396973
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.2650864  Vali Loss: 0.2198846 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9216549  Vali macro F1 0.8859919 
new best score!!!!
Validation loss decreased (0.242043 --> 0.219885).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.2419250011444092
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.2480209  Vali Loss: 0.2107288 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9344672  Vali macro F1 0.9042872 
new best score!!!!
Validation loss decreased (0.219885 --> 0.210729).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.242161750793457
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.2342571  Vali Loss: 0.2005424 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9207907  Vali macro F1 0.8780369 
new best score!!!!
Validation loss decreased (0.210729 --> 0.200542).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.2398369312286377
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.2211148  Vali Loss: 0.1789103 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9372616  Vali macro F1 0.9071553 
new best score!!!!
Validation loss decreased (0.200542 --> 0.178910).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.2399752140045166
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.2032060  Vali Loss: 0.1726916 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9314238  Vali macro F1 0.9000871 
new best score!!!!
Validation loss decreased (0.178910 --> 0.172692).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.241506814956665
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.1924462  Vali Loss: 0.1634545 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9355641  Vali macro F1 0.9073211 
new best score!!!!
Validation loss decreased (0.172692 --> 0.163454).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.2404680252075195
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.1865527  Vali Loss: 0.1677458 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9401641  Vali macro F1 0.9110277 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 1.2406930923461914
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.1728627  Vali Loss: 0.1505759 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9432535  Vali macro F1 0.9150341 
new best score!!!!
Validation loss decreased (0.163454 --> 0.150576).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 1.241518497467041
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.1633894  Vali Loss: 0.1448285 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9403126  Vali macro F1 0.9094417 
new best score!!!!
Validation loss decreased (0.150576 --> 0.144829).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.2410204410552979
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.1617968  Vali Loss: 0.1509436 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9449366  Vali macro F1 0.9219189 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 1.2381467819213867
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.1562997  Vali Loss: 0.1343601 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9236351  Vali macro F1 0.8801715 
new best score!!!!
Validation loss decreased (0.144829 --> 0.134360).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 1.2376878261566162
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.1486198  Vali Loss: 0.1289931 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9502692  Vali macro F1 0.9229167 
new best score!!!!
Validation loss decreased (0.134360 --> 0.128993).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 1.2390878200531006
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.1374337  Vali Loss: 0.1191197 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9469349  Vali macro F1 0.9164860 
new best score!!!!
Validation loss decreased (0.128993 --> 0.119120).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 1.2405803203582764
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.1345494  Vali Loss: 0.1165558 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9541029  Vali macro F1 0.9246121 
new best score!!!!
Validation loss decreased (0.119120 --> 0.116556).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 1.2412011623382568
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.1245548  Vali Loss: 0.1086823 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9613665  Vali macro F1 0.9346430 
new best score!!!!
Validation loss decreased (0.116556 --> 0.108682).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.2397379875183105
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.1295887  Vali Loss: 0.1038938 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9661450  Vali macro F1 0.9458264 
new best score!!!!
Validation loss decreased (0.108682 --> 0.103894).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 1.2395946979522705
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.1259007  Vali Loss: 0.1220523 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9480663  Vali macro F1 0.9232533 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 1.2388432025909424
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.1139717  Vali Loss: 0.1058022 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9623017  Vali macro F1 0.9412346 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 1.2376353740692139
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.1143903  Vali Loss: 0.1268006 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9623511  Vali macro F1 0.9410971 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 1.2370989322662354
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.1084382  Vali Loss: 0.1003229 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9575264  Vali macro F1 0.9418438 
new best score!!!!
Validation loss decreased (0.103894 --> 0.100323).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 1.2386674880981445
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.1060293  Vali Loss: 0.0832894 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9713450  Vali macro F1 0.9546070 
new best score!!!!
Validation loss decreased (0.100323 --> 0.083289).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 1.2417078018188477
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0956924  Vali Loss: 0.0871000 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9677254  Vali macro F1 0.9468615 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 1.2395853996276855
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.1062455  Vali Loss: 0.0896269 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858548  Vali macro F1 0.9803211 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 1.2391362190246582
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0953101  Vali Loss: 0.0987398 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9547484  Vali macro F1 0.9281032 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 1.2387049198150635
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0966495  Vali Loss: 0.0923994 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9656839  Vali macro F1 0.9501778 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 45 cost time: 1.2444982528686523
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0878471  Vali Loss: 0.0734595 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830310  Vali macro F1 0.9778828 
new best score!!!!
Validation loss decreased (0.083289 --> 0.073460).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 1.2406566143035889
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0797343  Vali Loss: 0.0768080 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858003  Vali macro F1 0.9828658 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 1.2397325038909912
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0798322  Vali Loss: 0.0725173 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830468  Vali macro F1 0.9777769 
new best score!!!!
Validation loss decreased (0.073460 --> 0.072517).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 1.239797830581665
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0757881  Vali Loss: 0.0817630 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9639201  Vali macro F1 0.9390342 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 1.240523338317871
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0705494  Vali Loss: 0.0656767 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801379  Vali macro F1 0.9727102 
new best score!!!!
Validation loss decreased (0.072517 --> 0.065677).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 1.2501153945922852
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0655995  Vali Loss: 0.0771932 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801209  Vali macro F1 0.9705069 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 1.241420030593872
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0630872  Vali Loss: 0.0575732 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830106  Vali macro F1 0.9777422 
new best score!!!!
Validation loss decreased (0.065677 --> 0.057573).  Saving model ...
new best score!!!!
Epoch: 52 cost time: 1.2414617538452148
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0612224  Vali Loss: 0.0589900 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887203  Vali macro F1 0.9876620 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 1.2395541667938232
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0586687  Vali Loss: 0.0576344 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9742656  Vali macro F1 0.9623699 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 1.2389535903930664
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0592497  Vali Loss: 0.0527966 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886819  Vali macro F1 0.9849945 
new best score!!!!
Validation loss decreased (0.057573 --> 0.052797).  Saving model ...
new best score!!!!
Epoch: 55 cost time: 1.2393829822540283
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0536204  Vali Loss: 0.0575292 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887111  Vali macro F1 0.9824724 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 1.2403299808502197
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0601845  Vali Loss: 0.0532769 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 57 cost time: 1.2404334545135498
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0591819  Vali Loss: 0.0614588 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9769138  Vali macro F1 0.9622221 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 58 cost time: 1.237969160079956
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0534418  Vali Loss: 0.0719258 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9645082  Vali macro F1 0.9428692 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 59 cost time: 1.2401130199432373
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0512701  Vali Loss: 0.1096041 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9562736  Vali macro F1 0.9272440 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 60 cost time: 1.2416491508483887
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0549741  Vali Loss: 0.0462715 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943641  Vali macro F1 0.9922169 
new best score!!!!
Validation loss decreased (0.052797 --> 0.046271).  Saving model ...
new best score!!!!
Epoch: 61 cost time: 1.2424671649932861
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0426097  Vali Loss: 0.0443362 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915426  Vali macro F1 0.9873446 
new best score!!!!
Validation loss decreased (0.046271 --> 0.044336).  Saving model ...
new best score!!!!
Epoch: 62 cost time: 1.2420196533203125
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0400901  Vali Loss: 0.0432658 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943641  Vali macro F1 0.9922169 
new best score!!!!
Validation loss decreased (0.044336 --> 0.043266).  Saving model ...
new best score!!!!
Epoch: 63 cost time: 1.2403721809387207
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0406617  Vali Loss: 0.0422199 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943641  Vali macro F1 0.9922169 
new best score!!!!
Validation loss decreased (0.043266 --> 0.042220).  Saving model ...
new best score!!!!
Epoch: 64 cost time: 1.2420661449432373
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0389918  Vali Loss: 0.0409631 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943641  Vali macro F1 0.9922169 
new best score!!!!
Validation loss decreased (0.042220 --> 0.040963).  Saving model ...
new best score!!!!
Epoch: 65 cost time: 1.2421586513519287
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0391656  Vali Loss: 0.0407877 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943641  Vali macro F1 0.9922169 
new best score!!!!
Validation loss decreased (0.040963 --> 0.040788).  Saving model ...
new best score!!!!
Epoch: 66 cost time: 1.2392597198486328
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0370243  Vali Loss: 0.0410506 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 67 cost time: 1.2381260395050049
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0411028  Vali Loss: 0.0391538 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943641  Vali macro F1 0.9922169 
new best score!!!!
Validation loss decreased (0.040788 --> 0.039154).  Saving model ...
new best score!!!!
Epoch: 68 cost time: 1.2405219078063965
VALI: Epoch: 68, Steps: 13 | Train Loss: 0.0359688  Vali Loss: 0.0414041 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 69 cost time: 1.2384426593780518
VALI: Epoch: 69, Steps: 13 | Train Loss: 0.0377382  Vali Loss: 0.0383914 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
new best score!!!!
Validation loss decreased (0.039154 --> 0.038391).  Saving model ...
new best score!!!!
Epoch: 70 cost time: 1.2381045818328857
VALI: Epoch: 70, Steps: 13 | Train Loss: 0.0372061  Vali Loss: 0.0372743 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
new best score!!!!
Validation loss decreased (0.038391 --> 0.037274).  Saving model ...
new best score!!!!
Epoch: 71 cost time: 1.2428913116455078
VALI: Epoch: 71, Steps: 13 | Train Loss: 0.0365061  Vali Loss: 0.0375590 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 72 cost time: 1.2411346435546875
VALI: Epoch: 72, Steps: 13 | Train Loss: 0.0370856  Vali Loss: 0.0383516 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 73 cost time: 1.2408602237701416
VALI: Epoch: 73, Steps: 13 | Train Loss: 0.0367242  Vali Loss: 0.0383373 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 74 cost time: 1.2394778728485107
VALI: Epoch: 74, Steps: 13 | Train Loss: 0.0341418  Vali Loss: 0.0374238 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 75 cost time: 1.2401535511016846
VALI: Epoch: 75, Steps: 13 | Train Loss: 0.0335773  Vali Loss: 0.0374544 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 76 cost time: 1.2381560802459717
VALI: Epoch: 76, Steps: 13 | Train Loss: 0.0351899  Vali Loss: 0.0375257 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 77 cost time: 1.2387607097625732
VALI: Epoch: 77, Steps: 13 | Train Loss: 0.0373334  Vali Loss: 0.0372823 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 78 cost time: 1.2439923286437988
VALI: Epoch: 78, Steps: 13 | Train Loss: 0.0386913  Vali Loss: 0.0370472 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
new best score!!!!
Validation loss decreased (0.037274 --> 0.037047).  Saving model ...
new best score!!!!
Epoch: 79 cost time: 1.239607810974121
VALI: Epoch: 79, Steps: 13 | Train Loss: 0.0355947  Vali Loss: 0.0368087 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
new best score!!!!
Validation loss decreased (0.037047 --> 0.036809).  Saving model ...
new best score!!!!
Epoch: 80 cost time: 1.238863468170166
VALI: Epoch: 80, Steps: 13 | Train Loss: 0.0359434  Vali Loss: 0.0368284 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 81 cost time: 1.2415275573730469
VALI: Epoch: 81, Steps: 13 | Train Loss: 0.0388341  Vali Loss: 0.0368357 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 82 cost time: 1.2412571907043457
VALI: Epoch: 82, Steps: 13 | Train Loss: 0.0362418  Vali Loss: 0.0369531 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 83 cost time: 1.2624974250793457
VALI: Epoch: 83, Steps: 13 | Train Loss: 0.0354539  Vali Loss: 0.0371154 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 84 cost time: 1.2379755973815918
VALI: Epoch: 84, Steps: 13 | Train Loss: 0.0372994  Vali Loss: 0.0371795 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 85 cost time: 1.2412381172180176
VALI: Epoch: 85, Steps: 13 | Train Loss: 0.0362632  Vali Loss: 0.0371910 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 86 cost time: 1.239753007888794
VALI: Epoch: 86, Steps: 13 | Train Loss: 0.0385822  Vali Loss: 0.0371869 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 87 cost time: 1.2386956214904785
VALI: Epoch: 87, Steps: 13 | Train Loss: 0.0365591  Vali Loss: 0.0371707 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 88 cost time: 1.2378733158111572
VALI: Epoch: 88, Steps: 13 | Train Loss: 0.0376503  Vali Loss: 0.0371501 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 89 cost time: 1.2395281791687012
VALI: Epoch: 89, Steps: 13 | Train Loss: 0.0356603  Vali Loss: 0.0371375 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 90 cost time: 1.2404074668884277
VALI: Epoch: 90, Steps: 13 | Train Loss: 0.0360470  Vali Loss: 0.0371346 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 91 cost time: 1.240417718887329
VALI: Epoch: 91, Steps: 13 | Train Loss: 0.0317708  Vali Loss: 0.0371328 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 92 cost time: 1.2392578125
VALI: Epoch: 92, Steps: 13 | Train Loss: 0.0361356  Vali Loss: 0.0371325 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 93 cost time: 1.23911714553833
VALI: Epoch: 93, Steps: 13 | Train Loss: 0.0336675  Vali Loss: 0.0371316 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 94 cost time: 1.2390105724334717
VALI: Epoch: 94, Steps: 13 | Train Loss: 0.0338524  Vali Loss: 0.0371287 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9841629  Test weighted F1: 0.9841494  Test macro F1 0.9828101 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 73347
pruned model Parameter : 76626
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.2510645389556885
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0351877  Vali Loss: 0.0366144 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
Validation loss decreased (inf --> 0.036614).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.2542521953582764
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0338297  Vali Loss: 0.0375170 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943641  Vali macro F1 0.9922169 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.2500874996185303
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0324508  Vali Loss: 0.0347455 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
new best score!!!!
Validation loss decreased (0.036614 --> 0.034746).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 1.2484605312347412
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0369532  Vali Loss: 0.0347982 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 1.2479846477508545
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0331738  Vali Loss: 0.0364134 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 1.2498502731323242
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0331869  Vali Loss: 0.0345818 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
new best score!!!!
Validation loss decreased (0.034746 --> 0.034582).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 1.252176284790039
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0363067  Vali Loss: 0.0329784 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
new best score!!!!
Validation loss decreased (0.034582 --> 0.032978).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 1.251657247543335
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0345237  Vali Loss: 0.0341509 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 1.2477879524230957
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0306439  Vali Loss: 0.0319092 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
new best score!!!!
Validation loss decreased (0.032978 --> 0.031909).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 1.2512362003326416
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0345123  Vali Loss: 0.0341370 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886819  Vali macro F1 0.9849945 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 1.2516272068023682
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0306976  Vali Loss: 0.0318543 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
new best score!!!!
Validation loss decreased (0.031909 --> 0.031854).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 1.250490665435791
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0342489  Vali Loss: 0.0319411 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 1.2518587112426758
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0316123  Vali Loss: 0.0338127 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 1.2507820129394531
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0286726  Vali Loss: 0.0334542 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 1.2514145374298096
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0291977  Vali Loss: 0.0306364 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
new best score!!!!
Validation loss decreased (0.031854 --> 0.030636).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 1.2499892711639404
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0285264  Vali Loss: 0.0304916 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
new best score!!!!
Validation loss decreased (0.030636 --> 0.030492).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 1.257861852645874
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0280618  Vali Loss: 0.0367970 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858366  Vali macro F1 0.9800283 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 1.250636100769043
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0313400  Vali Loss: 0.0301350 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
new best score!!!!
Validation loss decreased (0.030492 --> 0.030135).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 1.2506053447723389
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0325320  Vali Loss: 0.0315605 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 1.250476360321045
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0293355  Vali Loss: 0.0327074 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 1.2569525241851807
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0291931  Vali Loss: 0.0290755 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
new best score!!!!
Validation loss decreased (0.030135 --> 0.029076).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 22 cost time: 1.2578635215759277
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0293844  Vali Loss: 0.0340912 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858366  Vali macro F1 0.9800283 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 1.2512948513031006
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0327347  Vali Loss: 0.0291152 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 1.2539422512054443
Fine Tuning VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0268313  Vali Loss: 0.0289808 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
new best score!!!!
Validation loss decreased (0.029076 --> 0.028981).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 25 cost time: 1.250399112701416
Fine Tuning VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0253303  Vali Loss: 0.0297412 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 1.2530372142791748
Fine Tuning VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0268499  Vali Loss: 0.0292749 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 27 cost time: 1.251708984375
Fine Tuning VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0249832  Vali Loss: 0.0284653 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
new best score!!!!
Validation loss decreased (0.028981 --> 0.028465).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 28 cost time: 1.2515931129455566
Fine Tuning VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0269033  Vali Loss: 0.0285261 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 29 cost time: 1.2521677017211914
Fine Tuning VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0260579  Vali Loss: 0.0275136 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
new best score!!!!
Validation loss decreased (0.028465 --> 0.027514).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 30 cost time: 1.2557952404022217
Fine Tuning VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0251000  Vali Loss: 0.0272363 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
new best score!!!!
Validation loss decreased (0.027514 --> 0.027236).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 31 cost time: 1.2551722526550293
Fine Tuning VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0298587  Vali Loss: 0.0304055 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 32 cost time: 1.2519855499267578
Fine Tuning VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0257680  Vali Loss: 0.0264267 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
new best score!!!!
Validation loss decreased (0.027236 --> 0.026427).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 33 cost time: 1.2544105052947998
Fine Tuning VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0252291  Vali Loss: 0.0312583 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886819  Vali macro F1 0.9849945 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 34 cost time: 1.2531051635742188
Fine Tuning VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0245533  Vali Loss: 0.0263604 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
new best score!!!!
Validation loss decreased (0.026427 --> 0.026360).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 35 cost time: 1.253751277923584
Fine Tuning VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0245669  Vali Loss: 0.0269038 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 36 cost time: 1.254633903503418
Fine Tuning VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0249290  Vali Loss: 0.0254573 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
new best score!!!!
Validation loss decreased (0.026360 --> 0.025457).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 37 cost time: 1.2528893947601318
Fine Tuning VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0255393  Vali Loss: 0.0277800 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 38 cost time: 1.2548367977142334
Fine Tuning VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0228814  Vali Loss: 0.0246010 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943641  Vali macro F1 0.9922169 
new best score!!!!
Validation loss decreased (0.025457 --> 0.024601).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 39 cost time: 1.2518329620361328
Fine Tuning VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0239266  Vali Loss: 0.0280542 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 40 cost time: 1.2525548934936523
Fine Tuning VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0248131  Vali Loss: 0.0287634 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 41 cost time: 1.2515535354614258
Fine Tuning VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0247182  Vali Loss: 0.0252103 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 42 cost time: 1.2525224685668945
Fine Tuning VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0235456  Vali Loss: 0.0278477 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 43 cost time: 1.2523632049560547
Fine Tuning VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0227151  Vali Loss: 0.0259453 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 44 cost time: 1.252490520477295
Fine Tuning VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0255981  Vali Loss: 0.0254168 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 45 cost time: 1.2514004707336426
Fine Tuning VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0210859  Vali Loss: 0.0244100 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
new best score!!!!
Validation loss decreased (0.024601 --> 0.024410).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 46 cost time: 1.2512867450714111
Fine Tuning VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0251644  Vali Loss: 0.0273590 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886819  Vali macro F1 0.9849945 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 47 cost time: 1.2559428215026855
Fine Tuning VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0249689  Vali Loss: 0.0233301 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
new best score!!!!
Validation loss decreased (0.024410 --> 0.023330).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 48 cost time: 1.2584328651428223
Fine Tuning VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0216102  Vali Loss: 0.0244273 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 49 cost time: 1.2500965595245361
Fine Tuning VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0224058  Vali Loss: 0.0249385 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 50 cost time: 1.2549903392791748
Fine Tuning VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0216708  Vali Loss: 0.0260667 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 51 cost time: 1.2531459331512451
Fine Tuning VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0202843  Vali Loss: 0.0261376 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 52 cost time: 1.2560944557189941
Fine Tuning VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0232395  Vali Loss: 0.0256225 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 53 cost time: 1.259772777557373
Fine Tuning VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0216696  Vali Loss: 0.0261206 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 54 cost time: 1.2661364078521729
Fine Tuning VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0228392  Vali Loss: 0.0268007 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 55 cost time: 1.2690868377685547
Fine Tuning VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0218162  Vali Loss: 0.0259733 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 56 cost time: 1.2577056884765625
Fine Tuning VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0227934  Vali Loss: 0.0257786 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 57 cost time: 1.2562179565429688
Fine Tuning VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0200345  Vali Loss: 0.0253412 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 58 cost time: 1.2547411918640137
Fine Tuning VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0208297  Vali Loss: 0.0253411 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 59 cost time: 1.251150369644165
Fine Tuning VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0206041  Vali Loss: 0.0253745 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 60 cost time: 1.254974126815796
Fine Tuning VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0207799  Vali Loss: 0.0254026 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 61 cost time: 1.2548751831054688
Fine Tuning VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0217064  Vali Loss: 0.0254106 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 62 cost time: 1.2555828094482422
Fine Tuning VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0204658  Vali Loss: 0.0254004 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915101  Vali macro F1 0.9899134 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9875566  Test weighted F1: 0.9875666  Test macro F1 0.9857854 
================ the 1 th CV Experiment ================ 
Overlapping random Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00266667 0.00239234 0.0023753  0.00332226 0.00595238 0.00568182
 0.00320513 0.00302115 0.00234192 0.00390625]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.2411479949951172
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.2853936  Vali Loss: 2.2744962 Vali Accuracy: 0.1158192  Vali weighted F1: 0.0240435  Vali macro F1 0.0207595 
Validation loss decreased (inf --> 2.274496).  Saving model ...
Epoch: 2 cost time: 1.228879690170288
VALI: Epoch: 2, Steps: 13 | Train Loss: 2.2477461  Vali Loss: 2.2015014 Vali Accuracy: 0.1920904  Vali weighted F1: 0.1055517  Vali macro F1 0.0792911 
new best score!!!!
Validation loss decreased (2.274496 --> 2.201501).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.2303414344787598
VALI: Epoch: 3, Steps: 13 | Train Loss: 2.0795753  Vali Loss: 1.8260127 Vali Accuracy: 0.3305085  Vali weighted F1: 0.2879338  Vali macro F1 0.2752549 
new best score!!!!
Validation loss decreased (2.201501 --> 1.826013).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.2303619384765625
VALI: Epoch: 4, Steps: 13 | Train Loss: 1.6488785  Vali Loss: 1.3842253 Vali Accuracy: 0.5706215  Vali weighted F1: 0.5572515  Vali macro F1 0.5221173 
new best score!!!!
Validation loss decreased (1.826013 --> 1.384225).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.2319574356079102
VALI: Epoch: 5, Steps: 13 | Train Loss: 1.3149651  Vali Loss: 1.1120401 Vali Accuracy: 0.6723164  Vali weighted F1: 0.6330734  Vali macro F1 0.5784485 
new best score!!!!
Validation loss decreased (1.384225 --> 1.112040).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.2345836162567139
VALI: Epoch: 6, Steps: 13 | Train Loss: 1.0789364  Vali Loss: 0.8604493 Vali Accuracy: 0.7344633  Vali weighted F1: 0.7028196  Vali macro F1 0.6472137 
new best score!!!!
Validation loss decreased (1.112040 --> 0.860449).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.229828119277954
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.9063753  Vali Loss: 0.7324365 Vali Accuracy: 0.7853107  Vali weighted F1: 0.7899910  Vali macro F1 0.7635327 
new best score!!!!
Validation loss decreased (0.860449 --> 0.732437).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.228062391281128
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.7710749  Vali Loss: 0.6333526 Vali Accuracy: 0.8248588  Vali weighted F1: 0.8048361  Vali macro F1 0.7642505 
new best score!!!!
Validation loss decreased (0.732437 --> 0.633353).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.2299892902374268
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.6546560  Vali Loss: 0.5301218 Vali Accuracy: 0.8361582  Vali weighted F1: 0.8342404  Vali macro F1 0.8051815 
new best score!!!!
Validation loss decreased (0.633353 --> 0.530122).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.2294976711273193
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.5661217  Vali Loss: 0.4812440 Vali Accuracy: 0.8728814  Vali weighted F1: 0.8700868  Vali macro F1 0.8449030 
new best score!!!!
Validation loss decreased (0.530122 --> 0.481244).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.224973201751709
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.5065069  Vali Loss: 0.4389191 Vali Accuracy: 0.8531073  Vali weighted F1: 0.8488453  Vali macro F1 0.8203580 
new best score!!!!
Validation loss decreased (0.481244 --> 0.438919).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.2215120792388916
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.4449627  Vali Loss: 0.3820130 Vali Accuracy: 0.8728814  Vali weighted F1: 0.8581991  Vali macro F1 0.8189904 
new best score!!!!
Validation loss decreased (0.438919 --> 0.382013).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.2297580242156982
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.4105646  Vali Loss: 0.3421796 Vali Accuracy: 0.8954802  Vali weighted F1: 0.8919260  Vali macro F1 0.8608033 
new best score!!!!
Validation loss decreased (0.382013 --> 0.342180).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.2316906452178955
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.3758894  Vali Loss: 0.3399291 Vali Accuracy: 0.9096045  Vali weighted F1: 0.9087806  Vali macro F1 0.8900428 
new best score!!!!
Validation loss decreased (0.342180 --> 0.339929).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.2294819355010986
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.3575650  Vali Loss: 0.2865522 Vali Accuracy: 0.9265537  Vali weighted F1: 0.9243805  Vali macro F1 0.8948882 
new best score!!!!
Validation loss decreased (0.339929 --> 0.286552).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.2277181148529053
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.3297032  Vali Loss: 0.2612889 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9298552  Vali macro F1 0.9007761 
new best score!!!!
Validation loss decreased (0.286552 --> 0.261289).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.2305858135223389
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.3014415  Vali Loss: 0.2532028 Vali Accuracy: 0.9180791  Vali weighted F1: 0.9176947  Vali macro F1 0.8888817 
new best score!!!!
Validation loss decreased (0.261289 --> 0.253203).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.2301185131072998
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.2781472  Vali Loss: 0.2801791 Vali Accuracy: 0.9124294  Vali weighted F1: 0.9073163  Vali macro F1 0.8778341 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 1.2321820259094238
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.2572800  Vali Loss: 0.2229838 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9278095  Vali macro F1 0.9032156 
new best score!!!!
Validation loss decreased (0.253203 --> 0.222984).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.2299771308898926
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.2305871  Vali Loss: 0.2079547 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9381656  Vali macro F1 0.9037022 
new best score!!!!
Validation loss decreased (0.222984 --> 0.207955).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.2402725219726562
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.2284081  Vali Loss: 0.1984118 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9134608  Vali macro F1 0.8577680 
new best score!!!!
Validation loss decreased (0.207955 --> 0.198412).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.2294442653656006
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.2165397  Vali Loss: 0.1801125 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9517899  Vali macro F1 0.9323248 
new best score!!!!
Validation loss decreased (0.198412 --> 0.180112).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.2228095531463623
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.1984376  Vali Loss: 0.1709069 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9344985  Vali macro F1 0.8963060 
new best score!!!!
Validation loss decreased (0.180112 --> 0.170907).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.2241408824920654
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.1919350  Vali Loss: 0.1711894 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9190887  Vali macro F1 0.8623259 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 1.2410316467285156
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.1734528  Vali Loss: 0.1526720 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9599751  Vali macro F1 0.9399766 
new best score!!!!
Validation loss decreased (0.170907 --> 0.152672).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.223323106765747
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.1666593  Vali Loss: 0.1543124 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9632131  Vali macro F1 0.9528702 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 1.2192585468292236
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.1559260  Vali Loss: 0.1449399 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9631249  Vali macro F1 0.9452222 
new best score!!!!
Validation loss decreased (0.152672 --> 0.144940).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 1.2212011814117432
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.1431603  Vali Loss: 0.1320348 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9660528  Vali macro F1 0.9537663 
new best score!!!!
Validation loss decreased (0.144940 --> 0.132035).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.2209999561309814
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.1372712  Vali Loss: 0.1291944 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9689115  Vali macro F1 0.9600586 
new best score!!!!
Validation loss decreased (0.132035 --> 0.129194).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.220325231552124
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.1304537  Vali Loss: 0.1239992 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9772183  Vali macro F1 0.9660072 
new best score!!!!
Validation loss decreased (0.129194 --> 0.123999).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 1.2206981182098389
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.1205875  Vali Loss: 0.1203107 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9510044  Vali macro F1 0.9207554 
new best score!!!!
Validation loss decreased (0.123999 --> 0.120311).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 1.221160650253296
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.1167271  Vali Loss: 0.0953700 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9828684  Vali macro F1 0.9705742 
new best score!!!!
Validation loss decreased (0.120311 --> 0.095370).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 1.2203750610351562
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.1024112  Vali Loss: 0.1177656 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9593209  Vali macro F1 0.9404455 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 1.2173352241516113
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.1062079  Vali Loss: 0.1084878 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9510014  Vali macro F1 0.9205646 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 1.218672752380371
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.1037683  Vali Loss: 0.0900081 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858600  Vali macro F1 0.9829069 
new best score!!!!
Validation loss decreased (0.095370 --> 0.090008).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 1.2219033241271973
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.1013477  Vali Loss: 0.1053616 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9414330  Vali macro F1 0.9005667 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 1.2226593494415283
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.1037376  Vali Loss: 0.1001201 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9547231  Vali macro F1 0.9274605 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 1.2174944877624512
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0853166  Vali Loss: 0.0857349 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9677935  Vali macro F1 0.9479192 
new best score!!!!
Validation loss decreased (0.090008 --> 0.085735).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 1.2219665050506592
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0789785  Vali Loss: 0.0718027 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829648  Vali macro F1 0.9749353 
new best score!!!!
Validation loss decreased (0.085735 --> 0.071803).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 1.2209444046020508
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0750550  Vali Loss: 0.0799336 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9771978  Vali macro F1 0.9655294 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 1.226262092590332
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0785724  Vali Loss: 0.1234464 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9652989  Vali macro F1 0.9481479 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 1.2249341011047363
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0775324  Vali Loss: 0.0593523 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829068  Vali macro F1 0.9721825 
new best score!!!!
Validation loss decreased (0.071803 --> 0.059352).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 1.2221624851226807
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0646615  Vali Loss: 0.0942694 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9772507  Vali macro F1 0.9667824 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 1.2215003967285156
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0633445  Vali Loss: 0.0549261 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887111  Vali macro F1 0.9824724 
new best score!!!!
Validation loss decreased (0.059352 --> 0.054926).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 1.2218022346496582
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0592617  Vali Loss: 0.0466830 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943570  Vali macro F1 0.9902381 
new best score!!!!
Validation loss decreased (0.054926 --> 0.046683).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 1.220271348953247
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0531235  Vali Loss: 0.0584563 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858677  Vali macro F1 0.9800517 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 1.2209501266479492
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0491557  Vali Loss: 0.0391655 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915359  Vali macro F1 0.9872979 
new best score!!!!
Validation loss decreased (0.046683 --> 0.039165).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 1.2188234329223633
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0446894  Vali Loss: 0.0605564 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801379  Vali macro F1 0.9727102 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 1.2196409702301025
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0550147  Vali Loss: 0.0740906 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829826  Vali macro F1 0.9755964 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 1.2190742492675781
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0563642  Vali Loss: 0.0636439 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801231  Vali macro F1 0.9703547 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 1.2208187580108643
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0507285  Vali Loss: 0.0405154 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857212  Vali macro F1 0.9750760 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 52 cost time: 1.2198727130889893
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0447871  Vali Loss: 0.0439394 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859413  Vali macro F1 0.9819919 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 53 cost time: 1.2193989753723145
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0407607  Vali Loss: 0.0378540 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915966  Vali macro F1 0.9891978 
new best score!!!!
Validation loss decreased (0.039165 --> 0.037854).  Saving model ...
new best score!!!!
Epoch: 54 cost time: 1.222992181777954
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0370861  Vali Loss: 0.0347751 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915359  Vali macro F1 0.9872979 
new best score!!!!
Validation loss decreased (0.037854 --> 0.034775).  Saving model ...
new best score!!!!
Epoch: 55 cost time: 1.2195029258728027
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0392568  Vali Loss: 0.0351681 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915359  Vali macro F1 0.9872979 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 1.2167589664459229
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0381129  Vali Loss: 0.0326413 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915359  Vali macro F1 0.9872979 
new best score!!!!
Validation loss decreased (0.034775 --> 0.032641).  Saving model ...
new best score!!!!
Epoch: 57 cost time: 1.2237772941589355
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0374878  Vali Loss: 0.0335083 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 58 cost time: 1.218338966369629
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0373186  Vali Loss: 0.0347000 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915359  Vali macro F1 0.9872979 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 59 cost time: 1.2221465110778809
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0374490  Vali Loss: 0.0348787 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915359  Vali macro F1 0.9872979 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 60 cost time: 1.2211062908172607
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0383990  Vali Loss: 0.0321768 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915359  Vali macro F1 0.9872979 
new best score!!!!
Validation loss decreased (0.032641 --> 0.032177).  Saving model ...
new best score!!!!
Epoch: 61 cost time: 1.2354323863983154
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0359827  Vali Loss: 0.0385520 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858180  Vali macro F1 0.9772998 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 62 cost time: 1.2218050956726074
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0377560  Vali Loss: 0.0322837 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915359  Vali macro F1 0.9872979 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 63 cost time: 1.2195522785186768
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0354104  Vali Loss: 0.0367222 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915359  Vali macro F1 0.9872979 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 64 cost time: 1.2158396244049072
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0334915  Vali Loss: 0.0343587 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915359  Vali macro F1 0.9872979 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 65 cost time: 1.2196455001831055
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0350522  Vali Loss: 0.0327826 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915359  Vali macro F1 0.9872979 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 66 cost time: 1.2187438011169434
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0337509  Vali Loss: 0.0329548 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915359  Vali macro F1 0.9872979 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 67 cost time: 1.2175610065460205
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0351836  Vali Loss: 0.0329709 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915359  Vali macro F1 0.9872979 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 68 cost time: 1.217665195465088
VALI: Epoch: 68, Steps: 13 | Train Loss: 0.0330176  Vali Loss: 0.0332657 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915359  Vali macro F1 0.9872979 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 69 cost time: 1.2197237014770508
VALI: Epoch: 69, Steps: 13 | Train Loss: 0.0326945  Vali Loss: 0.0328791 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915359  Vali macro F1 0.9872979 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 70 cost time: 1.2209947109222412
VALI: Epoch: 70, Steps: 13 | Train Loss: 0.0318225  Vali Loss: 0.0327830 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915359  Vali macro F1 0.9872979 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 71 cost time: 1.2187268733978271
VALI: Epoch: 71, Steps: 13 | Train Loss: 0.0333898  Vali Loss: 0.0327900 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915359  Vali macro F1 0.9872979 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 72 cost time: 1.218299388885498
VALI: Epoch: 72, Steps: 13 | Train Loss: 0.0320069  Vali Loss: 0.0327789 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915359  Vali macro F1 0.9872979 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 73 cost time: 1.2181165218353271
VALI: Epoch: 73, Steps: 13 | Train Loss: 0.0342878  Vali Loss: 0.0327983 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915359  Vali macro F1 0.9872979 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 74 cost time: 1.217646837234497
VALI: Epoch: 74, Steps: 13 | Train Loss: 0.0327713  Vali Loss: 0.0327879 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915359  Vali macro F1 0.9872979 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 75 cost time: 1.2170426845550537
VALI: Epoch: 75, Steps: 13 | Train Loss: 0.0367086  Vali Loss: 0.0327764 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915359  Vali macro F1 0.9872979 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9841629  Test weighted F1: 0.9842399  Test macro F1 0.9794528 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 73347
pruned model Parameter : 76626
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.247941255569458
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0385427  Vali Loss: 0.0462929 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858180  Vali macro F1 0.9772998 
Validation loss decreased (inf --> 0.046293).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.2404437065124512
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0328026  Vali Loss: 0.0316134 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915359  Vali macro F1 0.9872979 
new best score!!!!
Validation loss decreased (0.046293 --> 0.031613).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 1.2381222248077393
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0337054  Vali Loss: 0.0310707 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
new best score!!!!
Validation loss decreased (0.031613 --> 0.031071).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 1.2375078201293945
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0340187  Vali Loss: 0.0405039 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829909  Vali macro F1 0.9750128 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 1.239269733428955
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0333031  Vali Loss: 0.0305267 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943641  Vali macro F1 0.9922169 
new best score!!!!
Validation loss decreased (0.031071 --> 0.030527).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 1.240267276763916
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0336516  Vali Loss: 0.0360619 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886907  Vali macro F1 0.9823318 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 1.2390389442443848
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0341332  Vali Loss: 0.0300427 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943641  Vali macro F1 0.9922169 
new best score!!!!
Validation loss decreased (0.030527 --> 0.030043).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 1.2419886589050293
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0297908  Vali Loss: 0.0328900 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915359  Vali macro F1 0.9872979 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 1.2404851913452148
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0330034  Vali Loss: 0.0296219 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915359  Vali macro F1 0.9872979 
new best score!!!!
Validation loss decreased (0.030043 --> 0.029622).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 1.2423179149627686
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0324622  Vali Loss: 0.0342872 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886907  Vali macro F1 0.9823318 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 1.23885178565979
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0304914  Vali Loss: 0.0287352 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971785  Vali macro F1 0.9951103 
new best score!!!!
Validation loss decreased (0.029622 --> 0.028735).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 1.2413287162780762
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0326078  Vali Loss: 0.0344104 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886907  Vali macro F1 0.9823318 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 1.2429418563842773
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0318322  Vali Loss: 0.0279426 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
new best score!!!!
Validation loss decreased (0.028735 --> 0.027943).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 1.2418437004089355
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0289352  Vali Loss: 0.0311617 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915359  Vali macro F1 0.9872979 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 1.2463281154632568
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0307002  Vali Loss: 0.0308259 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915359  Vali macro F1 0.9872979 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 1.2412383556365967
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0286422  Vali Loss: 0.0390094 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886907  Vali macro F1 0.9823318 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 1.242825984954834
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0282174  Vali Loss: 0.0384072 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829909  Vali macro F1 0.9750128 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 1.239197015762329
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0318351  Vali Loss: 0.0272581 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943641  Vali macro F1 0.9922169 
new best score!!!!
Validation loss decreased (0.027943 --> 0.027258).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 1.2418158054351807
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0276723  Vali Loss: 0.0412873 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858636  Vali macro F1 0.9800448 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 1.2415893077850342
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0297352  Vali Loss: 0.0275487 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887088  Vali macro F1 0.9850110 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 1.2394142150878906
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0292117  Vali Loss: 0.0291949 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887088  Vali macro F1 0.9850110 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 1.2464702129364014
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0295145  Vali Loss: 0.0317173 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886907  Vali macro F1 0.9823318 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 23 cost time: 1.2426931858062744
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0277878  Vali Loss: 0.0287208 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915359  Vali macro F1 0.9872979 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 24 cost time: 1.2416050434112549
Fine Tuning VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0293872  Vali Loss: 0.0283917 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915359  Vali macro F1 0.9872979 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 25 cost time: 1.2410507202148438
Fine Tuning VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0258565  Vali Loss: 0.0317751 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915359  Vali macro F1 0.9872979 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 26 cost time: 1.2425107955932617
Fine Tuning VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0280277  Vali Loss: 0.0276473 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915359  Vali macro F1 0.9872979 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 27 cost time: 1.2418835163116455
Fine Tuning VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0283843  Vali Loss: 0.0394312 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886907  Vali macro F1 0.9823318 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 28 cost time: 1.2406234741210938
Fine Tuning VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0256652  Vali Loss: 0.0252848 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915359  Vali macro F1 0.9872979 
new best score!!!!
Validation loss decreased (0.027258 --> 0.025285).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 29 cost time: 1.242798089981079
Fine Tuning VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0252339  Vali Loss: 0.0422380 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 30 cost time: 1.2419192790985107
Fine Tuning VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0232537  Vali Loss: 0.0266122 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 31 cost time: 1.2419121265411377
Fine Tuning VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0219090  Vali Loss: 0.0294548 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886907  Vali macro F1 0.9823318 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 32 cost time: 1.2434039115905762
Fine Tuning VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0249310  Vali Loss: 0.0334053 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886907  Vali macro F1 0.9823318 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 33 cost time: 1.2409443855285645
Fine Tuning VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0233928  Vali Loss: 0.0306657 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858636  Vali macro F1 0.9800448 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 34 cost time: 1.2444438934326172
Fine Tuning VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0250830  Vali Loss: 0.0294876 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858636  Vali macro F1 0.9800448 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 35 cost time: 1.242802381515503
Fine Tuning VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0245539  Vali Loss: 0.0275350 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887088  Vali macro F1 0.9850110 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 36 cost time: 1.2410624027252197
Fine Tuning VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0238292  Vali Loss: 0.0263485 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915359  Vali macro F1 0.9872979 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 37 cost time: 1.2403862476348877
Fine Tuning VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0254968  Vali Loss: 0.0264341 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915359  Vali macro F1 0.9872979 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 38 cost time: 1.2390995025634766
Fine Tuning VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0235868  Vali Loss: 0.0267693 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915359  Vali macro F1 0.9872979 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 39 cost time: 1.2387237548828125
Fine Tuning VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0221407  Vali Loss: 0.0265762 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915359  Vali macro F1 0.9872979 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 40 cost time: 1.2373483180999756
Fine Tuning VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0240229  Vali Loss: 0.0265407 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915359  Vali macro F1 0.9872979 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 41 cost time: 1.2427988052368164
Fine Tuning VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0243982  Vali Loss: 0.0265002 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915359  Vali macro F1 0.9872979 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 42 cost time: 1.2390267848968506
Fine Tuning VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0234636  Vali Loss: 0.0265703 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915359  Vali macro F1 0.9872979 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 43 cost time: 1.2380387783050537
Fine Tuning VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0234159  Vali Loss: 0.0267072 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915359  Vali macro F1 0.9872979 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9864253  Test weighted F1: 0.9864755  Test macro F1 0.9844749 
================ the 2 th CV Experiment ================ 
Overlapping random Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.00277008 0.00236407 0.00247525 0.00325733 0.00543478 0.00574713
 0.00328947 0.00277008 0.00242131 0.00393701]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.2206463813781738
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.2866814  Vali Loss: 2.2748687 Vali Accuracy: 0.1497175  Vali weighted F1: 0.0621147  Vali macro F1 0.0495811 
Validation loss decreased (inf --> 2.274869).  Saving model ...
Epoch: 2 cost time: 1.220245361328125
VALI: Epoch: 2, Steps: 13 | Train Loss: 2.2395185  Vali Loss: 2.1683154 Vali Accuracy: 0.2005650  Vali weighted F1: 0.0916839  Vali macro F1 0.0691463 
new best score!!!!
Validation loss decreased (2.274869 --> 2.168315).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.219536304473877
VALI: Epoch: 3, Steps: 13 | Train Loss: 2.0339024  Vali Loss: 1.8041564 Vali Accuracy: 0.2881356  Vali weighted F1: 0.2499915  Vali macro F1 0.2489046 
new best score!!!!
Validation loss decreased (2.168315 --> 1.804156).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.2204415798187256
VALI: Epoch: 4, Steps: 13 | Train Loss: 1.6462282  Vali Loss: 1.3914079 Vali Accuracy: 0.5338983  Vali weighted F1: 0.5094868  Vali macro F1 0.4858557 
new best score!!!!
Validation loss decreased (1.804156 --> 1.391408).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.218625783920288
VALI: Epoch: 5, Steps: 13 | Train Loss: 1.3673601  Vali Loss: 1.1476945 Vali Accuracy: 0.6242938  Vali weighted F1: 0.5910226  Vali macro F1 0.5624352 
new best score!!!!
Validation loss decreased (1.391408 --> 1.147694).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.2208776473999023
VALI: Epoch: 6, Steps: 13 | Train Loss: 1.1555655  Vali Loss: 0.9529098 Vali Accuracy: 0.6920904  Vali weighted F1: 0.6599507  Vali macro F1 0.6027291 
new best score!!!!
Validation loss decreased (1.147694 --> 0.952910).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.2241730690002441
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.9739090  Vali Loss: 0.7896306 Vali Accuracy: 0.7994350  Vali weighted F1: 0.7832750  Vali macro F1 0.7403000 
new best score!!!!
Validation loss decreased (0.952910 --> 0.789631).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.220616102218628
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.8346877  Vali Loss: 0.6571749 Vali Accuracy: 0.8276836  Vali weighted F1: 0.8161828  Vali macro F1 0.7715088 
new best score!!!!
Validation loss decreased (0.789631 --> 0.657175).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.2199113368988037
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.7053274  Vali Loss: 0.5669640 Vali Accuracy: 0.8531073  Vali weighted F1: 0.8470574  Vali macro F1 0.8217129 
new best score!!!!
Validation loss decreased (0.657175 --> 0.566964).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.2248954772949219
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.6166305  Vali Loss: 0.4986363 Vali Accuracy: 0.8672316  Vali weighted F1: 0.8611982  Vali macro F1 0.8293940 
new best score!!!!
Validation loss decreased (0.566964 --> 0.498636).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.2324459552764893
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.5492040  Vali Loss: 0.4431495 Vali Accuracy: 0.8813559  Vali weighted F1: 0.8800143  Vali macro F1 0.8510303 
new best score!!!!
Validation loss decreased (0.498636 --> 0.443150).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.221775770187378
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.4848345  Vali Loss: 0.3880117 Vali Accuracy: 0.8813559  Vali weighted F1: 0.8650302  Vali macro F1 0.8210823 
new best score!!!!
Validation loss decreased (0.443150 --> 0.388012).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.2163357734680176
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.4484765  Vali Loss: 0.3650402 Vali Accuracy: 0.8983051  Vali weighted F1: 0.8910922  Vali macro F1 0.8580380 
new best score!!!!
Validation loss decreased (0.388012 --> 0.365040).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.2191054821014404
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.4138974  Vali Loss: 0.3294475 Vali Accuracy: 0.8983051  Vali weighted F1: 0.8953713  Vali macro F1 0.8555668 
new best score!!!!
Validation loss decreased (0.365040 --> 0.329447).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.2196838855743408
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.3813419  Vali Loss: 0.3134955 Vali Accuracy: 0.9039548  Vali weighted F1: 0.8903768  Vali macro F1 0.8470423 
new best score!!!!
Validation loss decreased (0.329447 --> 0.313496).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.2188735008239746
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.3513338  Vali Loss: 0.2840420 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9295073  Vali macro F1 0.9035768 
new best score!!!!
Validation loss decreased (0.313496 --> 0.284042).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.219261646270752
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.3211076  Vali Loss: 0.2782730 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9232946  Vali macro F1 0.9044921 
new best score!!!!
Validation loss decreased (0.284042 --> 0.278273).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.2217051982879639
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.3080504  Vali Loss: 0.2316370 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9395775  Vali macro F1 0.9114071 
new best score!!!!
Validation loss decreased (0.278273 --> 0.231637).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.2172274589538574
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.2750976  Vali Loss: 0.2329241 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9310126  Vali macro F1 0.9027967 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 1.221015214920044
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.2617456  Vali Loss: 0.2078743 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9283966  Vali macro F1 0.9001286 
new best score!!!!
Validation loss decreased (0.231637 --> 0.207874).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.224618911743164
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.2468699  Vali Loss: 0.1938055 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9407789  Vali macro F1 0.9069740 
new best score!!!!
Validation loss decreased (0.207874 --> 0.193805).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.2246873378753662
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.2378337  Vali Loss: 0.1897982 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9424093  Vali macro F1 0.9143207 
new best score!!!!
Validation loss decreased (0.193805 --> 0.189798).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.2256600856781006
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.2223039  Vali Loss: 0.1779371 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9480838  Vali macro F1 0.9189501 
new best score!!!!
Validation loss decreased (0.189798 --> 0.177937).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.2262423038482666
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.2082009  Vali Loss: 0.1671782 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9435133  Vali macro F1 0.9096130 
new best score!!!!
Validation loss decreased (0.177937 --> 0.167178).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.2302050590515137
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.1932484  Vali Loss: 0.1598797 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9528142  Vali macro F1 0.9266153 
new best score!!!!
Validation loss decreased (0.167178 --> 0.159880).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.2260329723358154
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.1951716  Vali Loss: 0.1408123 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9559282  Vali macro F1 0.9273697 
new best score!!!!
Validation loss decreased (0.159880 --> 0.140812).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.2283875942230225
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.1877473  Vali Loss: 0.1492587 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9316158  Vali macro F1 0.8977240 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 1.226459264755249
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.1842132  Vali Loss: 0.1560787 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9396463  Vali macro F1 0.9079988 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 1.2268962860107422
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.1643100  Vali Loss: 0.1404234 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9433863  Vali macro F1 0.9183835 
new best score!!!!
Validation loss decreased (0.140812 --> 0.140423).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.2253131866455078
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.1687810  Vali Loss: 0.1357209 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9499763  Vali macro F1 0.9249402 
new best score!!!!
Validation loss decreased (0.140423 --> 0.135721).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 1.2270774841308594
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.1534783  Vali Loss: 0.1265409 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9572670  Vali macro F1 0.9362697 
new best score!!!!
Validation loss decreased (0.135721 --> 0.126541).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 1.2287817001342773
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.1495628  Vali Loss: 0.1400708 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9631167  Vali macro F1 0.9430230 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 1.230611801147461
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.1432699  Vali Loss: 0.1189697 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9528693  Vali macro F1 0.9258760 
new best score!!!!
Validation loss decreased (0.126541 --> 0.118970).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 1.2322421073913574
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.1358286  Vali Loss: 0.1318392 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9576677  Vali macro F1 0.9389966 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 1.2281572818756104
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.1282241  Vali Loss: 0.1215172 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9573503  Vali macro F1 0.9383117 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 1.226935863494873
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.1356607  Vali Loss: 0.1268950 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9380300  Vali macro F1 0.8981694 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 1.2291688919067383
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.1361869  Vali Loss: 0.1231265 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9539636  Vali macro F1 0.9309690 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 1.2288482189178467
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.1241861  Vali Loss: 0.0986889 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9715808  Vali macro F1 0.9504831 
new best score!!!!
Validation loss decreased (0.118970 --> 0.098689).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 1.2285330295562744
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.1098054  Vali Loss: 0.1088022 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9689692  Vali macro F1 0.9508193 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 1.2303950786590576
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.1071426  Vali Loss: 0.0928445 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745892  Vali macro F1 0.9607245 
new best score!!!!
Validation loss decreased (0.098689 --> 0.092844).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 1.2253620624542236
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.1109340  Vali Loss: 0.0983124 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9659981  Vali macro F1 0.9486122 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 1.2334728240966797
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.1052050  Vali Loss: 0.1095039 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9684844  Vali macro F1 0.9548357 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 1.2372472286224365
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.1006684  Vali Loss: 0.0909194 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745896  Vali macro F1 0.9606947 
new best score!!!!
Validation loss decreased (0.092844 --> 0.090919).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 1.2477104663848877
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0952623  Vali Loss: 0.0986099 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9600667  Vali macro F1 0.9340857 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 1.266899824142456
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0946137  Vali Loss: 0.0967156 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9688381  Vali macro F1 0.9530059 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 1.232557773590088
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0839709  Vali Loss: 0.0795952 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830434  Vali macro F1 0.9754315 
new best score!!!!
Validation loss decreased (0.090919 --> 0.079595).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 1.2351562976837158
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0818684  Vali Loss: 0.0848807 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9771872  Vali macro F1 0.9628706 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 1.2337048053741455
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0697459  Vali Loss: 0.0755280 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802050  Vali macro F1 0.9702462 
new best score!!!!
Validation loss decreased (0.079595 --> 0.075528).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 1.2343950271606445
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0643126  Vali Loss: 0.0775127 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803954  Vali macro F1 0.9736918 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 1.2334566116333008
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0697367  Vali Loss: 0.0890450 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773799  Vali macro F1 0.9705267 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 1.235503911972046
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0596087  Vali Loss: 0.0766620 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9715724  Vali macro F1 0.9608635 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 1.2325623035430908
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0675404  Vali Loss: 0.1055893 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9653860  Vali macro F1 0.9493335 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 1.2341992855072021
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0682130  Vali Loss: 0.0686394 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830416  Vali macro F1 0.9778094 
new best score!!!!
Validation loss decreased (0.075528 --> 0.068639).  Saving model ...
new best score!!!!
Epoch: 54 cost time: 1.2410609722137451
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0701132  Vali Loss: 0.0744631 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801689  Vali macro F1 0.9727774 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 1.2364022731781006
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0563608  Vali Loss: 0.0765502 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9772543  Vali macro F1 0.9702355 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 56 cost time: 1.2356314659118652
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0545099  Vali Loss: 0.0566341 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9800432  Vali macro F1 0.9724862 
new best score!!!!
Validation loss decreased (0.068639 --> 0.056634).  Saving model ...
new best score!!!!
Epoch: 57 cost time: 1.2365400791168213
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0463314  Vali Loss: 0.0674262 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829956  Vali macro F1 0.9750640 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 58 cost time: 1.2317945957183838
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0506442  Vali Loss: 0.0636716 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9798769  Vali macro F1 0.9701218 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 59 cost time: 1.2333567142486572
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0486245  Vali Loss: 0.0515590 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887135  Vali macro F1 0.9850622 
new best score!!!!
Validation loss decreased (0.056634 --> 0.051559).  Saving model ...
new best score!!!!
Epoch: 60 cost time: 1.2326431274414062
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0503733  Vali Loss: 0.0424052 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914916  Vali macro F1 0.9880131 
new best score!!!!
Validation loss decreased (0.051559 --> 0.042405).  Saving model ...
new best score!!!!
Epoch: 61 cost time: 1.234550952911377
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0470205  Vali Loss: 0.0609985 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830670  Vali macro F1 0.9771614 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 62 cost time: 1.235856533050537
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0469249  Vali Loss: 0.0434953 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858683  Vali macro F1 0.9800960 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 63 cost time: 1.2360527515411377
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0411034  Vali Loss: 0.0422182 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887135  Vali macro F1 0.9850622 
new best score!!!!
Validation loss decreased (0.042405 --> 0.042218).  Saving model ...
new best score!!!!
Epoch: 64 cost time: 1.2344210147857666
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0384346  Vali Loss: 0.0672178 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9768402  Vali macro F1 0.9642732 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 65 cost time: 1.2323384284973145
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0369171  Vali Loss: 0.0521254 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829956  Vali macro F1 0.9750640 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 66 cost time: 1.2296671867370605
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0332869  Vali Loss: 0.0413083 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887135  Vali macro F1 0.9850622 
new best score!!!!
Validation loss decreased (0.042218 --> 0.041308).  Saving model ...
new best score!!!!
Epoch: 67 cost time: 1.2324323654174805
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0330270  Vali Loss: 0.0361532 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887135  Vali macro F1 0.9850622 
new best score!!!!
Validation loss decreased (0.041308 --> 0.036153).  Saving model ...
new best score!!!!
Epoch: 68 cost time: 1.2344233989715576
VALI: Epoch: 68, Steps: 13 | Train Loss: 0.0265002  Vali Loss: 0.0412048 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915417  Vali macro F1 0.9899811 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 69 cost time: 1.234891653060913
VALI: Epoch: 69, Steps: 13 | Train Loss: 0.0304199  Vali Loss: 0.0613765 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829956  Vali macro F1 0.9750640 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 70 cost time: 1.2346384525299072
VALI: Epoch: 70, Steps: 13 | Train Loss: 0.0263341  Vali Loss: 0.0404846 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886103  Vali macro F1 0.9828098 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 71 cost time: 1.2596540451049805
VALI: Epoch: 71, Steps: 13 | Train Loss: 0.0302521  Vali Loss: 0.0620974 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9799355  Vali macro F1 0.9677694 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 72 cost time: 1.2382473945617676
VALI: Epoch: 72, Steps: 13 | Train Loss: 0.0301177  Vali Loss: 0.0297975 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915417  Vali macro F1 0.9899811 
new best score!!!!
Validation loss decreased (0.036153 --> 0.029798).  Saving model ...
new best score!!!!
Epoch: 73 cost time: 1.236706018447876
VALI: Epoch: 73, Steps: 13 | Train Loss: 0.0293460  Vali Loss: 0.0438190 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9888051  Vali macro F1 0.9838379 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 74 cost time: 1.240854024887085
VALI: Epoch: 74, Steps: 13 | Train Loss: 0.0277379  Vali Loss: 0.0420925 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858683  Vali macro F1 0.9800960 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 75 cost time: 1.2407276630401611
VALI: Epoch: 75, Steps: 13 | Train Loss: 0.0280882  Vali Loss: 0.0468715 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858665  Vali macro F1 0.9802485 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 76 cost time: 1.243180513381958
VALI: Epoch: 76, Steps: 13 | Train Loss: 0.0264062  Vali Loss: 0.0426032 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858078  Vali macro F1 0.9781097 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 77 cost time: 1.2388560771942139
VALI: Epoch: 77, Steps: 13 | Train Loss: 0.0274011  Vali Loss: 0.0548411 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9828988  Vali macro F1 0.9728402 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 78 cost time: 1.2553610801696777
VALI: Epoch: 78, Steps: 13 | Train Loss: 0.0247526  Vali Loss: 0.0407434 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858683  Vali macro F1 0.9800960 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 79 cost time: 1.2444677352905273
VALI: Epoch: 79, Steps: 13 | Train Loss: 0.0222885  Vali Loss: 0.0409172 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887135  Vali macro F1 0.9850622 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 80 cost time: 1.2374987602233887
VALI: Epoch: 80, Steps: 13 | Train Loss: 0.0217498  Vali Loss: 0.0445720 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887135  Vali macro F1 0.9850622 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 81 cost time: 1.243182897567749
VALI: Epoch: 81, Steps: 13 | Train Loss: 0.0195785  Vali Loss: 0.0460573 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858683  Vali macro F1 0.9800960 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 82 cost time: 1.2366971969604492
VALI: Epoch: 82, Steps: 13 | Train Loss: 0.0189165  Vali Loss: 0.0458354 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858683  Vali macro F1 0.9800960 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 83 cost time: 1.240269660949707
VALI: Epoch: 83, Steps: 13 | Train Loss: 0.0193076  Vali Loss: 0.0457349 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858683  Vali macro F1 0.9800960 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 84 cost time: 1.2377183437347412
VALI: Epoch: 84, Steps: 13 | Train Loss: 0.0195270  Vali Loss: 0.0457287 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858683  Vali macro F1 0.9800960 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 85 cost time: 1.253082513809204
VALI: Epoch: 85, Steps: 13 | Train Loss: 0.0200938  Vali Loss: 0.0450828 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858683  Vali macro F1 0.9800960 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 86 cost time: 1.2709147930145264
VALI: Epoch: 86, Steps: 13 | Train Loss: 0.0194936  Vali Loss: 0.0447766 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858683  Vali macro F1 0.9800960 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 87 cost time: 1.232727289199829
VALI: Epoch: 87, Steps: 13 | Train Loss: 0.0191813  Vali Loss: 0.0449539 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858683  Vali macro F1 0.9800960 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9909502  Test weighted F1: 0.9909525  Test macro F1 0.9897574 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 73347
pruned model Parameter : 76626
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.2690415382385254
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0252167  Vali Loss: 0.0371892 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915417  Vali macro F1 0.9899811 
Validation loss decreased (inf --> 0.037189).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.2629494667053223
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0229270  Vali Loss: 0.0389059 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915417  Vali macro F1 0.9899811 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.2622733116149902
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0220684  Vali Loss: 0.0404270 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829956  Vali macro F1 0.9750640 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 1.2630963325500488
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0245931  Vali Loss: 0.0376423 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887135  Vali macro F1 0.9850622 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 1.2537875175476074
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0219527  Vali Loss: 0.0427796 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829956  Vali macro F1 0.9750640 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 1.2544357776641846
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0202789  Vali Loss: 0.0331561 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915417  Vali macro F1 0.9899811 
new best score!!!!
Validation loss decreased (0.037189 --> 0.033156).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 1.26265549659729
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0212078  Vali Loss: 0.0433332 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829956  Vali macro F1 0.9750640 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 1.2658460140228271
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0222378  Vali Loss: 0.0417947 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858683  Vali macro F1 0.9800960 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 1.2619531154632568
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0215774  Vali Loss: 0.0407560 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858683  Vali macro F1 0.9800960 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 1.2608799934387207
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0191984  Vali Loss: 0.0400099 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858683  Vali macro F1 0.9800960 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 11 cost time: 1.2639927864074707
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0200827  Vali Loss: 0.0429812 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829956  Vali macro F1 0.9750640 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 12 cost time: 1.2633743286132812
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0206386  Vali Loss: 0.0415362 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858683  Vali macro F1 0.9800960 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 1.2633187770843506
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0205683  Vali Loss: 0.0400247 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858683  Vali macro F1 0.9800960 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 1.2637524604797363
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0194528  Vali Loss: 0.0402613 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858683  Vali macro F1 0.9800960 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 1.269897699356079
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0186844  Vali Loss: 0.0393849 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858683  Vali macro F1 0.9800960 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 1.2600836753845215
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0173687  Vali Loss: 0.0395900 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858683  Vali macro F1 0.9800960 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 17 cost time: 1.2591006755828857
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0195313  Vali Loss: 0.0395610 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858683  Vali macro F1 0.9800960 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 1.2584168910980225
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0196872  Vali Loss: 0.0395789 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858683  Vali macro F1 0.9800960 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 1.2619714736938477
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0176366  Vali Loss: 0.0395663 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858683  Vali macro F1 0.9800960 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 1.2567734718322754
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0189584  Vali Loss: 0.0395356 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858683  Vali macro F1 0.9800960 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 1.251725196838379
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0190917  Vali Loss: 0.0395146 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858683  Vali macro F1 0.9800960 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9920814  Test weighted F1: 0.9920858  Test macro F1 0.9906252 
================ the 3 th CV Experiment ================ 
Overlapping random Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00271003 0.0023753  0.00240964 0.00321543 0.00543478 0.00591716
 0.00318471 0.00295858 0.00248756 0.00381679]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.2274458408355713
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.2858819  Vali Loss: 2.2754715 Vali Accuracy: 0.1581921  Vali weighted F1: 0.0628207  Vali macro F1 0.0507281 
Validation loss decreased (inf --> 2.275472).  Saving model ...
Epoch: 2 cost time: 1.2433497905731201
VALI: Epoch: 2, Steps: 13 | Train Loss: 2.2525371  Vali Loss: 2.2090666 Vali Accuracy: 0.1836158  Vali weighted F1: 0.1050591  Vali macro F1 0.0815683 
new best score!!!!
Validation loss decreased (2.275472 --> 2.209067).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.2263169288635254
VALI: Epoch: 3, Steps: 13 | Train Loss: 2.1038821  Vali Loss: 1.9046844 Vali Accuracy: 0.2909605  Vali weighted F1: 0.2418229  Vali macro F1 0.2378073 
new best score!!!!
Validation loss decreased (2.209067 --> 1.904684).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.225104808807373
VALI: Epoch: 4, Steps: 13 | Train Loss: 1.7327284  Vali Loss: 1.4570196 Vali Accuracy: 0.5197740  Vali weighted F1: 0.5020196  Vali macro F1 0.4689616 
new best score!!!!
Validation loss decreased (1.904684 --> 1.457020).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.2214367389678955
VALI: Epoch: 5, Steps: 13 | Train Loss: 1.3942561  Vali Loss: 1.1827544 Vali Accuracy: 0.6101695  Vali weighted F1: 0.5897291  Vali macro F1 0.5610883 
new best score!!!!
Validation loss decreased (1.457020 --> 1.182754).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.2236289978027344
VALI: Epoch: 6, Steps: 13 | Train Loss: 1.1614915  Vali Loss: 0.9939720 Vali Accuracy: 0.6779661  Vali weighted F1: 0.6520414  Vali macro F1 0.6004195 
new best score!!!!
Validation loss decreased (1.182754 --> 0.993972).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.2236313819885254
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.9981533  Vali Loss: 0.8333918 Vali Accuracy: 0.7514124  Vali weighted F1: 0.7309226  Vali macro F1 0.6888966 
new best score!!!!
Validation loss decreased (0.993972 --> 0.833392).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.2258355617523193
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.8545811  Vali Loss: 0.6769982 Vali Accuracy: 0.8107345  Vali weighted F1: 0.7985724  Vali macro F1 0.7613209 
new best score!!!!
Validation loss decreased (0.833392 --> 0.676998).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.2237827777862549
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.7361343  Vali Loss: 0.5922573 Vali Accuracy: 0.8615819  Vali weighted F1: 0.8620622  Vali macro F1 0.8489493 
new best score!!!!
Validation loss decreased (0.676998 --> 0.592257).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.227238416671753
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.6499620  Vali Loss: 0.5078402 Vali Accuracy: 0.8672316  Vali weighted F1: 0.8476045  Vali macro F1 0.8030443 
new best score!!!!
Validation loss decreased (0.592257 --> 0.507840).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.2240855693817139
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.5722011  Vali Loss: 0.4766254 Vali Accuracy: 0.8361582  Vali weighted F1: 0.8123258  Vali macro F1 0.7610362 
new best score!!!!
Validation loss decreased (0.507840 --> 0.476625).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.226771354675293
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.5179242  Vali Loss: 0.4151524 Vali Accuracy: 0.8954802  Vali weighted F1: 0.8954561  Vali macro F1 0.8734598 
new best score!!!!
Validation loss decreased (0.476625 --> 0.415152).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.2237894535064697
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.4775249  Vali Loss: 0.3753289 Vali Accuracy: 0.8785311  Vali weighted F1: 0.8617626  Vali macro F1 0.8125565 
new best score!!!!
Validation loss decreased (0.415152 --> 0.375329).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.22310471534729
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.4298257  Vali Loss: 0.3454879 Vali Accuracy: 0.8983051  Vali weighted F1: 0.8815102  Vali macro F1 0.8370869 
new best score!!!!
Validation loss decreased (0.375329 --> 0.345488).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.2303359508514404
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.3930207  Vali Loss: 0.3229364 Vali Accuracy: 0.9265537  Vali weighted F1: 0.9264550  Vali macro F1 0.9095325 
new best score!!!!
Validation loss decreased (0.345488 --> 0.322936).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.2260105609893799
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.3629270  Vali Loss: 0.2895052 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9312004  Vali macro F1 0.9049340 
new best score!!!!
Validation loss decreased (0.322936 --> 0.289505).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.2239177227020264
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.3268643  Vali Loss: 0.2711104 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9181147  Vali macro F1 0.8815893 
new best score!!!!
Validation loss decreased (0.289505 --> 0.271110).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.2223782539367676
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.3029358  Vali Loss: 0.2420347 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9351925  Vali macro F1 0.9075618 
new best score!!!!
Validation loss decreased (0.271110 --> 0.242035).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.2250034809112549
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.2850483  Vali Loss: 0.2484249 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9291811  Vali macro F1 0.9059226 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 1.2246837615966797
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.2661779  Vali Loss: 0.2149051 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9352112  Vali macro F1 0.9083743 
new best score!!!!
Validation loss decreased (0.242035 --> 0.214905).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.225252628326416
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.2436781  Vali Loss: 0.2007398 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9399725  Vali macro F1 0.9110345 
new best score!!!!
Validation loss decreased (0.214905 --> 0.200740).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.2263555526733398
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.2370708  Vali Loss: 0.2011230 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9209405  Vali macro F1 0.8949069 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 1.2297112941741943
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.2184643  Vali Loss: 0.1817444 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9490486  Vali macro F1 0.9237253 
new best score!!!!
Validation loss decreased (0.200740 --> 0.181744).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.2302641868591309
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.2119475  Vali Loss: 0.1728374 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9518219  Vali macro F1 0.9306138 
new best score!!!!
Validation loss decreased (0.181744 --> 0.172837).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.2304496765136719
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.1873211  Vali Loss: 0.1670046 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9488236  Vali macro F1 0.9317818 
new best score!!!!
Validation loss decreased (0.172837 --> 0.167005).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.2355930805206299
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.1821515  Vali Loss: 0.1641798 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9286052  Vali macro F1 0.8984244 
new best score!!!!
Validation loss decreased (0.167005 --> 0.164180).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.2341704368591309
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.1777257  Vali Loss: 0.1403708 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9411507  Vali macro F1 0.9116211 
new best score!!!!
Validation loss decreased (0.164180 --> 0.140371).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 1.2350900173187256
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.1701068  Vali Loss: 0.1483127 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9632687  Vali macro F1 0.9476381 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 1.2322514057159424
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.1607856  Vali Loss: 0.1293847 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9628221  Vali macro F1 0.9399133 
new best score!!!!
Validation loss decreased (0.140371 --> 0.129385).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.2301115989685059
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.1550399  Vali Loss: 0.1294206 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9545950  Vali macro F1 0.9333236 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 1.2378439903259277
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.1507497  Vali Loss: 0.1273713 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9529275  Vali macro F1 0.9264210 
new best score!!!!
Validation loss decreased (0.129385 --> 0.127371).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 1.226139783859253
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.1459514  Vali Loss: 0.1243721 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9601816  Vali macro F1 0.9429194 
new best score!!!!
Validation loss decreased (0.127371 --> 0.124372).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 1.2257726192474365
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.1493029  Vali Loss: 0.1261895 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9491122  Vali macro F1 0.9288554 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 1.231400728225708
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.1418515  Vali Loss: 0.1190660 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9536073  Vali macro F1 0.9277374 
new best score!!!!
Validation loss decreased (0.124372 --> 0.119066).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.2324209213256836
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.1315516  Vali Loss: 0.1127346 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9516153  Vali macro F1 0.9288616 
new best score!!!!
Validation loss decreased (0.119066 --> 0.112735).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 1.2545373439788818
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.1228046  Vali Loss: 0.1134464 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9550563  Vali macro F1 0.9252800 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 1.235107660293579
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.1265099  Vali Loss: 0.1296777 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9688916  Vali macro F1 0.9563583 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 1.2338683605194092
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.1207263  Vali Loss: 0.1077225 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9659667  Vali macro F1 0.9525346 
new best score!!!!
Validation loss decreased (0.112735 --> 0.107722).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 1.2293879985809326
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.1125343  Vali Loss: 0.0968732 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9687897  Vali macro F1 0.9529104 
new best score!!!!
Validation loss decreased (0.107722 --> 0.096873).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 1.2270185947418213
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.1018490  Vali Loss: 0.1071669 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9528034  Vali macro F1 0.9265994 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 1.2268617153167725
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.1013784  Vali Loss: 0.1007313 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9687476  Vali macro F1 0.9546043 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 1.2253949642181396
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0980950  Vali Loss: 0.1069636 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745411  Vali macro F1 0.9603520 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 1.2275683879852295
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0903936  Vali Loss: 0.0897702 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9717695  Vali macro F1 0.9573260 
new best score!!!!
Validation loss decreased (0.096873 --> 0.089770).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 1.2261555194854736
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0895171  Vali Loss: 0.0951179 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9689929  Vali macro F1 0.9526754 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 1.2292227745056152
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0872263  Vali Loss: 0.0993950 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9654015  Vali macro F1 0.9452252 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 1.2325775623321533
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0777544  Vali Loss: 0.0827905 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745262  Vali macro F1 0.9598597 
new best score!!!!
Validation loss decreased (0.089770 --> 0.082790).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 1.2315056324005127
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0777940  Vali Loss: 0.1057531 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9546157  Vali macro F1 0.9273939 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 1.2328402996063232
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0844472  Vali Loss: 0.0774804 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9689835  Vali macro F1 0.9553585 
new best score!!!!
Validation loss decreased (0.082790 --> 0.077480).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 1.234123945236206
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0711413  Vali Loss: 0.0814232 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9659498  Vali macro F1 0.9485168 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 1.233604907989502
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0779323  Vali Loss: 0.0813575 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9772801  Vali macro F1 0.9650929 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 1.2325935363769531
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0646614  Vali Loss: 0.0723663 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774690  Vali macro F1 0.9646616 
new best score!!!!
Validation loss decreased (0.077480 --> 0.072366).  Saving model ...
new best score!!!!
Epoch: 52 cost time: 1.2327277660369873
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0689871  Vali Loss: 0.0883266 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802044  Vali macro F1 0.9702018 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 1.2393722534179688
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0629325  Vali Loss: 0.0728071 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830725  Vali macro F1 0.9752958 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 1.2426493167877197
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0613472  Vali Loss: 0.0706640 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802003  Vali macro F1 0.9701950 
new best score!!!!
Validation loss decreased (0.072366 --> 0.070664).  Saving model ...
new best score!!!!
Epoch: 55 cost time: 1.235671043395996
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0637071  Vali Loss: 0.0802010 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9629063  Vali macro F1 0.9451805 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 1.23372483253479
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0611215  Vali Loss: 0.0700503 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745199  Vali macro F1 0.9586652 
new best score!!!!
Validation loss decreased (0.070664 --> 0.070050).  Saving model ...
new best score!!!!
Epoch: 57 cost time: 1.233936071395874
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0623366  Vali Loss: 0.0708142 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802003  Vali macro F1 0.9701950 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 58 cost time: 1.2336711883544922
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0633136  Vali Loss: 0.0826698 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9715164  Vali macro F1 0.9555851 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 59 cost time: 1.2302064895629883
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0594178  Vali Loss: 0.0680590 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9689383  Vali macro F1 0.9527529 
new best score!!!!
Validation loss decreased (0.070050 --> 0.068059).  Saving model ...
new best score!!!!
Epoch: 60 cost time: 1.2278544902801514
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0511911  Vali Loss: 0.0717020 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802003  Vali macro F1 0.9701950 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 61 cost time: 1.236161470413208
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0533390  Vali Loss: 0.0686884 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802371  Vali macro F1 0.9729670 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 62 cost time: 1.2241220474243164
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0521937  Vali Loss: 0.1077284 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9628767  Vali macro F1 0.9369721 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 63 cost time: 1.2236855030059814
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0536880  Vali Loss: 0.0586331 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830725  Vali macro F1 0.9752958 
new best score!!!!
Validation loss decreased (0.068059 --> 0.058633).  Saving model ...
new best score!!!!
Epoch: 64 cost time: 1.2251501083374023
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0447294  Vali Loss: 0.0591588 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802003  Vali macro F1 0.9701950 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 65 cost time: 1.2349109649658203
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0428289  Vali Loss: 0.0510259 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858866  Vali macro F1 0.9781890 
new best score!!!!
Validation loss decreased (0.058633 --> 0.051026).  Saving model ...
new best score!!!!
Epoch: 66 cost time: 1.232637643814087
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0430241  Vali Loss: 0.0518180 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801803  Vali macro F1 0.9707920 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 67 cost time: 1.2350573539733887
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0390025  Vali Loss: 0.0574798 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829708  Vali macro F1 0.9756099 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 68 cost time: 1.2303674221038818
VALI: Epoch: 68, Steps: 13 | Train Loss: 0.0481453  Vali Loss: 0.0802693 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9621308  Vali macro F1 0.9415554 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 69 cost time: 1.231801986694336
VALI: Epoch: 69, Steps: 13 | Train Loss: 0.0482353  Vali Loss: 0.0499451 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915229  Vali macro F1 0.9879042 
new best score!!!!
Validation loss decreased (0.051026 --> 0.049945).  Saving model ...
new best score!!!!
Epoch: 70 cost time: 1.2332134246826172
VALI: Epoch: 70, Steps: 13 | Train Loss: 0.0452618  Vali Loss: 0.0603411 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774696  Vali macro F1 0.9699479 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 71 cost time: 1.2448737621307373
VALI: Epoch: 71, Steps: 13 | Train Loss: 0.0455283  Vali Loss: 0.0633655 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745589  Vali macro F1 0.9656860 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 72 cost time: 1.2370190620422363
VALI: Epoch: 72, Steps: 13 | Train Loss: 0.0430460  Vali Loss: 0.0602705 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9804674  Vali macro F1 0.9720697 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 73 cost time: 1.2327682971954346
VALI: Epoch: 73, Steps: 13 | Train Loss: 0.0444039  Vali Loss: 0.0445183 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858970  Vali macro F1 0.9773922 
new best score!!!!
Validation loss decreased (0.049945 --> 0.044518).  Saving model ...
new best score!!!!
Epoch: 74 cost time: 1.232919454574585
VALI: Epoch: 74, Steps: 13 | Train Loss: 0.0438799  Vali Loss: 0.0666911 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9772462  Vali macro F1 0.9675999 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 75 cost time: 1.2328665256500244
VALI: Epoch: 75, Steps: 13 | Train Loss: 0.0377407  Vali Loss: 0.0762335 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801682  Vali macro F1 0.9727331 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 76 cost time: 1.237013339996338
VALI: Epoch: 76, Steps: 13 | Train Loss: 0.0385918  Vali Loss: 0.0599693 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774045  Vali macro F1 0.9706721 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 77 cost time: 1.2321088314056396
VALI: Epoch: 77, Steps: 13 | Train Loss: 0.0284465  Vali Loss: 0.0832125 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774171  Vali macro F1 0.9706491 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 78 cost time: 1.2306134700775146
VALI: Epoch: 78, Steps: 13 | Train Loss: 0.0300347  Vali Loss: 0.0552625 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858636  Vali macro F1 0.9800448 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 79 cost time: 1.2314867973327637
VALI: Epoch: 79, Steps: 13 | Train Loss: 0.0267327  Vali Loss: 0.0516386 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858636  Vali macro F1 0.9800448 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 80 cost time: 1.2293758392333984
VALI: Epoch: 80, Steps: 13 | Train Loss: 0.0265391  Vali Loss: 0.0510870 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887088  Vali macro F1 0.9850110 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 81 cost time: 1.229219913482666
VALI: Epoch: 81, Steps: 13 | Train Loss: 0.0264774  Vali Loss: 0.0509854 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858636  Vali macro F1 0.9800448 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 82 cost time: 1.2275824546813965
VALI: Epoch: 82, Steps: 13 | Train Loss: 0.0251728  Vali Loss: 0.0518263 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830725  Vali macro F1 0.9752958 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 83 cost time: 1.2307584285736084
VALI: Epoch: 83, Steps: 13 | Train Loss: 0.0214461  Vali Loss: 0.0516422 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887088  Vali macro F1 0.9850110 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 84 cost time: 1.2328495979309082
VALI: Epoch: 84, Steps: 13 | Train Loss: 0.0226957  Vali Loss: 0.0517191 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887088  Vali macro F1 0.9850110 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 85 cost time: 1.2376658916473389
VALI: Epoch: 85, Steps: 13 | Train Loss: 0.0215752  Vali Loss: 0.0516811 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887088  Vali macro F1 0.9850110 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 86 cost time: 1.2374534606933594
VALI: Epoch: 86, Steps: 13 | Train Loss: 0.0231276  Vali Loss: 0.0516975 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887088  Vali macro F1 0.9850110 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 87 cost time: 1.2354578971862793
VALI: Epoch: 87, Steps: 13 | Train Loss: 0.0224783  Vali Loss: 0.0517471 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887088  Vali macro F1 0.9850110 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 88 cost time: 1.2323851585388184
VALI: Epoch: 88, Steps: 13 | Train Loss: 0.0236811  Vali Loss: 0.0517695 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887088  Vali macro F1 0.9850110 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9819005  Test weighted F1: 0.9817880  Test macro F1 0.9719719 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 73347
pruned model Parameter : 76626
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.2543656826019287
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0341706  Vali Loss: 0.0461787 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831265  Vali macro F1 0.9771315 
Validation loss decreased (inf --> 0.046179).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.2513175010681152
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0284509  Vali Loss: 0.0493495 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830591  Vali macro F1 0.9752024 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.2497355937957764
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0309314  Vali Loss: 0.0481518 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858941  Vali macro F1 0.9801505 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 1.2497096061706543
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0292043  Vali Loss: 0.0451474 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858941  Vali macro F1 0.9801505 
new best score!!!!
Validation loss decreased (0.046179 --> 0.045147).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 1.2490289211273193
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0253806  Vali Loss: 0.0463929 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830591  Vali macro F1 0.9752024 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 1.2450661659240723
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0264555  Vali Loss: 0.0430261 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858941  Vali macro F1 0.9801505 
new best score!!!!
Validation loss decreased (0.045147 --> 0.043026).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 1.2471091747283936
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0264379  Vali Loss: 0.0465545 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830591  Vali macro F1 0.9752024 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 1.2451951503753662
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0281995  Vali Loss: 0.0454528 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830591  Vali macro F1 0.9752024 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 1.2468507289886475
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0232164  Vali Loss: 0.0467074 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858941  Vali macro F1 0.9801505 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 1.245370864868164
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0235996  Vali Loss: 0.0473681 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830591  Vali macro F1 0.9752024 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 11 cost time: 1.245150089263916
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0254420  Vali Loss: 0.0477101 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858941  Vali macro F1 0.9801505 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 12 cost time: 1.2518548965454102
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0260145  Vali Loss: 0.0473464 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858941  Vali macro F1 0.9801505 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 1.247161865234375
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0257856  Vali Loss: 0.0455210 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803050  Vali macro F1 0.9722767 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 1.2446002960205078
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0272422  Vali Loss: 0.0465102 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830591  Vali macro F1 0.9752024 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 1.2509284019470215
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0237724  Vali Loss: 0.0468051 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831265  Vali macro F1 0.9771315 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 1.2626776695251465
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0247824  Vali Loss: 0.0497625 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858636  Vali macro F1 0.9800448 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 17 cost time: 1.2505748271942139
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0233271  Vali Loss: 0.0491308 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858636  Vali macro F1 0.9800448 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 1.2451086044311523
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0256021  Vali Loss: 0.0480974 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802916  Vali macro F1 0.9721833 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 1.2458460330963135
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0210196  Vali Loss: 0.0479001 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831265  Vali macro F1 0.9771315 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 1.245880126953125
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0214841  Vali Loss: 0.0478719 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831265  Vali macro F1 0.9771315 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 1.2525951862335205
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0214093  Vali Loss: 0.0479195 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831265  Vali macro F1 0.9771315 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9920814  Test weighted F1: 0.9920808  Test macro F1 0.9886166 
================ the 4 th CV Experiment ================ 
Overlapping random Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.00280112 0.00238095 0.00246914 0.00320513 0.00543478 0.00588235
 0.00315457 0.00289017 0.00235849 0.00404858]
Train data number :  3182
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  887
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.2814834117889404
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.2857861  Vali Loss: 2.2588196 Vali Accuracy: 0.1355932  Vali weighted F1: 0.0449441  Vali macro F1 0.0347087 
Validation loss decreased (inf --> 2.258820).  Saving model ...
Epoch: 2 cost time: 1.2329542636871338
VALI: Epoch: 2, Steps: 13 | Train Loss: 2.2362710  Vali Loss: 2.1334587 Vali Accuracy: 0.1864407  Vali weighted F1: 0.1004835  Vali macro F1 0.0830199 
new best score!!!!
Validation loss decreased (2.258820 --> 2.133459).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.2226717472076416
VALI: Epoch: 3, Steps: 13 | Train Loss: 2.0225323  Vali Loss: 1.8111934 Vali Accuracy: 0.3079096  Vali weighted F1: 0.2808698  Vali macro F1 0.3024983 
new best score!!!!
Validation loss decreased (2.133459 --> 1.811193).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.2209908962249756
VALI: Epoch: 4, Steps: 13 | Train Loss: 1.6434919  Vali Loss: 1.4594495 Vali Accuracy: 0.4576271  Vali weighted F1: 0.4587737  Vali macro F1 0.4496384 
new best score!!!!
Validation loss decreased (1.811193 --> 1.459450).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.222325086593628
VALI: Epoch: 5, Steps: 13 | Train Loss: 1.3481418  Vali Loss: 1.1974261 Vali Accuracy: 0.5282486  Vali weighted F1: 0.5293822  Vali macro F1 0.5084112 
new best score!!!!
Validation loss decreased (1.459450 --> 1.197426).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.2210936546325684
VALI: Epoch: 6, Steps: 13 | Train Loss: 1.1460827  Vali Loss: 1.0358817 Vali Accuracy: 0.6327684  Vali weighted F1: 0.6242117  Vali macro F1 0.6090698 
new best score!!!!
Validation loss decreased (1.197426 --> 1.035882).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.2203912734985352
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.9862310  Vali Loss: 0.8957694 Vali Accuracy: 0.7005650  Vali weighted F1: 0.6870733  Vali macro F1 0.6571064 
new best score!!!!
Validation loss decreased (1.035882 --> 0.895769).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.225614309310913
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.8525184  Vali Loss: 0.7649390 Vali Accuracy: 0.8135593  Vali weighted F1: 0.8131756  Vali macro F1 0.7980496 
new best score!!!!
Validation loss decreased (0.895769 --> 0.764939).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.240931510925293
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.7352488  Vali Loss: 0.6677182 Vali Accuracy: 0.8474576  Vali weighted F1: 0.8472197  Vali macro F1 0.8346816 
new best score!!!!
Validation loss decreased (0.764939 --> 0.667718).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.2300875186920166
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.6440560  Vali Loss: 0.5976165 Vali Accuracy: 0.8559322  Vali weighted F1: 0.8384864  Vali macro F1 0.7932296 
new best score!!!!
Validation loss decreased (0.667718 --> 0.597616).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.2288377285003662
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.5800507  Vali Loss: 0.5257498 Vali Accuracy: 0.8531073  Vali weighted F1: 0.8330136  Vali macro F1 0.7934640 
new best score!!!!
Validation loss decreased (0.597616 --> 0.525750).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.2318227291107178
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.5276336  Vali Loss: 0.4797114 Vali Accuracy: 0.8672316  Vali weighted F1: 0.8536427  Vali macro F1 0.8147760 
new best score!!!!
Validation loss decreased (0.525750 --> 0.479711).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.2315516471862793
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.4785420  Vali Loss: 0.4268225 Vali Accuracy: 0.8615819  Vali weighted F1: 0.8421043  Vali macro F1 0.8011510 
new best score!!!!
Validation loss decreased (0.479711 --> 0.426823).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.2322916984558105
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.4402656  Vali Loss: 0.4086925 Vali Accuracy: 0.8531073  Vali weighted F1: 0.8497783  Vali macro F1 0.8157852 
new best score!!!!
Validation loss decreased (0.426823 --> 0.408693).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.2399728298187256
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.4166031  Vali Loss: 0.3771414 Vali Accuracy: 0.8898305  Vali weighted F1: 0.8758546  Vali macro F1 0.8325216 
new best score!!!!
Validation loss decreased (0.408693 --> 0.377141).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.2370471954345703
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.3891056  Vali Loss: 0.3575065 Vali Accuracy: 0.8898305  Vali weighted F1: 0.8758438  Vali macro F1 0.8237010 
new best score!!!!
Validation loss decreased (0.377141 --> 0.357507).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.2370271682739258
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.3690873  Vali Loss: 0.3197923 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9206863  Vali macro F1 0.8917149 
new best score!!!!
Validation loss decreased (0.357507 --> 0.319792).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.2341349124908447
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.3352387  Vali Loss: 0.3069400 Vali Accuracy: 0.9124294  Vali weighted F1: 0.9074814  Vali macro F1 0.8751447 
new best score!!!!
Validation loss decreased (0.319792 --> 0.306940).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.2367124557495117
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.3085875  Vali Loss: 0.2799719 Vali Accuracy: 0.9096045  Vali weighted F1: 0.8927847  Vali macro F1 0.8401155 
new best score!!!!
Validation loss decreased (0.306940 --> 0.279972).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.236131191253662
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.2859900  Vali Loss: 0.2471229 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9280003  Vali macro F1 0.9011307 
new best score!!!!
Validation loss decreased (0.279972 --> 0.247123).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.2383387088775635
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.2707955  Vali Loss: 0.2259509 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9397074  Vali macro F1 0.9072941 
new best score!!!!
Validation loss decreased (0.247123 --> 0.225951).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.2398924827575684
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.2489824  Vali Loss: 0.2320492 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9171134  Vali macro F1 0.8716526 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 1.2379114627838135
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.2337525  Vali Loss: 0.2056382 Vali Accuracy: 0.9265537  Vali weighted F1: 0.9265385  Vali macro F1 0.8880946 
new best score!!!!
Validation loss decreased (0.225951 --> 0.205638).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.2421202659606934
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.2259923  Vali Loss: 0.2015204 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9350523  Vali macro F1 0.9035711 
new best score!!!!
Validation loss decreased (0.205638 --> 0.201520).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.2395851612091064
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.2055139  Vali Loss: 0.1886611 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9332917  Vali macro F1 0.8947859 
new best score!!!!
Validation loss decreased (0.201520 --> 0.188661).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.245039463043213
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.1964832  Vali Loss: 0.1797481 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9402021  Vali macro F1 0.9097327 
new best score!!!!
Validation loss decreased (0.188661 --> 0.179748).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.2412257194519043
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.1892521  Vali Loss: 0.1834345 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9459610  Vali macro F1 0.9169818 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 1.2597229480743408
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.1784043  Vali Loss: 0.1727940 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9575355  Vali macro F1 0.9358405 
new best score!!!!
Validation loss decreased (0.179748 --> 0.172794).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.2429735660552979
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.1720100  Vali Loss: 0.1520030 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9603507  Vali macro F1 0.9385986 
new best score!!!!
Validation loss decreased (0.172794 --> 0.152003).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.2459514141082764
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.1637185  Vali Loss: 0.1544223 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9517024  Vali macro F1 0.9361827 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 1.2457497119903564
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.1592520  Vali Loss: 0.1600590 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9689307  Vali macro F1 0.9526203 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 1.2398180961608887
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.1554600  Vali Loss: 0.1488104 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9630871  Vali macro F1 0.9471227 
new best score!!!!
Validation loss decreased (0.152003 --> 0.148810).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 1.239882469177246
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.1526003  Vali Loss: 0.1333727 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9689317  Vali macro F1 0.9525755 
new best score!!!!
Validation loss decreased (0.148810 --> 0.133373).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 1.243645191192627
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.1424813  Vali Loss: 0.1412665 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9688557  Vali macro F1 0.9559194 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 1.2446069717407227
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.1366442  Vali Loss: 0.1376267 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9651709  Vali macro F1 0.9480600 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 1.243332862854004
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.1436532  Vali Loss: 0.1319048 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9631933  Vali macro F1 0.9505811 
new best score!!!!
Validation loss decreased (0.133373 --> 0.131905).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 1.2408714294433594
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.1372727  Vali Loss: 0.1383682 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9627103  Vali macro F1 0.9425193 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 1.2432329654693604
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.1329070  Vali Loss: 0.1099390 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746172  Vali macro F1 0.9601087 
new best score!!!!
Validation loss decreased (0.131905 --> 0.109939).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 1.237257719039917
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.1121755  Vali Loss: 0.1131456 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9660181  Vali macro F1 0.9486049 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 1.238022804260254
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.1113021  Vali Loss: 0.1093496 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9742366  Vali macro F1 0.9611209 
new best score!!!!
Validation loss decreased (0.109939 --> 0.109350).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 1.2386250495910645
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.1098093  Vali Loss: 0.1059340 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9715883  Vali macro F1 0.9601995 
new best score!!!!
Validation loss decreased (0.109350 --> 0.105934).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 1.2375590801239014
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.1020512  Vali Loss: 0.0993466 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9772150  Vali macro F1 0.9671897 
new best score!!!!
Validation loss decreased (0.105934 --> 0.099347).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 1.2357637882232666
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0990132  Vali Loss: 0.0952459 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9744596  Vali macro F1 0.9616803 
new best score!!!!
Validation loss decreased (0.099347 --> 0.095246).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 1.2374000549316406
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0946221  Vali Loss: 0.0969218 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802394  Vali macro F1 0.9721688 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 1.237595796585083
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0903407  Vali Loss: 0.0997512 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801725  Vali macro F1 0.9757253 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 1.231705904006958
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0950178  Vali Loss: 0.1097265 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9714448  Vali macro F1 0.9628280 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 1.2380931377410889
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0849153  Vali Loss: 0.0850475 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830260  Vali macro F1 0.9747365 
new best score!!!!
Validation loss decreased (0.095246 --> 0.085047).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 1.240234613418579
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0822369  Vali Loss: 0.0862431 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773555  Vali macro F1 0.9730719 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 1.2396166324615479
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0772738  Vali Loss: 0.0780722 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830508  Vali macro F1 0.9754924 
new best score!!!!
Validation loss decreased (0.085047 --> 0.078072).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 1.2399358749389648
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0736851  Vali Loss: 0.0833570 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773622  Vali macro F1 0.9728996 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 1.240586757659912
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0740899  Vali Loss: 0.0781174 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830424  Vali macro F1 0.9778217 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 1.2436060905456543
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0637679  Vali Loss: 0.0651575 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858891  Vali macro F1 0.9822699 
new best score!!!!
Validation loss decreased (0.078072 --> 0.065158).  Saving model ...
new best score!!!!
Epoch: 53 cost time: 1.2412099838256836
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0621437  Vali Loss: 0.0654122 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830688  Vali macro F1 0.9784605 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 1.2340116500854492
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0697509  Vali Loss: 0.0644827 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830719  Vali macro F1 0.9778947 
new best score!!!!
Validation loss decreased (0.065158 --> 0.064483).  Saving model ...
new best score!!!!
Epoch: 55 cost time: 1.2342233657836914
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0573784  Vali Loss: 0.0651562 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830719  Vali macro F1 0.9778947 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 1.2383348941802979
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0554571  Vali Loss: 0.0718198 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802432  Vali macro F1 0.9757366 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 57 cost time: 1.2453196048736572
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0567942  Vali Loss: 0.0656766 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802603  Vali macro F1 0.9751983 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 58 cost time: 1.2415778636932373
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0508856  Vali Loss: 0.0608086 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830719  Vali macro F1 0.9778947 
new best score!!!!
Validation loss decreased (0.064483 --> 0.060809).  Saving model ...
new best score!!!!
Epoch: 59 cost time: 1.2461931705474854
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0467399  Vali Loss: 0.0727122 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9772233  Vali macro F1 0.9665811 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 60 cost time: 1.2446706295013428
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0492940  Vali Loss: 0.0552483 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858950  Vali macro F1 0.9829544 
new best score!!!!
Validation loss decreased (0.060809 --> 0.055248).  Saving model ...
new best score!!!!
Epoch: 61 cost time: 1.2617530822753906
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0468170  Vali Loss: 0.0487104 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858950  Vali macro F1 0.9829544 
new best score!!!!
Validation loss decreased (0.055248 --> 0.048710).  Saving model ...
new best score!!!!
Epoch: 62 cost time: 1.2468650341033936
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0425941  Vali Loss: 0.0564725 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830520  Vali macro F1 0.9807205 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 63 cost time: 1.2448346614837646
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0395458  Vali Loss: 0.0553316 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830719  Vali macro F1 0.9778947 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 64 cost time: 1.242957592010498
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0430544  Vali Loss: 0.0563915 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802244  Vali macro F1 0.9749883 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 65 cost time: 1.2420623302459717
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0453961  Vali Loss: 0.0562367 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830389  Vali macro F1 0.9777474 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 66 cost time: 1.2443745136260986
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0402354  Vali Loss: 0.0584861 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858564  Vali macro F1 0.9821229 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 67 cost time: 1.2446105480194092
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0366314  Vali Loss: 0.0497833 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830475  Vali macro F1 0.9771390 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 68 cost time: 1.2422642707824707
VALI: Epoch: 68, Steps: 13 | Train Loss: 0.0340377  Vali Loss: 0.0462850 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830475  Vali macro F1 0.9771390 
new best score!!!!
Validation loss decreased (0.048710 --> 0.046285).  Saving model ...
new best score!!!!
Epoch: 69 cost time: 1.2412619590759277
VALI: Epoch: 69, Steps: 13 | Train Loss: 0.0330357  Vali Loss: 0.0468875 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830475  Vali macro F1 0.9771390 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 70 cost time: 1.2420825958251953
VALI: Epoch: 70, Steps: 13 | Train Loss: 0.0329135  Vali Loss: 0.0463872 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859041  Vali macro F1 0.9794373 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 71 cost time: 1.244899034500122
VALI: Epoch: 71, Steps: 13 | Train Loss: 0.0318469  Vali Loss: 0.0497851 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858564  Vali macro F1 0.9821229 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 72 cost time: 1.2430226802825928
VALI: Epoch: 72, Steps: 13 | Train Loss: 0.0320852  Vali Loss: 0.0474336 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830475  Vali macro F1 0.9771390 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 73 cost time: 1.2400853633880615
VALI: Epoch: 73, Steps: 13 | Train Loss: 0.0301919  Vali Loss: 0.0467036 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859041  Vali macro F1 0.9794373 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 74 cost time: 1.240330696105957
VALI: Epoch: 74, Steps: 13 | Train Loss: 0.0312063  Vali Loss: 0.0469260 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859041  Vali macro F1 0.9794373 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 75 cost time: 1.2417171001434326
VALI: Epoch: 75, Steps: 13 | Train Loss: 0.0296938  Vali Loss: 0.0469806 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859041  Vali macro F1 0.9794373 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 76 cost time: 1.2374143600463867
VALI: Epoch: 76, Steps: 13 | Train Loss: 0.0315951  Vali Loss: 0.0470353 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859041  Vali macro F1 0.9794373 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 77 cost time: 1.2373325824737549
VALI: Epoch: 77, Steps: 13 | Train Loss: 0.0313378  Vali Loss: 0.0472729 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859041  Vali macro F1 0.9794373 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 78 cost time: 1.2360520362854004
VALI: Epoch: 78, Steps: 13 | Train Loss: 0.0311938  Vali Loss: 0.0471566 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859041  Vali macro F1 0.9794373 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 79 cost time: 1.237558364868164
VALI: Epoch: 79, Steps: 13 | Train Loss: 0.0300452  Vali Loss: 0.0471245 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859041  Vali macro F1 0.9794373 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 80 cost time: 1.2367370128631592
VALI: Epoch: 80, Steps: 13 | Train Loss: 0.0324357  Vali Loss: 0.0471213 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859041  Vali macro F1 0.9794373 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 81 cost time: 1.2371673583984375
VALI: Epoch: 81, Steps: 13 | Train Loss: 0.0296785  Vali Loss: 0.0470815 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859041  Vali macro F1 0.9794373 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 82 cost time: 1.234938383102417
VALI: Epoch: 82, Steps: 13 | Train Loss: 0.0306192  Vali Loss: 0.0470755 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859041  Vali macro F1 0.9794373 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 83 cost time: 1.2377989292144775
VALI: Epoch: 83, Steps: 13 | Train Loss: 0.0295145  Vali Loss: 0.0470606 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859041  Vali macro F1 0.9794373 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9887260  Test weighted F1: 0.9887159  Test macro F1 0.9856648 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 73347
pruned model Parameter : 76626
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.2661654949188232
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0334498  Vali Loss: 0.0477963 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859041  Vali macro F1 0.9794373 
Validation loss decreased (inf --> 0.047796).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.2584152221679688
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0311490  Vali Loss: 0.0501149 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859041  Vali macro F1 0.9794373 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.2583849430084229
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0322125  Vali Loss: 0.0484974 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859041  Vali macro F1 0.9794373 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 1.257786750793457
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0312754  Vali Loss: 0.0460772 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887185  Vali macro F1 0.9851055 
new best score!!!!
Validation loss decreased (0.047796 --> 0.046077).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 1.2596104145050049
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0308421  Vali Loss: 0.0487672 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887130  Vali macro F1 0.9844211 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 1.2585039138793945
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0288903  Vali Loss: 0.0469788 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859041  Vali macro F1 0.9794373 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 7 cost time: 1.2581593990325928
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0278414  Vali Loss: 0.0436540 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887271  Vali macro F1 0.9844971 
new best score!!!!
Validation loss decreased (0.046077 --> 0.043654).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 1.258289098739624
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0274857  Vali Loss: 0.0432713 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859041  Vali macro F1 0.9794373 
new best score!!!!
Validation loss decreased (0.043654 --> 0.043271).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 1.2578988075256348
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0267355  Vali Loss: 0.0442107 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859041  Vali macro F1 0.9794373 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 1.2561814785003662
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0285792  Vali Loss: 0.0456697 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887271  Vali macro F1 0.9844971 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 1.2595458030700684
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0302094  Vali Loss: 0.0446679 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859041  Vali macro F1 0.9794373 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 1.262218952178955
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0277057  Vali Loss: 0.0457020 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887271  Vali macro F1 0.9844971 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 1.2758550643920898
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0303280  Vali Loss: 0.0481554 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858564  Vali macro F1 0.9821229 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 14 cost time: 1.251915454864502
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0256815  Vali Loss: 0.0435459 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887271  Vali macro F1 0.9844971 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 1.257124423980713
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0260663  Vali Loss: 0.0457031 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859041  Vali macro F1 0.9794373 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 1.2552664279937744
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0268250  Vali Loss: 0.0460126 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887271  Vali macro F1 0.9844971 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 1.2546727657318115
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0256576  Vali Loss: 0.0454041 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887271  Vali macro F1 0.9844971 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 1.2544686794281006
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0286516  Vali Loss: 0.0470265 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859041  Vali macro F1 0.9794373 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 19 cost time: 1.254589319229126
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0252935  Vali Loss: 0.0473319 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859041  Vali macro F1 0.9794373 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 1.2531497478485107
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0260044  Vali Loss: 0.0474142 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859041  Vali macro F1 0.9794373 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 1.2546985149383545
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0254115  Vali Loss: 0.0475794 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887271  Vali macro F1 0.9844971 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 1.2549498081207275
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0225303  Vali Loss: 0.0471582 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887271  Vali macro F1 0.9844971 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 23 cost time: 1.2557203769683838
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0258001  Vali Loss: 0.0462917 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887271  Vali macro F1 0.9844971 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9842165  Test weighted F1: 0.9841731  Test macro F1 0.9756087 

============================= JOB FEEDBACK =============================

NodeName=uc2n564
Job ID: 20948450
Cluster: uc2
User/Group: px3192/tm
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 20
CPU Utilized: 01:10:34
CPU Efficiency: 4.85% of 1-00:14:40 core-walltime
Job Wall-clock time: 01:12:44
Memory Utilized: 4.82 GB
Memory Efficiency: 0.00% of 0.00 MB
