Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 1125747
Set the seed as :  1
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
================ SOCV Mode ====================
================ 5 CV ======================
================ the 0 th CV Experiment ================ 
Overlapping random Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.0027933  0.00240964 0.00243309 0.00330033 0.00526316 0.00581395
 0.00303951 0.00290698 0.00234742 0.00421941]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 3.1221888065338135
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.1449581  Vali Loss: 1.5927250 Vali Accuracy: 0.4774011  Vali weighted F1: 0.4174234  Vali macro F1 0.4077072 
Validation loss decreased (inf --> 1.592725).  Saving model ...
Epoch: 2 cost time: 1.357799768447876
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.2065100  Vali Loss: 0.7860650 Vali Accuracy: 0.7457627  Vali weighted F1: 0.7317420  Vali macro F1 0.6925740 
new best score!!!!
Validation loss decreased (1.592725 --> 0.786065).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.3657166957855225
VALI: Epoch: 3, Steps: 13 | Train Loss: 0.6976482  Vali Loss: 0.4620601 Vali Accuracy: 0.8446328  Vali weighted F1: 0.8308932  Vali macro F1 0.7956966 
new best score!!!!
Validation loss decreased (0.786065 --> 0.462060).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.3814637660980225
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.4400641  Vali Loss: 0.3404465 Vali Accuracy: 0.8587571  Vali weighted F1: 0.8546886  Vali macro F1 0.8260609 
new best score!!!!
Validation loss decreased (0.462060 --> 0.340446).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.3484301567077637
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.3242236  Vali Loss: 0.2368349 Vali Accuracy: 0.8870056  Vali weighted F1: 0.8790000  Vali macro F1 0.8377555 
new best score!!!!
Validation loss decreased (0.340446 --> 0.236835).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.346827745437622
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.2490000  Vali Loss: 0.2013453 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9232396  Vali macro F1 0.8989556 
new best score!!!!
Validation loss decreased (0.236835 --> 0.201345).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.3491313457489014
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.1996235  Vali Loss: 0.1594897 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9220718  Vali macro F1 0.8915699 
new best score!!!!
Validation loss decreased (0.201345 --> 0.159490).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.3455393314361572
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.1776509  Vali Loss: 0.1343060 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9313510  Vali macro F1 0.9007923 
new best score!!!!
Validation loss decreased (0.159490 --> 0.134306).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.3471035957336426
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.1581937  Vali Loss: 0.1594674 Vali Accuracy: 0.9265537  Vali weighted F1: 0.9228758  Vali macro F1 0.8911219 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 1.3433845043182373
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.1429853  Vali Loss: 0.1499268 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9148300  Vali macro F1 0.8797998 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 11 cost time: 1.3448596000671387
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.1311205  Vali Loss: 0.1230668 Vali Accuracy: 0.9152542  Vali weighted F1: 0.9111871  Vali macro F1 0.8701485 
new best score!!!!
Validation loss decreased (0.134306 --> 0.123067).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.34401273727417
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1276817  Vali Loss: 0.1226056 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9433688  Vali macro F1 0.9160998 
new best score!!!!
Validation loss decreased (0.123067 --> 0.122606).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.3501510620117188
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1189235  Vali Loss: 0.1099982 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9301808  Vali macro F1 0.8913129 
new best score!!!!
Validation loss decreased (0.122606 --> 0.109998).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.3539071083068848
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1146676  Vali Loss: 0.1172887 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9399855  Vali macro F1 0.9060033 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 1.3463773727416992
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1086853  Vali Loss: 0.1170699 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9310013  Vali macro F1 0.8928598 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 16 cost time: 1.345094919204712
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1012209  Vali Loss: 0.1062029 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9280710  Vali macro F1 0.8857718 
new best score!!!!
Validation loss decreased (0.109998 --> 0.106203).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.3489744663238525
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0906050  Vali Loss: 0.1070701 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9406764  Vali macro F1 0.9113927 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 1.3424317836761475
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0928136  Vali Loss: 0.1135524 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9491308  Vali macro F1 0.9256288 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 1.3382110595703125
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0896634  Vali Loss: 0.0985538 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9544644  Vali macro F1 0.9280223 
new best score!!!!
Validation loss decreased (0.106203 --> 0.098554).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.3463733196258545
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0770526  Vali Loss: 0.1030203 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9546908  Vali macro F1 0.9336248 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 1.3416283130645752
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0770212  Vali Loss: 0.1175100 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9421972  Vali macro F1 0.9211285 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 1.3426363468170166
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0741607  Vali Loss: 0.1035889 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9549042  Vali macro F1 0.9377463 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 23 cost time: 1.3410794734954834
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0709783  Vali Loss: 0.1059005 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9601877  Vali macro F1 0.9442831 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 24 cost time: 1.3587968349456787
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0697771  Vali Loss: 0.1017779 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9444339  Vali macro F1 0.9206994 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 25 cost time: 1.3407490253448486
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0706040  Vali Loss: 0.0825613 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9561018  Vali macro F1 0.9355190 
new best score!!!!
Validation loss decreased (0.098554 --> 0.082561).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.3422496318817139
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0548011  Vali Loss: 0.0714910 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9716961  Vali macro F1 0.9609865 
new best score!!!!
Validation loss decreased (0.082561 --> 0.071491).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.3479459285736084
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0512955  Vali Loss: 0.0685593 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802421  Vali macro F1 0.9714761 
new best score!!!!
Validation loss decreased (0.071491 --> 0.068559).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 1.3431494235992432
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0494396  Vali Loss: 0.0681521 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745882  Vali macro F1 0.9662368 
new best score!!!!
Validation loss decreased (0.068559 --> 0.068152).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.3436205387115479
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0493360  Vali Loss: 0.0669629 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802507  Vali macro F1 0.9733938 
new best score!!!!
Validation loss decreased (0.068152 --> 0.066963).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.3416430950164795
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0446868  Vali Loss: 0.0668478 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802507  Vali macro F1 0.9733938 
new best score!!!!
Validation loss decreased (0.066963 --> 0.066848).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 1.3438153266906738
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0444741  Vali Loss: 0.0670800 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802507  Vali macro F1 0.9733938 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 1.3430283069610596
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0424516  Vali Loss: 0.0682995 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774210  Vali macro F1 0.9710122 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 1.344834327697754
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0430307  Vali Loss: 0.0694795 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774199  Vali macro F1 0.9710916 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 34 cost time: 1.343386173248291
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0424319  Vali Loss: 0.0694776 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774199  Vali macro F1 0.9710916 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 35 cost time: 1.3442535400390625
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0414120  Vali Loss: 0.0697313 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774199  Vali macro F1 0.9710916 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 36 cost time: 1.3422250747680664
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0411912  Vali Loss: 0.0695678 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774199  Vali macro F1 0.9710916 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 1.3445866107940674
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0407829  Vali Loss: 0.0695639 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745547  Vali macro F1 0.9681936 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 1.342921257019043
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0390587  Vali Loss: 0.0692813 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745547  Vali macro F1 0.9681936 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 1.3425416946411133
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0386524  Vali Loss: 0.0691217 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745547  Vali macro F1 0.9681936 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 40 cost time: 1.343968152999878
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0394856  Vali Loss: 0.0691588 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745547  Vali macro F1 0.9681936 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 41 cost time: 1.344867467880249
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0398588  Vali Loss: 0.0691529 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745547  Vali macro F1 0.9681936 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 1.3425264358520508
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0386508  Vali Loss: 0.0691360 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745547  Vali macro F1 0.9681936 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 1.3437225818634033
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0391510  Vali Loss: 0.0691123 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745547  Vali macro F1 0.9681936 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 1.3439221382141113
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0396084  Vali Loss: 0.0691109 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745547  Vali macro F1 0.9681936 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 45 cost time: 1.3450605869293213
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0401987  Vali Loss: 0.0691085 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745547  Vali macro F1 0.9681936 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9739819  Test weighted F1: 0.9741804  Test macro F1 0.9592554 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1125747
pruned model Parameter : 1128786
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.6300230026245117
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0479977  Vali Loss: 0.0676005 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774210  Vali macro F1 0.9710122 
Validation loss decreased (inf --> 0.067601).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.5724925994873047
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0416130  Vali Loss: 0.0716196 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9719101  Vali macro F1 0.9644289 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.5704047679901123
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0409057  Vali Loss: 0.0697428 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9660706  Vali macro F1 0.9562856 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 1.5714187622070312
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0405140  Vali Loss: 0.0721796 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9719176  Vali macro F1 0.9664260 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 1.571563482284546
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0370744  Vali Loss: 0.0698424 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802453  Vali macro F1 0.9738699 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 1.5704827308654785
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0387851  Vali Loss: 0.0708420 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746240  Vali macro F1 0.9687724 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 1.5718622207641602
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0367983  Vali Loss: 0.0722198 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9747430  Vali macro F1 0.9692043 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 1.5719988346099854
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0338127  Vali Loss: 0.0758774 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9747173  Vali macro F1 0.9691610 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 1.5728180408477783
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0360883  Vali Loss: 0.0687147 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9747440  Vali macro F1 0.9687240 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 1.5755059719085693
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0329117  Vali Loss: 0.0714754 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802609  Vali macro F1 0.9782745 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 11 cost time: 1.5725152492523193
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0321608  Vali Loss: 0.0689170 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9775545  Vali macro F1 0.9759281 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 1.5732221603393555
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0306788  Vali Loss: 0.0675060 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745413  Vali macro F1 0.9690716 
new best score!!!!
Validation loss decreased (0.067601 --> 0.067506).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 1.5751419067382812
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0317258  Vali Loss: 0.0675873 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745413  Vali macro F1 0.9690716 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 1.5721790790557861
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0298189  Vali Loss: 0.0671180 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745413  Vali macro F1 0.9690716 
new best score!!!!
Validation loss decreased (0.067506 --> 0.067118).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 1.5728602409362793
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0297758  Vali Loss: 0.0669322 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746240  Vali macro F1 0.9687724 
new best score!!!!
Validation loss decreased (0.067118 --> 0.066932).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 16 cost time: 1.5738425254821777
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0288196  Vali Loss: 0.0670850 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746240  Vali macro F1 0.9687724 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 1.5752606391906738
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0303082  Vali Loss: 0.0669618 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746240  Vali macro F1 0.9687724 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 1.5743319988250732
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0292671  Vali Loss: 0.0669957 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773614  Vali macro F1 0.9738254 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 1.5729365348815918
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0296789  Vali Loss: 0.0667976 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801868  Vali macro F1 0.9766037 
new best score!!!!
Validation loss decreased (0.066932 --> 0.066798).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 20 cost time: 1.5744256973266602
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0301235  Vali Loss: 0.0667228 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801868  Vali macro F1 0.9766037 
new best score!!!!
Validation loss decreased (0.066798 --> 0.066723).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 21 cost time: 1.5738434791564941
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0304326  Vali Loss: 0.0667989 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801868  Vali macro F1 0.9766037 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 1.5765891075134277
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0295770  Vali Loss: 0.0668147 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774441  Vali macro F1 0.9735262 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 1.5781662464141846
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0288174  Vali Loss: 0.0667218 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774441  Vali macro F1 0.9735262 
new best score!!!!
Validation loss decreased (0.066723 --> 0.066722).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 24 cost time: 1.575699806213379
Fine Tuning VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0306726  Vali Loss: 0.0667071 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774441  Vali macro F1 0.9735262 
new best score!!!!
Validation loss decreased (0.066722 --> 0.066707).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 25 cost time: 1.5760715007781982
Fine Tuning VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0291624  Vali Loss: 0.0663576 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774441  Vali macro F1 0.9735262 
new best score!!!!
Validation loss decreased (0.066707 --> 0.066358).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 26 cost time: 1.5762948989868164
Fine Tuning VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0289844  Vali Loss: 0.0657405 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802695  Vali macro F1 0.9763045 
new best score!!!!
Validation loss decreased (0.066358 --> 0.065741).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 27 cost time: 1.5786778926849365
Fine Tuning VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0291960  Vali Loss: 0.0654811 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802695  Vali macro F1 0.9763045 
new best score!!!!
Validation loss decreased (0.065741 --> 0.065481).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 28 cost time: 1.5788609981536865
Fine Tuning VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0270822  Vali Loss: 0.0652932 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802695  Vali macro F1 0.9763045 
new best score!!!!
Validation loss decreased (0.065481 --> 0.065293).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 29 cost time: 1.5759851932525635
Fine Tuning VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0290213  Vali Loss: 0.0658172 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802695  Vali macro F1 0.9763045 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 30 cost time: 1.5749962329864502
Fine Tuning VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0297014  Vali Loss: 0.0657127 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802695  Vali macro F1 0.9763045 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 31 cost time: 1.5810043811798096
Fine Tuning VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0284364  Vali Loss: 0.0652284 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802695  Vali macro F1 0.9763045 
new best score!!!!
Validation loss decreased (0.065293 --> 0.065228).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 32 cost time: 1.5766408443450928
Fine Tuning VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0280705  Vali Loss: 0.0650251 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802695  Vali macro F1 0.9763045 
new best score!!!!
Validation loss decreased (0.065228 --> 0.065025).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 33 cost time: 1.5802133083343506
Fine Tuning VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0288794  Vali Loss: 0.0651838 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802695  Vali macro F1 0.9763045 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 34 cost time: 1.579829454421997
Fine Tuning VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0274897  Vali Loss: 0.0650403 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802695  Vali macro F1 0.9763045 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 35 cost time: 1.5770809650421143
Fine Tuning VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0276826  Vali Loss: 0.0648830 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802695  Vali macro F1 0.9763045 
new best score!!!!
Validation loss decreased (0.065025 --> 0.064883).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 36 cost time: 1.5797393321990967
Fine Tuning VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0264544  Vali Loss: 0.0644229 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802695  Vali macro F1 0.9763045 
new best score!!!!
Validation loss decreased (0.064883 --> 0.064423).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 37 cost time: 1.5771090984344482
Fine Tuning VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0283291  Vali Loss: 0.0643085 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802695  Vali macro F1 0.9763045 
new best score!!!!
Validation loss decreased (0.064423 --> 0.064308).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 38 cost time: 1.575110912322998
Fine Tuning VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0272759  Vali Loss: 0.0643628 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802695  Vali macro F1 0.9763045 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 39 cost time: 1.581622838973999
Fine Tuning VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0271298  Vali Loss: 0.0646076 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801868  Vali macro F1 0.9766037 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 40 cost time: 1.5821802616119385
Fine Tuning VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0280293  Vali Loss: 0.0643188 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801868  Vali macro F1 0.9766037 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 41 cost time: 1.578552484512329
Fine Tuning VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0276673  Vali Loss: 0.0635328 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801868  Vali macro F1 0.9766037 
new best score!!!!
Validation loss decreased (0.064308 --> 0.063533).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 42 cost time: 1.5830488204956055
Fine Tuning VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0274218  Vali Loss: 0.0632408 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801868  Vali macro F1 0.9766037 
new best score!!!!
Validation loss decreased (0.063533 --> 0.063241).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 43 cost time: 1.5839383602142334
Fine Tuning VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0269663  Vali Loss: 0.0633367 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801868  Vali macro F1 0.9766037 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 44 cost time: 1.5802793502807617
Fine Tuning VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0268504  Vali Loss: 0.0631997 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801868  Vali macro F1 0.9766037 
new best score!!!!
Validation loss decreased (0.063241 --> 0.063200).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 45 cost time: 1.5807745456695557
Fine Tuning VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0296651  Vali Loss: 0.0627670 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801868  Vali macro F1 0.9766037 
new best score!!!!
Validation loss decreased (0.063200 --> 0.062767).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 46 cost time: 1.58339524269104
Fine Tuning VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0272474  Vali Loss: 0.0631192 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801868  Vali macro F1 0.9766037 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 47 cost time: 1.5837852954864502
Fine Tuning VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0265977  Vali Loss: 0.0634732 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801868  Vali macro F1 0.9766037 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 48 cost time: 1.5807440280914307
Fine Tuning VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0262974  Vali Loss: 0.0633323 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801868  Vali macro F1 0.9766037 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 49 cost time: 1.5870749950408936
Fine Tuning VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0263733  Vali Loss: 0.0633801 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801868  Vali macro F1 0.9766037 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 50 cost time: 1.5813267230987549
Fine Tuning VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0252297  Vali Loss: 0.0633466 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801868  Vali macro F1 0.9766037 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 51 cost time: 1.5853686332702637
Fine Tuning VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0264513  Vali Loss: 0.0633773 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801868  Vali macro F1 0.9766037 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 52 cost time: 1.585749626159668
Fine Tuning VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0248683  Vali Loss: 0.0634162 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773614  Vali macro F1 0.9738254 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 53 cost time: 1.5827867984771729
Fine Tuning VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0257857  Vali Loss: 0.0633922 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773614  Vali macro F1 0.9738254 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 54 cost time: 1.586759328842163
Fine Tuning VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0264180  Vali Loss: 0.0633752 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773614  Vali macro F1 0.9738254 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 55 cost time: 1.5826325416564941
Fine Tuning VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0267542  Vali Loss: 0.0633840 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773614  Vali macro F1 0.9738254 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Fine Tuning Epoch: 56 cost time: 1.5843920707702637
Fine Tuning VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0267188  Vali Loss: 0.0633854 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773614  Vali macro F1 0.9738254 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 57 cost time: 1.586700439453125
Fine Tuning VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0256554  Vali Loss: 0.0633743 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773614  Vali macro F1 0.9738254 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 58 cost time: 1.5859651565551758
Fine Tuning VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0262463  Vali Loss: 0.0633671 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773614  Vali macro F1 0.9738254 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 59 cost time: 1.5880939960479736
Fine Tuning VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0256551  Vali Loss: 0.0633597 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773614  Vali macro F1 0.9738254 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 60 cost time: 1.5910871028900146
Fine Tuning VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0267520  Vali Loss: 0.0633483 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773614  Vali macro F1 0.9738254 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9830317  Test weighted F1: 0.9830773  Test macro F1 0.9763028 
================ the 1 th CV Experiment ================ 
Overlapping random Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00280112 0.00243902 0.00238095 0.00328947 0.00561798 0.00568182
 0.00304878 0.00282486 0.00238095 0.00420168]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.3620755672454834
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.1292121  Vali Loss: 1.5712972 Vali Accuracy: 0.4322034  Vali weighted F1: 0.3917525  Vali macro F1 0.3634289 
Validation loss decreased (inf --> 1.571297).  Saving model ...
Epoch: 2 cost time: 1.3459646701812744
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.2232824  Vali Loss: 0.7832468 Vali Accuracy: 0.7316384  Vali weighted F1: 0.7127948  Vali macro F1 0.6719723 
new best score!!!!
Validation loss decreased (1.571297 --> 0.783247).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.345912218093872
VALI: Epoch: 3, Steps: 13 | Train Loss: 0.7375397  Vali Loss: 0.4963269 Vali Accuracy: 0.8276836  Vali weighted F1: 0.8211669  Vali macro F1 0.7891990 
new best score!!!!
Validation loss decreased (0.783247 --> 0.496327).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.3447105884552002
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.4796427  Vali Loss: 0.3427549 Vali Accuracy: 0.8587571  Vali weighted F1: 0.8431872  Vali macro F1 0.8021317 
new best score!!!!
Validation loss decreased (0.496327 --> 0.342755).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.3437731266021729
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.3415970  Vali Loss: 0.2464796 Vali Accuracy: 0.8870056  Vali weighted F1: 0.8741219  Vali macro F1 0.8354075 
new best score!!!!
Validation loss decreased (0.342755 --> 0.246480).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.3451967239379883
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.2708050  Vali Loss: 0.2318364 Vali Accuracy: 0.8926554  Vali weighted F1: 0.8721190  Vali macro F1 0.8245530 
new best score!!!!
Validation loss decreased (0.246480 --> 0.231836).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.3468708992004395
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.2164211  Vali Loss: 0.1799196 Vali Accuracy: 0.9124294  Vali weighted F1: 0.9096752  Vali macro F1 0.8691028 
new best score!!!!
Validation loss decreased (0.231836 --> 0.179920).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.3435978889465332
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.1837798  Vali Loss: 0.1493018 Vali Accuracy: 0.9152542  Vali weighted F1: 0.9136605  Vali macro F1 0.8739131 
new best score!!!!
Validation loss decreased (0.179920 --> 0.149302).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.3458223342895508
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.1601276  Vali Loss: 0.1369029 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9182398  Vali macro F1 0.8787618 
new best score!!!!
Validation loss decreased (0.149302 --> 0.136903).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.3432083129882812
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.1419756  Vali Loss: 0.1352373 Vali Accuracy: 0.9265537  Vali weighted F1: 0.9125959  Vali macro F1 0.8696492 
new best score!!!!
Validation loss decreased (0.136903 --> 0.135237).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.3422789573669434
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.1274769  Vali Loss: 0.1144989 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9388144  Vali macro F1 0.9040366 
new best score!!!!
Validation loss decreased (0.135237 --> 0.114499).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.3467638492584229
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1204928  Vali Loss: 0.1291830 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9201697  Vali macro F1 0.8841671 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 1.3427069187164307
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1149341  Vali Loss: 0.1187236 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9152887  Vali macro F1 0.8708768 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 14 cost time: 1.343508005142212
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1100435  Vali Loss: 0.1358788 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9119696  Vali macro F1 0.8728218 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 15 cost time: 1.3435635566711426
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1174208  Vali Loss: 0.0982828 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9546375  Vali macro F1 0.9302986 
new best score!!!!
Validation loss decreased (0.114499 --> 0.098283).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.3448057174682617
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1115349  Vali Loss: 0.1242155 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9169902  Vali macro F1 0.8672472 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 1.3418784141540527
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.1140925  Vali Loss: 0.1020832 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9414830  Vali macro F1 0.9069114 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 1.343052864074707
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.1000961  Vali Loss: 0.1050416 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9537302  Vali macro F1 0.9291483 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 19 cost time: 1.3428220748901367
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0964479  Vali Loss: 0.1170617 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9406941  Vali macro F1 0.9195897 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 20 cost time: 1.3425970077514648
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.1118353  Vali Loss: 0.1055789 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9166309  Vali macro F1 0.8711949 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 21 cost time: 1.3433432579040527
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0955646  Vali Loss: 0.0819122 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9717778  Vali macro F1 0.9571245 
new best score!!!!
Validation loss decreased (0.098283 --> 0.081912).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.3474397659301758
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0835304  Vali Loss: 0.0811259 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9574652  Vali macro F1 0.9329976 
new best score!!!!
Validation loss decreased (0.081912 --> 0.081126).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.3453199863433838
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0798983  Vali Loss: 0.0808078 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9655396  Vali macro F1 0.9466087 
new best score!!!!
Validation loss decreased (0.081126 --> 0.080808).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.3468878269195557
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0751291  Vali Loss: 0.0761502 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9685874  Vali macro F1 0.9517465 
new best score!!!!
Validation loss decreased (0.080808 --> 0.076150).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.346435785293579
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0741838  Vali Loss: 0.0764847 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745013  Vali macro F1 0.9617155 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 1.345215082168579
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0729059  Vali Loss: 0.0771278 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9740377  Vali macro F1 0.9609341 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 27 cost time: 1.3477590084075928
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0693775  Vali Loss: 0.0762019 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745013  Vali macro F1 0.9617155 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 28 cost time: 1.344938039779663
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0687173  Vali Loss: 0.0773014 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9715709  Vali macro F1 0.9567758 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 29 cost time: 1.3513739109039307
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0672658  Vali Loss: 0.0768548 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9713070  Vali macro F1 0.9563309 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 30 cost time: 1.3437097072601318
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0659497  Vali Loss: 0.0770488 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9713070  Vali macro F1 0.9563309 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 1.3585608005523682
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0661207  Vali Loss: 0.0764087 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9713070  Vali macro F1 0.9563309 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 1.3450698852539062
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0638462  Vali Loss: 0.0759784 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9772724  Vali macro F1 0.9663868 
new best score!!!!
Validation loss decreased (0.076150 --> 0.075978).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 1.3477590084075928
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0669933  Vali Loss: 0.0755530 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745013  Vali macro F1 0.9617155 
new best score!!!!
Validation loss decreased (0.075978 --> 0.075553).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 1.3461389541625977
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0647361  Vali Loss: 0.0755264 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9772724  Vali macro F1 0.9663868 
new best score!!!!
Validation loss decreased (0.075553 --> 0.075526).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.3473081588745117
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0677136  Vali Loss: 0.0753772 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9772724  Vali macro F1 0.9663868 
new best score!!!!
Validation loss decreased (0.075526 --> 0.075377).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 1.346146821975708
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0655892  Vali Loss: 0.0753546 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9772724  Vali macro F1 0.9663868 
new best score!!!!
Validation loss decreased (0.075377 --> 0.075355).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 1.3459033966064453
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0649811  Vali Loss: 0.0753226 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9772724  Vali macro F1 0.9663868 
new best score!!!!
Validation loss decreased (0.075355 --> 0.075323).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 1.3462588787078857
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0657714  Vali Loss: 0.0753872 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9772724  Vali macro F1 0.9663868 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 1.3469820022583008
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0640407  Vali Loss: 0.0753919 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9772724  Vali macro F1 0.9663868 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 1.3429865837097168
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0626277  Vali Loss: 0.0751406 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9772724  Vali macro F1 0.9663868 
new best score!!!!
Validation loss decreased (0.075323 --> 0.075141).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 1.3454415798187256
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0648029  Vali Loss: 0.0749932 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9772724  Vali macro F1 0.9663868 
new best score!!!!
Validation loss decreased (0.075141 --> 0.074993).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 1.3457224369049072
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0622364  Vali Loss: 0.0747700 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801799  Vali macro F1 0.9712882 
new best score!!!!
Validation loss decreased (0.074993 --> 0.074770).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 1.3447177410125732
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0645299  Vali Loss: 0.0746066 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773890  Vali macro F1 0.9665834 
new best score!!!!
Validation loss decreased (0.074770 --> 0.074607).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 1.3456943035125732
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0627905  Vali Loss: 0.0744164 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773890  Vali macro F1 0.9665834 
new best score!!!!
Validation loss decreased (0.074607 --> 0.074416).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 1.3455286026000977
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0632714  Vali Loss: 0.0744266 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801799  Vali macro F1 0.9712882 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 1.3461952209472656
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0628813  Vali Loss: 0.0740220 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802444  Vali macro F1 0.9713968 
new best score!!!!
Validation loss decreased (0.074416 --> 0.074022).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 1.3481724262237549
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0643685  Vali Loss: 0.0743758 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801799  Vali macro F1 0.9712882 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 1.3445205688476562
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0621396  Vali Loss: 0.0743489 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801799  Vali macro F1 0.9712882 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 1.3443596363067627
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0647817  Vali Loss: 0.0739396 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801799  Vali macro F1 0.9712882 
new best score!!!!
Validation loss decreased (0.074022 --> 0.073940).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 1.34492826461792
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0625639  Vali Loss: 0.0739861 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801799  Vali macro F1 0.9712882 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 1.3438520431518555
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0621554  Vali Loss: 0.0741411 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801799  Vali macro F1 0.9712882 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 1.3454358577728271
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0637546  Vali Loss: 0.0738787 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830516  Vali macro F1 0.9761289 
new best score!!!!
Validation loss decreased (0.073940 --> 0.073879).  Saving model ...
new best score!!!!
Epoch: 53 cost time: 1.345348834991455
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0612592  Vali Loss: 0.0744601 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9772724  Vali macro F1 0.9663868 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 1.343611717224121
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0610177  Vali Loss: 0.0740141 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801799  Vali macro F1 0.9712882 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 1.342501163482666
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0624012  Vali Loss: 0.0736584 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830516  Vali macro F1 0.9761289 
new best score!!!!
Validation loss decreased (0.073879 --> 0.073658).  Saving model ...
new best score!!!!
Epoch: 56 cost time: 1.3445117473602295
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0625589  Vali Loss: 0.0737582 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830516  Vali macro F1 0.9761289 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 57 cost time: 1.3446028232574463
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0599096  Vali Loss: 0.0735746 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830516  Vali macro F1 0.9761289 
new best score!!!!
Validation loss decreased (0.073658 --> 0.073575).  Saving model ...
new best score!!!!
Epoch: 58 cost time: 1.3448262214660645
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0601320  Vali Loss: 0.0731307 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830516  Vali macro F1 0.9761289 
new best score!!!!
Validation loss decreased (0.073575 --> 0.073131).  Saving model ...
new best score!!!!
Epoch: 59 cost time: 1.3516499996185303
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0626702  Vali Loss: 0.0733911 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801799  Vali macro F1 0.9712882 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 60 cost time: 1.3432023525238037
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0598546  Vali Loss: 0.0731272 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830516  Vali macro F1 0.9761289 
new best score!!!!
Validation loss decreased (0.073131 --> 0.073127).  Saving model ...
new best score!!!!
Epoch: 61 cost time: 1.3564848899841309
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0611495  Vali Loss: 0.0724334 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830516  Vali macro F1 0.9761289 
new best score!!!!
Validation loss decreased (0.073127 --> 0.072433).  Saving model ...
new best score!!!!
Epoch: 62 cost time: 1.347442388534546
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0585436  Vali Loss: 0.0720014 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830516  Vali macro F1 0.9761289 
new best score!!!!
Validation loss decreased (0.072433 --> 0.072001).  Saving model ...
new best score!!!!
Epoch: 63 cost time: 1.3440043926239014
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0624382  Vali Loss: 0.0721299 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830516  Vali macro F1 0.9761289 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 64 cost time: 1.345365285873413
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0628443  Vali Loss: 0.0721369 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830516  Vali macro F1 0.9761289 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 65 cost time: 1.342804193496704
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0605954  Vali Loss: 0.0723518 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830516  Vali macro F1 0.9761289 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 66 cost time: 1.3445532321929932
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0608116  Vali Loss: 0.0725648 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830516  Vali macro F1 0.9761289 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 67 cost time: 1.344473123550415
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0600847  Vali Loss: 0.0725899 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830516  Vali macro F1 0.9761289 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 68 cost time: 1.3430860042572021
VALI: Epoch: 68, Steps: 13 | Train Loss: 0.0607487  Vali Loss: 0.0726190 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830516  Vali macro F1 0.9761289 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 69 cost time: 1.34413743019104
VALI: Epoch: 69, Steps: 13 | Train Loss: 0.0613468  Vali Loss: 0.0726183 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830516  Vali macro F1 0.9761289 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 70 cost time: 1.3428153991699219
VALI: Epoch: 70, Steps: 13 | Train Loss: 0.0611200  Vali Loss: 0.0726327 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830516  Vali macro F1 0.9761289 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 71 cost time: 1.3426296710968018
VALI: Epoch: 71, Steps: 13 | Train Loss: 0.0581015  Vali Loss: 0.0726646 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830516  Vali macro F1 0.9761289 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 72 cost time: 1.3440501689910889
VALI: Epoch: 72, Steps: 13 | Train Loss: 0.0620120  Vali Loss: 0.0726631 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830516  Vali macro F1 0.9761289 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 73 cost time: 1.3442792892456055
VALI: Epoch: 73, Steps: 13 | Train Loss: 0.0606746  Vali Loss: 0.0726602 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830516  Vali macro F1 0.9761289 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 74 cost time: 1.3425312042236328
VALI: Epoch: 74, Steps: 13 | Train Loss: 0.0588575  Vali Loss: 0.0726600 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830516  Vali macro F1 0.9761289 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 75 cost time: 1.340714931488037
VALI: Epoch: 75, Steps: 13 | Train Loss: 0.0602461  Vali Loss: 0.0726656 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830516  Vali macro F1 0.9761289 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 76 cost time: 1.3438122272491455
VALI: Epoch: 76, Steps: 13 | Train Loss: 0.0611458  Vali Loss: 0.0726628 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830516  Vali macro F1 0.9761289 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 77 cost time: 1.342052698135376
VALI: Epoch: 77, Steps: 13 | Train Loss: 0.0596840  Vali Loss: 0.0726531 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830516  Vali macro F1 0.9761289 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9807692  Test weighted F1: 0.9807784  Test macro F1 0.9710548 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1125747
pruned model Parameter : 1128786
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.5922343730926514
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0620352  Vali Loss: 0.0722483 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801391  Vali macro F1 0.9713262 
Validation loss decreased (inf --> 0.072248).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.590651512145996
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0589921  Vali Loss: 0.0726193 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9739968  Vali macro F1 0.9609721 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.5916318893432617
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0564950  Vali Loss: 0.0694562 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801799  Vali macro F1 0.9712882 
new best score!!!!
Validation loss decreased (0.072248 --> 0.069456).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 1.5911197662353516
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0585965  Vali Loss: 0.0658745 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830112  Vali macro F1 0.9761283 
new best score!!!!
Validation loss decreased (0.069456 --> 0.065874).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 1.5915777683258057
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0542323  Vali Loss: 0.0637877 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858973  Vali macro F1 0.9809260 
new best score!!!!
Validation loss decreased (0.065874 --> 0.063788).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 1.5923054218292236
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0547494  Vali Loss: 0.0671629 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886738  Vali macro F1 0.9856737 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 1.591764211654663
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0505496  Vali Loss: 0.0581608 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802040  Vali macro F1 0.9713962 
new best score!!!!
Validation loss decreased (0.063788 --> 0.058161).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 1.5920875072479248
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0483644  Vali Loss: 0.0599105 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886738  Vali macro F1 0.9856737 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 1.5923967361450195
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0448965  Vali Loss: 0.0625619 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858183  Vali macro F1 0.9808602 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 1.5888338088989258
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0451458  Vali Loss: 0.0608870 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858183  Vali macro F1 0.9808602 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 1.5893559455871582
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0431094  Vali Loss: 0.0622436 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858183  Vali macro F1 0.9808602 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 1.5919954776763916
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0395700  Vali Loss: 0.0578039 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802444  Vali macro F1 0.9713968 
new best score!!!!
Validation loss decreased (0.058161 --> 0.057804).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 1.5924046039581299
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0421575  Vali Loss: 0.0591315 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858569  Vali macro F1 0.9809254 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 1.5872769355773926
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0392985  Vali Loss: 0.0615288 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830111  Vali macro F1 0.9809741 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 1.5905094146728516
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0397689  Vali Loss: 0.0600615 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830772  Vali macro F1 0.9761722 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 1.5903689861297607
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0403711  Vali Loss: 0.0577789 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830772  Vali macro F1 0.9761722 
new best score!!!!
Validation loss decreased (0.057804 --> 0.057779).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 1.5901367664337158
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0376676  Vali Loss: 0.0596576 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830111  Vali macro F1 0.9809741 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 1.592893362045288
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0353315  Vali Loss: 0.0582765 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829829  Vali macro F1 0.9785014 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 1.5886962413787842
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0329019  Vali Loss: 0.0578977 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829846  Vali macro F1 0.9784628 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 1.5906009674072266
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0329524  Vali Loss: 0.0506777 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829846  Vali macro F1 0.9784628 
new best score!!!!
Validation loss decreased (0.057779 --> 0.050678).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 21 cost time: 1.5923962593078613
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0308045  Vali Loss: 0.0539866 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858384  Vali macro F1 0.9833149 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 22 cost time: 1.5908856391906738
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0308313  Vali Loss: 0.0529477 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858384  Vali macro F1 0.9833149 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 23 cost time: 1.5922837257385254
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0276383  Vali Loss: 0.0573192 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829829  Vali macro F1 0.9785014 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 24 cost time: 1.5914232730865479
Fine Tuning VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0296659  Vali Loss: 0.0687567 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9744842  Vali macro F1 0.9689988 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 25 cost time: 1.590606689453125
Fine Tuning VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0286492  Vali Loss: 0.0551961 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829846  Vali macro F1 0.9784628 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 26 cost time: 1.587277889251709
Fine Tuning VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0262886  Vali Loss: 0.0557467 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9800997  Vali macro F1 0.9735998 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 27 cost time: 1.5872597694396973
Fine Tuning VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0238167  Vali Loss: 0.0560384 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887141  Vali macro F1 0.9856743 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 28 cost time: 1.589709758758545
Fine Tuning VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0238325  Vali Loss: 0.0559804 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829756  Vali macro F1 0.9808981 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 29 cost time: 1.5888478755950928
Fine Tuning VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0228248  Vali Loss: 0.0523322 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829756  Vali macro F1 0.9808981 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 30 cost time: 1.5899322032928467
Fine Tuning VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0248662  Vali Loss: 0.0513373 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858401  Vali macro F1 0.9832763 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 31 cost time: 1.5901691913604736
Fine Tuning VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0224862  Vali Loss: 0.0507501 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858401  Vali macro F1 0.9832763 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 32 cost time: 1.5894098281860352
Fine Tuning VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0205779  Vali Loss: 0.0506262 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829829  Vali macro F1 0.9785014 
new best score!!!!
Validation loss decreased (0.050678 --> 0.050626).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 33 cost time: 1.5913944244384766
Fine Tuning VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0199742  Vali Loss: 0.0506058 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829829  Vali macro F1 0.9785014 
new best score!!!!
Validation loss decreased (0.050626 --> 0.050606).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 34 cost time: 1.5904340744018555
Fine Tuning VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0201741  Vali Loss: 0.0500372 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858384  Vali macro F1 0.9833149 
new best score!!!!
Validation loss decreased (0.050606 --> 0.050037).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 35 cost time: 1.5915253162384033
Fine Tuning VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0215836  Vali Loss: 0.0500866 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829829  Vali macro F1 0.9785014 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 36 cost time: 1.5919482707977295
Fine Tuning VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0200389  Vali Loss: 0.0501777 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829829  Vali macro F1 0.9785014 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 37 cost time: 1.589798927307129
Fine Tuning VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0221240  Vali Loss: 0.0502204 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858401  Vali macro F1 0.9832763 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 38 cost time: 1.5874810218811035
Fine Tuning VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0212062  Vali Loss: 0.0498839 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858384  Vali macro F1 0.9833149 
new best score!!!!
Validation loss decreased (0.050037 --> 0.049884).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 39 cost time: 1.5908591747283936
Fine Tuning VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0188931  Vali Loss: 0.0491712 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858384  Vali macro F1 0.9833149 
new best score!!!!
Validation loss decreased (0.049884 --> 0.049171).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 40 cost time: 1.5878047943115234
Fine Tuning VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0206338  Vali Loss: 0.0485494 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829829  Vali macro F1 0.9785014 
new best score!!!!
Validation loss decreased (0.049171 --> 0.048549).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 41 cost time: 1.588677167892456
Fine Tuning VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0200549  Vali Loss: 0.0483688 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829829  Vali macro F1 0.9785014 
new best score!!!!
Validation loss decreased (0.048549 --> 0.048369).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 42 cost time: 1.5880513191223145
Fine Tuning VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0194960  Vali Loss: 0.0482740 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858384  Vali macro F1 0.9833149 
new best score!!!!
Validation loss decreased (0.048369 --> 0.048274).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 43 cost time: 1.5922996997833252
Fine Tuning VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0183845  Vali Loss: 0.0481888 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858384  Vali macro F1 0.9833149 
new best score!!!!
Validation loss decreased (0.048274 --> 0.048189).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 44 cost time: 1.58870530128479
Fine Tuning VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0207723  Vali Loss: 0.0480478 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829829  Vali macro F1 0.9785014 
new best score!!!!
Validation loss decreased (0.048189 --> 0.048048).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 45 cost time: 1.5884206295013428
Fine Tuning VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0189834  Vali Loss: 0.0473082 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829829  Vali macro F1 0.9785014 
new best score!!!!
Validation loss decreased (0.048048 --> 0.047308).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 46 cost time: 1.5926806926727295
Fine Tuning VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0176951  Vali Loss: 0.0463907 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829829  Vali macro F1 0.9785014 
new best score!!!!
Validation loss decreased (0.047308 --> 0.046391).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 47 cost time: 1.5919833183288574
Fine Tuning VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0187655  Vali Loss: 0.0459356 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858384  Vali macro F1 0.9833149 
new best score!!!!
Validation loss decreased (0.046391 --> 0.045936).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 48 cost time: 1.5921361446380615
Fine Tuning VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0212977  Vali Loss: 0.0454397 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858384  Vali macro F1 0.9833149 
new best score!!!!
Validation loss decreased (0.045936 --> 0.045440).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 49 cost time: 1.588578224182129
Fine Tuning VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0201613  Vali Loss: 0.0452445 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858384  Vali macro F1 0.9833149 
new best score!!!!
Validation loss decreased (0.045440 --> 0.045244).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 50 cost time: 1.5894711017608643
Fine Tuning VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0202583  Vali Loss: 0.0467674 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858384  Vali macro F1 0.9833149 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 51 cost time: 1.5876305103302002
Fine Tuning VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0201053  Vali Loss: 0.0474059 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858384  Vali macro F1 0.9833149 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 52 cost time: 1.589184045791626
Fine Tuning VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0180564  Vali Loss: 0.0475299 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829829  Vali macro F1 0.9785014 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 53 cost time: 1.5895938873291016
Fine Tuning VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0171420  Vali Loss: 0.0473719 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858384  Vali macro F1 0.9833149 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 54 cost time: 1.5888113975524902
Fine Tuning VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0194326  Vali Loss: 0.0474227 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858384  Vali macro F1 0.9833149 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 55 cost time: 1.5921614170074463
Fine Tuning VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0184773  Vali Loss: 0.0474588 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858384  Vali macro F1 0.9833149 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 56 cost time: 1.590907335281372
Fine Tuning VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0173286  Vali Loss: 0.0474813 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858384  Vali macro F1 0.9833149 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 57 cost time: 1.591686725616455
Fine Tuning VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0199804  Vali Loss: 0.0475689 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858384  Vali macro F1 0.9833149 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 58 cost time: 1.5898292064666748
Fine Tuning VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0178396  Vali Loss: 0.0475506 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858384  Vali macro F1 0.9833149 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 59 cost time: 1.5908830165863037
Fine Tuning VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0188593  Vali Loss: 0.0475325 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858384  Vali macro F1 0.9833149 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Fine Tuning Epoch: 60 cost time: 1.590228796005249
Fine Tuning VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0182421  Vali Loss: 0.0475248 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858384  Vali macro F1 0.9833149 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 61 cost time: 1.5889654159545898
Fine Tuning VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0185067  Vali Loss: 0.0475270 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858384  Vali macro F1 0.9833149 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 62 cost time: 1.5903470516204834
Fine Tuning VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0187788  Vali Loss: 0.0475300 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858384  Vali macro F1 0.9833149 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 63 cost time: 1.5920746326446533
Fine Tuning VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0189049  Vali Loss: 0.0475284 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858384  Vali macro F1 0.9833149 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 64 cost time: 1.5916836261749268
Fine Tuning VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0183755  Vali Loss: 0.0475241 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858384  Vali macro F1 0.9833149 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9807692  Test weighted F1: 0.9808426  Test macro F1 0.9719575 
================ the 2 th CV Experiment ================ 
Overlapping random Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.00276243 0.00239234 0.00246305 0.00330033 0.00595238 0.00574713
 0.00308642 0.00291545 0.00232019 0.00390625]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.348578929901123
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.1301745  Vali Loss: 1.5773951 Vali Accuracy: 0.4237288  Vali weighted F1: 0.3852745  Vali macro F1 0.3520223 
Validation loss decreased (inf --> 1.577395).  Saving model ...
Epoch: 2 cost time: 1.3487818241119385
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.2130766  Vali Loss: 0.8091366 Vali Accuracy: 0.6864407  Vali weighted F1: 0.6566852  Vali macro F1 0.6227282 
new best score!!!!
Validation loss decreased (1.577395 --> 0.809137).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.345262050628662
VALI: Epoch: 3, Steps: 13 | Train Loss: 0.7294665  Vali Loss: 0.4703518 Vali Accuracy: 0.8389831  Vali weighted F1: 0.8336329  Vali macro F1 0.8055701 
new best score!!!!
Validation loss decreased (0.809137 --> 0.470352).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.3486719131469727
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.4775752  Vali Loss: 0.3336966 Vali Accuracy: 0.8615819  Vali weighted F1: 0.8609803  Vali macro F1 0.8225701 
new best score!!!!
Validation loss decreased (0.470352 --> 0.333697).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.3478074073791504
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.3424098  Vali Loss: 0.2542273 Vali Accuracy: 0.9265537  Vali weighted F1: 0.9227907  Vali macro F1 0.8957665 
new best score!!!!
Validation loss decreased (0.333697 --> 0.254227).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.3462238311767578
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.2729670  Vali Loss: 0.1994274 Vali Accuracy: 0.9124294  Vali weighted F1: 0.9026450  Vali macro F1 0.8547431 
new best score!!!!
Validation loss decreased (0.254227 --> 0.199427).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.348722219467163
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.2197431  Vali Loss: 0.1794715 Vali Accuracy: 0.9067797  Vali weighted F1: 0.8929009  Vali macro F1 0.8374027 
new best score!!!!
Validation loss decreased (0.199427 --> 0.179472).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.347393274307251
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.1757206  Vali Loss: 0.1341167 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9313373  Vali macro F1 0.8909141 
new best score!!!!
Validation loss decreased (0.179472 --> 0.134117).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.346726655960083
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.1521674  Vali Loss: 0.1280226 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9361309  Vali macro F1 0.9060913 
new best score!!!!
Validation loss decreased (0.134117 --> 0.128023).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.3468363285064697
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.1385563  Vali Loss: 0.1202580 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9283425  Vali macro F1 0.8907210 
new best score!!!!
Validation loss decreased (0.128023 --> 0.120258).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.3462681770324707
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.1287848  Vali Loss: 0.1201226 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9306750  Vali macro F1 0.8945177 
new best score!!!!
Validation loss decreased (0.120258 --> 0.120123).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.3457965850830078
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1184827  Vali Loss: 0.1144510 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9365056  Vali macro F1 0.8997333 
new best score!!!!
Validation loss decreased (0.120123 --> 0.114451).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.3471119403839111
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1118146  Vali Loss: 0.1061308 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9212909  Vali macro F1 0.8716937 
new best score!!!!
Validation loss decreased (0.114451 --> 0.106131).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.3488430976867676
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1064461  Vali Loss: 0.0940965 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9508494  Vali macro F1 0.9226904 
new best score!!!!
Validation loss decreased (0.106131 --> 0.094096).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.3494083881378174
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1027200  Vali Loss: 0.0829975 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9629593  Vali macro F1 0.9399502 
new best score!!!!
Validation loss decreased (0.094096 --> 0.082997).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.3501520156860352
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0927703  Vali Loss: 0.0843901 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9453905  Vali macro F1 0.9150960 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 1.3515965938568115
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0969546  Vali Loss: 0.0867911 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9537234  Vali macro F1 0.9266661 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 1.3505713939666748
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0820002  Vali Loss: 0.0679938 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773969  Vali macro F1 0.9642461 
new best score!!!!
Validation loss decreased (0.082997 --> 0.067994).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.3494305610656738
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0766402  Vali Loss: 0.0666560 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9602631  Vali macro F1 0.9349995 
new best score!!!!
Validation loss decreased (0.067994 --> 0.066656).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.3485655784606934
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0718870  Vali Loss: 0.0685218 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9768412  Vali macro F1 0.9632532 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 1.3514130115509033
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0742233  Vali Loss: 0.0926628 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9498898  Vali macro F1 0.9287635 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 1.3523375988006592
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0595258  Vali Loss: 0.0475026 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9904762 
new best score!!!!
Validation loss decreased (0.066656 --> 0.047503).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.3548080921173096
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0484749  Vali Loss: 0.0423626 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971735  Vali macro F1 0.9952354 
new best score!!!!
Validation loss decreased (0.047503 --> 0.042363).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.3559987545013428
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0507486  Vali Loss: 0.0615624 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858311  Vali macro F1 0.9809351 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 1.352673053741455
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0410344  Vali Loss: 0.0501826 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9711608  Vali macro F1 0.9586540 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 1.3517038822174072
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0442484  Vali Loss: 0.0350487 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858950  Vali macro F1 0.9810053 
new best score!!!!
Validation loss decreased (0.042363 --> 0.035049).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.3594629764556885
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0348883  Vali Loss: 0.0506030 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830310  Vali macro F1 0.9781619 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 1.351043701171875
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0347124  Vali Loss: 0.0326906 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915740  Vali macro F1 0.9904526 
new best score!!!!
Validation loss decreased (0.035049 --> 0.032691).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.3606126308441162
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0348558  Vali Loss: 0.0344914 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915238  Vali macro F1 0.9904915 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 1.3544719219207764
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0279725  Vali Loss: 0.0330585 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886877  Vali macro F1 0.9857106 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 1.3517487049102783
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0277197  Vali Loss: 0.0352185 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887379  Vali macro F1 0.9856718 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 32 cost time: 1.352074146270752
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0204554  Vali Loss: 0.0332467 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858172  Vali macro F1 0.9809396 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 33 cost time: 1.3498125076293945
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0284013  Vali Loss: 0.0325944 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829818  Vali macro F1 0.9785808 
new best score!!!!
Validation loss decreased (0.032691 --> 0.032594).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 1.351557970046997
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0204174  Vali Loss: 0.0414447 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802327  Vali macro F1 0.9758405 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 1.352332353591919
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0152697  Vali Loss: 0.0278652 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886635  Vali macro F1 0.9832802 
new best score!!!!
Validation loss decreased (0.032594 --> 0.027865).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 1.350407361984253
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0152728  Vali Loss: 0.0313327 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886635  Vali macro F1 0.9832802 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 1.3523061275482178
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0216622  Vali Loss: 0.0251415 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915480  Vali macro F1 0.9905345 
new best score!!!!
Validation loss decreased (0.027865 --> 0.025141).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 1.3511936664581299
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0207798  Vali Loss: 0.0288776 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886635  Vali macro F1 0.9832802 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 1.3501195907592773
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0172431  Vali Loss: 0.0380162 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858381  Vali macro F1 0.9805019 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 1.3496143817901611
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0141733  Vali Loss: 0.0369444 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857787  Vali macro F1 0.9784172 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 1.349815845489502
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0128653  Vali Loss: 0.0337297 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858564  Vali macro F1 0.9809402 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 42 cost time: 1.3503201007843018
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0111261  Vali Loss: 0.0223654 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914820  Vali macro F1 0.9856410 
new best score!!!!
Validation loss decreased (0.025141 --> 0.022365).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 1.3518133163452148
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0141870  Vali Loss: 0.0404592 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858564  Vali macro F1 0.9809402 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 1.3513851165771484
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0219736  Vali Loss: 0.0366267 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886498  Vali macro F1 0.9832572 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 1.3492355346679688
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0214020  Vali Loss: 0.0378275 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802049  Vali macro F1 0.9753000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 46 cost time: 1.3521449565887451
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0166145  Vali Loss: 0.0288781 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886635  Vali macro F1 0.9832802 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 47 cost time: 1.3519692420959473
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0133388  Vali Loss: 0.0252785 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914820  Vali macro F1 0.9856410 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 48 cost time: 1.3500950336456299
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0085121  Vali Loss: 0.0265797 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914820  Vali macro F1 0.9856410 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 1.3505456447601318
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0069563  Vali Loss: 0.0291297 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914820  Vali macro F1 0.9856410 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 1.3503992557525635
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0063857  Vali Loss: 0.0300433 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914820  Vali macro F1 0.9856410 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 1.3521697521209717
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0064040  Vali Loss: 0.0293580 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914820  Vali macro F1 0.9856410 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 52 cost time: 1.3615071773529053
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0057795  Vali Loss: 0.0295529 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914820  Vali macro F1 0.9856410 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 53 cost time: 1.3637895584106445
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0054265  Vali Loss: 0.0296163 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914820  Vali macro F1 0.9856410 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 1.3540220260620117
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0058323  Vali Loss: 0.0296055 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914820  Vali macro F1 0.9856410 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 1.3513882160186768
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0056393  Vali Loss: 0.0295261 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914820  Vali macro F1 0.9856410 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 56 cost time: 1.348829984664917
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0061941  Vali Loss: 0.0295368 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914820  Vali macro F1 0.9856410 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 57 cost time: 1.3544726371765137
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0052412  Vali Loss: 0.0296536 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914820  Vali macro F1 0.9856410 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9909502  Test weighted F1: 0.9909615  Test macro F1 0.9881287 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1125747
pruned model Parameter : 1128786
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.5922060012817383
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0082192  Vali Loss: 0.0226847 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914820  Vali macro F1 0.9856410 
Validation loss decreased (inf --> 0.022685).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.590186595916748
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0076736  Vali Loss: 0.0304720 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914820  Vali macro F1 0.9856410 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.5910296440124512
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0057768  Vali Loss: 0.0303686 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9885971  Vali macro F1 0.9807780 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 1.5930635929107666
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0047374  Vali Loss: 0.0289964 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9885971  Vali macro F1 0.9807780 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 1.5912666320800781
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0049306  Vali Loss: 0.0254566 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914820  Vali macro F1 0.9856410 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 1.5856916904449463
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0047370  Vali Loss: 0.0227845 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914820  Vali macro F1 0.9856410 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 1.5904593467712402
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0056769  Vali Loss: 0.0277358 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857787  Vali macro F1 0.9784172 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 1.5916664600372314
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0042378  Vali Loss: 0.0237944 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914820  Vali macro F1 0.9856410 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 1.5929644107818604
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0046819  Vali Loss: 0.0244235 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914820  Vali macro F1 0.9856410 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 1.593292236328125
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0035446  Vali Loss: 0.0259291 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9885971  Vali macro F1 0.9807780 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 11 cost time: 1.5891852378845215
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0039513  Vali Loss: 0.0252022 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9885971  Vali macro F1 0.9807780 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 1.5903470516204834
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0034733  Vali Loss: 0.0247123 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9885971  Vali macro F1 0.9807780 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 1.5880780220031738
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0036561  Vali Loss: 0.0245316 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9885971  Vali macro F1 0.9807780 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 1.590735912322998
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0035320  Vali Loss: 0.0248009 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9885971  Vali macro F1 0.9807780 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 1.5915257930755615
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0034813  Vali Loss: 0.0249796 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9885971  Vali macro F1 0.9807780 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 16 cost time: 1.5911386013031006
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0038061  Vali Loss: 0.0249829 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9885971  Vali macro F1 0.9807780 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9920814  Test weighted F1: 0.9920836  Test macro F1 0.9913212 
================ the 3 th CV Experiment ================ 
Overlapping random Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00280899 0.00242718 0.00236967 0.00330033 0.00574713 0.00581395
 0.00315457 0.00280112 0.002331   0.00411523]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.3520240783691406
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.1412953  Vali Loss: 1.6107535 Vali Accuracy: 0.4152542  Vali weighted F1: 0.3762103  Vali macro F1 0.3534808 
Validation loss decreased (inf --> 1.610753).  Saving model ...
Epoch: 2 cost time: 1.3474488258361816
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.2420136  Vali Loss: 0.7948360 Vali Accuracy: 0.7118644  Vali weighted F1: 0.7014025  Vali macro F1 0.6715068 
new best score!!!!
Validation loss decreased (1.610753 --> 0.794836).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.3477697372436523
VALI: Epoch: 3, Steps: 13 | Train Loss: 0.7276963  Vali Loss: 0.4765350 Vali Accuracy: 0.8389831  Vali weighted F1: 0.8170356  Vali macro F1 0.7740791 
new best score!!!!
Validation loss decreased (0.794836 --> 0.476535).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.3476109504699707
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.4658684  Vali Loss: 0.3399040 Vali Accuracy: 0.8615819  Vali weighted F1: 0.8396264  Vali macro F1 0.7961727 
new best score!!!!
Validation loss decreased (0.476535 --> 0.339904).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.347482681274414
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.3262544  Vali Loss: 0.2882882 Vali Accuracy: 0.8926554  Vali weighted F1: 0.8704973  Vali macro F1 0.8230461 
new best score!!!!
Validation loss decreased (0.339904 --> 0.288288).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.346992015838623
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.2726468  Vali Loss: 0.2088623 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9207437  Vali macro F1 0.8865168 
new best score!!!!
Validation loss decreased (0.288288 --> 0.208862).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.3469007015228271
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.2051706  Vali Loss: 0.1761556 Vali Accuracy: 0.9180791  Vali weighted F1: 0.9169737  Vali macro F1 0.8842060 
new best score!!!!
Validation loss decreased (0.208862 --> 0.176156).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.3476674556732178
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.1732277  Vali Loss: 0.1535491 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9231826  Vali macro F1 0.8894382 
new best score!!!!
Validation loss decreased (0.176156 --> 0.153549).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.3469820022583008
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.1529567  Vali Loss: 0.1368050 Vali Accuracy: 0.9265537  Vali weighted F1: 0.9166898  Vali macro F1 0.8741270 
new best score!!!!
Validation loss decreased (0.153549 --> 0.136805).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.3454039096832275
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.1352714  Vali Loss: 0.1508681 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9082306  Vali macro F1 0.8599328 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 1.3533873558044434
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.1321204  Vali Loss: 0.1459788 Vali Accuracy: 0.9124294  Vali weighted F1: 0.8982309  Vali macro F1 0.8493710 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 12 cost time: 1.3450164794921875
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1232886  Vali Loss: 0.1416916 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9009415  Vali macro F1 0.8501102 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 13 cost time: 1.3620595932006836
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1210122  Vali Loss: 0.1460599 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9028393  Vali macro F1 0.8499411 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 14 cost time: 1.3470892906188965
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1305740  Vali Loss: 0.1054750 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9530044  Vali macro F1 0.9283945 
new best score!!!!
Validation loss decreased (0.136805 --> 0.105475).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.3477466106414795
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1166265  Vali Loss: 0.1100113 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9273125  Vali macro F1 0.8846569 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 1.3457491397857666
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1076113  Vali Loss: 0.1241800 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9101940  Vali macro F1 0.8694898 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 17 cost time: 1.3451664447784424
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0991749  Vali Loss: 0.1121994 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9355619  Vali macro F1 0.9078875 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 18 cost time: 1.3483693599700928
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0896295  Vali Loss: 0.1027733 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9480409  Vali macro F1 0.9239923 
new best score!!!!
Validation loss decreased (0.105475 --> 0.102773).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.3475117683410645
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0869158  Vali Loss: 0.0903541 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9518630  Vali macro F1 0.9260421 
new best score!!!!
Validation loss decreased (0.102773 --> 0.090354).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.3480596542358398
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0873705  Vali Loss: 0.1019963 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9371610  Vali macro F1 0.9108823 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 1.3473951816558838
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0818679  Vali Loss: 0.0991344 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9545368  Vali macro F1 0.9332825 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 1.3479082584381104
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0737572  Vali Loss: 0.0851483 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9630672  Vali macro F1 0.9538528 
new best score!!!!
Validation loss decreased (0.090354 --> 0.085148).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.3471953868865967
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0658907  Vali Loss: 0.0727528 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802421  Vali macro F1 0.9714761 
new best score!!!!
Validation loss decreased (0.085148 --> 0.072753).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.3499605655670166
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0592979  Vali Loss: 0.0727508 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9625208  Vali macro F1 0.9464770 
new best score!!!!
Validation loss decreased (0.072753 --> 0.072751).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.3477201461791992
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0638530  Vali Loss: 0.0838336 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9450872  Vali macro F1 0.9196558 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 1.3469066619873047
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0562313  Vali Loss: 0.0577989 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745892  Vali macro F1 0.9619469 
new best score!!!!
Validation loss decreased (0.072751 --> 0.057799).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.349717378616333
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0419973  Vali Loss: 0.0425673 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858950  Vali macro F1 0.9810053 
new best score!!!!
Validation loss decreased (0.057799 --> 0.042567).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 1.3486804962158203
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0354609  Vali Loss: 0.0374897 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801544  Vali macro F1 0.9763041 
new best score!!!!
Validation loss decreased (0.042567 --> 0.037490).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.347862720489502
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0357990  Vali Loss: 0.0373638 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943744  Vali macro F1 0.9952991 
new best score!!!!
Validation loss decreased (0.037490 --> 0.037364).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.3465137481689453
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0340804  Vali Loss: 0.0437079 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830267  Vali macro F1 0.9785585 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 1.3492469787597656
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0288860  Vali Loss: 0.0386662 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915447  Vali macro F1 0.9929175 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 1.348970890045166
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0312096  Vali Loss: 0.0636974 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859127  Vali macro F1 0.9857439 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 1.3484907150268555
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0289422  Vali Loss: 0.0429148 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887183  Vali macro F1 0.9881529 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 34 cost time: 1.348741054534912
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0261541  Vali Loss: 0.0608347 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802009  Vali macro F1 0.9785720 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 35 cost time: 1.347992181777954
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0248555  Vali Loss: 0.0485434 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830134  Vali macro F1 0.9813287 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 1.3468432426452637
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0169222  Vali Loss: 0.0358346 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858934  Vali macro F1 0.9860696 
new best score!!!!
Validation loss decreased (0.037364 --> 0.035835).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 1.3483235836029053
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0166514  Vali Loss: 0.0399059 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887454  Vali macro F1 0.9909484 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 1.3528263568878174
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0167249  Vali Loss: 0.0388974 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887454  Vali macro F1 0.9909484 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 1.3501269817352295
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0141813  Vali Loss: 0.0374120 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887199  Vali macro F1 0.9908342 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 40 cost time: 1.3483786582946777
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0138622  Vali Loss: 0.0384471 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887199  Vali macro F1 0.9908342 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 41 cost time: 1.3549110889434814
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0141340  Vali Loss: 0.0428367 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915447  Vali macro F1 0.9929175 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 42 cost time: 1.3483943939208984
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0119587  Vali Loss: 0.0424547 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915447  Vali macro F1 0.9929175 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 1.363745927810669
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0129273  Vali Loss: 0.0422012 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915447  Vali macro F1 0.9929175 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 1.3501057624816895
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0127841  Vali Loss: 0.0418764 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915447  Vali macro F1 0.9929175 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 1.347266674041748
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0129167  Vali Loss: 0.0418729 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915447  Vali macro F1 0.9929175 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 46 cost time: 1.348144292831421
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0113090  Vali Loss: 0.0419312 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915447  Vali macro F1 0.9929175 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 47 cost time: 1.3472933769226074
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0122541  Vali Loss: 0.0419439 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915447  Vali macro F1 0.9929175 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 1.3476243019104004
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0124558  Vali Loss: 0.0419099 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915447  Vali macro F1 0.9929175 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 1.3478763103485107
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0126997  Vali Loss: 0.0418965 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915447  Vali macro F1 0.9929175 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 50 cost time: 1.3494935035705566
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0128561  Vali Loss: 0.0418576 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915447  Vali macro F1 0.9929175 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 51 cost time: 1.3478975296020508
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0122879  Vali Loss: 0.0418185 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915447  Vali macro F1 0.9929175 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9864253  Test weighted F1: 0.9864384  Test macro F1 0.9842841 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1125747
pruned model Parameter : 1128786
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.5801057815551758
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0141463  Vali Loss: 0.0483756 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859189  Vali macro F1 0.9861838 
Validation loss decreased (inf --> 0.048376).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.5795178413391113
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0127878  Vali Loss: 0.0306835 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915009  Vali macro F1 0.9928603 
new best score!!!!
Validation loss decreased (0.048376 --> 0.030683).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 1.5794472694396973
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0159370  Vali Loss: 0.0436796 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887183  Vali macro F1 0.9881529 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 1.5842945575714111
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0111536  Vali Loss: 0.0384602 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915447  Vali macro F1 0.9929175 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 1.5816385746002197
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0105740  Vali Loss: 0.0377984 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887183  Vali macro F1 0.9881529 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 1.5833160877227783
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0118506  Vali Loss: 0.0328046 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915447  Vali macro F1 0.9929175 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 1.5795221328735352
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0097291  Vali Loss: 0.0362054 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915447  Vali macro F1 0.9929175 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 8 cost time: 1.5858385562896729
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0119948  Vali Loss: 0.0456548 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887183  Vali macro F1 0.9881529 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 1.5815753936767578
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0103655  Vali Loss: 0.0443145 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915447  Vali macro F1 0.9929175 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 1.5825965404510498
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0091171  Vali Loss: 0.0304832 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887454  Vali macro F1 0.9909484 
new best score!!!!
Validation loss decreased (0.030683 --> 0.030483).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 1.582627773284912
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0089562  Vali Loss: 0.0305931 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859189  Vali macro F1 0.9861838 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 1.5780808925628662
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0075133  Vali Loss: 0.0328847 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859189  Vali macro F1 0.9861838 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 1.582892656326294
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0095097  Vali Loss: 0.0298753 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859189  Vali macro F1 0.9861838 
new best score!!!!
Validation loss decreased (0.030483 --> 0.029875).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 14 cost time: 1.5851776599884033
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0078386  Vali Loss: 0.0264289 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887454  Vali macro F1 0.9909484 
new best score!!!!
Validation loss decreased (0.029875 --> 0.026429).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 15 cost time: 1.582507610321045
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0074637  Vali Loss: 0.0267103 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887183  Vali macro F1 0.9881529 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 1.5799295902252197
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0073753  Vali Loss: 0.0228686 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943744  Vali macro F1 0.9952991 
new best score!!!!
Validation loss decreased (0.026429 --> 0.022869).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 1.5796449184417725
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0074886  Vali Loss: 0.0360597 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858491  Vali macro F1 0.9853174 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 1.5831549167633057
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0082036  Vali Loss: 0.0310978 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886719  Vali macro F1 0.9903818 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 1.5829582214355469
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0074715  Vali Loss: 0.0287787 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887183  Vali macro F1 0.9881529 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 1.5779502391815186
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0059208  Vali Loss: 0.0285860 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887183  Vali macro F1 0.9881529 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 1.582664966583252
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0055576  Vali Loss: 0.0246366 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887183  Vali macro F1 0.9881529 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 22 cost time: 1.5815143585205078
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0060679  Vali Loss: 0.0244122 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887183  Vali macro F1 0.9881529 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 1.5782060623168945
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0059912  Vali Loss: 0.0249463 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887183  Vali macro F1 0.9881529 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 1.5774738788604736
Fine Tuning VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0071863  Vali Loss: 0.0255409 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887183  Vali macro F1 0.9881529 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 1.583317518234253
Fine Tuning VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0054963  Vali Loss: 0.0256472 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887183  Vali macro F1 0.9881529 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 1.5788447856903076
Fine Tuning VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0063276  Vali Loss: 0.0251209 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887183  Vali macro F1 0.9881529 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 27 cost time: 1.5813980102539062
Fine Tuning VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0052871  Vali Loss: 0.0251976 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887183  Vali macro F1 0.9881529 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 28 cost time: 1.5816638469696045
Fine Tuning VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0053562  Vali Loss: 0.0252266 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887183  Vali macro F1 0.9881529 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 29 cost time: 1.5803661346435547
Fine Tuning VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0053723  Vali Loss: 0.0252472 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887183  Vali macro F1 0.9881529 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 30 cost time: 1.5826225280761719
Fine Tuning VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0060702  Vali Loss: 0.0252640 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887183  Vali macro F1 0.9881529 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 31 cost time: 1.5805168151855469
Fine Tuning VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0053793  Vali Loss: 0.0252296 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887183  Vali macro F1 0.9881529 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9909502  Test weighted F1: 0.9909672  Test macro F1 0.9901604 
================ the 4 th CV Experiment ================ 
Overlapping random Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.00275482 0.00243902 0.00239808 0.00322581 0.00564972 0.00588235
 0.00319489 0.00285714 0.00235294 0.00404858]
Train data number :  3182
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  887
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.4083304405212402
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.1647035  Vali Loss: 1.6837937 Vali Accuracy: 0.4661017  Vali weighted F1: 0.4092843  Vali macro F1 0.3492663 
Validation loss decreased (inf --> 1.683794).  Saving model ...
Epoch: 2 cost time: 1.3523707389831543
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.2626879  Vali Loss: 0.7811767 Vali Accuracy: 0.7457627  Vali weighted F1: 0.7439136  Vali macro F1 0.6856114 
new best score!!!!
Validation loss decreased (1.683794 --> 0.781177).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.3498716354370117
VALI: Epoch: 3, Steps: 13 | Train Loss: 0.7329294  Vali Loss: 0.4531423 Vali Accuracy: 0.9124294  Vali weighted F1: 0.8990132  Vali macro F1 0.8294939 
new best score!!!!
Validation loss decreased (0.781177 --> 0.453142).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.3485877513885498
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.4725500  Vali Loss: 0.3051781 Vali Accuracy: 0.9039548  Vali weighted F1: 0.8914483  Vali macro F1 0.8299555 
new best score!!!!
Validation loss decreased (0.453142 --> 0.305178).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.3478939533233643
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.3445845  Vali Loss: 0.2365626 Vali Accuracy: 0.8954802  Vali weighted F1: 0.8829909  Vali macro F1 0.8225167 
new best score!!!!
Validation loss decreased (0.305178 --> 0.236563).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.3457958698272705
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.2677347  Vali Loss: 0.1715755 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9371674  Vali macro F1 0.8826234 
new best score!!!!
Validation loss decreased (0.236563 --> 0.171575).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.3470799922943115
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.2073793  Vali Loss: 0.1397418 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9441428  Vali macro F1 0.8879055 
new best score!!!!
Validation loss decreased (0.171575 --> 0.139742).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.3466815948486328
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.1679774  Vali Loss: 0.1262807 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9329366  Vali macro F1 0.8691444 
new best score!!!!
Validation loss decreased (0.139742 --> 0.126281).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.347104787826538
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.1518436  Vali Loss: 0.1100931 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9339565  Vali macro F1 0.8739070 
new best score!!!!
Validation loss decreased (0.126281 --> 0.110093).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.349639654159546
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.1366100  Vali Loss: 0.1020470 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9471513  Vali macro F1 0.8938142 
new best score!!!!
Validation loss decreased (0.110093 --> 0.102047).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.346658706665039
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.1252332  Vali Loss: 0.0956697 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9389942  Vali macro F1 0.8825849 
new best score!!!!
Validation loss decreased (0.102047 --> 0.095670).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.3473522663116455
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1128416  Vali Loss: 0.0836768 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9525209  Vali macro F1 0.9037387 
new best score!!!!
Validation loss decreased (0.095670 --> 0.083677).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.3482182025909424
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1010713  Vali Loss: 0.0897128 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9275442  Vali macro F1 0.8656537 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 1.3452568054199219
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1071412  Vali Loss: 0.1058015 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9305740  Vali macro F1 0.8588177 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 15 cost time: 1.3461980819702148
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1231491  Vali Loss: 0.0963128 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9548239  Vali macro F1 0.9194416 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 16 cost time: 1.3508517742156982
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1009020  Vali Loss: 0.0758968 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9635306  Vali macro F1 0.9250539 
new best score!!!!
Validation loss decreased (0.083677 --> 0.075897).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.3471949100494385
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0879547  Vali Loss: 0.0786621 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9601570  Vali macro F1 0.9229150 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 1.3454318046569824
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0776776  Vali Loss: 0.0732365 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9473100  Vali macro F1 0.8709249 
new best score!!!!
Validation loss decreased (0.075897 --> 0.073236).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.3465006351470947
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0831975  Vali Loss: 0.0634992 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9750055  Vali macro F1 0.9482239 
new best score!!!!
Validation loss decreased (0.073236 --> 0.063499).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.3485536575317383
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0705958  Vali Loss: 0.0607404 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9686780  Vali macro F1 0.9346840 
new best score!!!!
Validation loss decreased (0.063499 --> 0.060740).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.347712516784668
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0678795  Vali Loss: 0.0533889 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9777742  Vali macro F1 0.9547912 
new best score!!!!
Validation loss decreased (0.060740 --> 0.053389).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.3471927642822266
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0718970  Vali Loss: 0.0597410 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9693211  Vali macro F1 0.9427686 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 1.3483145236968994
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0642770  Vali Loss: 0.0479800 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9805491  Vali macro F1 0.9606300 
new best score!!!!
Validation loss decreased (0.053389 --> 0.047980).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.3501551151275635
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0546294  Vali Loss: 0.0841911 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9654761  Vali macro F1 0.9309356 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 1.34830641746521
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0527614  Vali Loss: 0.0459669 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9804586  Vali macro F1 0.9597711 
new best score!!!!
Validation loss decreased (0.047980 --> 0.045967).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.3481581211090088
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0414316  Vali Loss: 0.0393964 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9777218  Vali macro F1 0.9577216 
new best score!!!!
Validation loss decreased (0.045967 --> 0.039396).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.3491718769073486
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0341837  Vali Loss: 0.0368095 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9804565  Vali macro F1 0.9638796 
new best score!!!!
Validation loss decreased (0.039396 --> 0.036809).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 1.3487284183502197
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0309970  Vali Loss: 0.0352196 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9796870  Vali macro F1 0.9598031 
new best score!!!!
Validation loss decreased (0.036809 --> 0.035220).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.3505282402038574
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0329359  Vali Loss: 0.0367118 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9861171  Vali macro F1 0.9686610 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 1.349557876586914
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0348866  Vali Loss: 0.0294457 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887073  Vali macro F1 0.9815194 
new best score!!!!
Validation loss decreased (0.035220 --> 0.029446).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 1.3504586219787598
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0272461  Vali Loss: 0.0230906 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915299  Vali macro F1 0.9847528 
new best score!!!!
Validation loss decreased (0.029446 --> 0.023091).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 1.3502874374389648
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0223776  Vali Loss: 0.0234346 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915299  Vali macro F1 0.9847528 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 1.3484010696411133
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0172516  Vali Loss: 0.0232824 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915299  Vali macro F1 0.9847528 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 1.3491568565368652
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0142098  Vali Loss: 0.0218647 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886896  Vali macro F1 0.9821234 
new best score!!!!
Validation loss decreased (0.023091 --> 0.021865).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.3483846187591553
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0164922  Vali Loss: 0.0380160 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858816  Vali macro F1 0.9796478 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 1.3481574058532715
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0287596  Vali Loss: 0.0504302 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9748248  Vali macro F1 0.9697760 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 1.349830150604248
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0294453  Vali Loss: 0.0227819 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 1.348344326019287
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0313415  Vali Loss: 0.0210240 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915299  Vali macro F1 0.9847528 
new best score!!!!
Validation loss decreased (0.021865 --> 0.021024).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 1.351883888244629
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0224751  Vali Loss: 0.0222853 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9883822  Vali macro F1 0.9768956 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 1.3503243923187256
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0252739  Vali Loss: 0.0159710 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
new best score!!!!
Validation loss decreased (0.021024 --> 0.015971).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 1.3489665985107422
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0223869  Vali Loss: 0.0175456 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 1.356703758239746
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0172114  Vali Loss: 0.0331527 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914974  Vali macro F1 0.9889568 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 1.3497111797332764
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0133070  Vali Loss: 0.0235257 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914859  Vali macro F1 0.9885453 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 1.3655242919921875
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0097991  Vali Loss: 0.0221354 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887027  Vali macro F1 0.9818444 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 45 cost time: 1.3490748405456543
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0105613  Vali Loss: 0.0169470 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 46 cost time: 1.3498218059539795
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0074471  Vali Loss: 0.0172501 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915299  Vali macro F1 0.9847528 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 1.3504958152770996
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0079155  Vali Loss: 0.0164717 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 48 cost time: 1.3490238189697266
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0090316  Vali Loss: 0.0159308 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
new best score!!!!
Validation loss decreased (0.015971 --> 0.015931).  Saving model ...
new best score!!!!
Epoch: 49 cost time: 1.3482518196105957
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0073549  Vali Loss: 0.0155449 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
new best score!!!!
Validation loss decreased (0.015931 --> 0.015545).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 1.349841833114624
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0065712  Vali Loss: 0.0154051 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
new best score!!!!
Validation loss decreased (0.015545 --> 0.015405).  Saving model ...
new best score!!!!
Epoch: 51 cost time: 1.3518776893615723
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0067332  Vali Loss: 0.0156249 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 1.3496675491333008
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0067756  Vali Loss: 0.0159754 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 53 cost time: 1.3483772277832031
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0064872  Vali Loss: 0.0162867 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 54 cost time: 1.3496103286743164
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0067066  Vali Loss: 0.0166809 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 55 cost time: 1.3486900329589844
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0069847  Vali Loss: 0.0169930 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 56 cost time: 1.34830641746521
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0065166  Vali Loss: 0.0169892 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 57 cost time: 1.34855318069458
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0060822  Vali Loss: 0.0170008 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 58 cost time: 1.3504693508148193
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0065270  Vali Loss: 0.0170069 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 59 cost time: 1.3503422737121582
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0057264  Vali Loss: 0.0169833 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 60 cost time: 1.3510618209838867
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0060172  Vali Loss: 0.0169731 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 61 cost time: 1.348308801651001
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0072502  Vali Loss: 0.0169718 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 62 cost time: 1.3493587970733643
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0060051  Vali Loss: 0.0169753 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 63 cost time: 1.3488378524780273
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0068883  Vali Loss: 0.0169737 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 64 cost time: 1.348738431930542
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0062966  Vali Loss: 0.0169767 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 65 cost time: 1.347627878189087
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0063516  Vali Loss: 0.0169766 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9932356  Test weighted F1: 0.9932333  Test macro F1 0.9927030 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1125747
pruned model Parameter : 1128786
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.5998234748840332
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0086398  Vali Loss: 0.0151939 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
Validation loss decreased (inf --> 0.015194).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.5993099212646484
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0066934  Vali Loss: 0.0156220 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.5938694477081299
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0067313  Vali Loss: 0.0145613 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
new best score!!!!
Validation loss decreased (0.015194 --> 0.014561).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 1.5979549884796143
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0056074  Vali Loss: 0.0161462 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915299  Vali macro F1 0.9847528 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 1.599452018737793
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0058318  Vali Loss: 0.0152701 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 1.5985298156738281
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0053590  Vali Loss: 0.0154243 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 1.5986428260803223
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0052024  Vali Loss: 0.0156594 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 8 cost time: 1.5990896224975586
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0046823  Vali Loss: 0.0157286 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 9 cost time: 1.5976696014404297
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0045796  Vali Loss: 0.0154405 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 1.6000251770019531
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0048178  Vali Loss: 0.0152345 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 1.5981838703155518
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0046150  Vali Loss: 0.0161982 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 1.598069429397583
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0043149  Vali Loss: 0.0156738 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 1.5972745418548584
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0037760  Vali Loss: 0.0156150 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 14 cost time: 1.5997936725616455
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0044687  Vali Loss: 0.0155933 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 1.600243330001831
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0040158  Vali Loss: 0.0156336 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 1.5975914001464844
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0044240  Vali Loss: 0.0156419 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 1.5985808372497559
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0041794  Vali Loss: 0.0155685 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 1.5995433330535889
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0038798  Vali Loss: 0.0155017 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943262  Vali macro F1 0.9911746 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9943630  Test weighted F1: 0.9943607  Test macro F1 0.9935942 
Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 1125747
Set the seed as :  2
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
================ SOCV Mode ====================
================ 5 CV ======================
================ the 0 th CV Experiment ================ 
Overlapping random Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.002849   0.00238663 0.00242718 0.00324675 0.00552486 0.00552486
 0.00308642 0.00288184 0.00236407 0.0041841 ]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.4026508331298828
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.1103011  Vali Loss: 1.4966432 Vali Accuracy: 0.4322034  Vali weighted F1: 0.4185445  Vali macro F1 0.3857132 
Validation loss decreased (inf --> 1.496643).  Saving model ...
Epoch: 2 cost time: 1.3482592105865479
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.1725710  Vali Loss: 0.7497520 Vali Accuracy: 0.7005650  Vali weighted F1: 0.6698697  Vali macro F1 0.6299497 
new best score!!!!
Validation loss decreased (1.496643 --> 0.749752).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.347343921661377
VALI: Epoch: 3, Steps: 13 | Train Loss: 0.7038758  Vali Loss: 0.4351500 Vali Accuracy: 0.8361582  Vali weighted F1: 0.8278795  Vali macro F1 0.7801326 
new best score!!!!
Validation loss decreased (0.749752 --> 0.435150).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.347240686416626
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.4656483  Vali Loss: 0.3037609 Vali Accuracy: 0.8728814  Vali weighted F1: 0.8727771  Vali macro F1 0.8485085 
new best score!!!!
Validation loss decreased (0.435150 --> 0.303761).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.347520112991333
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.3364469  Vali Loss: 0.2268408 Vali Accuracy: 0.9096045  Vali weighted F1: 0.9101831  Vali macro F1 0.8636317 
new best score!!!!
Validation loss decreased (0.303761 --> 0.226841).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.3483128547668457
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.2614754  Vali Loss: 0.1740826 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9492373  Vali macro F1 0.9192903 
new best score!!!!
Validation loss decreased (0.226841 --> 0.174083).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.3458433151245117
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.2171028  Vali Loss: 0.1601354 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9371176  Vali macro F1 0.8936096 
new best score!!!!
Validation loss decreased (0.174083 --> 0.160135).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.3469445705413818
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.1879787  Vali Loss: 0.1243527 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9484917  Vali macro F1 0.9013240 
new best score!!!!
Validation loss decreased (0.160135 --> 0.124353).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.3483266830444336
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.1655866  Vali Loss: 0.1192284 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9241969  Vali macro F1 0.8559922 
new best score!!!!
Validation loss decreased (0.124353 --> 0.119228).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.3503589630126953
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.1481052  Vali Loss: 0.0994482 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9395114  Vali macro F1 0.8896428 
new best score!!!!
Validation loss decreased (0.119228 --> 0.099448).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.349370002746582
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.1277810  Vali Loss: 0.1081732 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9521329  Vali macro F1 0.9115407 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 1.3534061908721924
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1227870  Vali Loss: 0.0947044 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9466891  Vali macro F1 0.9001291 
new best score!!!!
Validation loss decreased (0.099448 --> 0.094704).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.350351333618164
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1091226  Vali Loss: 0.0854124 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9564741  Vali macro F1 0.9207798 
new best score!!!!
Validation loss decreased (0.094704 --> 0.085412).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.3661582469940186
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0921207  Vali Loss: 0.0680004 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9742272  Vali macro F1 0.9506653 
new best score!!!!
Validation loss decreased (0.085412 --> 0.068000).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.347276210784912
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0816873  Vali Loss: 0.0605591 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746514  Vali macro F1 0.9532216 
new best score!!!!
Validation loss decreased (0.068000 --> 0.060559).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.3503227233886719
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0766619  Vali Loss: 0.0601917 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9714323  Vali macro F1 0.9477532 
new best score!!!!
Validation loss decreased (0.060559 --> 0.060192).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.3477559089660645
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0664884  Vali Loss: 0.0933888 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9549473  Vali macro F1 0.9269664 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 1.3474781513214111
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0595084  Vali Loss: 0.0377390 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9884912  Vali macro F1 0.9783692 
new best score!!!!
Validation loss decreased (0.060192 --> 0.037739).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.3484129905700684
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0641131  Vali Loss: 0.0400077 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887644  Vali macro F1 0.9798734 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 1.3465986251831055
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0512804  Vali Loss: 0.0351844 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9885991  Vali macro F1 0.9815743 
new best score!!!!
Validation loss decreased (0.037739 --> 0.035184).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.3497951030731201
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0429080  Vali Loss: 0.0228137 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915227  Vali macro F1 0.9855161 
new best score!!!!
Validation loss decreased (0.035184 --> 0.022814).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.3510711193084717
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0361698  Vali Loss: 0.0334276 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9885991  Vali macro F1 0.9815743 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 1.3524847030639648
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0333835  Vali Loss: 0.0216625 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915624  Vali macro F1 0.9857291 
new best score!!!!
Validation loss decreased (0.022814 --> 0.021662).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.3554003238677979
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0297573  Vali Loss: 0.0249822 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886489  Vali macro F1 0.9792383 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 1.3601486682891846
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0261629  Vali Loss: 0.0202816 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943343  Vali macro F1 0.9915238 
new best score!!!!
Validation loss decreased (0.021662 --> 0.020282).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.3649544715881348
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0231008  Vali Loss: 0.0166746 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914400  Vali macro F1 0.9852047 
new best score!!!!
Validation loss decreased (0.020282 --> 0.016675).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.352684497833252
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0215481  Vali Loss: 0.0197681 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943343  Vali macro F1 0.9915238 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 1.3514151573181152
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0202651  Vali Loss: 0.0159458 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915227  Vali macro F1 0.9855161 
new best score!!!!
Validation loss decreased (0.016675 --> 0.015946).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.3502709865570068
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0186115  Vali Loss: 0.0128390 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9942675  Vali macro F1 0.9875458 
new best score!!!!
Validation loss decreased (0.015946 --> 0.012839).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.3503084182739258
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0203825  Vali Loss: 0.0203222 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915559  Vali macro F1 0.9881117 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 1.3521196842193604
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0210537  Vali Loss: 0.0177136 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943359  Vali macro F1 0.9912032 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 1.3503916263580322
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0193282  Vali Loss: 0.0151165 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943899  Vali macro F1 0.9880702 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 1.350888967514038
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0152501  Vali Loss: 0.0158394 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 34 cost time: 1.3490231037139893
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0181018  Vali Loss: 0.0128781 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 35 cost time: 1.3508098125457764
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0121745  Vali Loss: 0.0093648 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
new best score!!!!
Validation loss decreased (0.012839 --> 0.009365).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 1.351538896560669
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0100164  Vali Loss: 0.0077333 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
new best score!!!!
Validation loss decreased (0.009365 --> 0.007733).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 1.3487327098846436
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0086803  Vali Loss: 0.0076511 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
new best score!!!!
Validation loss decreased (0.007733 --> 0.007651).  Saving model ...
new best score!!!!
Epoch: 38 cost time: 1.3517537117004395
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0078474  Vali Loss: 0.0083794 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 1.3519675731658936
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0087641  Vali Loss: 0.0085817 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971876  Vali macro F1 0.9939876 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 1.3547561168670654
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0084627  Vali Loss: 0.0074700 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
new best score!!!!
Validation loss decreased (0.007651 --> 0.007470).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 1.3495266437530518
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0074921  Vali Loss: 0.0077578 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 1.3651506900787354
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0076324  Vali Loss: 0.0085516 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971876  Vali macro F1 0.9939876 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 1.3542089462280273
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0086471  Vali Loss: 0.0077309 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 1.3519318103790283
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0073258  Vali Loss: 0.0080835 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971876  Vali macro F1 0.9939876 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 45 cost time: 1.3498241901397705
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0076128  Vali Loss: 0.0085893 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971876  Vali macro F1 0.9939876 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 46 cost time: 1.3514378070831299
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0072109  Vali Loss: 0.0083041 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971876  Vali macro F1 0.9939876 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 1.350010871887207
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0070810  Vali Loss: 0.0081504 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971876  Vali macro F1 0.9939876 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 48 cost time: 1.3501667976379395
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0068559  Vali Loss: 0.0078668 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971876  Vali macro F1 0.9939876 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 49 cost time: 1.3534457683563232
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0068855  Vali Loss: 0.0078108 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971876  Vali macro F1 0.9939876 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 50 cost time: 1.3525516986846924
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0063704  Vali Loss: 0.0077442 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971876  Vali macro F1 0.9939876 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 51 cost time: 1.3507745265960693
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0075339  Vali Loss: 0.0077509 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971876  Vali macro F1 0.9939876 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 1.352421760559082
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0066081  Vali Loss: 0.0077525 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971876  Vali macro F1 0.9939876 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 53 cost time: 1.3508734703063965
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0068329  Vali Loss: 0.0077610 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971876  Vali macro F1 0.9939876 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 54 cost time: 1.3515172004699707
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0065404  Vali Loss: 0.0077530 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971876  Vali macro F1 0.9939876 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 55 cost time: 1.350240707397461
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0063113  Vali Loss: 0.0077490 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971876  Vali macro F1 0.9939876 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9920814  Test weighted F1: 0.9920810  Test macro F1 0.9924986 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1125747
pruned model Parameter : 1128786
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.5889930725097656
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0089584  Vali Loss: 0.0075865 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971876  Vali macro F1 0.9939876 
Validation loss decreased (inf --> 0.007586).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.5869786739349365
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0077054  Vali Loss: 0.0099269 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943343  Vali macro F1 0.9915238 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.5892794132232666
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0072351  Vali Loss: 0.0093043 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943647  Vali macro F1 0.9916542 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 1.5888006687164307
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0061729  Vali Loss: 0.0081370 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943647  Vali macro F1 0.9916542 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 1.5885298252105713
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0065398  Vali Loss: 0.0073274 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943343  Vali macro F1 0.9915238 
new best score!!!!
Validation loss decreased (0.007586 --> 0.007327).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 1.587836503982544
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0053884  Vali Loss: 0.0134927 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915379  Vali macro F1 0.9893137 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 1.5879580974578857
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0065026  Vali Loss: 0.0079319 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915273  Vali macro F1 0.9855237 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 1.5821783542633057
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0047537  Vali Loss: 0.0115808 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943647  Vali macro F1 0.9916542 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 1.5870261192321777
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0069688  Vali Loss: 0.0074486 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943343  Vali macro F1 0.9915238 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 1.585218906402588
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0048781  Vali Loss: 0.0070085 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971876  Vali macro F1 0.9939876 
new best score!!!!
Validation loss decreased (0.007327 --> 0.007009).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 1.58903169631958
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0052549  Vali Loss: 0.0121949 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943647  Vali macro F1 0.9916542 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 1.58772873878479
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0058408  Vali Loss: 0.0057441 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
new best score!!!!
Validation loss decreased (0.007009 --> 0.005744).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 1.588649034500122
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0047112  Vali Loss: 0.0077946 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971876  Vali macro F1 0.9939876 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 1.5894956588745117
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0040369  Vali Loss: 0.0059797 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971876  Vali macro F1 0.9939876 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 1.5901739597320557
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0051098  Vali Loss: 0.0084738 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971876  Vali macro F1 0.9939876 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 1.585249662399292
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0054326  Vali Loss: 0.0077134 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 1.5888209342956543
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0045059  Vali Loss: 0.0095379 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971876  Vali macro F1 0.9939876 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 18 cost time: 1.5891075134277344
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0045362  Vali Loss: 0.0055412 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
new best score!!!!
Validation loss decreased (0.005744 --> 0.005541).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 1.59016752243042
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0041613  Vali Loss: 0.0111059 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943647  Vali macro F1 0.9916542 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 20 cost time: 1.5882761478424072
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0035646  Vali Loss: 0.0084602 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943647  Vali macro F1 0.9916542 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 21 cost time: 1.5888140201568604
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0033962  Vali Loss: 0.0081369 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943647  Vali macro F1 0.9916542 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 22 cost time: 1.588270664215088
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0035153  Vali Loss: 0.0112645 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943647  Vali macro F1 0.9916542 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 23 cost time: 1.586500883102417
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0047525  Vali Loss: 0.0066332 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 24 cost time: 1.586345911026001
Fine Tuning VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0032188  Vali Loss: 0.0056046 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971573  Vali macro F1 0.9938573 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 25 cost time: 1.586721658706665
Fine Tuning VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0034389  Vali Loss: 0.0061814 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943647  Vali macro F1 0.9916542 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 26 cost time: 1.587815761566162
Fine Tuning VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0033737  Vali Loss: 0.0079262 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943647  Vali macro F1 0.9916542 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 27 cost time: 1.5858492851257324
Fine Tuning VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0032123  Vali Loss: 0.0092694 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943647  Vali macro F1 0.9916542 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 28 cost time: 1.5860569477081299
Fine Tuning VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0027762  Vali Loss: 0.0094300 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943647  Vali macro F1 0.9916542 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 29 cost time: 1.5858469009399414
Fine Tuning VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0026439  Vali Loss: 0.0094383 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943647  Vali macro F1 0.9916542 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 30 cost time: 1.5900545120239258
Fine Tuning VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0027308  Vali Loss: 0.0094603 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943647  Vali macro F1 0.9916542 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 31 cost time: 1.587766408920288
Fine Tuning VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0032656  Vali Loss: 0.0094643 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943647  Vali macro F1 0.9916542 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 32 cost time: 1.5848028659820557
Fine Tuning VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0031092  Vali Loss: 0.0094437 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943647  Vali macro F1 0.9916542 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 33 cost time: 1.5899455547332764
Fine Tuning VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0029560  Vali Loss: 0.0094538 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943647  Vali macro F1 0.9916542 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9932127  Test weighted F1: 0.9932134  Test macro F1 0.9945335 
================ the 1 th CV Experiment ================ 
Overlapping random Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00271739 0.002331   0.00242131 0.00326797 0.00595238 0.00578035
 0.00303951 0.00301205 0.00238095 0.00404858]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.3564119338989258
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.1174994  Vali Loss: 1.4891586 Vali Accuracy: 0.4378531  Vali weighted F1: 0.4255931  Vali macro F1 0.3947415 
Validation loss decreased (inf --> 1.489159).  Saving model ...
Epoch: 2 cost time: 1.3526599407196045
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.1816938  Vali Loss: 0.7626724 Vali Accuracy: 0.7231638  Vali weighted F1: 0.7046962  Vali macro F1 0.6912365 
new best score!!!!
Validation loss decreased (1.489159 --> 0.762672).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.3634464740753174
VALI: Epoch: 3, Steps: 13 | Train Loss: 0.7239980  Vali Loss: 0.4863245 Vali Accuracy: 0.7966102  Vali weighted F1: 0.7727746  Vali macro F1 0.7262359 
new best score!!!!
Validation loss decreased (0.762672 --> 0.486325).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.3495161533355713
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.4930849  Vali Loss: 0.3233856 Vali Accuracy: 0.8926554  Vali weighted F1: 0.8796296  Vali macro F1 0.8237080 
new best score!!!!
Validation loss decreased (0.486325 --> 0.323386).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.3495659828186035
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.3543760  Vali Loss: 0.2279605 Vali Accuracy: 0.9180791  Vali weighted F1: 0.9171844  Vali macro F1 0.8701579 
new best score!!!!
Validation loss decreased (0.323386 --> 0.227960).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.3498284816741943
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.2728691  Vali Loss: 0.1999556 Vali Accuracy: 0.9124294  Vali weighted F1: 0.8990739  Vali macro F1 0.8393636 
new best score!!!!
Validation loss decreased (0.227960 --> 0.199956).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.348616361618042
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.2220122  Vali Loss: 0.1565117 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9292858  Vali macro F1 0.8763914 
new best score!!!!
Validation loss decreased (0.199956 --> 0.156512).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.347822666168213
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.1823053  Vali Loss: 0.1254460 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9489837  Vali macro F1 0.9104695 
new best score!!!!
Validation loss decreased (0.156512 --> 0.125446).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.3504045009613037
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.1538658  Vali Loss: 0.1200542 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9244134  Vali macro F1 0.8620750 
new best score!!!!
Validation loss decreased (0.125446 --> 0.120054).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.3476722240447998
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.1421775  Vali Loss: 0.1088916 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9656599  Vali macro F1 0.9387783 
new best score!!!!
Validation loss decreased (0.120054 --> 0.108892).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.3479070663452148
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.1263630  Vali Loss: 0.0957933 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9494829  Vali macro F1 0.9027828 
new best score!!!!
Validation loss decreased (0.108892 --> 0.095793).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.3516263961791992
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1268669  Vali Loss: 0.0960464 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9466020  Vali macro F1 0.9049635 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 1.347475290298462
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1078946  Vali Loss: 0.0941128 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9474419  Vali macro F1 0.9149380 
new best score!!!!
Validation loss decreased (0.095793 --> 0.094113).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.3489725589752197
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0962911  Vali Loss: 0.0736790 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9596869  Vali macro F1 0.9234195 
new best score!!!!
Validation loss decreased (0.094113 --> 0.073679).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.3507437705993652
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0920285  Vali Loss: 0.0792984 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9621970  Vali macro F1 0.9380409 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 1.349259376525879
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0803432  Vali Loss: 0.0665737 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9686184  Vali macro F1 0.9457774 
new best score!!!!
Validation loss decreased (0.073679 --> 0.066574).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.35115647315979
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0670428  Vali Loss: 0.0548676 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9715921  Vali macro F1 0.9527023 
new best score!!!!
Validation loss decreased (0.066574 --> 0.054868).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.3491604328155518
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0633793  Vali Loss: 0.0447583 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9772716  Vali macro F1 0.9684911 
new best score!!!!
Validation loss decreased (0.054868 --> 0.044758).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.3508048057556152
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0634323  Vali Loss: 0.0401584 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857416  Vali macro F1 0.9757201 
new best score!!!!
Validation loss decreased (0.044758 --> 0.040158).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.3490126132965088
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0453995  Vali Loss: 0.0454435 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801821  Vali macro F1 0.9742465 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 1.3514103889465332
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0374339  Vali Loss: 0.0364232 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886634  Vali macro F1 0.9855471 
new best score!!!!
Validation loss decreased (0.040158 --> 0.036423).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.352189540863037
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0327430  Vali Loss: 0.0429419 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745623  Vali macro F1 0.9573315 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 1.349069595336914
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0409512  Vali Loss: 0.0615947 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745383  Vali macro F1 0.9669448 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 1.3478724956512451
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0441604  Vali Loss: 0.0361221 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859133  Vali macro F1 0.9843125 
new best score!!!!
Validation loss decreased (0.036423 --> 0.036122).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.3502235412597656
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0491248  Vali Loss: 0.0319482 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886634  Vali macro F1 0.9855471 
new best score!!!!
Validation loss decreased (0.036122 --> 0.031948).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.351896047592163
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0355710  Vali Loss: 0.0170915 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915283  Vali macro F1 0.9852439 
new best score!!!!
Validation loss decreased (0.031948 --> 0.017091).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.3507466316223145
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0310654  Vali Loss: 0.0236803 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830405  Vali macro F1 0.9775891 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 1.350792646408081
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0267225  Vali Loss: 0.0356400 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801621  Vali macro F1 0.9713037 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 1.3516554832458496
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0466896  Vali Loss: 0.0573122 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9747282  Vali macro F1 0.9665303 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 1.3569300174713135
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0416853  Vali Loss: 0.0284736 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859059  Vali macro F1 0.9807651 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 31 cost time: 1.349865198135376
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0333095  Vali Loss: 0.0165801 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
new best score!!!!
Validation loss decreased (0.017091 --> 0.016580).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 1.3705415725708008
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0217045  Vali Loss: 0.0204095 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886938  Vali macro F1 0.9866097 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 1.3499600887298584
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0203826  Vali Loss: 0.0253557 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829148  Vali macro F1 0.9733797 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 1.3505475521087646
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0177647  Vali Loss: 0.0159412 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887279  Vali macro F1 0.9833784 
new best score!!!!
Validation loss decreased (0.016580 --> 0.015941).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.3498008251190186
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0141255  Vali Loss: 0.0131152 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943899  Vali macro F1 0.9880702 
new best score!!!!
Validation loss decreased (0.015941 --> 0.013115).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 1.3514206409454346
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0174520  Vali Loss: 0.0176636 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943601  Vali macro F1 0.9916465 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 1.3500146865844727
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0152254  Vali Loss: 0.0153102 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915381  Vali macro F1 0.9890333 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 1.349076747894287
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0109198  Vali Loss: 0.0146870 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943601  Vali macro F1 0.9916465 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 1.3502962589263916
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0105972  Vali Loss: 0.0131279 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915381  Vali macro F1 0.9890333 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 40 cost time: 1.3521687984466553
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0103687  Vali Loss: 0.0081134 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943601  Vali macro F1 0.9916465 
new best score!!!!
Validation loss decreased (0.013115 --> 0.008113).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 1.3512790203094482
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0145856  Vali Loss: 0.0110525 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 1.3534748554229736
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0141768  Vali Loss: 0.0128011 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943601  Vali macro F1 0.9916465 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 1.3498725891113281
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0135565  Vali Loss: 0.0163023 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859154  Vali macro F1 0.9804977 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 1.3513503074645996
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0169363  Vali Loss: 0.0133798 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915169  Vali macro F1 0.9879124 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 45 cost time: 1.351600170135498
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0119184  Vali Loss: 0.0226499 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915352  Vali macro F1 0.9887480 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 46 cost time: 1.3520832061767578
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0100684  Vali Loss: 0.0150101 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943601  Vali macro F1 0.9916465 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 1.3521051406860352
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0083276  Vali Loss: 0.0142129 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915379  Vali macro F1 0.9893137 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 48 cost time: 1.3519673347473145
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0074567  Vali Loss: 0.0136501 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943647  Vali macro F1 0.9916542 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 49 cost time: 1.3528366088867188
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0081179  Vali Loss: 0.0138236 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915743  Vali macro F1 0.9892449 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 50 cost time: 1.3502671718597412
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0073053  Vali Loss: 0.0134546 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915743  Vali macro F1 0.9892449 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 51 cost time: 1.3496339321136475
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0065281  Vali Loss: 0.0134411 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915743  Vali macro F1 0.9892449 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 52 cost time: 1.3509798049926758
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0069380  Vali Loss: 0.0133896 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915743  Vali macro F1 0.9892449 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 53 cost time: 1.3497607707977295
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0075350  Vali Loss: 0.0133576 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915743  Vali macro F1 0.9892449 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 54 cost time: 1.3498950004577637
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0071419  Vali Loss: 0.0133212 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915743  Vali macro F1 0.9892449 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 55 cost time: 1.3499133586883545
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0061878  Vali Loss: 0.0133529 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915743  Vali macro F1 0.9892449 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9954751  Test weighted F1: 0.9954744  Test macro F1 0.9947330 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1125747
pruned model Parameter : 1128786
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.58211088180542
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0095751  Vali Loss: 0.0104945 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971876  Vali macro F1 0.9939876 
Validation loss decreased (inf --> 0.010495).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.5803494453430176
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0092175  Vali Loss: 0.0091573 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
new best score!!!!
Validation loss decreased (0.010495 --> 0.009157).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 1.5769603252410889
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0081937  Vali Loss: 0.0096912 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971876  Vali macro F1 0.9939876 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 1.5810742378234863
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0090269  Vali Loss: 0.0101997 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 1.5775566101074219
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0074440  Vali Loss: 0.0107902 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943601  Vali macro F1 0.9916465 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 1.5759341716766357
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0070096  Vali Loss: 0.0095182 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943601  Vali macro F1 0.9916465 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 1.579127550125122
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0068063  Vali Loss: 0.0100816 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943601  Vali macro F1 0.9916465 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 8 cost time: 1.5803921222686768
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0057870  Vali Loss: 0.0117763 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943601  Vali macro F1 0.9916465 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 1.5758850574493408
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0073816  Vali Loss: 0.0103087 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943601  Vali macro F1 0.9916465 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 1.578300952911377
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0061470  Vali Loss: 0.0123320 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915381  Vali macro F1 0.9890333 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 1.5773611068725586
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0065956  Vali Loss: 0.0142017 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887007  Vali macro F1 0.9829028 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 1.5815715789794922
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0049294  Vali Loss: 0.0126885 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943601  Vali macro F1 0.9916465 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 13 cost time: 1.5763325691223145
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0060003  Vali Loss: 0.0119750 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943601  Vali macro F1 0.9916465 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 1.5766935348510742
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0050256  Vali Loss: 0.0114758 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943601  Vali macro F1 0.9916465 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 1.5770418643951416
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0050176  Vali Loss: 0.0112444 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943601  Vali macro F1 0.9916465 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 1.575324535369873
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0050071  Vali Loss: 0.0109724 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943601  Vali macro F1 0.9916465 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 1.575352668762207
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0050652  Vali Loss: 0.0106659 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943601  Vali macro F1 0.9916465 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9943439  Test weighted F1: 0.9943404  Test macro F1 0.9942932 
================ the 2 th CV Experiment ================ 
Overlapping random Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.00280112 0.00239808 0.00241546 0.00322581 0.00549451 0.00552486
 0.00324675 0.00292398 0.00236967 0.00396825]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.3504149913787842
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.1234902  Vali Loss: 1.5029350 Vali Accuracy: 0.4519774  Vali weighted F1: 0.4479086  Vali macro F1 0.4203840 
Validation loss decreased (inf --> 1.502935).  Saving model ...
Epoch: 2 cost time: 1.3494133949279785
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.1754183  Vali Loss: 0.7197753 Vali Accuracy: 0.7429379  Vali weighted F1: 0.7253325  Vali macro F1 0.6783639 
new best score!!!!
Validation loss decreased (1.502935 --> 0.719775).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.349137783050537
VALI: Epoch: 3, Steps: 13 | Train Loss: 0.7122725  Vali Loss: 0.4575416 Vali Accuracy: 0.8276836  Vali weighted F1: 0.8150270  Vali macro F1 0.7665926 
new best score!!!!
Validation loss decreased (0.719775 --> 0.457542).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.3490724563598633
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.4763992  Vali Loss: 0.3225389 Vali Accuracy: 0.8728814  Vali weighted F1: 0.8582917  Vali macro F1 0.7961246 
new best score!!!!
Validation loss decreased (0.457542 --> 0.322539).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.3476498126983643
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.3515711  Vali Loss: 0.2201395 Vali Accuracy: 0.9265537  Vali weighted F1: 0.9268099  Vali macro F1 0.8985235 
new best score!!!!
Validation loss decreased (0.322539 --> 0.220139).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.3497240543365479
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.2704859  Vali Loss: 0.1849490 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9141765  Vali macro F1 0.8556368 
new best score!!!!
Validation loss decreased (0.220139 --> 0.184949).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.3500804901123047
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.2226160  Vali Loss: 0.1493818 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9469940  Vali macro F1 0.9128467 
new best score!!!!
Validation loss decreased (0.184949 --> 0.149382).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.347456932067871
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.1901540  Vali Loss: 0.1255764 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9461558  Vali macro F1 0.9075416 
new best score!!!!
Validation loss decreased (0.149382 --> 0.125576).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.348090648651123
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.1627739  Vali Loss: 0.1282409 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9184613  Vali macro F1 0.8609290 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 1.349799394607544
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.1464993  Vali Loss: 0.1018890 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9511375  Vali macro F1 0.9136771 
new best score!!!!
Validation loss decreased (0.125576 --> 0.101889).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.3532226085662842
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.1240887  Vali Loss: 0.0962415 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9450012  Vali macro F1 0.9009432 
new best score!!!!
Validation loss decreased (0.101889 --> 0.096242).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.3486428260803223
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1190595  Vali Loss: 0.0829833 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746974  Vali macro F1 0.9572553 
new best score!!!!
Validation loss decreased (0.096242 --> 0.082983).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.3642382621765137
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1074616  Vali Loss: 0.0817875 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9507461  Vali macro F1 0.9081466 
new best score!!!!
Validation loss decreased (0.082983 --> 0.081788).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.349088191986084
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0960151  Vali Loss: 0.0775799 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9711715  Vali macro F1 0.9496558 
new best score!!!!
Validation loss decreased (0.081788 --> 0.077580).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.3461706638336182
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0881255  Vali Loss: 0.0760428 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9622768  Vali macro F1 0.9330050 
new best score!!!!
Validation loss decreased (0.077580 --> 0.076043).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.3472845554351807
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0802157  Vali Loss: 0.0651877 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746798  Vali macro F1 0.9570292 
new best score!!!!
Validation loss decreased (0.076043 --> 0.065188).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.3483002185821533
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0706308  Vali Loss: 0.0709254 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9716419  Vali macro F1 0.9518026 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 1.3464648723602295
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0665332  Vali Loss: 0.0423172 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9771651  Vali macro F1 0.9572142 
new best score!!!!
Validation loss decreased (0.065188 --> 0.042317).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.3477423191070557
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0551125  Vali Loss: 0.0466334 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774011  Vali macro F1 0.9600320 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 1.3476426601409912
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0514778  Vali Loss: 0.0435350 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9772410  Vali macro F1 0.9650342 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 1.3510093688964844
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0518928  Vali Loss: 0.0288324 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915629  Vali macro F1 0.9819629 
new best score!!!!
Validation loss decreased (0.042317 --> 0.028832).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.3488168716430664
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0419736  Vali Loss: 0.0261319 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943899  Vali macro F1 0.9880702 
new best score!!!!
Validation loss decreased (0.028832 --> 0.026132).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.349635362625122
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0557478  Vali Loss: 0.0351405 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859350  Vali macro F1 0.9772044 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 1.3491253852844238
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0537008  Vali Loss: 0.0478173 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745179  Vali macro F1 0.9657381 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 1.3500027656555176
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0394128  Vali Loss: 0.0218612 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943557  Vali macro F1 0.9950124 
new best score!!!!
Validation loss decreased (0.026132 --> 0.021861).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.3508672714233398
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0317374  Vali Loss: 0.0150342 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971724  Vali macro F1 0.9976589 
new best score!!!!
Validation loss decreased (0.021861 --> 0.015034).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.3514912128448486
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0313042  Vali Loss: 0.0248706 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915573  Vali macro F1 0.9926731 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 1.3492927551269531
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0298067  Vali Loss: 0.0175453 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887349  Vali macro F1 0.9830456 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 1.350381851196289
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0251810  Vali Loss: 0.0119185 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9942655  Vali macro F1 0.9902133 
new best score!!!!
Validation loss decreased (0.015034 --> 0.011919).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.3502514362335205
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0227654  Vali Loss: 0.0176419 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943899  Vali macro F1 0.9880702 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 1.3509948253631592
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0265420  Vali Loss: 0.0219474 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914461  Vali macro F1 0.9848917 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 1.3496956825256348
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0331307  Vali Loss: 0.0134750 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943601  Vali macro F1 0.9916465 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 1.3528900146484375
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0194195  Vali Loss: 0.0105944 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943510  Vali macro F1 0.9950048 
new best score!!!!
Validation loss decreased (0.011919 --> 0.010594).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 1.3514914512634277
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0165593  Vali Loss: 0.0118712 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943601  Vali macro F1 0.9916465 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 1.3508985042572021
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0117629  Vali Loss: 0.0048682 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.010594 --> 0.004868).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 1.353309154510498
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0143183  Vali Loss: 0.0130966 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9953261 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 1.3501029014587402
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0182812  Vali Loss: 0.0221468 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 1.348332166671753
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0156973  Vali Loss: 0.0066483 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 1.3491096496582031
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0117027  Vali Loss: 0.0081734 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943417  Vali macro F1 0.9929124 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 40 cost time: 1.3559961318969727
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0090996  Vali Loss: 0.0046994 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004868 --> 0.004699).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 1.3511521816253662
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0080049  Vali Loss: 0.0049839 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971724  Vali macro F1 0.9976589 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 1.3661293983459473
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0099584  Vali Loss: 0.0054214 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971724  Vali macro F1 0.9976589 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 1.3489160537719727
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0100578  Vali Loss: 0.0044995 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971724  Vali macro F1 0.9976589 
new best score!!!!
Validation loss decreased (0.004699 --> 0.004500).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 1.3528971672058105
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0089920  Vali Loss: 0.0098481 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943417  Vali macro F1 0.9929124 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 1.34971022605896
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0070267  Vali Loss: 0.0040955 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004500 --> 0.004096).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 1.3507258892059326
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0077492  Vali Loss: 0.0039961 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004096 --> 0.003996).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 1.3508422374725342
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0071570  Vali Loss: 0.0027560 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.003996 --> 0.002756).  Saving model ...
new best score!!!!
Epoch: 48 cost time: 1.3523526191711426
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0082846  Vali Loss: 0.0030416 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 1.3496661186218262
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0088384  Vali Loss: 0.0095189 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971876  Vali macro F1 0.9939876 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 1.3535363674163818
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0155308  Vali Loss: 0.0133147 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971786  Vali macro F1 0.9973459 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 1.3509175777435303
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0116921  Vali Loss: 0.0147937 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971780  Vali macro F1 0.9973867 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 52 cost time: 1.3492069244384766
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0083699  Vali Loss: 0.0074024 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971771  Vali macro F1 0.9976665 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 53 cost time: 1.3518872261047363
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0079087  Vali Loss: 0.0048609 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 1.3508861064910889
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0050022  Vali Loss: 0.0041541 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 1.3510017395019531
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0057985  Vali Loss: 0.0040150 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 56 cost time: 1.3525311946868896
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0045167  Vali Loss: 0.0038003 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 57 cost time: 1.349491834640503
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0042418  Vali Loss: 0.0036153 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 58 cost time: 1.3482346534729004
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0041522  Vali Loss: 0.0035901 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 59 cost time: 1.3479583263397217
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0044555  Vali Loss: 0.0035625 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 60 cost time: 1.350179672241211
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0045957  Vali Loss: 0.0035445 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 61 cost time: 1.351149559020996
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0040594  Vali Loss: 0.0035212 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 62 cost time: 1.3484516143798828
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0044118  Vali Loss: 0.0034948 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9909502  Test weighted F1: 0.9909490  Test macro F1 0.9875942 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1125747
pruned model Parameter : 1128786
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.5903213024139404
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0084265  Vali Loss: 0.0047407 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971724  Vali macro F1 0.9976589 
Validation loss decreased (inf --> 0.004741).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.5908372402191162
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0048344  Vali Loss: 0.0028728 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004741 --> 0.002873).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 1.591017246246338
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0043824  Vali Loss: 0.0025398 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002873 --> 0.002540).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 1.594062089920044
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0042648  Vali Loss: 0.0026769 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 1.5920822620391846
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0037227  Vali Loss: 0.0030097 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 1.5893259048461914
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0036658  Vali Loss: 0.0028287 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 1.5897166728973389
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0033626  Vali Loss: 0.0022972 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002540 --> 0.002297).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 1.5891077518463135
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0031699  Vali Loss: 0.0020651 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002297 --> 0.002065).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 1.5926005840301514
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0030764  Vali Loss: 0.0018698 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.002065 --> 0.001870).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 1.5926733016967773
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0029254  Vali Loss: 0.0017244 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001870 --> 0.001724).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 1.5911915302276611
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0037143  Vali Loss: 0.0016085 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.001724 --> 0.001608).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 1.5912127494812012
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0026499  Vali Loss: 0.0016333 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 1.5927138328552246
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0065237  Vali Loss: 0.0018923 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 1.5910029411315918
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0049751  Vali Loss: 0.0063718 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971876  Vali macro F1 0.9939876 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 1.5937483310699463
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0046337  Vali Loss: 0.0023810 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 1.592918872833252
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0038694  Vali Loss: 0.0025731 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 17 cost time: 1.5901286602020264
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0026944  Vali Loss: 0.0041098 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9972060  Vali macro F1 0.9952859 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 1.591094732284546
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0026564  Vali Loss: 0.0016913 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 1.5925192832946777
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0033233  Vali Loss: 0.0017426 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 1.5924196243286133
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0025251  Vali Loss: 0.0019666 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 1.591426134109497
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0024385  Vali Loss: 0.0017735 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 22 cost time: 1.5906915664672852
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0022010  Vali Loss: 0.0017569 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 1.5898792743682861
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0025870  Vali Loss: 0.0017461 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 1.5906667709350586
Fine Tuning VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0021713  Vali Loss: 0.0017363 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 1.5906918048858643
Fine Tuning VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0020079  Vali Loss: 0.0017204 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 1.5890305042266846
Fine Tuning VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0024905  Vali Loss: 0.0017089 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9920814  Test weighted F1: 0.9921216  Test macro F1 0.9924961 
================ the 3 th CV Experiment ================ 
Overlapping random Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00271003 0.00234742 0.00247525 0.00337838 0.00540541 0.00584795
 0.00310559 0.00282486 0.00240964 0.00411523]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.3474452495574951
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.1311790  Vali Loss: 1.5304401 Vali Accuracy: 0.4519774  Vali weighted F1: 0.4439623  Vali macro F1 0.4264161 
Validation loss decreased (inf --> 1.530440).  Saving model ...
Epoch: 2 cost time: 1.3504509925842285
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.2094719  Vali Loss: 0.7380631 Vali Accuracy: 0.7570621  Vali weighted F1: 0.7527748  Vali macro F1 0.7188221 
new best score!!!!
Validation loss decreased (1.530440 --> 0.738063).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.3463857173919678
VALI: Epoch: 3, Steps: 13 | Train Loss: 0.7091508  Vali Loss: 0.4652321 Vali Accuracy: 0.8502825  Vali weighted F1: 0.8483895  Vali macro F1 0.8187704 
new best score!!!!
Validation loss decreased (0.738063 --> 0.465232).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.3528835773468018
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.4726816  Vali Loss: 0.3196436 Vali Accuracy: 0.8757062  Vali weighted F1: 0.8770263  Vali macro F1 0.8507213 
new best score!!!!
Validation loss decreased (0.465232 --> 0.319644).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.3455910682678223
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.3483489  Vali Loss: 0.2258314 Vali Accuracy: 0.9180791  Vali weighted F1: 0.9182286  Vali macro F1 0.8743453 
new best score!!!!
Validation loss decreased (0.319644 --> 0.225831).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.3632965087890625
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.2637873  Vali Loss: 0.1876016 Vali Accuracy: 0.9124294  Vali weighted F1: 0.9049206  Vali macro F1 0.8527261 
new best score!!!!
Validation loss decreased (0.225831 --> 0.187602).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.34706449508667
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.2186820  Vali Loss: 0.1386649 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9576408  Vali macro F1 0.9195132 
new best score!!!!
Validation loss decreased (0.187602 --> 0.138665).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.3465473651885986
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.1790641  Vali Loss: 0.1162050 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9449448  Vali macro F1 0.8865436 
new best score!!!!
Validation loss decreased (0.138665 --> 0.116205).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.3445885181427002
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.1506532  Vali Loss: 0.1158239 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9289769  Vali macro F1 0.8716994 
new best score!!!!
Validation loss decreased (0.116205 --> 0.115824).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.3483450412750244
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.1374973  Vali Loss: 0.1174574 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9451123  Vali macro F1 0.9105051 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 1.3456850051879883
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.1244866  Vali Loss: 0.0806337 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9564972  Vali macro F1 0.9103261 
new best score!!!!
Validation loss decreased (0.115824 --> 0.080634).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.34586763381958
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1161546  Vali Loss: 0.0799181 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9740917  Vali macro F1 0.9549782 
new best score!!!!
Validation loss decreased (0.080634 --> 0.079918).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.3450396060943604
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1046270  Vali Loss: 0.0671827 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9718657  Vali macro F1 0.9435551 
new best score!!!!
Validation loss decreased (0.079918 --> 0.067183).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.3468902111053467
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0909729  Vali Loss: 0.0655632 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9687393  Vali macro F1 0.9467566 
new best score!!!!
Validation loss decreased (0.067183 --> 0.065563).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.3459453582763672
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0814305  Vali Loss: 0.0642932 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9714323  Vali macro F1 0.9477532 
new best score!!!!
Validation loss decreased (0.065563 --> 0.064293).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.3461918830871582
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0738976  Vali Loss: 0.0540255 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9743955  Vali macro F1 0.9588255 
new best score!!!!
Validation loss decreased (0.064293 --> 0.054025).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.3457934856414795
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0716691  Vali Loss: 0.0599559 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9741755  Vali macro F1 0.9569833 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 1.3471345901489258
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0754538  Vali Loss: 0.0708921 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9627995  Vali macro F1 0.9481863 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 19 cost time: 1.3450679779052734
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0674166  Vali Loss: 0.0772819 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9684903  Vali macro F1 0.9468538 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 20 cost time: 1.3454346656799316
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0622533  Vali Loss: 0.0352668 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9771851  Vali macro F1 0.9607557 
new best score!!!!
Validation loss decreased (0.054025 --> 0.035267).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.3508636951446533
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0528077  Vali Loss: 0.0326527 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831106  Vali macro F1 0.9675970 
new best score!!!!
Validation loss decreased (0.035267 --> 0.032653).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.3481316566467285
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0487355  Vali Loss: 0.0305802 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887353  Vali macro F1 0.9796218 
new best score!!!!
Validation loss decreased (0.032653 --> 0.030580).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.3475100994110107
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0358114  Vali Loss: 0.0231406 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887006  Vali macro F1 0.9757143 
new best score!!!!
Validation loss decreased (0.030580 --> 0.023141).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.3485980033874512
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0368917  Vali Loss: 0.0311091 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831379  Vali macro F1 0.9711448 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 1.3467614650726318
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0271220  Vali Loss: 0.0202436 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914320  Vali macro F1 0.9840896 
new best score!!!!
Validation loss decreased (0.023141 --> 0.020244).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.3511133193969727
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0230348  Vali Loss: 0.0178173 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915629  Vali macro F1 0.9819629 
new best score!!!!
Validation loss decreased (0.020244 --> 0.017817).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.348571538925171
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0303882  Vali Loss: 0.0179558 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887353  Vali macro F1 0.9796218 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 1.348057746887207
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0274793  Vali Loss: 0.0368714 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9833037  Vali macro F1 0.9728967 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 1.3467602729797363
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0258335  Vali Loss: 0.0206233 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887380  Vali macro F1 0.9790643 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 1.3477463722229004
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0192484  Vali Loss: 0.0149368 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
new best score!!!!
Validation loss decreased (0.017817 --> 0.014937).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 1.350614070892334
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0168486  Vali Loss: 0.0216815 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915254  Vali macro F1 0.9849586 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 1.351283073425293
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0153063  Vali Loss: 0.0252413 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915273  Vali macro F1 0.9855237 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 1.3480913639068604
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0197848  Vali Loss: 0.0230508 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 34 cost time: 1.3501381874084473
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0307515  Vali Loss: 0.0148437 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943899  Vali macro F1 0.9880702 
new best score!!!!
Validation loss decreased (0.014937 --> 0.014844).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.3546762466430664
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0312019  Vali Loss: 0.0560081 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829211  Vali macro F1 0.9768377 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 1.3492577075958252
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0231104  Vali Loss: 0.0179403 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943899  Vali macro F1 0.9880702 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 1.3483266830444336
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0159614  Vali Loss: 0.0153779 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 1.3487722873687744
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0130494  Vali Loss: 0.0156739 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886882  Vali macro F1 0.9831654 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 1.3479585647583008
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0125676  Vali Loss: 0.0112253 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
new best score!!!!
Validation loss decreased (0.014844 --> 0.011225).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 1.3496174812316895
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0113237  Vali Loss: 0.0233999 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887380  Vali macro F1 0.9790643 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 1.3502898216247559
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0109749  Vali Loss: 0.0207297 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915227  Vali macro F1 0.9855161 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 1.3472435474395752
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0100437  Vali Loss: 0.0093124 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9878571 
new best score!!!!
Validation loss decreased (0.011225 --> 0.009312).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 1.3474438190460205
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0079357  Vali Loss: 0.0296754 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859395  Vali macro F1 0.9774458 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 1.3475244045257568
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0099603  Vali Loss: 0.0144650 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971876  Vali macro F1 0.9939876 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 1.3479392528533936
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0084528  Vali Loss: 0.0205139 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943601  Vali macro F1 0.9916465 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 46 cost time: 1.3486056327819824
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0075785  Vali Loss: 0.0201537 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943601  Vali macro F1 0.9916465 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 47 cost time: 1.3481776714324951
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0061525  Vali Loss: 0.0133534 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914952  Vali macro F1 0.9891655 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 48 cost time: 1.3481261730194092
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0048809  Vali Loss: 0.0140294 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915256  Vali macro F1 0.9892959 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 49 cost time: 1.3466951847076416
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0047882  Vali Loss: 0.0155387 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915256  Vali macro F1 0.9892959 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 50 cost time: 1.3467600345611572
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0050496  Vali Loss: 0.0160077 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915256  Vali macro F1 0.9892959 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 51 cost time: 1.3495924472808838
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0048428  Vali Loss: 0.0169110 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943601  Vali macro F1 0.9916465 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 52 cost time: 1.347536325454712
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0042777  Vali Loss: 0.0173286 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943601  Vali macro F1 0.9916465 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 53 cost time: 1.3474242687225342
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0046297  Vali Loss: 0.0173307 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943601  Vali macro F1 0.9916465 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 54 cost time: 1.3479454517364502
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0049800  Vali Loss: 0.0174713 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943601  Vali macro F1 0.9916465 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 55 cost time: 1.3479201793670654
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0038916  Vali Loss: 0.0175207 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943601  Vali macro F1 0.9916465 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 56 cost time: 1.3462274074554443
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0045109  Vali Loss: 0.0175097 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943601  Vali macro F1 0.9916465 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 57 cost time: 1.3462603092193604
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0043785  Vali Loss: 0.0175247 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943601  Vali macro F1 0.9916465 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9909502  Test weighted F1: 0.9909464  Test macro F1 0.9901478 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1125747
pruned model Parameter : 1128786
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.601377010345459
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0078979  Vali Loss: 0.0117293 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
Validation loss decreased (inf --> 0.011729).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.602297067642212
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0072758  Vali Loss: 0.0103243 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
new best score!!!!
Validation loss decreased (0.011729 --> 0.010324).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 1.6035664081573486
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0063094  Vali Loss: 0.0119294 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 1.6006464958190918
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0066839  Vali Loss: 0.0175776 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915227  Vali macro F1 0.9855161 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 1.60237717628479
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0049986  Vali Loss: 0.0155265 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915227  Vali macro F1 0.9855161 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 1.600400447845459
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0043020  Vali Loss: 0.0130753 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915227  Vali macro F1 0.9855161 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 1.6037769317626953
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0045487  Vali Loss: 0.0119342 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 8 cost time: 1.5964257717132568
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0045992  Vali Loss: 0.0142258 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915227  Vali macro F1 0.9855161 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 1.599926233291626
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0052383  Vali Loss: 0.0151332 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915049  Vali macro F1 0.9886176 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 1.5999431610107422
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0040992  Vali Loss: 0.0147437 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 1.6021091938018799
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0037621  Vali Loss: 0.0154904 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915227  Vali macro F1 0.9855161 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 1.5998058319091797
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0034182  Vali Loss: 0.0132556 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 13 cost time: 1.6009275913238525
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0048400  Vali Loss: 0.0128729 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 1.6002287864685059
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0039427  Vali Loss: 0.0127178 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943297  Vali macro F1 0.9915162 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 1.6011602878570557
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0037219  Vali Loss: 0.0128305 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915227  Vali macro F1 0.9855161 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 1.6031155586242676
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0039524  Vali Loss: 0.0128408 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915227  Vali macro F1 0.9855161 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 1.6020338535308838
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0036658  Vali Loss: 0.0129017 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915227  Vali macro F1 0.9855161 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9909502  Test weighted F1: 0.9909468  Test macro F1 0.9889406 
================ the 4 th CV Experiment ================ 
Overlapping random Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.00265252 0.00243309 0.00246305 0.00332226 0.00571429 0.00568182
 0.00314465 0.0028169  0.00238663 0.00409836]
Train data number :  3182
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  887
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.3525922298431396
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.1271984  Vali Loss: 1.5816870 Vali Accuracy: 0.4632768  Vali weighted F1: 0.4280872  Vali macro F1 0.4081283 
Validation loss decreased (inf --> 1.581687).  Saving model ...
Epoch: 2 cost time: 1.3548855781555176
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.1700739  Vali Loss: 0.7856843 Vali Accuracy: 0.6977401  Vali weighted F1: 0.6912092  Vali macro F1 0.6659605 
new best score!!!!
Validation loss decreased (1.581687 --> 0.785684).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.3510034084320068
VALI: Epoch: 3, Steps: 13 | Train Loss: 0.6748171  Vali Loss: 0.4725841 Vali Accuracy: 0.8333333  Vali weighted F1: 0.8112289  Vali macro F1 0.7752721 
new best score!!!!
Validation loss decreased (0.785684 --> 0.472584).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.3494610786437988
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.4392806  Vali Loss: 0.3226089 Vali Accuracy: 0.8926554  Vali weighted F1: 0.8728153  Vali macro F1 0.8255261 
new best score!!!!
Validation loss decreased (0.472584 --> 0.322609).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.3503050804138184
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.3175632  Vali Loss: 0.2647103 Vali Accuracy: 0.8898305  Vali weighted F1: 0.8690747  Vali macro F1 0.8216364 
new best score!!!!
Validation loss decreased (0.322609 --> 0.264710).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.3487014770507812
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.2500752  Vali Loss: 0.2126707 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9190170  Vali macro F1 0.8854108 
new best score!!!!
Validation loss decreased (0.264710 --> 0.212671).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.3517210483551025
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.2055934  Vali Loss: 0.1745660 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9007784  Vali macro F1 0.8497555 
new best score!!!!
Validation loss decreased (0.212671 --> 0.174566).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.3509721755981445
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.1711259  Vali Loss: 0.1625575 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9096034  Vali macro F1 0.8677132 
new best score!!!!
Validation loss decreased (0.174566 --> 0.162557).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.3490164279937744
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.1494808  Vali Loss: 0.1523838 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9478887  Vali macro F1 0.9312229 
new best score!!!!
Validation loss decreased (0.162557 --> 0.152384).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.3508105278015137
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.1323779  Vali Loss: 0.1290926 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9511998  Vali macro F1 0.9363527 
new best score!!!!
Validation loss decreased (0.152384 --> 0.129093).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.3502066135406494
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.1358824  Vali Loss: 0.1276759 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9487488  Vali macro F1 0.9278394 
new best score!!!!
Validation loss decreased (0.129093 --> 0.127676).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.3554458618164062
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1127340  Vali Loss: 0.1357666 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9149500  Vali macro F1 0.8732409 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 1.3508930206298828
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1016701  Vali Loss: 0.1240141 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9507859  Vali macro F1 0.9340035 
new best score!!!!
Validation loss decreased (0.127676 --> 0.124014).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.3650262355804443
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0912275  Vali Loss: 0.1064598 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9630659  Vali macro F1 0.9530524 
new best score!!!!
Validation loss decreased (0.124014 --> 0.106460).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.3510022163391113
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0849266  Vali Loss: 0.0825145 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9686051  Vali macro F1 0.9575723 
new best score!!!!
Validation loss decreased (0.106460 --> 0.082514).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.350158929824829
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0716461  Vali Loss: 0.1077080 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9484491  Vali macro F1 0.9318847 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 1.3582968711853027
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0668738  Vali Loss: 0.0872279 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9662327  Vali macro F1 0.9578177 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 1.364715814590454
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0718209  Vali Loss: 0.0855107 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9596572  Vali macro F1 0.9446819 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 19 cost time: 1.3583498001098633
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0579045  Vali Loss: 0.0781286 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9716948  Vali macro F1 0.9636642 
new best score!!!!
Validation loss decreased (0.082514 --> 0.078129).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.3507206439971924
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0501169  Vali Loss: 0.1052432 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9541561  Vali macro F1 0.9428496 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 1.3501887321472168
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0436478  Vali Loss: 0.1120857 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9454275  Vali macro F1 0.9291351 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 1.3528127670288086
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0659366  Vali Loss: 0.1068196 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9579453  Vali macro F1 0.9450455 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 23 cost time: 1.350421667098999
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0468511  Vali Loss: 0.0683228 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745554  Vali macro F1 0.9708344 
new best score!!!!
Validation loss decreased (0.078129 --> 0.068323).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.3526721000671387
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0343255  Vali Loss: 0.0816354 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9717083  Vali macro F1 0.9647370 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 1.350576639175415
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0347745  Vali Loss: 0.0657688 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9568950  Vali macro F1 0.9397170 
new best score!!!!
Validation loss decreased (0.068323 --> 0.065769).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.3525605201721191
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0258787  Vali Loss: 0.0498697 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830984  Vali macro F1 0.9810194 
new best score!!!!
Validation loss decreased (0.065769 --> 0.049870).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.3523707389831543
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0261658  Vali Loss: 0.0610914 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9775186  Vali macro F1 0.9730305 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 1.353449821472168
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0218642  Vali Loss: 0.0610771 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774523  Vali macro F1 0.9705299 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 1.3528978824615479
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0217822  Vali Loss: 0.0342704 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915250  Vali macro F1 0.9906338 
new best score!!!!
Validation loss decreased (0.049870 --> 0.034270).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.353722095489502
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0251458  Vali Loss: 0.0491810 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802780  Vali macro F1 0.9763803 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 1.351893424987793
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0246794  Vali Loss: 0.0460203 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774217  Vali macro F1 0.9687895 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 1.3504273891448975
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0190164  Vali Loss: 0.0412403 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858805  Vali macro F1 0.9834530 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 1.352332353591919
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0151814  Vali Loss: 0.0362397 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886842  Vali macro F1 0.9852286 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 34 cost time: 1.3518884181976318
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0173157  Vali Loss: 0.0655519 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9772902  Vali macro F1 0.9678446 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 35 cost time: 1.352677822113037
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0156743  Vali Loss: 0.0386617 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830501  Vali macro F1 0.9795073 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 1.3512234687805176
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0102697  Vali Loss: 0.0362009 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858752  Vali macro F1 0.9813314 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 1.3518433570861816
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0086497  Vali Loss: 0.0346027 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886940  Vali macro F1 0.9859776 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 1.3504624366760254
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0087952  Vali Loss: 0.0341520 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858136  Vali macro F1 0.9840648 
new best score!!!!
Validation loss decreased (0.034270 --> 0.034152).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 1.3565325736999512
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0078426  Vali Loss: 0.0352724 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858530  Vali macro F1 0.9827513 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 1.3558850288391113
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0074285  Vali Loss: 0.0357951 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829858  Vali macro F1 0.9794136 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 1.351088523864746
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0085262  Vali Loss: 0.0354809 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829858  Vali macro F1 0.9794136 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 1.3591852188110352
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0072745  Vali Loss: 0.0336919 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829858  Vali macro F1 0.9794136 
new best score!!!!
Validation loss decreased (0.034152 --> 0.033692).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 1.3581652641296387
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0080487  Vali Loss: 0.0340882 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858530  Vali macro F1 0.9827513 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 44 cost time: 1.3496756553649902
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0077216  Vali Loss: 0.0346399 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829858  Vali macro F1 0.9794136 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 45 cost time: 1.350433588027954
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0069042  Vali Loss: 0.0335784 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829858  Vali macro F1 0.9794136 
new best score!!!!
Validation loss decreased (0.033692 --> 0.033578).  Saving model ...
new best score!!!!
Epoch: 46 cost time: 1.3528687953948975
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0066095  Vali Loss: 0.0340215 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829858  Vali macro F1 0.9794136 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 1.3527123928070068
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0060525  Vali Loss: 0.0357031 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829858  Vali macro F1 0.9794136 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 48 cost time: 1.3517045974731445
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0060687  Vali Loss: 0.0378498 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801626  Vali macro F1 0.9772639 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 49 cost time: 1.3535346984863281
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0063056  Vali Loss: 0.0376138 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830347  Vali macro F1 0.9805136 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 50 cost time: 1.3541653156280518
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0060833  Vali Loss: 0.0338108 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858625  Vali macro F1 0.9851647 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 51 cost time: 1.3543660640716553
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0061442  Vali Loss: 0.0333970 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858625  Vali macro F1 0.9851647 
new best score!!!!
Validation loss decreased (0.033578 --> 0.033397).  Saving model ...
new best score!!!!
Epoch: 52 cost time: 1.352391242980957
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0058302  Vali Loss: 0.0330851 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858625  Vali macro F1 0.9851647 
new best score!!!!
Validation loss decreased (0.033397 --> 0.033085).  Saving model ...
new best score!!!!
Epoch: 53 cost time: 1.3517961502075195
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0068074  Vali Loss: 0.0330710 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858625  Vali macro F1 0.9851647 
new best score!!!!
Validation loss decreased (0.033085 --> 0.033071).  Saving model ...
new best score!!!!
Epoch: 54 cost time: 1.3514337539672852
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0066201  Vali Loss: 0.0330850 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858625  Vali macro F1 0.9851647 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 1.3496801853179932
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0072013  Vali Loss: 0.0331019 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858589  Vali macro F1 0.9826641 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 56 cost time: 1.3504345417022705
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0063110  Vali Loss: 0.0335494 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858589  Vali macro F1 0.9826641 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 57 cost time: 1.3517777919769287
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0064923  Vali Loss: 0.0343216 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858589  Vali macro F1 0.9826641 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 58 cost time: 1.3496613502502441
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0065702  Vali Loss: 0.0347849 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858589  Vali macro F1 0.9826641 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 59 cost time: 1.3510181903839111
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0062553  Vali Loss: 0.0348031 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858589  Vali macro F1 0.9826641 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 60 cost time: 1.3485088348388672
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0069842  Vali Loss: 0.0347720 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858589  Vali macro F1 0.9826641 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 61 cost time: 1.3498313426971436
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0056393  Vali Loss: 0.0347707 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858589  Vali macro F1 0.9826641 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 62 cost time: 1.3517491817474365
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0055609  Vali Loss: 0.0347860 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858589  Vali macro F1 0.9826641 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 63 cost time: 1.3510043621063232
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0055927  Vali Loss: 0.0348014 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858589  Vali macro F1 0.9826641 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-07
Epoch: 64 cost time: 1.3504371643066406
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0054682  Vali Loss: 0.0348028 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858589  Vali macro F1 0.9826641 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 65 cost time: 1.3512778282165527
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0062591  Vali Loss: 0.0348052 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858589  Vali macro F1 0.9826641 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 66 cost time: 1.3496973514556885
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0064547  Vali Loss: 0.0348065 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858589  Vali macro F1 0.9826641 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 67 cost time: 1.3525516986846924
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0067750  Vali Loss: 0.0348031 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858589  Vali macro F1 0.9826641 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 68 cost time: 1.3529586791992188
VALI: Epoch: 68, Steps: 13 | Train Loss: 0.0061784  Vali Loss: 0.0348036 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858589  Vali macro F1 0.9826641 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9875986  Test weighted F1: 0.9876115  Test macro F1 0.9863832 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1125747
pruned model Parameter : 1128786
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.6007213592529297
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0089566  Vali Loss: 0.0322995 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829905  Vali macro F1 0.9819150 
Validation loss decreased (inf --> 0.032300).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.5965700149536133
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0064073  Vali Loss: 0.0509847 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859232  Vali macro F1 0.9827577 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.5957512855529785
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0111181  Vali Loss: 0.0386225 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858625  Vali macro F1 0.9851647 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 1.5954992771148682
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0063652  Vali Loss: 0.0378495 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858625  Vali macro F1 0.9851647 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 1.5945098400115967
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0066735  Vali Loss: 0.0423535 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830659  Vali macro F1 0.9810797 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 1.5967888832092285
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0061078  Vali Loss: 0.0372584 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858691  Vali macro F1 0.9838265 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 1.597254753112793
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0057689  Vali Loss: 0.0350012 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858691  Vali macro F1 0.9838265 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 1.59623122215271
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0068266  Vali Loss: 0.0382012 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830347  Vali macro F1 0.9805136 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 1.5923748016357422
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0050640  Vali Loss: 0.0390266 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831027  Vali macro F1 0.9781186 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 1.5944797992706299
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0041672  Vali Loss: 0.0374273 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858589  Vali macro F1 0.9826641 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 11 cost time: 1.5935287475585938
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0049168  Vali Loss: 0.0364531 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858589  Vali macro F1 0.9826641 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 1.594252109527588
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0053954  Vali Loss: 0.0358357 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858589  Vali macro F1 0.9826641 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 1.592468500137329
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0045651  Vali Loss: 0.0353567 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858589  Vali macro F1 0.9826641 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 1.5956904888153076
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0060180  Vali Loss: 0.0345769 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858589  Vali macro F1 0.9826641 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 1.5940437316894531
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0044105  Vali Loss: 0.0340356 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858589  Vali macro F1 0.9826641 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 16 cost time: 1.5947411060333252
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0044535  Vali Loss: 0.0340123 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858589  Vali macro F1 0.9826641 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9898534  Test weighted F1: 0.9898641  Test macro F1 0.9883369 
Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 1125747
Set the seed as :  3
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
================ SOCV Mode ====================
================ 5 CV ======================
================ the 0 th CV Experiment ================ 
Overlapping random Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.00269542 0.00226757 0.00255102 0.0031348  0.00578035 0.00578035
 0.00319489 0.00290698 0.0023753  0.00420168]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.3800334930419922
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.1356902  Vali Loss: 1.5680314 Vali Accuracy: 0.4237288  Vali weighted F1: 0.3579514  Vali macro F1 0.3168948 
Validation loss decreased (inf --> 1.568031).  Saving model ...
Epoch: 2 cost time: 1.3587000370025635
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.2126758  Vali Loss: 0.7516576 Vali Accuracy: 0.7683616  Vali weighted F1: 0.7729972  Vali macro F1 0.7536641 
new best score!!!!
Validation loss decreased (1.568031 --> 0.751658).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.3563563823699951
VALI: Epoch: 3, Steps: 13 | Train Loss: 0.6813915  Vali Loss: 0.4938325 Vali Accuracy: 0.8361582  Vali weighted F1: 0.8165671  Vali macro F1 0.7794420 
new best score!!!!
Validation loss decreased (0.751658 --> 0.493832).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.3593215942382812
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.4553560  Vali Loss: 0.3380007 Vali Accuracy: 0.8757062  Vali weighted F1: 0.8677131  Vali macro F1 0.8374064 
new best score!!!!
Validation loss decreased (0.493832 --> 0.338001).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.3575496673583984
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.3403653  Vali Loss: 0.2674904 Vali Accuracy: 0.9039548  Vali weighted F1: 0.9017178  Vali macro F1 0.8768491 
new best score!!!!
Validation loss decreased (0.338001 --> 0.267490).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.357895851135254
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.2731332  Vali Loss: 0.2347629 Vali Accuracy: 0.9096045  Vali weighted F1: 0.9058706  Vali macro F1 0.8726363 
new best score!!!!
Validation loss decreased (0.267490 --> 0.234763).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.3586297035217285
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.2248257  Vali Loss: 0.2119136 Vali Accuracy: 0.9039548  Vali weighted F1: 0.8817705  Vali macro F1 0.8388331 
new best score!!!!
Validation loss decreased (0.234763 --> 0.211914).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.3600666522979736
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.1887188  Vali Loss: 0.1836036 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9192200  Vali macro F1 0.8897419 
new best score!!!!
Validation loss decreased (0.211914 --> 0.183604).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.3634881973266602
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.1543766  Vali Loss: 0.1705912 Vali Accuracy: 0.9180791  Vali weighted F1: 0.9017815  Vali macro F1 0.8623786 
new best score!!!!
Validation loss decreased (0.183604 --> 0.170591).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.3568496704101562
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.1346990  Vali Loss: 0.1546722 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9258708  Vali macro F1 0.8964455 
new best score!!!!
Validation loss decreased (0.170591 --> 0.154672).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.3719720840454102
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.1228379  Vali Loss: 0.1536382 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9118816  Vali macro F1 0.8775051 
new best score!!!!
Validation loss decreased (0.154672 --> 0.153638).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.3610985279083252
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1081193  Vali Loss: 0.1408359 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9449316  Vali macro F1 0.9202812 
new best score!!!!
Validation loss decreased (0.153638 --> 0.140836).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.3580687046051025
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0981756  Vali Loss: 0.1352556 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9444974  Vali macro F1 0.9219771 
new best score!!!!
Validation loss decreased (0.140836 --> 0.135256).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.360783576965332
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0959225  Vali Loss: 0.1327113 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9445974  Vali macro F1 0.9246627 
new best score!!!!
Validation loss decreased (0.135256 --> 0.132711).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.3614473342895508
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0872188  Vali Loss: 0.1412227 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9445384  Vali macro F1 0.9209867 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 1.358123779296875
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0907443  Vali Loss: 0.1502278 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9097948  Vali macro F1 0.8723323 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 17 cost time: 1.3565168380737305
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0906595  Vali Loss: 0.1407078 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9538455  Vali macro F1 0.9359300 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 18 cost time: 1.3569018840789795
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0799811  Vali Loss: 0.1271727 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9406696  Vali macro F1 0.9181872 
new best score!!!!
Validation loss decreased (0.132711 --> 0.127173).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.3614282608032227
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0847139  Vali Loss: 0.1352088 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9447791  Vali macro F1 0.9227132 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 1.3576116561889648
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0822120  Vali Loss: 0.1209993 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9575595  Vali macro F1 0.9408918 
new best score!!!!
Validation loss decreased (0.127173 --> 0.120999).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.3597853183746338
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0729629  Vali Loss: 0.1038638 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9630715  Vali macro F1 0.9488963 
new best score!!!!
Validation loss decreased (0.120999 --> 0.103864).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.3618688583374023
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0610412  Vali Loss: 0.1181858 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9572573  Vali macro F1 0.9411088 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 1.35917329788208
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0500179  Vali Loss: 0.1237082 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9531497  Vali macro F1 0.9333468 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 1.3582732677459717
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0436441  Vali Loss: 0.0811753 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773991  Vali macro F1 0.9692094 
new best score!!!!
Validation loss decreased (0.103864 --> 0.081175).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.3587465286254883
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0427895  Vali Loss: 0.0865645 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9771494  Vali macro F1 0.9701787 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 1.3604822158813477
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0339486  Vali Loss: 0.0811441 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9772803  Vali macro F1 0.9706882 
new best score!!!!
Validation loss decreased (0.081175 --> 0.081144).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.359839916229248
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0281420  Vali Loss: 0.0880505 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9800865  Vali macro F1 0.9748237 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 1.356834888458252
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0268239  Vali Loss: 0.0626554 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886552  Vali macro F1 0.9867576 
new best score!!!!
Validation loss decreased (0.081144 --> 0.062655).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.3593213558197021
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0258777  Vali Loss: 0.0606214 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858416  Vali macro F1 0.9836113 
new best score!!!!
Validation loss decreased (0.062655 --> 0.060621).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.3601422309875488
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0273334  Vali Loss: 0.0789480 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858399  Vali macro F1 0.9823623 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 1.3575022220611572
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0274885  Vali Loss: 0.1167602 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9631006  Vali macro F1 0.9522992 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 1.3599371910095215
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0269913  Vali Loss: 0.0691651 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858462  Vali macro F1 0.9844280 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 1.3578181266784668
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0217326  Vali Loss: 0.0606094 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857476  Vali macro F1 0.9856662 
new best score!!!!
Validation loss decreased (0.060621 --> 0.060609).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 1.36232590675354
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0203830  Vali Loss: 0.0602528 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9885408  Vali macro F1 0.9880231 
new best score!!!!
Validation loss decreased (0.060609 --> 0.060253).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.3599917888641357
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0175077  Vali Loss: 0.1139347 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9657707  Vali macro F1 0.9531747 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 1.364793062210083
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0160477  Vali Loss: 0.0762067 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9772841  Vali macro F1 0.9705989 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 1.35758638381958
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0162584  Vali Loss: 0.0605282 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857476  Vali macro F1 0.9856662 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 1.3777308464050293
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0140286  Vali Loss: 0.0715742 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9800881  Vali macro F1 0.9768813 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 1.3586268424987793
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0189264  Vali Loss: 0.0626723 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857188  Vali macro F1 0.9837126 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 40 cost time: 1.3574776649475098
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0119632  Vali Loss: 0.0600363 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9885369  Vali macro F1 0.9881124 
new best score!!!!
Validation loss decreased (0.060253 --> 0.060036).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 1.3629941940307617
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0096295  Vali Loss: 0.0603636 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857188  Vali macro F1 0.9837126 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 1.3599002361297607
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0087451  Vali Loss: 0.0594568 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857188  Vali macro F1 0.9837126 
new best score!!!!
Validation loss decreased (0.060036 --> 0.059457).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 1.3606362342834473
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0087115  Vali Loss: 0.0578233 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857188  Vali macro F1 0.9837126 
new best score!!!!
Validation loss decreased (0.059457 --> 0.057823).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 1.3588557243347168
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0073600  Vali Loss: 0.0596119 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857188  Vali macro F1 0.9837126 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 1.3606276512145996
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0071932  Vali Loss: 0.0595796 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857188  Vali macro F1 0.9837126 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 1.3579654693603516
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0072872  Vali Loss: 0.0576008 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857188  Vali macro F1 0.9837126 
new best score!!!!
Validation loss decreased (0.057823 --> 0.057601).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 1.358914852142334
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0059539  Vali Loss: 0.0590118 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857188  Vali macro F1 0.9837126 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 1.3568854331970215
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0067180  Vali Loss: 0.0592894 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857188  Vali macro F1 0.9837126 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 1.359729290008545
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0057200  Vali Loss: 0.0563528 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857188  Vali macro F1 0.9837126 
new best score!!!!
Validation loss decreased (0.057601 --> 0.056353).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 1.3601062297821045
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0050182  Vali Loss: 0.0549209 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857188  Vali macro F1 0.9837126 
new best score!!!!
Validation loss decreased (0.056353 --> 0.054921).  Saving model ...
new best score!!!!
Epoch: 51 cost time: 1.359234094619751
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0052370  Vali Loss: 0.0542867 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857188  Vali macro F1 0.9837126 
new best score!!!!
Validation loss decreased (0.054921 --> 0.054287).  Saving model ...
new best score!!!!
Epoch: 52 cost time: 1.3600895404815674
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0054555  Vali Loss: 0.0562132 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857188  Vali macro F1 0.9837126 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 1.361410140991211
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0057735  Vali Loss: 0.0594751 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857188  Vali macro F1 0.9837126 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 1.3570823669433594
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0052053  Vali Loss: 0.0561192 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857188  Vali macro F1 0.9837126 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 55 cost time: 1.360332727432251
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0052845  Vali Loss: 0.0556304 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857188  Vali macro F1 0.9837126 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 56 cost time: 1.3598952293395996
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0047146  Vali Loss: 0.0582290 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857188  Vali macro F1 0.9837126 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 57 cost time: 1.360163927078247
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0050712  Vali Loss: 0.0582710 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857188  Vali macro F1 0.9837126 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 58 cost time: 1.3576815128326416
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0048193  Vali Loss: 0.0579598 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857188  Vali macro F1 0.9837126 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 59 cost time: 1.35807466506958
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0053340  Vali Loss: 0.0578260 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857188  Vali macro F1 0.9837126 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 60 cost time: 1.3590731620788574
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0046419  Vali Loss: 0.0577528 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857188  Vali macro F1 0.9837126 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 61 cost time: 1.358203411102295
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0045719  Vali Loss: 0.0577655 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857188  Vali macro F1 0.9837126 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 62 cost time: 1.3610975742340088
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0045469  Vali Loss: 0.0577539 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857188  Vali macro F1 0.9837126 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 63 cost time: 1.3592169284820557
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0049309  Vali Loss: 0.0577485 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857188  Vali macro F1 0.9837126 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 64 cost time: 1.3650341033935547
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0053733  Vali Loss: 0.0577370 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857188  Vali macro F1 0.9837126 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 65 cost time: 1.3600654602050781
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0044171  Vali Loss: 0.0577428 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857188  Vali macro F1 0.9837126 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 66 cost time: 1.374497652053833
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0044455  Vali Loss: 0.0577342 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857188  Vali macro F1 0.9837126 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9932127  Test weighted F1: 0.9932182  Test macro F1 0.9917456 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1125747
pruned model Parameter : 1128786
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.594254493713379
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0063391  Vali Loss: 0.0501732 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886715  Vali macro F1 0.9868086 
Validation loss decreased (inf --> 0.050173).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.589888095855713
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0058537  Vali Loss: 0.0510920 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857227  Vali macro F1 0.9836233 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.5943238735198975
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0052439  Vali Loss: 0.0630960 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829087  Vali macro F1 0.9793505 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 1.5928454399108887
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0049675  Vali Loss: 0.0527981 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9885369  Vali macro F1 0.9881124 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 1.5895569324493408
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0051727  Vali Loss: 0.0559993 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9885369  Vali macro F1 0.9881124 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 1.5923235416412354
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0052427  Vali Loss: 0.0602418 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857188  Vali macro F1 0.9837126 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 1.5880584716796875
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0045877  Vali Loss: 0.0574488 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857188  Vali macro F1 0.9837126 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 1.5905108451843262
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0041206  Vali Loss: 0.0586299 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857188  Vali macro F1 0.9837126 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 1.5887377262115479
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0033474  Vali Loss: 0.0614702 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857188  Vali macro F1 0.9837126 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 1.5925118923187256
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0041243  Vali Loss: 0.0657619 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829264  Vali macro F1 0.9813603 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 11 cost time: 1.5926542282104492
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0033951  Vali Loss: 0.0650306 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857188  Vali macro F1 0.9837126 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 1.5923068523406982
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0034986  Vali Loss: 0.0640059 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857188  Vali macro F1 0.9837126 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 1.5933029651641846
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0026887  Vali Loss: 0.0634657 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857188  Vali macro F1 0.9837126 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 1.5916352272033691
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0030017  Vali Loss: 0.0631541 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857188  Vali macro F1 0.9837126 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 1.5934998989105225
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0030762  Vali Loss: 0.0631130 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857188  Vali macro F1 0.9837126 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 16 cost time: 1.5911414623260498
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0030251  Vali Loss: 0.0631632 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9857188  Vali macro F1 0.9837126 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9943439  Test weighted F1: 0.9943430  Test macro F1 0.9926262 
================ the 1 th CV Experiment ================ 
Overlapping random Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00289855 0.0023753  0.00243309 0.00328947 0.00584795 0.00581395
 0.00306748 0.00289855 0.002331   0.00383142]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.3538415431976318
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.1290230  Vali Loss: 1.5215062 Vali Accuracy: 0.4378531  Vali weighted F1: 0.4064139  Vali macro F1 0.3590019 
Validation loss decreased (inf --> 1.521506).  Saving model ...
Epoch: 2 cost time: 1.3525333404541016
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.1610192  Vali Loss: 0.7431141 Vali Accuracy: 0.7231638  Vali weighted F1: 0.7330249  Vali macro F1 0.7113617 
new best score!!!!
Validation loss decreased (1.521506 --> 0.743114).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.3502004146575928
VALI: Epoch: 3, Steps: 13 | Train Loss: 0.6646315  Vali Loss: 0.4642042 Vali Accuracy: 0.8361582  Vali weighted F1: 0.8152607  Vali macro F1 0.7799553 
new best score!!!!
Validation loss decreased (0.743114 --> 0.464204).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.349306344985962
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.4422786  Vali Loss: 0.3300437 Vali Accuracy: 0.8785311  Vali weighted F1: 0.8592449  Vali macro F1 0.8144058 
new best score!!!!
Validation loss decreased (0.464204 --> 0.330044).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.3508570194244385
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.3230796  Vali Loss: 0.2845409 Vali Accuracy: 0.8841808  Vali weighted F1: 0.8644860  Vali macro F1 0.8193939 
new best score!!!!
Validation loss decreased (0.330044 --> 0.284541).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.350250005722046
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.2599648  Vali Loss: 0.2375950 Vali Accuracy: 0.9039548  Vali weighted F1: 0.9029186  Vali macro F1 0.8739789 
new best score!!!!
Validation loss decreased (0.284541 --> 0.237595).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.3553011417388916
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.2252128  Vali Loss: 0.1968755 Vali Accuracy: 0.9067797  Vali weighted F1: 0.8861459  Vali macro F1 0.8421051 
new best score!!!!
Validation loss decreased (0.237595 --> 0.196875).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.3506922721862793
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.1897277  Vali Loss: 0.1776570 Vali Accuracy: 0.9265537  Vali weighted F1: 0.9108545  Vali macro F1 0.8626824 
new best score!!!!
Validation loss decreased (0.196875 --> 0.177657).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.3683748245239258
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.1523063  Vali Loss: 0.1667626 Vali Accuracy: 0.9096045  Vali weighted F1: 0.8889961  Vali macro F1 0.8448187 
new best score!!!!
Validation loss decreased (0.177657 --> 0.166763).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.3506522178649902
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.1477407  Vali Loss: 0.1548791 Vali Accuracy: 0.9265537  Vali weighted F1: 0.9061926  Vali macro F1 0.8552414 
new best score!!!!
Validation loss decreased (0.166763 --> 0.154879).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.3515379428863525
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.1280550  Vali Loss: 0.1530097 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9154622  Vali macro F1 0.8794800 
new best score!!!!
Validation loss decreased (0.154879 --> 0.153010).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.3512723445892334
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1175860  Vali Loss: 0.1518638 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9148608  Vali macro F1 0.8796269 
new best score!!!!
Validation loss decreased (0.153010 --> 0.151864).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.3523962497711182
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1079891  Vali Loss: 0.1564515 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9409944  Vali macro F1 0.9158936 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 1.3501372337341309
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1143456  Vali Loss: 0.1750491 Vali Accuracy: 0.9180791  Vali weighted F1: 0.9166760  Vali macro F1 0.8843486 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 15 cost time: 1.3492488861083984
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1194566  Vali Loss: 0.1512524 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9495980  Vali macro F1 0.9230603 
new best score!!!!
Validation loss decreased (0.151864 --> 0.151252).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.3515520095825195
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1071780  Vali Loss: 0.1430174 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9428500  Vali macro F1 0.9169770 
new best score!!!!
Validation loss decreased (0.151252 --> 0.143017).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.3501341342926025
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0985449  Vali Loss: 0.1414368 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9404571  Vali macro F1 0.9141781 
new best score!!!!
Validation loss decreased (0.143017 --> 0.141437).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.3484845161437988
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0928423  Vali Loss: 0.1399769 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9350352  Vali macro F1 0.9081153 
new best score!!!!
Validation loss decreased (0.141437 --> 0.139977).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.3486566543579102
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0854350  Vali Loss: 0.1357235 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9381512  Vali macro F1 0.9140113 
new best score!!!!
Validation loss decreased (0.139977 --> 0.135723).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.3513460159301758
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0768374  Vali Loss: 0.1274614 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9427133  Vali macro F1 0.9227272 
new best score!!!!
Validation loss decreased (0.135723 --> 0.127461).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.3516578674316406
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0708434  Vali Loss: 0.1239353 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9535405  Vali macro F1 0.9321763 
new best score!!!!
Validation loss decreased (0.127461 --> 0.123935).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.35312819480896
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0696221  Vali Loss: 0.1314605 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9398916  Vali macro F1 0.9151442 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 1.352926254272461
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0721583  Vali Loss: 0.1240895 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9566250  Vali macro F1 0.9363922 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 1.3515677452087402
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0628479  Vali Loss: 0.1003381 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9689371  Vali macro F1 0.9583760 
new best score!!!!
Validation loss decreased (0.123935 --> 0.100338).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.3526332378387451
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0553464  Vali Loss: 0.0995543 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9660776  Vali macro F1 0.9533774 
new best score!!!!
Validation loss decreased (0.100338 --> 0.099554).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.3517415523529053
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0483751  Vali Loss: 0.0891218 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773977  Vali macro F1 0.9725807 
new best score!!!!
Validation loss decreased (0.099554 --> 0.089122).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.3531694412231445
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0404235  Vali Loss: 0.0853158 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802332  Vali macro F1 0.9736846 
new best score!!!!
Validation loss decreased (0.089122 --> 0.085316).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 1.3519163131713867
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0475117  Vali Loss: 0.0860111 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830362  Vali macro F1 0.9800659 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 1.3502089977264404
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0486919  Vali Loss: 0.0856589 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745827  Vali macro F1 0.9696962 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 1.3501999378204346
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0432188  Vali Loss: 0.0754784 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858462  Vali macro F1 0.9844280 
new best score!!!!
Validation loss decreased (0.085316 --> 0.075478).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 1.3522462844848633
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0383266  Vali Loss: 0.1318277 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9602554  Vali macro F1 0.9487650 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 1.351423740386963
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0368407  Vali Loss: 0.0929218 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9689026  Vali macro F1 0.9616187 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 1.353118896484375
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0262201  Vali Loss: 0.1076048 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9717152  Vali macro F1 0.9627382 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 34 cost time: 1.3512921333312988
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0269316  Vali Loss: 0.0702026 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858299  Vali macro F1 0.9843742 
new best score!!!!
Validation loss decreased (0.075478 --> 0.070203).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.3509366512298584
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0223808  Vali Loss: 0.0680941 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802125  Vali macro F1 0.9776840 
new best score!!!!
Validation loss decreased (0.070203 --> 0.068094).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 1.359605312347412
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0156760  Vali Loss: 0.0911293 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802260  Vali macro F1 0.9757286 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 1.3495361804962158
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0157690  Vali Loss: 0.0759192 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830512  Vali macro F1 0.9781093 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 1.3526196479797363
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0145653  Vali Loss: 0.0659246 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858206  Vali macro F1 0.9837263 
new best score!!!!
Validation loss decreased (0.068094 --> 0.065925).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 1.3513209819793701
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0121849  Vali Loss: 0.0683470 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830339  Vali macro F1 0.9813803 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 1.3492209911346436
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0147147  Vali Loss: 0.0809228 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9799660  Vali macro F1 0.9729545 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 1.351245641708374
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0305411  Vali Loss: 0.0827486 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830226  Vali macro F1 0.9820461 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 1.3491733074188232
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0212684  Vali Loss: 0.0789642 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774077  Vali macro F1 0.9714036 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 1.3532016277313232
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0144902  Vali Loss: 0.0665528 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801662  Vali macro F1 0.9769001 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 44 cost time: 1.3485474586486816
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0107449  Vali Loss: 0.0631741 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858583  Vali macro F1 0.9837602 
new best score!!!!
Validation loss decreased (0.065925 --> 0.063174).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 1.3498680591583252
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0092571  Vali Loss: 0.0634656 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858583  Vali macro F1 0.9837602 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 1.353450059890747
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0084674  Vali Loss: 0.0604826 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858583  Vali macro F1 0.9837602 
new best score!!!!
Validation loss decreased (0.063174 --> 0.060483).  Saving model ...
new best score!!!!
Epoch: 47 cost time: 1.3530986309051514
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0075998  Vali Loss: 0.0609264 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858583  Vali macro F1 0.9837602 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 1.3536107540130615
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0084290  Vali Loss: 0.0628611 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858583  Vali macro F1 0.9837602 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 1.3497681617736816
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0084361  Vali Loss: 0.0634672 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858583  Vali macro F1 0.9837602 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 50 cost time: 1.3525807857513428
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0071660  Vali Loss: 0.0628762 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829978  Vali macro F1 0.9813464 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 51 cost time: 1.3520245552062988
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0071443  Vali Loss: 0.0613181 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858583  Vali macro F1 0.9837602 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 52 cost time: 1.3520832061767578
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0066093  Vali Loss: 0.0613857 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858583  Vali macro F1 0.9837602 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 1.352503776550293
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0068951  Vali Loss: 0.0615102 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858583  Vali macro F1 0.9837602 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 1.3516297340393066
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0081638  Vali Loss: 0.0615713 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858583  Vali macro F1 0.9837602 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 55 cost time: 1.3510746955871582
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0069662  Vali Loss: 0.0619023 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829978  Vali macro F1 0.9813464 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 56 cost time: 1.3529777526855469
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0065939  Vali Loss: 0.0619899 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829978  Vali macro F1 0.9813464 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 57 cost time: 1.352241039276123
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0065424  Vali Loss: 0.0619960 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829978  Vali macro F1 0.9813464 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 58 cost time: 1.3523502349853516
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0074971  Vali Loss: 0.0619901 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829978  Vali macro F1 0.9813464 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 59 cost time: 1.351386547088623
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0072786  Vali Loss: 0.0620232 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829978  Vali macro F1 0.9813464 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 60 cost time: 1.3532447814941406
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0084995  Vali Loss: 0.0620364 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829978  Vali macro F1 0.9813464 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 61 cost time: 1.3511550426483154
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0059618  Vali Loss: 0.0620452 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9829978  Vali macro F1 0.9813464 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9966063  Test weighted F1: 0.9966018  Test macro F1 0.9961249 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1125747
pruned model Parameter : 1128786
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.5929999351501465
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0084168  Vali Loss: 0.0643123 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858583  Vali macro F1 0.9837602 
Validation loss decreased (inf --> 0.064312).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.584442377090454
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0071317  Vali Loss: 0.0615357 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830339  Vali macro F1 0.9813803 
new best score!!!!
Validation loss decreased (0.064312 --> 0.061536).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 1.5936026573181152
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0082123  Vali Loss: 0.0629506 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858462  Vali macro F1 0.9844280 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 1.5896050930023193
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0067650  Vali Loss: 0.0649655 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858614  Vali macro F1 0.9824465 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 1.5943310260772705
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0064045  Vali Loss: 0.0614315 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858462  Vali macro F1 0.9844280 
new best score!!!!
Validation loss decreased (0.061536 --> 0.061432).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 1.590904951095581
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0058597  Vali Loss: 0.0646236 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886715  Vali macro F1 0.9868086 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 1.5958285331726074
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0060321  Vali Loss: 0.0676439 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858462  Vali macro F1 0.9844280 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 1.5885646343231201
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0048356  Vali Loss: 0.0707597 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858462  Vali macro F1 0.9844280 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 1.5957822799682617
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0046880  Vali Loss: 0.0706871 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858462  Vali macro F1 0.9844253 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 1.5908467769622803
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0056975  Vali Loss: 0.0708148 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830226  Vali macro F1 0.9820461 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 11 cost time: 1.5958280563354492
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0039351  Vali Loss: 0.0711159 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830226  Vali macro F1 0.9820461 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 1.5892961025238037
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0040166  Vali Loss: 0.0723354 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830226  Vali macro F1 0.9820461 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 1.5960109233856201
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0033338  Vali Loss: 0.0719864 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830226  Vali macro F1 0.9820461 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 1.5891838073730469
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0035287  Vali Loss: 0.0766409 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830226  Vali macro F1 0.9820461 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 1.5940759181976318
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0046017  Vali Loss: 0.0742578 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830226  Vali macro F1 0.9820461 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 16 cost time: 1.5888712406158447
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0037936  Vali Loss: 0.0745789 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830226  Vali macro F1 0.9820461 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 1.5990843772888184
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0032537  Vali Loss: 0.0751918 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830226  Vali macro F1 0.9820461 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 1.5907268524169922
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0031276  Vali Loss: 0.0760807 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830226  Vali macro F1 0.9820461 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 1.595841884613037
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0036679  Vali Loss: 0.0761661 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830226  Vali macro F1 0.9820461 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 1.5912470817565918
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0029937  Vali Loss: 0.0764091 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830226  Vali macro F1 0.9820461 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9966063  Test weighted F1: 0.9965958  Test macro F1 0.9972744 
================ the 2 th CV Experiment ================ 
Overlapping random Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.00274725 0.00243309 0.00232558 0.00318471 0.00578035 0.00609756
 0.00320513 0.00299401 0.002331   0.00393701]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.3512234687805176
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.1247964  Vali Loss: 1.5162024 Vali Accuracy: 0.4830508  Vali weighted F1: 0.4745008  Vali macro F1 0.4279889 
Validation loss decreased (inf --> 1.516202).  Saving model ...
Epoch: 2 cost time: 1.3500745296478271
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.1581510  Vali Loss: 0.8061070 Vali Accuracy: 0.6440678  Vali weighted F1: 0.6371823  Vali macro F1 0.6243011 
new best score!!!!
Validation loss decreased (1.516202 --> 0.806107).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.3497447967529297
VALI: Epoch: 3, Steps: 13 | Train Loss: 0.6747521  Vali Loss: 0.5052275 Vali Accuracy: 0.8163842  Vali weighted F1: 0.7950372  Vali macro F1 0.7600102 
new best score!!!!
Validation loss decreased (0.806107 --> 0.505228).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.3480277061462402
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.4487803  Vali Loss: 0.3546555 Vali Accuracy: 0.8728814  Vali weighted F1: 0.8533568  Vali macro F1 0.8074315 
new best score!!!!
Validation loss decreased (0.505228 --> 0.354656).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.3489830493927002
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.3465993  Vali Loss: 0.2750788 Vali Accuracy: 0.9011299  Vali weighted F1: 0.8806085  Vali macro F1 0.8340600 
new best score!!!!
Validation loss decreased (0.354656 --> 0.275079).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.3497767448425293
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.2574565  Vali Loss: 0.2232712 Vali Accuracy: 0.8983051  Vali weighted F1: 0.8843099  Vali macro F1 0.8445992 
new best score!!!!
Validation loss decreased (0.275079 --> 0.223271).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.3517837524414062
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.2098036  Vali Loss: 0.1994545 Vali Accuracy: 0.9152542  Vali weighted F1: 0.9050516  Vali macro F1 0.8673075 
new best score!!!!
Validation loss decreased (0.223271 --> 0.199454).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.3501148223876953
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.1745214  Vali Loss: 0.1698839 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9337450  Vali macro F1 0.9046232 
new best score!!!!
Validation loss decreased (0.199454 --> 0.169884).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.3550231456756592
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.1447607  Vali Loss: 0.1616362 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9193342  Vali macro F1 0.8791747 
new best score!!!!
Validation loss decreased (0.169884 --> 0.161636).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.3537282943725586
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.1385922  Vali Loss: 0.1573768 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9063255  Vali macro F1 0.8588927 
new best score!!!!
Validation loss decreased (0.161636 --> 0.157377).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.3489875793457031
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.1239209  Vali Loss: 0.1534841 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9455806  Vali macro F1 0.9226924 
new best score!!!!
Validation loss decreased (0.157377 --> 0.153484).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.3480260372161865
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1163858  Vali Loss: 0.1511132 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9412117  Vali macro F1 0.9194513 
new best score!!!!
Validation loss decreased (0.153484 --> 0.151113).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.3489799499511719
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1066079  Vali Loss: 0.1402939 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9407302  Vali macro F1 0.9173652 
new best score!!!!
Validation loss decreased (0.151113 --> 0.140294).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.3512306213378906
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0924811  Vali Loss: 0.1534643 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9069770  Vali macro F1 0.8701822 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 1.3518602848052979
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0913116  Vali Loss: 0.1541022 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9447215  Vali macro F1 0.9224267 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 16 cost time: 1.3559613227844238
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0918851  Vali Loss: 0.1285256 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9549133  Vali macro F1 0.9387326 
new best score!!!!
Validation loss decreased (0.140294 --> 0.128526).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.3578743934631348
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0810644  Vali Loss: 0.1371600 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9239994  Vali macro F1 0.8929072 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 1.3545241355895996
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0665570  Vali Loss: 0.1040250 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9688350  Vali macro F1 0.9570034 
new best score!!!!
Validation loss decreased (0.128526 --> 0.104025).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.3534958362579346
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0637796  Vali Loss: 0.1146687 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9571005  Vali macro F1 0.9421639 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 1.3540408611297607
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0600261  Vali Loss: 0.0972940 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9688370  Vali macro F1 0.9577109 
new best score!!!!
Validation loss decreased (0.104025 --> 0.097294).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.3571176528930664
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0519243  Vali Loss: 0.0916447 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9689048  Vali macro F1 0.9599139 
new best score!!!!
Validation loss decreased (0.097294 --> 0.091645).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.3578190803527832
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0498420  Vali Loss: 0.0794626 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830690  Vali macro F1 0.9815736 
new best score!!!!
Validation loss decreased (0.091645 --> 0.079463).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.3536980152130127
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0461463  Vali Loss: 0.0938528 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9693016  Vali macro F1 0.9601646 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 1.354964256286621
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0422464  Vali Loss: 0.0790695 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802287  Vali macro F1 0.9759500 
new best score!!!!
Validation loss decreased (0.079463 --> 0.079070).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.3535661697387695
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0398082  Vali Loss: 0.0613248 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886715  Vali macro F1 0.9868086 
new best score!!!!
Validation loss decreased (0.079070 --> 0.061325).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.3576908111572266
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0265926  Vali Loss: 0.0578841 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859177  Vali macro F1 0.9843407 
new best score!!!!
Validation loss decreased (0.061325 --> 0.057884).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.3565354347229004
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0312960  Vali Loss: 0.0822268 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9746111  Vali macro F1 0.9650349 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 1.3564186096191406
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0331711  Vali Loss: 0.0507374 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886552  Vali macro F1 0.9867576 
new best score!!!!
Validation loss decreased (0.057884 --> 0.050737).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.3548245429992676
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0192735  Vali Loss: 0.0754205 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802974  Vali macro F1 0.9756413 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 1.356933832168579
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0159379  Vali Loss: 0.0479370 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914896  Vali macro F1 0.9912085 
new best score!!!!
Validation loss decreased (0.050737 --> 0.047937).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 1.3559174537658691
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0186438  Vali Loss: 0.0875952 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858663  Vali macro F1 0.9845713 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 1.3541693687438965
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0193665  Vali Loss: 0.0929859 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9748775  Vali macro F1 0.9662925 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 33 cost time: 1.3540046215057373
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0183444  Vali Loss: 0.0683623 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801771  Vali macro F1 0.9779597 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 34 cost time: 1.3587918281555176
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0158654  Vali Loss: 0.0619682 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859105  Vali macro F1 0.9863599 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 35 cost time: 1.3548455238342285
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0202303  Vali Loss: 0.0603509 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858663  Vali macro F1 0.9845713 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 36 cost time: 1.3816578388214111
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0144208  Vali Loss: 0.0529863 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887007  Vali macro F1 0.9890222 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 1.3674814701080322
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0100572  Vali Loss: 0.0556711 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887007  Vali macro F1 0.9890222 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 1.3594894409179688
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0087784  Vali Loss: 0.0514804 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887007  Vali macro F1 0.9890222 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 1.3546452522277832
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0079449  Vali Loss: 0.0496679 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887007  Vali macro F1 0.9890222 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 40 cost time: 1.3548672199249268
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0083374  Vali Loss: 0.0495711 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887007  Vali macro F1 0.9890222 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 41 cost time: 1.3569822311401367
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0077025  Vali Loss: 0.0495824 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887007  Vali macro F1 0.9890222 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 1.356149435043335
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0079140  Vali Loss: 0.0496600 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887007  Vali macro F1 0.9890222 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 1.3545231819152832
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0082456  Vali Loss: 0.0496748 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887007  Vali macro F1 0.9890222 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 1.3510308265686035
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0078569  Vali Loss: 0.0496059 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887007  Vali macro F1 0.9890222 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 45 cost time: 1.351093053817749
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0092858  Vali Loss: 0.0495151 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887007  Vali macro F1 0.9890222 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9852941  Test weighted F1: 0.9853499  Test macro F1 0.9819441 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1125747
pruned model Parameter : 1128786
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.5798993110656738
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0121731  Vali Loss: 0.0524452 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831288  Vali macro F1 0.9821545 
Validation loss decreased (inf --> 0.052445).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.5782005786895752
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0112613  Vali Loss: 0.0515182 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859177  Vali macro F1 0.9843407 
new best score!!!!
Validation loss decreased (0.052445 --> 0.051518).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 1.577028512954712
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0101080  Vali Loss: 0.0509917 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859284  Vali macro F1 0.9850673 
new best score!!!!
Validation loss decreased (0.051518 --> 0.050992).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 1.577446460723877
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0095394  Vali Loss: 0.0550490 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831416  Vali macro F1 0.9810660 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 1.5779783725738525
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0083763  Vali Loss: 0.0547807 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887358  Vali macro F1 0.9887405 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 1.578554391860962
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0089116  Vali Loss: 0.0521920 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887358  Vali macro F1 0.9887405 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 1.5804424285888672
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0088153  Vali Loss: 0.0578084 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831288  Vali macro F1 0.9821545 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 8 cost time: 1.5777406692504883
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0087298  Vali Loss: 0.0816963 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859014  Vali macro F1 0.9842896 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 9 cost time: 1.5739669799804688
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0106297  Vali Loss: 0.0603490 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859469  Vali macro F1 0.9865543 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 1.577746868133545
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0077789  Vali Loss: 0.0603030 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859469  Vali macro F1 0.9865543 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 1.5760972499847412
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0066228  Vali Loss: 0.0552456 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859469  Vali macro F1 0.9865543 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 1.5751760005950928
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0071911  Vali Loss: 0.0538906 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859469  Vali macro F1 0.9865543 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 1.576395034790039
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0061270  Vali Loss: 0.0662910 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858941  Vali macro F1 0.9853497 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 14 cost time: 1.5765576362609863
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0074508  Vali Loss: 0.0654141 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858941  Vali macro F1 0.9853497 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 1.5798871517181396
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0060949  Vali Loss: 0.0636831 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858941  Vali macro F1 0.9853497 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 1.5779814720153809
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0063759  Vali Loss: 0.0631136 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858941  Vali macro F1 0.9853497 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 1.5814781188964844
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0063135  Vali Loss: 0.0633094 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858941  Vali macro F1 0.9853497 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 1.5797827243804932
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0059533  Vali Loss: 0.0627816 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858941  Vali macro F1 0.9853497 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9819005  Test weighted F1: 0.9819110  Test macro F1 0.9783482 
================ the 3 th CV Experiment ================ 
Overlapping random Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00280899 0.0023753  0.00248139 0.00325733 0.00568182 0.00568182
 0.00302115 0.00291545 0.00233645 0.00409836]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.3565878868103027
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.1107466  Vali Loss: 1.4869106 Vali Accuracy: 0.5282486  Vali weighted F1: 0.4987987  Vali macro F1 0.4693460 
Validation loss decreased (inf --> 1.486911).  Saving model ...
Epoch: 2 cost time: 1.3534502983093262
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.1254267  Vali Loss: 0.7529980 Vali Accuracy: 0.7062147  Vali weighted F1: 0.6967144  Vali macro F1 0.6669712 
new best score!!!!
Validation loss decreased (1.486911 --> 0.752998).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.355393409729004
VALI: Epoch: 3, Steps: 13 | Train Loss: 0.6548185  Vali Loss: 0.4923585 Vali Accuracy: 0.8333333  Vali weighted F1: 0.8287557  Vali macro F1 0.8013535 
new best score!!!!
Validation loss decreased (0.752998 --> 0.492359).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.3514931201934814
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.4432118  Vali Loss: 0.3373408 Vali Accuracy: 0.8785311  Vali weighted F1: 0.8736635  Vali macro F1 0.8515342 
new best score!!!!
Validation loss decreased (0.492359 --> 0.337341).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.3534045219421387
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.3334498  Vali Loss: 0.2658306 Vali Accuracy: 0.9096045  Vali weighted F1: 0.8991410  Vali macro F1 0.8623268 
new best score!!!!
Validation loss decreased (0.337341 --> 0.265831).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.3543405532836914
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.2654853  Vali Loss: 0.2455711 Vali Accuracy: 0.8926554  Vali weighted F1: 0.8864127  Vali macro F1 0.8617612 
new best score!!!!
Validation loss decreased (0.265831 --> 0.245571).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.3522379398345947
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.2280511  Vali Loss: 0.2162600 Vali Accuracy: 0.8954802  Vali weighted F1: 0.8820633  Vali macro F1 0.8487590 
new best score!!!!
Validation loss decreased (0.245571 --> 0.216260).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.3539009094238281
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.1990349  Vali Loss: 0.1871379 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9276566  Vali macro F1 0.8983047 
new best score!!!!
Validation loss decreased (0.216260 --> 0.187138).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.3527302742004395
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.1665470  Vali Loss: 0.1767158 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9236640  Vali macro F1 0.8954535 
new best score!!!!
Validation loss decreased (0.187138 --> 0.176716).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.3532719612121582
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.1456812  Vali Loss: 0.1560030 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9431856  Vali macro F1 0.9192177 
new best score!!!!
Validation loss decreased (0.176716 --> 0.156003).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.3533291816711426
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.1253164  Vali Loss: 0.1482926 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9404498  Vali macro F1 0.9128891 
new best score!!!!
Validation loss decreased (0.156003 --> 0.148293).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.352576494216919
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1115375  Vali Loss: 0.1507038 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9098494  Vali macro F1 0.8738216 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 1.3515732288360596
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1078078  Vali Loss: 0.1340667 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9404752  Vali macro F1 0.9134379 
new best score!!!!
Validation loss decreased (0.148293 --> 0.134067).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.352846384048462
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0941164  Vali Loss: 0.1611479 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9070673  Vali macro F1 0.8711706 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 1.3540337085723877
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0975376  Vali Loss: 0.1391642 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9528601  Vali macro F1 0.9312405 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 16 cost time: 1.3519835472106934
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0865997  Vali Loss: 0.1245410 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9546944  Vali macro F1 0.9374553 
new best score!!!!
Validation loss decreased (0.134067 --> 0.124541).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.3517239093780518
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0796107  Vali Loss: 0.1119495 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9632426  Vali macro F1 0.9535207 
new best score!!!!
Validation loss decreased (0.124541 --> 0.111950).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.3531970977783203
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0675889  Vali Loss: 0.1141378 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9536258  Vali macro F1 0.9357208 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 1.3504681587219238
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0626717  Vali Loss: 0.1744618 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9092191  Vali macro F1 0.8746758 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 1.352074146270752
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0721272  Vali Loss: 0.1070374 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9633738  Vali macro F1 0.9529872 
new best score!!!!
Validation loss decreased (0.111950 --> 0.107037).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.353761911392212
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0557724  Vali Loss: 0.0988737 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9661969  Vali macro F1 0.9547969 
new best score!!!!
Validation loss decreased (0.107037 --> 0.098874).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.3596549034118652
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0516119  Vali Loss: 0.1008729 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9689860  Vali macro F1 0.9617535 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 1.3535375595092773
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0560686  Vali Loss: 0.1202989 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9595717  Vali macro F1 0.9421053 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 24 cost time: 1.3696725368499756
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0507843  Vali Loss: 0.0866851 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9719628  Vali macro F1 0.9670681 
new best score!!!!
Validation loss decreased (0.098874 --> 0.086685).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.3547766208648682
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0378249  Vali Loss: 0.0871063 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803101  Vali macro F1 0.9764010 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 1.3510947227478027
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0304346  Vali Loss: 0.0835136 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9775445  Vali macro F1 0.9737895 
new best score!!!!
Validation loss decreased (0.086685 --> 0.083514).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.352614164352417
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0280634  Vali Loss: 0.0762010 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9776735  Vali macro F1 0.9722930 
new best score!!!!
Validation loss decreased (0.083514 --> 0.076201).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 1.3546228408813477
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0252172  Vali Loss: 0.0675098 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858794  Vali macro F1 0.9843979 
new best score!!!!
Validation loss decreased (0.076201 --> 0.067510).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.3545782566070557
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0230940  Vali Loss: 0.0791375 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773949  Vali macro F1 0.9695483 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 1.3508765697479248
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0171573  Vali Loss: 0.0898689 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9748709  Vali macro F1 0.9681198 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 1.3523435592651367
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0169692  Vali Loss: 0.0582258 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886976  Vali macro F1 0.9887978 
new best score!!!!
Validation loss decreased (0.067510 --> 0.058226).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 1.3505144119262695
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0167432  Vali Loss: 0.0672957 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830442  Vali macro F1 0.9820091 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 1.351067304611206
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0150951  Vali Loss: 0.0589616 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886760  Vali macro F1 0.9880622 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 1.3508579730987549
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0220450  Vali Loss: 0.0945789 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9690949  Vali macro F1 0.9633499 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 35 cost time: 1.3546879291534424
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0257321  Vali Loss: 0.0903903 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9800508  Vali macro F1 0.9767894 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 36 cost time: 1.3510258197784424
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0195250  Vali Loss: 0.0646948 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858206  Vali macro F1 0.9855282 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 37 cost time: 1.3520936965942383
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0109021  Vali Loss: 0.0636024 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887437  Vali macro F1 0.9883500 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 1.3529276847839355
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0113542  Vali Loss: 0.0610463 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886976  Vali macro F1 0.9887978 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 1.351658821105957
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0102011  Vali Loss: 0.0578058 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859089  Vali macro F1 0.9851690 
new best score!!!!
Validation loss decreased (0.058226 --> 0.057806).  Saving model ...
new best score!!!!
Epoch: 40 cost time: 1.3533272743225098
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0105303  Vali Loss: 0.0575667 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859089  Vali macro F1 0.9851690 
new best score!!!!
Validation loss decreased (0.057806 --> 0.057567).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 1.3537976741790771
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0101992  Vali Loss: 0.0569794 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886722  Vali macro F1 0.9882489 
new best score!!!!
Validation loss decreased (0.057567 --> 0.056979).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 1.353761911392212
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0094562  Vali Loss: 0.0564686 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886722  Vali macro F1 0.9882489 
new best score!!!!
Validation loss decreased (0.056979 --> 0.056469).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 1.351386547088623
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0081707  Vali Loss: 0.0552468 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887001  Vali macro F1 0.9875216 
new best score!!!!
Validation loss decreased (0.056469 --> 0.055247).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 1.3538882732391357
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0072628  Vali Loss: 0.0538195 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914634  Vali macro F1 0.9906015 
new best score!!!!
Validation loss decreased (0.055247 --> 0.053819).  Saving model ...
new best score!!!!
Epoch: 45 cost time: 1.3520798683166504
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0071943  Vali Loss: 0.0538303 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914634  Vali macro F1 0.9906015 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 46 cost time: 1.3516151905059814
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0075393  Vali Loss: 0.0547320 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887001  Vali macro F1 0.9875216 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 47 cost time: 1.351289987564087
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0074826  Vali Loss: 0.0547789 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887001  Vali macro F1 0.9875216 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 48 cost time: 1.3515684604644775
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0068520  Vali Loss: 0.0539527 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887001  Vali macro F1 0.9875216 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 49 cost time: 1.3556218147277832
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0080776  Vali Loss: 0.0531541 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887382  Vali macro F1 0.9874619 
new best score!!!!
Validation loss decreased (0.053819 --> 0.053154).  Saving model ...
new best score!!!!
Epoch: 50 cost time: 1.3533062934875488
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0069440  Vali Loss: 0.0538116 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887001  Vali macro F1 0.9875216 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 51 cost time: 1.3545863628387451
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0061438  Vali Loss: 0.0535345 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887001  Vali macro F1 0.9875216 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 52 cost time: 1.3532829284667969
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0068465  Vali Loss: 0.0550162 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887382  Vali macro F1 0.9874619 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 53 cost time: 1.3705689907073975
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0072887  Vali Loss: 0.0530757 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887480  Vali macro F1 0.9879768 
new best score!!!!
Validation loss decreased (0.053154 --> 0.053076).  Saving model ...
new best score!!!!
Epoch: 54 cost time: 1.3539745807647705
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0057144  Vali Loss: 0.0525712 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887480  Vali macro F1 0.9879768 
new best score!!!!
Validation loss decreased (0.053076 --> 0.052571).  Saving model ...
new best score!!!!
Epoch: 55 cost time: 1.3569328784942627
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0067948  Vali Loss: 0.0530368 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887480  Vali macro F1 0.9879768 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 56 cost time: 1.3527183532714844
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0060626  Vali Loss: 0.0528646 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887480  Vali macro F1 0.9879768 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 57 cost time: 1.3524694442749023
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0059468  Vali Loss: 0.0531850 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887382  Vali macro F1 0.9874619 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 58 cost time: 1.3511497974395752
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0065881  Vali Loss: 0.0544012 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887382  Vali macro F1 0.9874619 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 59 cost time: 1.354722499847412
VALI: Epoch: 59, Steps: 13 | Train Loss: 0.0060329  Vali Loss: 0.0579029 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859201  Vali macro F1 0.9830621 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 60 cost time: 1.3523573875427246
VALI: Epoch: 60, Steps: 13 | Train Loss: 0.0056510  Vali Loss: 0.0567581 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859201  Vali macro F1 0.9830621 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 61 cost time: 1.3523390293121338
VALI: Epoch: 61, Steps: 13 | Train Loss: 0.0056963  Vali Loss: 0.0559065 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859201  Vali macro F1 0.9830621 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 62 cost time: 1.3517193794250488
VALI: Epoch: 62, Steps: 13 | Train Loss: 0.0061131  Vali Loss: 0.0553231 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859201  Vali macro F1 0.9830621 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 63 cost time: 1.3536059856414795
VALI: Epoch: 63, Steps: 13 | Train Loss: 0.0062262  Vali Loss: 0.0547523 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887480  Vali macro F1 0.9879768 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 64 cost time: 1.3533554077148438
VALI: Epoch: 64, Steps: 13 | Train Loss: 0.0057522  Vali Loss: 0.0544379 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887480  Vali macro F1 0.9879768 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 65 cost time: 1.3538084030151367
VALI: Epoch: 65, Steps: 13 | Train Loss: 0.0059318  Vali Loss: 0.0544132 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887480  Vali macro F1 0.9879768 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 66 cost time: 1.352621078491211
VALI: Epoch: 66, Steps: 13 | Train Loss: 0.0058818  Vali Loss: 0.0543866 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887480  Vali macro F1 0.9879768 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 67 cost time: 1.353494644165039
VALI: Epoch: 67, Steps: 13 | Train Loss: 0.0063254  Vali Loss: 0.0543533 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887480  Vali macro F1 0.9879768 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 68 cost time: 1.3528521060943604
VALI: Epoch: 68, Steps: 13 | Train Loss: 0.0066494  Vali Loss: 0.0543100 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887480  Vali macro F1 0.9879768 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 69 cost time: 1.351332426071167
VALI: Epoch: 69, Steps: 13 | Train Loss: 0.0056450  Vali Loss: 0.0542689 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887480  Vali macro F1 0.9879768 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9875566  Test weighted F1: 0.9875388  Test macro F1 0.9827855 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1125747
pruned model Parameter : 1128786
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.5964734554290771
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0059577  Vali Loss: 0.0532666 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859236  Vali macro F1 0.9855956 
Validation loss decreased (inf --> 0.053267).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.5981435775756836
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0065563  Vali Loss: 0.0582221 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859236  Vali macro F1 0.9855956 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.5970873832702637
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0059646  Vali Loss: 0.0617062 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831347  Vali macro F1 0.9834093 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 1.5958616733551025
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0050356  Vali Loss: 0.0591910 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859259  Vali macro F1 0.9857619 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 1.5961410999298096
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0060011  Vali Loss: 0.0596720 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803415  Vali macro F1 0.9810564 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 1.5958888530731201
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0045535  Vali Loss: 0.0602428 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831347  Vali macro F1 0.9834093 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 1.5957987308502197
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0045634  Vali Loss: 0.0620130 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803166  Vali macro F1 0.9790095 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 1.5961277484893799
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0046085  Vali Loss: 0.0590252 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859236  Vali macro F1 0.9855956 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 1.5969274044036865
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0045485  Vali Loss: 0.0582003 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859236  Vali macro F1 0.9855956 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 1.596642255783081
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0049840  Vali Loss: 0.0618776 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831078  Vali macro F1 0.9813621 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 11 cost time: 1.5951924324035645
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0044991  Vali Loss: 0.0611386 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831078  Vali macro F1 0.9813621 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 1.5954210758209229
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0042374  Vali Loss: 0.0604062 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859259  Vali macro F1 0.9857619 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 1.5950994491577148
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0039126  Vali Loss: 0.0602649 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859259  Vali macro F1 0.9857619 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 1.5957214832305908
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0040114  Vali Loss: 0.0601090 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859259  Vali macro F1 0.9857619 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 1.5945019721984863
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0046852  Vali Loss: 0.0598316 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859259  Vali macro F1 0.9857619 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 16 cost time: 1.5974206924438477
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0034147  Vali Loss: 0.0598072 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859259  Vali macro F1 0.9857619 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9852941  Test weighted F1: 0.9852896  Test macro F1 0.9796459 
================ the 4 th CV Experiment ================ 
Overlapping random Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.00282486 0.00235294 0.00242718 0.00328947 0.00549451 0.00552486
 0.00319489 0.00276243 0.00244499 0.00416667]
Train data number :  3182
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  887
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.3560333251953125
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.0935299  Vali Loss: 1.4091116 Vali Accuracy: 0.5593220  Vali weighted F1: 0.5514314  Vali macro F1 0.4976331 
Validation loss decreased (inf --> 1.409112).  Saving model ...
Epoch: 2 cost time: 1.355046272277832
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.0980630  Vali Loss: 0.6572912 Vali Accuracy: 0.7683616  Vali weighted F1: 0.7558215  Vali macro F1 0.7066240 
new best score!!!!
Validation loss decreased (1.409112 --> 0.657291).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.3518486022949219
VALI: Epoch: 3, Steps: 13 | Train Loss: 0.6320355  Vali Loss: 0.4420720 Vali Accuracy: 0.8502825  Vali weighted F1: 0.8381637  Vali macro F1 0.7705574 
new best score!!!!
Validation loss decreased (0.657291 --> 0.442072).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.3517847061157227
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.4341567  Vali Loss: 0.3029486 Vali Accuracy: 0.9067797  Vali weighted F1: 0.9011587  Vali macro F1 0.8261678 
new best score!!!!
Validation loss decreased (0.442072 --> 0.302949).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.3507051467895508
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.3392891  Vali Loss: 0.2441080 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9290366  Vali macro F1 0.8877601 
new best score!!!!
Validation loss decreased (0.302949 --> 0.244108).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.3519258499145508
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.2793214  Vali Loss: 0.1811720 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9283122  Vali macro F1 0.8497000 
new best score!!!!
Validation loss decreased (0.244108 --> 0.181172).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.3517913818359375
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.2163927  Vali Loss: 0.1536026 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9249249  Vali macro F1 0.8448675 
new best score!!!!
Validation loss decreased (0.181172 --> 0.153603).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.3517029285430908
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.1754836  Vali Loss: 0.1159915 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9519169  Vali macro F1 0.9041529 
new best score!!!!
Validation loss decreased (0.153603 --> 0.115992).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.3514554500579834
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.1582874  Vali Loss: 0.0965446 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9616564  Vali macro F1 0.9032101 
new best score!!!!
Validation loss decreased (0.115992 --> 0.096545).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.3504793643951416
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.1394705  Vali Loss: 0.0897405 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9512033  Vali macro F1 0.8833970 
new best score!!!!
Validation loss decreased (0.096545 --> 0.089741).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.352170705795288
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.1266926  Vali Loss: 0.0884544 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9541431  Vali macro F1 0.8902882 
new best score!!!!
Validation loss decreased (0.089741 --> 0.088454).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.3526310920715332
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1247616  Vali Loss: 0.0786807 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9595172  Vali macro F1 0.8974974 
new best score!!!!
Validation loss decreased (0.088454 --> 0.078681).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.3496825695037842
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1125794  Vali Loss: 0.0723140 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9566586  Vali macro F1 0.8842857 
new best score!!!!
Validation loss decreased (0.078681 --> 0.072314).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.3509767055511475
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1053305  Vali Loss: 0.0667964 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9696112  Vali macro F1 0.9245630 
new best score!!!!
Validation loss decreased (0.072314 --> 0.066796).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.3517932891845703
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1030436  Vali Loss: 0.0732592 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9627799  Vali macro F1 0.9173414 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 1.3531734943389893
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0895498  Vali Loss: 0.0549873 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9793700  Vali macro F1 0.9454545 
new best score!!!!
Validation loss decreased (0.066796 --> 0.054987).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.3504550457000732
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0827517  Vali Loss: 0.0537559 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9800855  Vali macro F1 0.9526458 
new best score!!!!
Validation loss decreased (0.054987 --> 0.053756).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.3514976501464844
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0799035  Vali Loss: 0.0499052 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9791799  Vali macro F1 0.9499987 
new best score!!!!
Validation loss decreased (0.053756 --> 0.049905).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.3589370250701904
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0752544  Vali Loss: 0.0436889 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9820040  Vali macro F1 0.9523529 
new best score!!!!
Validation loss decreased (0.049905 --> 0.043689).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.3520538806915283
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0702493  Vali Loss: 0.0392971 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886064  Vali macro F1 0.9700000 
new best score!!!!
Validation loss decreased (0.043689 --> 0.039297).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.368809700012207
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0628955  Vali Loss: 0.0497150 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9738631  Vali macro F1 0.9318373 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 1.354515552520752
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0588735  Vali Loss: 0.0443653 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9832781  Vali macro F1 0.9585323 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 23 cost time: 1.354499340057373
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0631598  Vali Loss: 0.0314237 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886064  Vali macro F1 0.9700000 
new best score!!!!
Validation loss decreased (0.039297 --> 0.031424).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.3529202938079834
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0540345  Vali Loss: 0.0355285 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858367  Vali macro F1 0.9627586 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 1.3522305488586426
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0492050  Vali Loss: 0.0270430 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887006  Vali macro F1 0.9703297 
new best score!!!!
Validation loss decreased (0.031424 --> 0.027043).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.3595004081726074
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0347147  Vali Loss: 0.0252216 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915020  Vali macro F1 0.9776552 
new best score!!!!
Validation loss decreased (0.027043 --> 0.025222).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.3556149005889893
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0388097  Vali Loss: 0.0265276 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9888379  Vali macro F1 0.9733071 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 1.3528895378112793
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0389446  Vali Loss: 0.0413750 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9771275  Vali macro F1 0.9498231 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 1.3499457836151123
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0330889  Vali Loss: 0.0310680 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886064  Vali macro F1 0.9700000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 1.349985122680664
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0267372  Vali Loss: 0.0249663 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9851648 
new best score!!!!
Validation loss decreased (0.025222 --> 0.024966).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 1.3523738384246826
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0256669  Vali Loss: 0.0164126 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9851648 
new best score!!!!
Validation loss decreased (0.024966 --> 0.016413).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 1.350945234298706
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0226473  Vali Loss: 0.0166427 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943828  Vali macro F1 0.9877100 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 1.3512725830078125
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0173297  Vali Loss: 0.0172834 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914553  Vali macro F1 0.9776552 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 1.3494987487792969
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0176643  Vali Loss: 0.0234341 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914553  Vali macro F1 0.9776552 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 35 cost time: 1.3503320217132568
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0199193  Vali Loss: 0.0159917 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9913828  Vali macro F1 0.9772791 
new best score!!!!
Validation loss decreased (0.016413 --> 0.015992).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 1.3506407737731934
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0188371  Vali Loss: 0.0134087 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943828  Vali macro F1 0.9877100 
new best score!!!!
Validation loss decreased (0.015992 --> 0.013409).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 1.3531494140625
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0149982  Vali Loss: 0.0196983 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9944835  Vali macro F1 0.9880040 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 1.351424217224121
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0153255  Vali Loss: 0.0397212 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9863216  Vali macro F1 0.9772110 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 39 cost time: 1.3520402908325195
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0208095  Vali Loss: 0.0270261 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9861075  Vali macro F1 0.9707589 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 40 cost time: 1.3512377738952637
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0169714  Vali Loss: 0.0276618 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9860569  Vali macro F1 0.9660549 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 41 cost time: 1.3516218662261963
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0129220  Vali Loss: 0.0173173 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9916661  Vali macro F1 0.9805966 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 42 cost time: 1.3529717922210693
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0094847  Vali Loss: 0.0120049 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943828  Vali macro F1 0.9877100 
new best score!!!!
Validation loss decreased (0.013409 --> 0.012005).  Saving model ...
new best score!!!!
Epoch: 43 cost time: 1.3518333435058594
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0081861  Vali Loss: 0.0099559 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.012005 --> 0.009956).  Saving model ...
new best score!!!!
Epoch: 44 cost time: 1.3510570526123047
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0069411  Vali Loss: 0.0105965 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9925926 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 1.349776268005371
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0073121  Vali Loss: 0.0120944 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9925926 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 1.3563315868377686
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0059961  Vali Loss: 0.0111980 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9925926 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 1.3532071113586426
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0060456  Vali Loss: 0.0117534 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9925926 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 1.3680312633514404
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0058768  Vali Loss: 0.0106955 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9925926 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 49 cost time: 1.3498179912567139
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0061351  Vali Loss: 0.0106377 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9925926 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 1.3509862422943115
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0057682  Vali Loss: 0.0106057 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9925926 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 1.3492145538330078
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0066522  Vali Loss: 0.0106037 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9925926 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 1.352107286453247
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0057324  Vali Loss: 0.0107681 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9925926 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 1.3517203330993652
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0054019  Vali Loss: 0.0108868 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9925926 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 54 cost time: 1.351250171661377
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0068667  Vali Loss: 0.0108575 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9925926 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 55 cost time: 1.3503172397613525
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0054272  Vali Loss: 0.0108426 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9925926 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 56 cost time: 1.3506574630737305
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0055423  Vali Loss: 0.0108330 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9925926 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 57 cost time: 1.351820468902588
VALI: Epoch: 57, Steps: 13 | Train Loss: 0.0060835  Vali Loss: 0.0108262 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9925926 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 58 cost time: 1.350494384765625
VALI: Epoch: 58, Steps: 13 | Train Loss: 0.0061349  Vali Loss: 0.0108705 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9925926 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9909808  Test weighted F1: 0.9910050  Test macro F1 0.9905767 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1125747
pruned model Parameter : 1128786
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.5909183025360107
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0058899  Vali Loss: 0.0079862 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9851648 
Validation loss decreased (inf --> 0.007986).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.5905210971832275
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0052525  Vali Loss: 0.0147941 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9925926 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.5914270877838135
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0049273  Vali Loss: 0.0077230 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943032  Vali macro F1 0.9850000 
new best score!!!!
Validation loss decreased (0.007986 --> 0.007723).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 1.5900797843933105
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0067248  Vali Loss: 0.0116800 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9925926 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 1.5884747505187988
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0070764  Vali Loss: 0.0151489 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9925926 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 1.591520071029663
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0041965  Vali Loss: 0.0164416 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943348  Vali macro F1 0.9851648 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 1.5882439613342285
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0042955  Vali Loss: 0.0089377 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9925926 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 8 cost time: 1.590791940689087
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0041847  Vali Loss: 0.0131193 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943348  Vali macro F1 0.9851648 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 9 cost time: 1.591566801071167
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0041843  Vali Loss: 0.0140168 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9851648 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 1.5901193618774414
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0041878  Vali Loss: 0.0088747 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9925926 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 1.5920603275299072
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0040358  Vali Loss: 0.0142777 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943348  Vali macro F1 0.9851648 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 1.5872125625610352
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0037120  Vali Loss: 0.0122024 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9925926 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 1.591132402420044
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0035032  Vali Loss: 0.0148505 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9925926 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 14 cost time: 1.5925204753875732
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0032350  Vali Loss: 0.0144795 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9925926 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 1.5905678272247314
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0032273  Vali Loss: 0.0142388 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9925926 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 1.5973219871520996
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0030272  Vali Loss: 0.0140598 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9925926 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 1.5904638767242432
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0030714  Vali Loss: 0.0128517 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9925926 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 1.5926151275634766
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0035309  Vali Loss: 0.0117216 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9925926 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9864713  Test weighted F1: 0.9865326  Test macro F1 0.9844981 
Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 1125747
Set the seed as :  4
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
================ SOCV Mode ====================
================ 5 CV ======================
================ the 0 th CV Experiment ================ 
Overlapping random Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.00278552 0.00240385 0.00239808 0.00333333 0.00561798 0.00591716
 0.003125   0.00287356 0.00234192 0.00398406]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.4053776264190674
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.1029740  Vali Loss: 1.6278122 Vali Accuracy: 0.4011299  Vali weighted F1: 0.3334493  Vali macro F1 0.3489871 
Validation loss decreased (inf --> 1.627812).  Saving model ...
Epoch: 2 cost time: 1.3594040870666504
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.1155685  Vali Loss: 0.7984874 Vali Accuracy: 0.7316384  Vali weighted F1: 0.7297537  Vali macro F1 0.7320890 
new best score!!!!
Validation loss decreased (1.627812 --> 0.798487).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.358959674835205
VALI: Epoch: 3, Steps: 13 | Train Loss: 0.6519712  Vali Loss: 0.5204181 Vali Accuracy: 0.8333333  Vali weighted F1: 0.8287058  Vali macro F1 0.8149901 
new best score!!!!
Validation loss decreased (0.798487 --> 0.520418).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.3569285869598389
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.4381476  Vali Loss: 0.3872649 Vali Accuracy: 0.8644068  Vali weighted F1: 0.8532546  Vali macro F1 0.8304375 
new best score!!!!
Validation loss decreased (0.520418 --> 0.387265).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.3582696914672852
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.3268037  Vali Loss: 0.3125966 Vali Accuracy: 0.8898305  Vali weighted F1: 0.8886910  Vali macro F1 0.8697639 
new best score!!!!
Validation loss decreased (0.387265 --> 0.312597).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.3604202270507812
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.2569864  Vali Loss: 0.2526218 Vali Accuracy: 0.9096045  Vali weighted F1: 0.8911072  Vali macro F1 0.8621858 
new best score!!!!
Validation loss decreased (0.312597 --> 0.252622).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.3576717376708984
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.2086328  Vali Loss: 0.2155865 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9201467  Vali macro F1 0.9008241 
new best score!!!!
Validation loss decreased (0.252622 --> 0.215587).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.3544929027557373
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.1700019  Vali Loss: 0.1957768 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9348024  Vali macro F1 0.9205818 
new best score!!!!
Validation loss decreased (0.215587 --> 0.195777).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.356642246246338
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.1434139  Vali Loss: 0.1840942 Vali Accuracy: 0.9180791  Vali weighted F1: 0.9022592  Vali macro F1 0.8758904 
new best score!!!!
Validation loss decreased (0.195777 --> 0.184094).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.3593685626983643
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.1252224  Vali Loss: 0.1640678 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9342531  Vali macro F1 0.9134027 
new best score!!!!
Validation loss decreased (0.184094 --> 0.164068).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.3558125495910645
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.1156303  Vali Loss: 0.1735673 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9274772  Vali macro F1 0.9074143 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 1.3563165664672852
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1116435  Vali Loss: 0.1512949 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9193633  Vali macro F1 0.8932744 
new best score!!!!
Validation loss decreased (0.164068 --> 0.151295).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.3572876453399658
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1026238  Vali Loss: 0.1289736 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9497505  Vali macro F1 0.9361016 
new best score!!!!
Validation loss decreased (0.151295 --> 0.128974).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.357093095779419
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1091678  Vali Loss: 0.1320663 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9546492  Vali macro F1 0.9425001 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 1.3577914237976074
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0988239  Vali Loss: 0.1246084 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9624813  Vali macro F1 0.9551847 
new best score!!!!
Validation loss decreased (0.128974 --> 0.124608).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.35801362991333
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.1032444  Vali Loss: 0.1335845 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745230  Vali macro F1 0.9715741 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 1.354785442352295
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0950072  Vali Loss: 0.1151955 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9628194  Vali macro F1 0.9509762 
new best score!!!!
Validation loss decreased (0.124608 --> 0.115196).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.3572113513946533
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0753418  Vali Loss: 0.0885971 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9744327  Vali macro F1 0.9710729 
new best score!!!!
Validation loss decreased (0.115196 --> 0.088597).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.3574576377868652
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0659035  Vali Loss: 0.0915270 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9772349  Vali macro F1 0.9735417 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 1.3557472229003906
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0639378  Vali Loss: 0.0833876 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773195  Vali macro F1 0.9736569 
new best score!!!!
Validation loss decreased (0.088597 --> 0.083388).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.359351396560669
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0606714  Vali Loss: 0.1191616 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9772374  Vali macro F1 0.9748917 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 1.364448070526123
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0533756  Vali Loss: 0.0479434 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830294  Vali macro F1 0.9799583 
new best score!!!!
Validation loss decreased (0.083388 --> 0.047943).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.3567688465118408
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0418868  Vali Loss: 0.0463963 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886967  Vali macro F1 0.9862089 
new best score!!!!
Validation loss decreased (0.047943 --> 0.046396).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.3570797443389893
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0373043  Vali Loss: 0.0504245 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886882  Vali macro F1 0.9876631 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 1.3546838760375977
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0376693  Vali Loss: 0.0581624 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9800895  Vali macro F1 0.9759555 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 1.3715579509735107
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0348200  Vali Loss: 0.0408170 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858045  Vali macro F1 0.9821378 
new best score!!!!
Validation loss decreased (0.046396 --> 0.040817).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.3600051403045654
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0325621  Vali Loss: 0.0552587 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915171  Vali macro F1 0.9900491 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 1.3577156066894531
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0289333  Vali Loss: 0.0455701 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943456  Vali macro F1 0.9953657 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 1.3568150997161865
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0231353  Vali Loss: 0.0513926 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943463  Vali macro F1 0.9953668 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 1.355625867843628
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0211890  Vali Loss: 0.0473165 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801626  Vali macro F1 0.9777054 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 31 cost time: 1.358276605606079
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0292157  Vali Loss: 0.0398787 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943463  Vali macro F1 0.9953668 
new best score!!!!
Validation loss decreased (0.040817 --> 0.039879).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 1.3607490062713623
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0222631  Vali Loss: 0.0295785 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
new best score!!!!
Validation loss decreased (0.039879 --> 0.029578).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 1.356011152267456
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0173853  Vali Loss: 0.0211264 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943067  Vali macro F1 0.9949788 
new best score!!!!
Validation loss decreased (0.029578 --> 0.021126).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 1.3610820770263672
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0133321  Vali Loss: 0.0418655 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943463  Vali macro F1 0.9953668 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 1.3594245910644531
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0106760  Vali Loss: 0.0274603 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943492  Vali macro F1 0.9939052 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 1.3583340644836426
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0111687  Vali Loss: 0.0214258 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 1.3593153953552246
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0083339  Vali Loss: 0.0358323 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 1.358994722366333
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0097545  Vali Loss: 0.0134614 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.021126 --> 0.013461).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 1.3622193336486816
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0165245  Vali Loss: 0.0319573 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886910  Vali macro F1 0.9889714 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 1.3579976558685303
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0166334  Vali Loss: 0.0138220 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 1.357914686203003
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0130892  Vali Loss: 0.0291719 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 1.3587708473205566
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0129585  Vali Loss: 0.0363411 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943463  Vali macro F1 0.9953668 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 1.357081651687622
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0088489  Vali Loss: 0.0276479 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 44 cost time: 1.3599591255187988
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0072632  Vali Loss: 0.0270719 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 1.3594672679901123
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0060935  Vali Loss: 0.0294191 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 1.35896635055542
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0064126  Vali Loss: 0.0311619 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 1.3594632148742676
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0055440  Vali Loss: 0.0288702 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 1.3591499328613281
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0055559  Vali Loss: 0.0299145 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 49 cost time: 1.3590412139892578
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0055413  Vali Loss: 0.0303450 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 1.3562726974487305
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0053035  Vali Loss: 0.0308668 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 1.3574295043945312
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0060954  Vali Loss: 0.0315101 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 1.359724521636963
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0051175  Vali Loss: 0.0332369 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 1.363715648651123
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0061569  Vali Loss: 0.0335450 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9898190  Test weighted F1: 0.9898158  Test macro F1 0.9898521 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1125747
pruned model Parameter : 1128786
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.5932297706604004
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0085129  Vali Loss: 0.0254266 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
Validation loss decreased (inf --> 0.025427).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.5932743549346924
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0071843  Vali Loss: 0.0305812 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.5909311771392822
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0060097  Vali Loss: 0.0305149 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915171  Vali macro F1 0.9900491 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 1.591998815536499
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0055457  Vali Loss: 0.0241445 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
new best score!!!!
Validation loss decreased (0.025427 --> 0.024144).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 1.5897715091705322
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0047524  Vali Loss: 0.0306898 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915171  Vali macro F1 0.9900491 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 6 cost time: 1.5914671421051025
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0057796  Vali Loss: 0.0280941 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 7 cost time: 1.5902574062347412
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0046379  Vali Loss: 0.0300819 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 8 cost time: 1.5934488773345947
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0053868  Vali Loss: 0.0288055 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 9 cost time: 1.589766502380371
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0057111  Vali Loss: 0.0308647 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 10 cost time: 1.590761423110962
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0045279  Vali Loss: 0.0280339 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 11 cost time: 1.593536138534546
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0042496  Vali Loss: 0.0350966 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 12 cost time: 1.5921969413757324
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0038111  Vali Loss: 0.0311501 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 13 cost time: 1.5895655155181885
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0035147  Vali Loss: 0.0290165 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 14 cost time: 1.5910301208496094
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0036512  Vali Loss: 0.0354728 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915171  Vali macro F1 0.9900491 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 15 cost time: 1.5889863967895508
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0036022  Vali Loss: 0.0353583 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915171  Vali macro F1 0.9900491 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 16 cost time: 1.589052438735962
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0042988  Vali Loss: 0.0330524 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 17 cost time: 1.5905864238739014
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0033640  Vali Loss: 0.0317278 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 18 cost time: 1.5939018726348877
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0031872  Vali Loss: 0.0318059 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 19 cost time: 1.5922777652740479
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0035791  Vali Loss: 0.0317474 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9886878  Test weighted F1: 0.9887193  Test macro F1 0.9865051 
================ the 1 th CV Experiment ================ 
Overlapping random Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00275482 0.00232558 0.00247525 0.00333333 0.00561798 0.00617284
 0.0031348  0.00288184 0.00239234 0.00378788]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.353553295135498
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.1156844  Vali Loss: 1.6460159 Vali Accuracy: 0.3954802  Vali weighted F1: 0.3391744  Vali macro F1 0.3507806 
Validation loss decreased (inf --> 1.646016).  Saving model ...
Epoch: 2 cost time: 1.3528406620025635
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.1254141  Vali Loss: 0.7987751 Vali Accuracy: 0.7598870  Vali weighted F1: 0.7383898  Vali macro F1 0.7205100 
new best score!!!!
Validation loss decreased (1.646016 --> 0.798775).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.3524398803710938
VALI: Epoch: 3, Steps: 13 | Train Loss: 0.6349481  Vali Loss: 0.4956978 Vali Accuracy: 0.8559322  Vali weighted F1: 0.8516957  Vali macro F1 0.8323254 
new best score!!!!
Validation loss decreased (0.798775 --> 0.495698).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.3526811599731445
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.4236855  Vali Loss: 0.3668531 Vali Accuracy: 0.8870056  Vali weighted F1: 0.8853814  Vali macro F1 0.8704580 
new best score!!!!
Validation loss decreased (0.495698 --> 0.366853).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.351956844329834
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.3058109  Vali Loss: 0.2792998 Vali Accuracy: 0.9124294  Vali weighted F1: 0.8965386  Vali macro F1 0.8687729 
new best score!!!!
Validation loss decreased (0.366853 --> 0.279300).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.3554694652557373
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.2370679  Vali Loss: 0.2356815 Vali Accuracy: 0.9265537  Vali weighted F1: 0.9229619  Vali macro F1 0.9040257 
new best score!!!!
Validation loss decreased (0.279300 --> 0.235681).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.357276201248169
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.1822216  Vali Loss: 0.2092876 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9090945  Vali macro F1 0.8820150 
new best score!!!!
Validation loss decreased (0.235681 --> 0.209288).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.3539314270019531
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.1563864  Vali Loss: 0.2077926 Vali Accuracy: 0.9096045  Vali weighted F1: 0.9062505  Vali macro F1 0.8821277 
new best score!!!!
Validation loss decreased (0.209288 --> 0.207793).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.3529412746429443
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.1434493  Vali Loss: 0.1730551 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9433428  Vali macro F1 0.9298775 
new best score!!!!
Validation loss decreased (0.207793 --> 0.173055).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.3546059131622314
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.1236286  Vali Loss: 0.1761365 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9206086  Vali macro F1 0.8964428 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 1.3633825778961182
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.1162809  Vali Loss: 0.1623300 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9487424  Vali macro F1 0.9375044 
new best score!!!!
Validation loss decreased (0.173055 --> 0.162330).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.3545849323272705
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1076890  Vali Loss: 0.1654405 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9262628  Vali macro F1 0.9052778 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 1.3534255027770996
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1015181  Vali Loss: 0.1701544 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9502294  Vali macro F1 0.9380417 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 14 cost time: 1.3511707782745361
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0980999  Vali Loss: 0.1626535 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9262928  Vali macro F1 0.9054446 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 15 cost time: 1.3508689403533936
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0932160  Vali Loss: 0.1435828 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9687056  Vali macro F1 0.9623535 
new best score!!!!
Validation loss decreased (0.162330 --> 0.143583).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.3546462059020996
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0951941  Vali Loss: 0.1491175 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9657943  Vali macro F1 0.9592275 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 1.352426290512085
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0870026  Vali Loss: 0.1288366 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9660358  Vali macro F1 0.9594303 
new best score!!!!
Validation loss decreased (0.143583 --> 0.128837).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.3537142276763916
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0739569  Vali Loss: 0.1143582 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801563  Vali macro F1 0.9771835 
new best score!!!!
Validation loss decreased (0.128837 --> 0.114358).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.3532054424285889
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0640404  Vali Loss: 0.0837281 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9800982  Vali macro F1 0.9754936 
new best score!!!!
Validation loss decreased (0.114358 --> 0.083728).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.3529000282287598
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0537646  Vali Loss: 0.0648905 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915270  Vali macro F1 0.9896005 
new best score!!!!
Validation loss decreased (0.083728 --> 0.064891).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.3541877269744873
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0466915  Vali Loss: 0.0726042 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801953  Vali macro F1 0.9788349 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 1.35268235206604
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0413137  Vali Loss: 0.0513736 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830198  Vali macro F1 0.9812164 
new best score!!!!
Validation loss decreased (0.064891 --> 0.051374).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.3540544509887695
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0334012  Vali Loss: 0.0737191 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858875  Vali macro F1 0.9848349 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 1.3529911041259766
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0350378  Vali Loss: 0.0765416 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830241  Vali macro F1 0.9812209 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 1.3527858257293701
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0357250  Vali Loss: 0.0598269 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830241  Vali macro F1 0.9812209 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 26 cost time: 1.3540093898773193
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0362384  Vali Loss: 0.0806781 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858463  Vali macro F1 0.9877978 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 27 cost time: 1.3537371158599854
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0316988  Vali Loss: 0.0794105 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886634  Vali macro F1 0.9885665 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 28 cost time: 1.3542118072509766
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0290666  Vali Loss: 0.0595249 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887011  Vali macro F1 0.9889503 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 1.3543031215667725
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0211618  Vali Loss: 0.0499244 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887011  Vali macro F1 0.9889503 
new best score!!!!
Validation loss decreased (0.051374 --> 0.049924).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.355738878250122
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0176560  Vali Loss: 0.0501104 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943518  Vali macro F1 0.9950457 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 1.3536386489868164
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0170456  Vali Loss: 0.0505890 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943518  Vali macro F1 0.9950457 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 1.3527283668518066
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0173471  Vali Loss: 0.0512745 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943518  Vali macro F1 0.9950457 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 1.3539869785308838
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0163316  Vali Loss: 0.0510954 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943518  Vali macro F1 0.9950457 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 34 cost time: 1.3526060581207275
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0149093  Vali Loss: 0.0520809 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943518  Vali macro F1 0.9950457 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 35 cost time: 1.3532421588897705
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0159052  Vali Loss: 0.0521224 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943518  Vali macro F1 0.9950457 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 1.3606727123260498
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0146407  Vali Loss: 0.0519220 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943518  Vali macro F1 0.9950457 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 1.3520305156707764
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0145662  Vali Loss: 0.0516539 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943518  Vali macro F1 0.9950457 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 1.3551530838012695
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0150147  Vali Loss: 0.0515078 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943518  Vali macro F1 0.9950457 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 1.3555386066436768
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0156996  Vali Loss: 0.0512750 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943518  Vali macro F1 0.9950457 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Epoch: 40 cost time: 1.372929334640503
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0157276  Vali Loss: 0.0512526 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943518  Vali macro F1 0.9950457 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 1.3535363674163818
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0152876  Vali Loss: 0.0512356 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943518  Vali macro F1 0.9950457 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 1.357154130935669
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0161913  Vali Loss: 0.0512312 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943518  Vali macro F1 0.9950457 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 1.3549604415893555
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0143823  Vali Loss: 0.0512113 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943518  Vali macro F1 0.9950457 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 44 cost time: 1.3548405170440674
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0145241  Vali Loss: 0.0511857 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943518  Vali macro F1 0.9950457 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9932127  Test weighted F1: 0.9932000  Test macro F1 0.9931425 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1125747
pruned model Parameter : 1128786
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.5957021713256836
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0196712  Vali Loss: 0.0527632 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915259  Vali macro F1 0.9911981 
Validation loss decreased (inf --> 0.052763).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.5957520008087158
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0165655  Vali Loss: 0.0589576 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915259  Vali macro F1 0.9911981 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.5916757583618164
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0151786  Vali Loss: 0.0539355 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943518  Vali macro F1 0.9950457 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 1.5931107997894287
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0141055  Vali Loss: 0.0570584 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943518  Vali macro F1 0.9950457 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 1.5923662185668945
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0127846  Vali Loss: 0.0523573 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943518  Vali macro F1 0.9950457 
new best score!!!!
Validation loss decreased (0.052763 --> 0.052357).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 1.589914321899414
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0123183  Vali Loss: 0.0494290 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943518  Vali macro F1 0.9950457 
new best score!!!!
Validation loss decreased (0.052357 --> 0.049429).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 7 cost time: 1.593217372894287
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0126460  Vali Loss: 0.0580285 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943518  Vali macro F1 0.9950457 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 8 cost time: 1.5958733558654785
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0122142  Vali Loss: 0.0577227 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943518  Vali macro F1 0.9950457 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 9 cost time: 1.5926737785339355
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0107862  Vali Loss: 0.0546432 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943518  Vali macro F1 0.9950457 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 10 cost time: 1.5938749313354492
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0105171  Vali Loss: 0.0545267 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943518  Vali macro F1 0.9950457 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 11 cost time: 1.5938560962677002
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0113637  Vali Loss: 0.0540381 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943518  Vali macro F1 0.9950457 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 12 cost time: 1.5921447277069092
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0100201  Vali Loss: 0.0521198 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943518  Vali macro F1 0.9950457 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 1.5909621715545654
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0095331  Vali Loss: 0.0567894 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943518  Vali macro F1 0.9950457 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 1.5919837951660156
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0092252  Vali Loss: 0.0580432 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943518  Vali macro F1 0.9950457 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 1.5921099185943604
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0088525  Vali Loss: 0.0571524 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943518  Vali macro F1 0.9950457 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 1.5947861671447754
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0090900  Vali Loss: 0.0569604 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943518  Vali macro F1 0.9950457 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 17 cost time: 1.5928027629852295
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0084269  Vali Loss: 0.0570137 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943518  Vali macro F1 0.9950457 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 1.597658634185791
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0085162  Vali Loss: 0.0574572 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943518  Vali macro F1 0.9950457 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 1.593672275543213
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0081481  Vali Loss: 0.0576188 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943518  Vali macro F1 0.9950457 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 1.5932731628417969
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0088118  Vali Loss: 0.0575041 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943518  Vali macro F1 0.9950457 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 1.5933148860931396
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0082115  Vali Loss: 0.0573963 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943518  Vali macro F1 0.9950457 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9954751  Test weighted F1: 0.9954742  Test macro F1 0.9961789 
================ the 2 th CV Experiment ================ 
Overlapping random Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.00268097 0.00233645 0.0025     0.00338983 0.00584795 0.00595238
 0.0030581  0.00294118 0.00234742 0.00389105]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.368530035018921
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.1078100  Vali Loss: 1.5828247 Vali Accuracy: 0.4265537  Vali weighted F1: 0.3868292  Vali macro F1 0.3958423 
Validation loss decreased (inf --> 1.582825).  Saving model ...
Epoch: 2 cost time: 1.361560583114624
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.0871473  Vali Loss: 0.8325760 Vali Accuracy: 0.7062147  Vali weighted F1: 0.6871961  Vali macro F1 0.6792401 
new best score!!!!
Validation loss decreased (1.582825 --> 0.832576).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.355757474899292
VALI: Epoch: 3, Steps: 13 | Train Loss: 0.6356527  Vali Loss: 0.5174534 Vali Accuracy: 0.8333333  Vali weighted F1: 0.8212229  Vali macro F1 0.8007470 
new best score!!!!
Validation loss decreased (0.832576 --> 0.517453).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.3515918254852295
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.4453943  Vali Loss: 0.3833212 Vali Accuracy: 0.8531073  Vali weighted F1: 0.8343331  Vali macro F1 0.8136514 
new best score!!!!
Validation loss decreased (0.517453 --> 0.383321).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.3522248268127441
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.3189012  Vali Loss: 0.3006804 Vali Accuracy: 0.8926554  Vali weighted F1: 0.8844254  Vali macro F1 0.8636217 
new best score!!!!
Validation loss decreased (0.383321 --> 0.300680).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.349287509918213
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.2516447  Vali Loss: 0.2519548 Vali Accuracy: 0.9096045  Vali weighted F1: 0.8968922  Vali macro F1 0.8709694 
new best score!!!!
Validation loss decreased (0.300680 --> 0.251955).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.3539838790893555
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.2083877  Vali Loss: 0.2272311 Vali Accuracy: 0.9096045  Vali weighted F1: 0.8850828  Vali macro F1 0.8518088 
new best score!!!!
Validation loss decreased (0.251955 --> 0.227231).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.3519988059997559
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.1786317  Vali Loss: 0.1973844 Vali Accuracy: 0.9180791  Vali weighted F1: 0.8968148  Vali macro F1 0.8656446 
new best score!!!!
Validation loss decreased (0.227231 --> 0.197384).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.3496801853179932
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.1526740  Vali Loss: 0.1836788 Vali Accuracy: 0.9152542  Vali weighted F1: 0.9074844  Vali macro F1 0.8830069 
new best score!!!!
Validation loss decreased (0.197384 --> 0.183679).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.3520145416259766
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.1457359  Vali Loss: 0.2127628 Vali Accuracy: 0.9180791  Vali weighted F1: 0.8996190  Vali macro F1 0.8711071 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 11 cost time: 1.3504812717437744
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.1351225  Vali Loss: 0.1712444 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9060880  Vali macro F1 0.8763302 
new best score!!!!
Validation loss decreased (0.183679 --> 0.171244).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.3522653579711914
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1211606  Vali Loss: 0.1543112 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9539468  Vali macro F1 0.9434320 
new best score!!!!
Validation loss decreased (0.171244 --> 0.154311).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.351118564605713
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1124068  Vali Loss: 0.1565532 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9574230  Vali macro F1 0.9465480 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 1.353698968887329
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1014923  Vali Loss: 0.1355559 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9365788  Vali macro F1 0.9165692 
new best score!!!!
Validation loss decreased (0.154311 --> 0.135556).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.3527796268463135
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1006557  Vali Loss: 0.1530031 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9744410  Vali macro F1 0.9697376 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 1.349722146987915
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0978056  Vali Loss: 0.1456104 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9659824  Vali macro F1 0.9582209 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 17 cost time: 1.3517498970031738
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0918785  Vali Loss: 0.1087277 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802009  Vali macro F1 0.9746417 
new best score!!!!
Validation loss decreased (0.135556 --> 0.108728).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.3523035049438477
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0879954  Vali Loss: 0.1290963 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9659312  Vali macro F1 0.9589647 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 1.3498196601867676
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0869235  Vali Loss: 0.1255425 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9504151  Vali macro F1 0.9368177 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 1.3509767055511475
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0757299  Vali Loss: 0.0882077 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830489  Vali macro F1 0.9798400 
new best score!!!!
Validation loss decreased (0.108728 --> 0.088208).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.3520355224609375
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0653278  Vali Loss: 0.0816917 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773721  Vali macro F1 0.9722557 
new best score!!!!
Validation loss decreased (0.088208 --> 0.081692).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.3542227745056152
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0547313  Vali Loss: 0.0884278 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9744410  Vali macro F1 0.9697376 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 1.3533062934875488
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0520157  Vali Loss: 0.0714169 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830317  Vali macro F1 0.9794995 
new best score!!!!
Validation loss decreased (0.081692 --> 0.071417).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.3529887199401855
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0525387  Vali Loss: 0.0776459 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801275  Vali macro F1 0.9768399 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 1.3514528274536133
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0565560  Vali Loss: 0.0507840 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858460  Vali macro F1 0.9835894 
new best score!!!!
Validation loss decreased (0.071417 --> 0.050784).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.3561296463012695
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0407537  Vali Loss: 0.0703380 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886882  Vali macro F1 0.9876631 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 1.3531317710876465
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0341985  Vali Loss: 0.0313672 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886974  Vali macro F1 0.9862101 
new best score!!!!
Validation loss decreased (0.050784 --> 0.031367).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 1.352203130722046
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0338828  Vali Loss: 0.0821079 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9801848  Vali macro F1 0.9781026 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 1.3536157608032227
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0347920  Vali Loss: 0.0404642 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914939  Vali macro F1 0.9914903 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 1.3640401363372803
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0278263  Vali Loss: 0.0233423 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971712  Vali macro F1 0.9976140 
new best score!!!!
Validation loss decreased (0.031367 --> 0.023342).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 1.3515172004699707
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0201218  Vali Loss: 0.0270354 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943414  Vali macro F1 0.9950659 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 32 cost time: 1.3508021831512451
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0228600  Vali Loss: 0.0155757 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.023342 --> 0.015576).  Saving model ...
new best score!!!!
Epoch: 33 cost time: 1.3542060852050781
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0229417  Vali Loss: 0.0292966 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943546  Vali macro F1 0.9944285 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 1.3529791831970215
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0192584  Vali Loss: 0.0149958 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
new best score!!!!
Validation loss decreased (0.015576 --> 0.014996).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.351017713546753
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0143913  Vali Loss: 0.0106093 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.014996 --> 0.010609).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 1.3520572185516357
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0106982  Vali Loss: 0.0310627 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 1.3540675640106201
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0099109  Vali Loss: 0.0326228 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 1.3523366451263428
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0115808  Vali Loss: 0.0099154 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.010609 --> 0.009915).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 1.3520960807800293
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0097197  Vali Loss: 0.0132037 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 1.351423978805542
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0090980  Vali Loss: 0.0085415 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.009915 --> 0.008542).  Saving model ...
new best score!!!!
Epoch: 41 cost time: 1.3535237312316895
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0103687  Vali Loss: 0.0053557 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.008542 --> 0.005356).  Saving model ...
new best score!!!!
Epoch: 42 cost time: 1.3516497611999512
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0088251  Vali Loss: 0.0054388 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 43 cost time: 1.352717638015747
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0077943  Vali Loss: 0.0296798 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943492  Vali macro F1 0.9939052 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 44 cost time: 1.3539226055145264
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0150427  Vali Loss: 0.0283494 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 45 cost time: 1.3514862060546875
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0104190  Vali Loss: 0.0249732 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943788  Vali macro F1 0.9953555 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 46 cost time: 1.3511276245117188
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0094526  Vali Loss: 0.0189365 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 47 cost time: 1.3524892330169678
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0064809  Vali Loss: 0.0188799 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 48 cost time: 1.352212905883789
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0060819  Vali Loss: 0.0181331 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 49 cost time: 1.3531949520111084
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0055047  Vali Loss: 0.0180289 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 50 cost time: 1.350106954574585
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0055103  Vali Loss: 0.0182848 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 51 cost time: 1.3503608703613281
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0050832  Vali Loss: 0.0174522 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 52 cost time: 1.3512516021728516
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0054711  Vali Loss: 0.0172920 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 53 cost time: 1.3522536754608154
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0067323  Vali Loss: 0.0171523 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 54 cost time: 1.3574409484863281
VALI: Epoch: 54, Steps: 13 | Train Loss: 0.0053230  Vali Loss: 0.0173520 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 55 cost time: 1.3513333797454834
VALI: Epoch: 55, Steps: 13 | Train Loss: 0.0055732  Vali Loss: 0.0171347 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 56 cost time: 1.3529329299926758
VALI: Epoch: 56, Steps: 13 | Train Loss: 0.0052224  Vali Loss: 0.0169516 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9875566  Test weighted F1: 0.9875967  Test macro F1 0.9871592 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1125747
pruned model Parameter : 1128786
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.5834190845489502
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0077834  Vali Loss: 0.0053808 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
Validation loss decreased (inf --> 0.005381).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.5826056003570557
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0061613  Vali Loss: 0.0046668 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.005381 --> 0.004667).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 1.5826561450958252
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0057492  Vali Loss: 0.0247355 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 1.581970453262329
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0053008  Vali Loss: 0.0289164 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 1.5786728858947754
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0047800  Vali Loss: 0.0245083 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 1.5825629234313965
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0047038  Vali Loss: 0.0094979 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 1.5793333053588867
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0049592  Vali Loss: 0.0040930 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004667 --> 0.004093).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 1.5815019607543945
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0048686  Vali Loss: 0.0076257 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 1.5846753120422363
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0042733  Vali Loss: 0.0286084 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 1.5793139934539795
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0043020  Vali Loss: 0.0258247 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 1.581801176071167
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0039324  Vali Loss: 0.0404026 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 1.5811219215393066
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0041880  Vali Loss: 0.0023832 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.004093 --> 0.002383).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 13 cost time: 1.5792169570922852
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0040770  Vali Loss: 0.0156982 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 1.5840094089508057
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0037216  Vali Loss: 0.0279956 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 1.5798897743225098
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0039988  Vali Loss: 0.0315749 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 1.583146572113037
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0030302  Vali Loss: 0.0362718 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 1.5812067985534668
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0030892  Vali Loss: 0.0143511 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 18 cost time: 1.5778396129608154
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0034186  Vali Loss: 0.0025432 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 19 cost time: 1.585279941558838
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0036074  Vali Loss: 0.0028815 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 20 cost time: 1.5806348323822021
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0037111  Vali Loss: 0.0349412 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914939  Vali macro F1 0.9914903 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 21 cost time: 1.5823955535888672
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0047797  Vali Loss: 0.0056273 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 22 cost time: 1.5815720558166504
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0028932  Vali Loss: 0.0266168 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9951554 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 23 cost time: 1.5812442302703857
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0031320  Vali Loss: 0.0202692 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 24 cost time: 1.583777666091919
Fine Tuning VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0027815  Vali Loss: 0.0177384 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 25 cost time: 1.5808463096618652
Fine Tuning VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0028287  Vali Loss: 0.0178164 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 26 cost time: 1.58343505859375
Fine Tuning VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0026071  Vali Loss: 0.0166518 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 27 cost time: 1.5813615322113037
Fine Tuning VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0031125  Vali Loss: 0.0170231 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9932127  Test weighted F1: 0.9932325  Test macro F1 0.9929811 
================ the 3 th CV Experiment ================ 
Overlapping random Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00263158 0.00242718 0.002457   0.003367   0.00598802 0.00571429
 0.00310559 0.002849   0.00240964 0.003861  ]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.378692865371704
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.0919398  Vali Loss: 1.5621832 Vali Accuracy: 0.3841808  Vali weighted F1: 0.3478628  Vali macro F1 0.3505092 
Validation loss decreased (inf --> 1.562183).  Saving model ...
Epoch: 2 cost time: 1.3662452697753906
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.0675003  Vali Loss: 0.7663899 Vali Accuracy: 0.7570621  Vali weighted F1: 0.7545434  Vali macro F1 0.7471221 
new best score!!!!
Validation loss decreased (1.562183 --> 0.766390).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.3615920543670654
VALI: Epoch: 3, Steps: 13 | Train Loss: 0.6225867  Vali Loss: 0.5074737 Vali Accuracy: 0.8333333  Vali weighted F1: 0.8312842  Vali macro F1 0.8174442 
new best score!!!!
Validation loss decreased (0.766390 --> 0.507474).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.3609094619750977
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.4375555  Vali Loss: 0.3746081 Vali Accuracy: 0.8644068  Vali weighted F1: 0.8396855  Vali macro F1 0.8125628 
new best score!!!!
Validation loss decreased (0.507474 --> 0.374608).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.3618829250335693
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.3180354  Vali Loss: 0.3073420 Vali Accuracy: 0.8870056  Vali weighted F1: 0.8745623  Vali macro F1 0.8519261 
new best score!!!!
Validation loss decreased (0.374608 --> 0.307342).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.3629121780395508
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.2557065  Vali Loss: 0.2376455 Vali Accuracy: 0.8983051  Vali weighted F1: 0.8736293  Vali macro F1 0.8409103 
new best score!!!!
Validation loss decreased (0.307342 --> 0.237646).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.3617818355560303
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.2093515  Vali Loss: 0.2164938 Vali Accuracy: 0.9265537  Vali weighted F1: 0.9263012  Vali macro F1 0.9091884 
new best score!!!!
Validation loss decreased (0.237646 --> 0.216494).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.3607063293457031
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.1923996  Vali Loss: 0.1919299 Vali Accuracy: 0.9209040  Vali weighted F1: 0.8996389  Vali macro F1 0.8678918 
new best score!!!!
Validation loss decreased (0.216494 --> 0.191930).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.3614375591278076
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.1593472  Vali Loss: 0.1765594 Vali Accuracy: 0.9180791  Vali weighted F1: 0.8968148  Vali macro F1 0.8656446 
new best score!!!!
Validation loss decreased (0.191930 --> 0.176559).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.3582212924957275
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.1435661  Vali Loss: 0.1594331 Vali Accuracy: 0.9209040  Vali weighted F1: 0.8963914  Vali macro F1 0.8620045 
new best score!!!!
Validation loss decreased (0.176559 --> 0.159433).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.359586238861084
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.1221201  Vali Loss: 0.1546375 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9024935  Vali macro F1 0.8703056 
new best score!!!!
Validation loss decreased (0.159433 --> 0.154638).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.3613510131835938
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1157227  Vali Loss: 0.1291108 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9554046  Vali macro F1 0.9407356 
new best score!!!!
Validation loss decreased (0.154638 --> 0.129111).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.362415075302124
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1034346  Vali Loss: 0.1529113 Vali Accuracy: 0.9209040  Vali weighted F1: 0.8964209  Vali macro F1 0.8618203 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 1.3578121662139893
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0984362  Vali Loss: 0.1449812 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9206086  Vali macro F1 0.8964428 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 15 cost time: 1.3593051433563232
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0961096  Vali Loss: 0.1237476 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9613701  Vali macro F1 0.9490028 
new best score!!!!
Validation loss decreased (0.129111 --> 0.123748).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.3600256443023682
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0869853  Vali Loss: 0.1291101 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9649864  Vali macro F1 0.9553993 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 1.3590705394744873
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0881243  Vali Loss: 0.1309675 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9717097  Vali macro F1 0.9660189 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 1.357983112335205
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0846583  Vali Loss: 0.1012904 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9681110  Vali macro F1 0.9596535 
new best score!!!!
Validation loss decreased (0.123748 --> 0.101290).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.3607313632965088
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0806158  Vali Loss: 0.0851380 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9743408  Vali macro F1 0.9692328 
new best score!!!!
Validation loss decreased (0.101290 --> 0.085138).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.3560473918914795
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0758223  Vali Loss: 0.0774788 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830456  Vali macro F1 0.9785149 
new best score!!!!
Validation loss decreased (0.085138 --> 0.077479).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.3595356941223145
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0633972  Vali Loss: 0.0958450 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9681110  Vali macro F1 0.9596535 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 1.357970952987671
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0592735  Vali Loss: 0.0550085 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886994  Vali macro F1 0.9860679 
new best score!!!!
Validation loss decreased (0.077479 --> 0.055009).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.3592069149017334
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0478823  Vali Loss: 0.0623905 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858421  Vali macro F1 0.9837951 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 1.3581130504608154
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0443742  Vali Loss: 0.0619668 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9770355  Vali macro F1 0.9703317 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 1.3671400547027588
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0435936  Vali Loss: 0.0294503 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886723  Vali macro F1 0.9861758 
new best score!!!!
Validation loss decreased (0.055009 --> 0.029450).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.3623003959655762
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0316561  Vali Loss: 0.0342266 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886743  Vali macro F1 0.9860336 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 1.3610572814941406
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0284088  Vali Loss: 0.0311634 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858170  Vali macro F1 0.9837609 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 28 cost time: 1.3625047206878662
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0265982  Vali Loss: 0.0403737 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858376  Vali macro F1 0.9853870 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 29 cost time: 1.3798463344573975
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0237201  Vali Loss: 0.0199307 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943512  Vali macro F1 0.9937630 
new best score!!!!
Validation loss decreased (0.029450 --> 0.019931).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.3627007007598877
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0316922  Vali Loss: 0.0496481 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858942  Vali macro F1 0.9867915 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 1.3630070686340332
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0264869  Vali Loss: 0.0411845 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803157  Vali macro F1 0.9777362 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 32 cost time: 1.3635449409484863
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0244944  Vali Loss: 0.0394022 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914959  Vali macro F1 0.9913476 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 33 cost time: 1.3611564636230469
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0173523  Vali Loss: 0.0379136 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886974  Vali macro F1 0.9862101 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 34 cost time: 1.3601667881011963
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0169585  Vali Loss: 0.0227254 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886638  Vali macro F1 0.9874915 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 35 cost time: 1.3604190349578857
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0116179  Vali Loss: 0.0260918 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943492  Vali macro F1 0.9939052 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 1.3616375923156738
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0103856  Vali Loss: 0.0258377 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943492  Vali macro F1 0.9939052 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 37 cost time: 1.3605563640594482
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0096573  Vali Loss: 0.0242435 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943492  Vali macro F1 0.9939052 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 38 cost time: 1.3609747886657715
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0096597  Vali Loss: 0.0220816 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943492  Vali macro F1 0.9939052 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 39 cost time: 1.3646228313446045
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0086953  Vali Loss: 0.0220160 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943492  Vali macro F1 0.9939052 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 40 cost time: 1.357245922088623
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0080195  Vali Loss: 0.0221956 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943492  Vali macro F1 0.9939052 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 41 cost time: 1.3560073375701904
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0086895  Vali Loss: 0.0221384 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943492  Vali macro F1 0.9939052 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 42 cost time: 1.3736567497253418
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0086948  Vali Loss: 0.0214363 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943492  Vali macro F1 0.9939052 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 43 cost time: 1.390305519104004
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0083487  Vali Loss: 0.0213993 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943492  Vali macro F1 0.9939052 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 44 cost time: 1.389847755432129
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0082282  Vali Loss: 0.0211378 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943492  Vali macro F1 0.9939052 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9864253  Test weighted F1: 0.9863550  Test macro F1 0.9813990 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1125747
pruned model Parameter : 1128786
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.591005563735962
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0190446  Vali Loss: 0.0417226 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886617  Vali macro F1 0.9876342 
Validation loss decreased (inf --> 0.041723).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.5857374668121338
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0136384  Vali Loss: 0.0299876 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886698  Vali macro F1 0.9892431 
new best score!!!!
Validation loss decreased (0.041723 --> 0.029988).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 1.5881059169769287
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0140015  Vali Loss: 0.0276507 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886698  Vali macro F1 0.9892431 
new best score!!!!
Validation loss decreased (0.029988 --> 0.027651).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 1.588768482208252
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0128126  Vali Loss: 0.0225557 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886617  Vali macro F1 0.9876342 
new best score!!!!
Validation loss decreased (0.027651 --> 0.022556).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 5 cost time: 1.5886116027832031
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0125889  Vali Loss: 0.0210895 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943198  Vali macro F1 0.9953379 
new best score!!!!
Validation loss decreased (0.022556 --> 0.021090).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 1.588824987411499
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0121754  Vali Loss: 0.0235609 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886617  Vali macro F1 0.9876342 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 1.5896282196044922
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0100955  Vali Loss: 0.0277742 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943198  Vali macro F1 0.9953379 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 1.589024543762207
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0106330  Vali Loss: 0.0212706 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858376  Vali macro F1 0.9853870 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 1.5896885395050049
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0105057  Vali Loss: 0.0152963 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886698  Vali macro F1 0.9892431 
new best score!!!!
Validation loss decreased (0.021090 --> 0.015296).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 10 cost time: 1.5868468284606934
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0112522  Vali Loss: 0.0110694 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915191  Vali macro F1 0.9899069 
new best score!!!!
Validation loss decreased (0.015296 --> 0.011069).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 11 cost time: 1.5926313400268555
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0099164  Vali Loss: 0.0154054 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915244  Vali macro F1 0.9916575 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 1.590250015258789
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0087881  Vali Loss: 0.0164239 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915191  Vali macro F1 0.9899069 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 1.5903511047363281
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0095309  Vali Loss: 0.0184207 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886617  Vali macro F1 0.9876342 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 1.5892300605773926
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0084295  Vali Loss: 0.0129815 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943492  Vali macro F1 0.9939052 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 1.5895373821258545
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0074654  Vali Loss: 0.0157029 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9914939  Vali macro F1 0.9914903 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 16 cost time: 1.5894205570220947
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0071369  Vali Loss: 0.0104249 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
new best score!!!!
Validation loss decreased (0.011069 --> 0.010425).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 17 cost time: 1.5863230228424072
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0068094  Vali Loss: 0.0135224 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943492  Vali macro F1 0.9939052 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 1.5881528854370117
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0077051  Vali Loss: 0.0088143 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
new best score!!!!
Validation loss decreased (0.010425 --> 0.008814).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 19 cost time: 1.5910825729370117
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0063481  Vali Loss: 0.0086181 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
new best score!!!!
Validation loss decreased (0.008814 --> 0.008618).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 20 cost time: 1.5921626091003418
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0070475  Vali Loss: 0.0122888 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 21 cost time: 1.5885379314422607
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0070111  Vali Loss: 0.0120155 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943492  Vali macro F1 0.9939052 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 22 cost time: 1.5887224674224854
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0059596  Vali Loss: 0.0140730 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943492  Vali macro F1 0.9939052 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 23 cost time: 1.5918734073638916
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0078336  Vali Loss: 0.0102586 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971741  Vali macro F1 0.9961524 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 24 cost time: 1.592679738998413
Fine Tuning VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0068815  Vali Loss: 0.0106268 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 25 cost time: 1.59397554397583
Fine Tuning VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0058714  Vali Loss: 0.0112374 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 26 cost time: 1.5936319828033447
Fine Tuning VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0058396  Vali Loss: 0.0116947 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 27 cost time: 1.593336820602417
Fine Tuning VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0054871  Vali Loss: 0.0118356 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 28 cost time: 1.5918700695037842
Fine Tuning VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0056093  Vali Loss: 0.0121601 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 29 cost time: 1.5930202007293701
Fine Tuning VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0050820  Vali Loss: 0.0117110 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 30 cost time: 1.5929539203643799
Fine Tuning VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0055503  Vali Loss: 0.0116809 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 31 cost time: 1.5938539505004883
Fine Tuning VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0051582  Vali Loss: 0.0117810 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 32 cost time: 1.5940096378326416
Fine Tuning VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0049142  Vali Loss: 0.0118402 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 33 cost time: 1.5943787097930908
Fine Tuning VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0047087  Vali Loss: 0.0118274 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 34 cost time: 1.590644121170044
Fine Tuning VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0054953  Vali Loss: 0.0118075 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971751  Vali macro F1 0.9977528 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9875566  Test weighted F1: 0.9875452  Test macro F1 0.9874183 
================ the 4 th CV Experiment ================ 
Overlapping random Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.0027027  0.00240385 0.00242131 0.00319489 0.00574713 0.00617284
 0.00315457 0.0028169  0.00246305 0.00390625]
Train data number :  3182
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  887
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.4047260284423828
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.1094652  Vali Loss: 1.5919125 Vali Accuracy: 0.3954802  Vali weighted F1: 0.3724034  Vali macro F1 0.3534247 
Validation loss decreased (inf --> 1.591913).  Saving model ...
Epoch: 2 cost time: 1.3885204792022705
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.1315430  Vali Loss: 0.7465216 Vali Accuracy: 0.7542373  Vali weighted F1: 0.7490597  Vali macro F1 0.7162500 
new best score!!!!
Validation loss decreased (1.591913 --> 0.746522).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.3870325088500977
VALI: Epoch: 3, Steps: 13 | Train Loss: 0.6524747  Vali Loss: 0.4489806 Vali Accuracy: 0.8615819  Vali weighted F1: 0.8426056  Vali macro F1 0.7948347 
new best score!!!!
Validation loss decreased (0.746522 --> 0.448981).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.3888249397277832
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.4351761  Vali Loss: 0.3381254 Vali Accuracy: 0.9067797  Vali weighted F1: 0.9003451  Vali macro F1 0.8675303 
new best score!!!!
Validation loss decreased (0.448981 --> 0.338125).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.4007844924926758
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.3216868  Vali Loss: 0.2956187 Vali Accuracy: 0.9124294  Vali weighted F1: 0.9120005  Vali macro F1 0.8905334 
new best score!!!!
Validation loss decreased (0.338125 --> 0.295619).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.3891630172729492
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.2665742  Vali Loss: 0.2008656 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9405046  Vali macro F1 0.9132782 
new best score!!!!
Validation loss decreased (0.295619 --> 0.200866).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.3996942043304443
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.1998132  Vali Loss: 0.1695443 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9419975  Vali macro F1 0.9091198 
new best score!!!!
Validation loss decreased (0.200866 --> 0.169544).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.383143424987793
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.1563525  Vali Loss: 0.1410789 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9493053  Vali macro F1 0.9171908 
new best score!!!!
Validation loss decreased (0.169544 --> 0.141079).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.3850927352905273
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.1357667  Vali Loss: 0.1513627 Vali Accuracy: 0.9237288  Vali weighted F1: 0.9199323  Vali macro F1 0.8749200 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 10 cost time: 1.3844029903411865
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.1217679  Vali Loss: 0.1379360 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9486363  Vali macro F1 0.9205264 
new best score!!!!
Validation loss decreased (0.141079 --> 0.137936).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.3877642154693604
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.1083899  Vali Loss: 0.1209171 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9523236  Vali macro F1 0.9246765 
new best score!!!!
Validation loss decreased (0.137936 --> 0.120917).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.38508939743042
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1073712  Vali Loss: 0.1174682 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9629364  Vali macro F1 0.9405776 
new best score!!!!
Validation loss decreased (0.120917 --> 0.117468).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.3856289386749268
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0995704  Vali Loss: 0.1149880 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9618814  Vali macro F1 0.9387103 
new best score!!!!
Validation loss decreased (0.117468 --> 0.114988).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.3903632164001465
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0835718  Vali Loss: 0.1039057 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9659838  Vali macro F1 0.9479490 
new best score!!!!
Validation loss decreased (0.114988 --> 0.103906).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.384192943572998
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0732293  Vali Loss: 0.1027744 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9562880  Vali macro F1 0.9376468 
new best score!!!!
Validation loss decreased (0.103906 --> 0.102774).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.3855082988739014
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0666848  Vali Loss: 0.0974021 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9585334  Vali macro F1 0.9367867 
new best score!!!!
Validation loss decreased (0.102774 --> 0.097402).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.3937115669250488
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0688552  Vali Loss: 0.1049663 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9648913  Vali macro F1 0.9498480 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 1.386415958404541
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0565818  Vali Loss: 0.0794810 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9772330  Vali macro F1 0.9645633 
new best score!!!!
Validation loss decreased (0.097402 --> 0.079481).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.3861396312713623
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0423815  Vali Loss: 0.1157845 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9650254  Vali macro F1 0.9496908 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 20 cost time: 1.3949470520019531
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0460028  Vali Loss: 0.0934912 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9627883  Vali macro F1 0.9454296 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 21 cost time: 1.3860359191894531
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0431664  Vali Loss: 0.0871101 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9716682  Vali macro F1 0.9612915 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 22 cost time: 1.3900628089904785
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0329144  Vali Loss: 0.0697562 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9686229  Vali macro F1 0.9547589 
new best score!!!!
Validation loss decreased (0.079481 --> 0.069756).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.3889319896697998
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0298439  Vali Loss: 0.0513511 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858881  Vali macro F1 0.9826015 
new best score!!!!
Validation loss decreased (0.069756 --> 0.051351).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.3885252475738525
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0301056  Vali Loss: 0.0764570 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745878  Vali macro F1 0.9676707 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 1.387993335723877
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0345804  Vali Loss: 0.0663832 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802309  Vali macro F1 0.9774520 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 1.3898882865905762
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0303027  Vali Loss: 0.0906802 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9745194  Vali macro F1 0.9651678 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 27 cost time: 1.398179054260254
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0311035  Vali Loss: 0.0579529 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830137  Vali macro F1 0.9780874 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 28 cost time: 1.3867723941802979
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0366609  Vali Loss: 0.0651627 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830153  Vali macro F1 0.9775166 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 29 cost time: 1.3870301246643066
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0270009  Vali Loss: 0.0634615 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830153  Vali macro F1 0.9775166 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 1.3967478275299072
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0186476  Vali Loss: 0.0603111 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830153  Vali macro F1 0.9775166 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 1.3926191329956055
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0177583  Vali Loss: 0.0583203 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830153  Vali macro F1 0.9775166 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 32 cost time: 1.3881745338439941
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0157364  Vali Loss: 0.0552436 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830153  Vali macro F1 0.9775166 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 33 cost time: 1.392664909362793
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0147948  Vali Loss: 0.0539412 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830153  Vali macro F1 0.9775166 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 34 cost time: 1.3884789943695068
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0138578  Vali Loss: 0.0543004 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830153  Vali macro F1 0.9775166 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 1.4059984683990479
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0136191  Vali Loss: 0.0538608 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830153  Vali macro F1 0.9775166 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 1.387542486190796
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0135591  Vali Loss: 0.0534675 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830153  Vali macro F1 0.9775166 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 1.3972220420837402
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0137711  Vali Loss: 0.0538510 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830153  Vali macro F1 0.9775166 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 1.3858306407928467
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0136163  Vali Loss: 0.0538991 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830153  Vali macro F1 0.9775166 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9864713  Test weighted F1: 0.9864662  Test macro F1 0.9827285 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1125747
pruned model Parameter : 1128786
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.594247817993164
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0243978  Vali Loss: 0.0676571 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9713866  Vali macro F1 0.9596552 
Validation loss decreased (inf --> 0.067657).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.592259168624878
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0221375  Vali Loss: 0.0516684 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802101  Vali macro F1 0.9725513 
new best score!!!!
Validation loss decreased (0.067657 --> 0.051668).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 1.592153549194336
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0197039  Vali Loss: 0.0609733 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9773981  Vali macro F1 0.9702957 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 1.590209722518921
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0192492  Vali Loss: 0.0564869 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802101  Vali macro F1 0.9725513 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 1.5901210308074951
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0205460  Vali Loss: 0.0552627 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830579  Vali macro F1 0.9775921 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 1.5916240215301514
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0168811  Vali Loss: 0.0568377 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802101  Vali macro F1 0.9725513 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 1.5909712314605713
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0156283  Vali Loss: 0.0582465 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802101  Vali macro F1 0.9725513 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 8 cost time: 1.589252233505249
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0150316  Vali Loss: 0.0586965 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802101  Vali macro F1 0.9725513 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 9 cost time: 1.594031572341919
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0144680  Vali Loss: 0.0622830 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802101  Vali macro F1 0.9725513 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 10 cost time: 1.5929338932037354
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0157891  Vali Loss: 0.0624018 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802101  Vali macro F1 0.9725513 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 11 cost time: 1.594076156616211
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0125113  Vali Loss: 0.0630039 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802101  Vali macro F1 0.9725513 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 12 cost time: 1.5916399955749512
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0146580  Vali Loss: 0.0610394 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802101  Vali macro F1 0.9725513 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 13 cost time: 1.5923101902008057
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0132233  Vali Loss: 0.0598737 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830579  Vali macro F1 0.9775921 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 14 cost time: 1.5902342796325684
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0133517  Vali Loss: 0.0598622 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9830579  Vali macro F1 0.9775921 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 15 cost time: 1.5910146236419678
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0144788  Vali Loss: 0.0602247 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802101  Vali macro F1 0.9725513 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 16 cost time: 1.5920212268829346
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0119663  Vali Loss: 0.0600698 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802101  Vali macro F1 0.9725513 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 17 cost time: 1.591303825378418
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0116369  Vali Loss: 0.0600047 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9802101  Vali macro F1 0.9725513 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9887260  Test weighted F1: 0.9887200  Test macro F1 0.9855712 
Use GPU: cuda:0
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Done!
Parameter : 1125747
Set the seed as :  5
 ----------------------- load all the data -------------------
-----------------------Sliding file are generated -----------------------
================ SOCV Mode ====================
================ 5 CV ======================
================ the 0 th CV Experiment ================ 
Overlapping random Experiment : The 1 Part as the test
[-] Target sampling weights:  [0.0025974  0.00241546 0.00248756 0.00307692 0.00561798 0.00621118
 0.0031746  0.00286533 0.00241546 0.00413223]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.4639918804168701
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.1319308  Vali Loss: 1.6401673 Vali Accuracy: 0.4491525  Vali weighted F1: 0.4338196  Vali macro F1 0.3944094 
Validation loss decreased (inf --> 1.640167).  Saving model ...
Epoch: 2 cost time: 1.3990745544433594
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.3048691  Vali Loss: 0.8406724 Vali Accuracy: 0.7175141  Vali weighted F1: 0.6932496  Vali macro F1 0.6560488 
new best score!!!!
Validation loss decreased (1.640167 --> 0.840672).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.3922173976898193
VALI: Epoch: 3, Steps: 13 | Train Loss: 0.7549159  Vali Loss: 0.5273106 Vali Accuracy: 0.8135593  Vali weighted F1: 0.8148989  Vali macro F1 0.7840914 
new best score!!!!
Validation loss decreased (0.840672 --> 0.527311).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.4050791263580322
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.4975913  Vali Loss: 0.3488256 Vali Accuracy: 0.8728814  Vali weighted F1: 0.8525074  Vali macro F1 0.8030933 
new best score!!!!
Validation loss decreased (0.527311 --> 0.348826).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.3934683799743652
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.3638987  Vali Loss: 0.2951957 Vali Accuracy: 0.8813559  Vali weighted F1: 0.8669290  Vali macro F1 0.8193697 
new best score!!!!
Validation loss decreased (0.348826 --> 0.295196).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.4149179458618164
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.2864098  Vali Loss: 0.2425401 Vali Accuracy: 0.8841808  Vali weighted F1: 0.8836977  Vali macro F1 0.8376896 
new best score!!!!
Validation loss decreased (0.295196 --> 0.242540).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.4038147926330566
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.2383156  Vali Loss: 0.1924436 Vali Accuracy: 0.9180791  Vali weighted F1: 0.9141851  Vali macro F1 0.8743082 
new best score!!!!
Validation loss decreased (0.242540 --> 0.192444).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.3932459354400635
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.1952149  Vali Loss: 0.1523425 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9375297  Vali macro F1 0.8994198 
new best score!!!!
Validation loss decreased (0.192444 --> 0.152342).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.392566442489624
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.1571256  Vali Loss: 0.1367523 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9096788  Vali macro F1 0.8558503 
new best score!!!!
Validation loss decreased (0.152342 --> 0.136752).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.4017078876495361
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.1378207  Vali Loss: 0.1316796 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9337189  Vali macro F1 0.8955636 
new best score!!!!
Validation loss decreased (0.136752 --> 0.131680).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.3906338214874268
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.1234476  Vali Loss: 0.1225924 Vali Accuracy: 0.9406780  Vali weighted F1: 0.9405892  Vali macro F1 0.9063375 
new best score!!!!
Validation loss decreased (0.131680 --> 0.122592).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.3939204216003418
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1214827  Vali Loss: 0.1154525 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9224182  Vali macro F1 0.8703007 
new best score!!!!
Validation loss decreased (0.122592 --> 0.115452).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.3900716304779053
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1201784  Vali Loss: 0.1192949 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9437068  Vali macro F1 0.9083895 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 14 cost time: 1.389357089996338
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1308314  Vali Loss: 0.1290107 Vali Accuracy: 0.9463277  Vali weighted F1: 0.9407367  Vali macro F1 0.9022139 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 15 cost time: 1.3896262645721436
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1162293  Vali Loss: 0.1252068 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9365220  Vali macro F1 0.8959725 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 16 cost time: 1.3879222869873047
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0985138  Vali Loss: 0.1054924 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9556212  Vali macro F1 0.9286740 
new best score!!!!
Validation loss decreased (0.115452 --> 0.105492).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.4024803638458252
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0903522  Vali Loss: 0.0897413 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9592483  Vali macro F1 0.9329175 
new best score!!!!
Validation loss decreased (0.105492 --> 0.089741).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.3936724662780762
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0820853  Vali Loss: 0.0959487 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9470237  Vali macro F1 0.9095408 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 1.3909516334533691
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0760373  Vali Loss: 0.0928969 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9590769  Vali macro F1 0.9292962 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 1.3945631980895996
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0698256  Vali Loss: 0.0992496 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9477529  Vali macro F1 0.9188385 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 21 cost time: 1.3933963775634766
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0617323  Vali Loss: 0.0744031 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9713342  Vali macro F1 0.9553726 
new best score!!!!
Validation loss decreased (0.089741 --> 0.074403).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.3943932056427002
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0619988  Vali Loss: 0.0789091 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9647256  Vali macro F1 0.9408196 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 23 cost time: 1.402494192123413
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0482960  Vali Loss: 0.0509859 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9772850  Vali macro F1 0.9634921 
new best score!!!!
Validation loss decreased (0.074403 --> 0.050986).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.3933780193328857
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0398645  Vali Loss: 0.1059914 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9475637  Vali macro F1 0.9206838 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 1.3921012878417969
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0450737  Vali Loss: 0.0588754 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9705398  Vali macro F1 0.9497549 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 26 cost time: 1.396186113357544
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0355580  Vali Loss: 0.0459893 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9828383  Vali macro F1 0.9747050 
new best score!!!!
Validation loss decreased (0.050986 --> 0.045989).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.3936190605163574
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0268081  Vali Loss: 0.0398630 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9885067  Vali macro F1 0.9799020 
new best score!!!!
Validation loss decreased (0.045989 --> 0.039863).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 1.393068552017212
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0202636  Vali Loss: 0.0315459 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
new best score!!!!
Validation loss decreased (0.039863 --> 0.031546).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.3922102451324463
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0186750  Vali Loss: 0.0290021 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943570  Vali macro F1 0.9902381 
new best score!!!!
Validation loss decreased (0.031546 --> 0.029002).  Saving model ...
new best score!!!!
Epoch: 30 cost time: 1.3977508544921875
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0264706  Vali Loss: 0.0485395 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9826922  Vali macro F1 0.9715230 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 31 cost time: 1.3936784267425537
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0260514  Vali Loss: 0.0270878 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943162  Vali macro F1 0.9900966 
new best score!!!!
Validation loss decreased (0.029002 --> 0.027088).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 1.3957791328430176
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0232844  Vali Loss: 0.0303350 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887212  Vali macro F1 0.9824375 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 1.4040186405181885
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0241589  Vali Loss: 0.0462279 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886477  Vali macro F1 0.9848997 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 1.391258955001831
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0143024  Vali Loss: 0.0238420 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915018  Vali macro F1 0.9872032 
new best score!!!!
Validation loss decreased (0.027088 --> 0.023842).  Saving model ...
new best score!!!!
Epoch: 35 cost time: 1.3940389156341553
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0149966  Vali Loss: 0.0303696 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915018  Vali macro F1 0.9872032 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 36 cost time: 1.4097468852996826
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0131690  Vali Loss: 0.0180768 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943570  Vali macro F1 0.9902381 
new best score!!!!
Validation loss decreased (0.023842 --> 0.018077).  Saving model ...
new best score!!!!
Epoch: 37 cost time: 1.3946576118469238
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0149775  Vali Loss: 0.0227758 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 38 cost time: 1.3917899131774902
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0147351  Vali Loss: 0.0172472 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943641  Vali macro F1 0.9922169 
new best score!!!!
Validation loss decreased (0.018077 --> 0.017247).  Saving model ...
new best score!!!!
Epoch: 39 cost time: 1.393655776977539
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0123308  Vali Loss: 0.0301210 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915355  Vali macro F1 0.9853309 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 1.3948965072631836
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0136775  Vali Loss: 0.0391808 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887212  Vali macro F1 0.9824375 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 1.3914802074432373
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0106879  Vali Loss: 0.0239398 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943540  Vali macro F1 0.9921816 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 1.3918375968933105
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0102090  Vali Loss: 0.0418394 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 1.4028422832489014
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0064738  Vali Loss: 0.0290201 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 44 cost time: 1.390340805053711
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0061828  Vali Loss: 0.0270750 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 1.3929157257080078
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0050606  Vali Loss: 0.0331825 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 1.4025609493255615
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0049918  Vali Loss: 0.0352446 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 1.393303632736206
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0052754  Vali Loss: 0.0326259 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 1.3898849487304688
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0045082  Vali Loss: 0.0323219 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 49 cost time: 1.3974645137786865
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0047068  Vali Loss: 0.0325374 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 50 cost time: 1.3909308910369873
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0051292  Vali Loss: 0.0323257 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 51 cost time: 1.3910868167877197
VALI: Epoch: 51, Steps: 13 | Train Loss: 0.0054210  Vali Loss: 0.0323639 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 52 cost time: 1.391733169555664
VALI: Epoch: 52, Steps: 13 | Train Loss: 0.0041177  Vali Loss: 0.0324800 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 53 cost time: 1.393021583557129
VALI: Epoch: 53, Steps: 13 | Train Loss: 0.0043681  Vali Loss: 0.0326228 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9898190  Test weighted F1: 0.9898142  Test macro F1 0.9877966 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1125747
pruned model Parameter : 1128786
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.6009228229522705
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0105812  Vali Loss: 0.0250295 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971684  Vali macro F1 0.9950751 
Validation loss decreased (inf --> 0.025029).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.6019768714904785
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0073254  Vali Loss: 0.0224752 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971684  Vali macro F1 0.9950751 
new best score!!!!
Validation loss decreased (0.025029 --> 0.022475).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 1.5997796058654785
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0064741  Vali Loss: 0.0246911 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971684  Vali macro F1 0.9950751 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 4 cost time: 1.6003234386444092
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0065696  Vali Loss: 0.0265152 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971684  Vali macro F1 0.9950751 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 5 cost time: 1.6040329933166504
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0053046  Vali Loss: 0.0304085 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 6 cost time: 1.5964553356170654
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0053985  Vali Loss: 0.0255856 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 7 cost time: 1.6012582778930664
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0054177  Vali Loss: 0.0222740 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971684  Vali macro F1 0.9950751 
new best score!!!!
Validation loss decreased (0.022475 --> 0.022274).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 8 cost time: 1.6002585887908936
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0048000  Vali Loss: 0.0174788 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
new best score!!!!
Validation loss decreased (0.022274 --> 0.017479).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 9 cost time: 1.6084156036376953
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0043344  Vali Loss: 0.0250632 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 1.6001832485198975
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0041767  Vali Loss: 0.0287053 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 1.5992240905761719
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0051700  Vali Loss: 0.0156071 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
new best score!!!!
Validation loss decreased (0.017479 --> 0.015607).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 12 cost time: 1.598982810974121
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0046989  Vali Loss: 0.0339786 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971684  Vali macro F1 0.9950751 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 13 cost time: 1.6006383895874023
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0046222  Vali Loss: 0.0242581 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971684  Vali macro F1 0.9950751 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 14 cost time: 1.6004984378814697
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0038426  Vali Loss: 0.0320176 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 15 cost time: 1.6012687683105469
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0041554  Vali Loss: 0.0253883 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971684  Vali macro F1 0.9950751 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 16 cost time: 1.6005785465240479
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0034906  Vali Loss: 0.0289355 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 17 cost time: 1.6002321243286133
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0031152  Vali Loss: 0.0308497 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 18 cost time: 1.6009893417358398
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0032521  Vali Loss: 0.0258994 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 19 cost time: 1.6008851528167725
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0035921  Vali Loss: 0.0222861 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 20 cost time: 1.6013340950012207
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0031581  Vali Loss: 0.0293568 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 21 cost time: 1.5988445281982422
Fine Tuning VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0032166  Vali Loss: 0.0298540 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 22 cost time: 1.5991919040679932
Fine Tuning VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0029273  Vali Loss: 0.0310400 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 23 cost time: 1.5981600284576416
Fine Tuning VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0026250  Vali Loss: 0.0303857 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 24 cost time: 1.5988874435424805
Fine Tuning VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0022728  Vali Loss: 0.0303073 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 25 cost time: 1.599778175354004
Fine Tuning VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0026357  Vali Loss: 0.0297502 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 26 cost time: 1.5998203754425049
Fine Tuning VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0032158  Vali Loss: 0.0244711 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9886878  Test weighted F1: 0.9886925  Test macro F1 0.9861456 
================ the 1 th CV Experiment ================ 
Overlapping random Experiment : The 2 Part as the test
[-] Target sampling weights:  [0.00266667 0.00239234 0.0023753  0.00332226 0.00595238 0.00568182
 0.00320513 0.00302115 0.00234192 0.00390625]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.3846330642700195
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.1297885  Vali Loss: 1.6222939 Vali Accuracy: 0.4915254  Vali weighted F1: 0.4893533  Vali macro F1 0.4599169 
Validation loss decreased (inf --> 1.622294).  Saving model ...
Epoch: 2 cost time: 1.385488748550415
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.2808115  Vali Loss: 0.7932155 Vali Accuracy: 0.7768362  Vali weighted F1: 0.7606694  Vali macro F1 0.7151978 
new best score!!!!
Validation loss decreased (1.622294 --> 0.793216).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.3826453685760498
VALI: Epoch: 3, Steps: 13 | Train Loss: 0.7261957  Vali Loss: 0.4855732 Vali Accuracy: 0.8446328  Vali weighted F1: 0.8323887  Vali macro F1 0.7903837 
new best score!!!!
Validation loss decreased (0.793216 --> 0.485573).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.386167287826538
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.4883927  Vali Loss: 0.3637402 Vali Accuracy: 0.8672316  Vali weighted F1: 0.8639567  Vali macro F1 0.8302825 
new best score!!!!
Validation loss decreased (0.485573 --> 0.363740).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.3965001106262207
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.3566590  Vali Loss: 0.2844202 Vali Accuracy: 0.9011299  Vali weighted F1: 0.8859134  Vali macro F1 0.8361836 
new best score!!!!
Validation loss decreased (0.363740 --> 0.284420).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.384920358657837
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.2731882  Vali Loss: 0.2125395 Vali Accuracy: 0.9180791  Vali weighted F1: 0.9175954  Vali macro F1 0.8847449 
new best score!!!!
Validation loss decreased (0.284420 --> 0.212540).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.3829104900360107
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.2288429  Vali Loss: 0.2045681 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9134775  Vali macro F1 0.8729824 
new best score!!!!
Validation loss decreased (0.212540 --> 0.204568).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.3939800262451172
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.1810304  Vali Loss: 0.1498490 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9429160  Vali macro F1 0.9170813 
new best score!!!!
Validation loss decreased (0.204568 --> 0.149849).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.3941855430603027
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.1480803  Vali Loss: 0.1401189 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9493940  Vali macro F1 0.9234840 
new best score!!!!
Validation loss decreased (0.149849 --> 0.140119).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.3887476921081543
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.1305423  Vali Loss: 0.1191189 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9395264  Vali macro F1 0.9027351 
new best score!!!!
Validation loss decreased (0.140119 --> 0.119119).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.390763759613037
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.1152173  Vali Loss: 0.1225154 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9515622  Vali macro F1 0.9255325 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 1.385423183441162
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1081965  Vali Loss: 0.1090015 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9576185  Vali macro F1 0.9347588 
new best score!!!!
Validation loss decreased (0.119119 --> 0.109002).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.3880650997161865
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0871805  Vali Loss: 0.1055487 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9548374  Vali macro F1 0.9300446 
new best score!!!!
Validation loss decreased (0.109002 --> 0.105549).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.3948688507080078
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0786059  Vali Loss: 0.1185842 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9494764  Vali macro F1 0.9235302 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 1.4009754657745361
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0720262  Vali Loss: 0.0796183 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9709861  Vali macro F1 0.9547428 
new best score!!!!
Validation loss decreased (0.105549 --> 0.079618).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.3863236904144287
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0606506  Vali Loss: 0.1188073 Vali Accuracy: 0.9435028  Vali weighted F1: 0.9401679  Vali macro F1 0.9107401 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 17 cost time: 1.3856229782104492
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0624676  Vali Loss: 0.1033508 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9563324  Vali macro F1 0.9351270 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 18 cost time: 1.3908700942993164
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0494041  Vali Loss: 0.0673824 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9771866  Vali macro F1 0.9628263 
new best score!!!!
Validation loss decreased (0.079618 --> 0.067382).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.387213945388794
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0449059  Vali Loss: 0.0635862 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9738154  Vali macro F1 0.9567199 
new best score!!!!
Validation loss decreased (0.067382 --> 0.063586).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.3875350952148438
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0429832  Vali Loss: 0.0771147 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9744306  Vali macro F1 0.9572651 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 1.3969762325286865
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0389805  Vali Loss: 0.1143466 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9537105  Vali macro F1 0.9207729 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 1.3884131908416748
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0443187  Vali Loss: 0.0569920 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9743657  Vali macro F1 0.9605515 
new best score!!!!
Validation loss decreased (0.063586 --> 0.056992).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.3878436088562012
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0338297  Vali Loss: 0.0719200 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9741904  Vali macro F1 0.9575238 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 1.3997936248779297
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0267009  Vali Loss: 0.0574466 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9799370  Vali macro F1 0.9675729 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 1.3873252868652344
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0249955  Vali Loss: 0.0460119 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858093  Vali macro F1 0.9779131 
new best score!!!!
Validation loss decreased (0.056992 --> 0.046012).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.3886473178863525
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0185745  Vali Loss: 0.0678760 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9742978  Vali macro F1 0.9618589 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 1.3886113166809082
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0186446  Vali Loss: 0.0341072 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
new best score!!!!
Validation loss decreased (0.046012 --> 0.034107).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 1.3894848823547363
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0201276  Vali Loss: 0.0477987 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859952  Vali macro F1 0.9770160 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 1.3883061408996582
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0195502  Vali Loss: 0.0487974 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9800419  Vali macro F1 0.9706446 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 1.3877699375152588
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0158921  Vali Loss: 0.0540255 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803117  Vali macro F1 0.9697000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 31 cost time: 1.3989019393920898
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0127189  Vali Loss: 0.0624828 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9856837  Vali macro F1 0.9776219 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 32 cost time: 1.3855845928192139
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0173091  Vali Loss: 0.0588971 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831119  Vali macro F1 0.9774297 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 33 cost time: 1.3873896598815918
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0139137  Vali Loss: 0.0398893 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831798  Vali macro F1 0.9773746 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 34 cost time: 1.39739990234375
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0097339  Vali Loss: 0.0435840 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9859681  Vali macro F1 0.9795809 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 35 cost time: 1.396815299987793
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0092039  Vali Loss: 0.0478144 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803163  Vali macro F1 0.9725850 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 36 cost time: 1.3888051509857178
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0076064  Vali Loss: 0.0534443 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803163  Vali macro F1 0.9725850 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 37 cost time: 1.3946959972381592
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0092202  Vali Loss: 0.0581677 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803163  Vali macro F1 0.9725850 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 38 cost time: 1.386993646621704
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0074862  Vali Loss: 0.0584725 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803163  Vali macro F1 0.9725850 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 39 cost time: 1.4040555953979492
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0076325  Vali Loss: 0.0587299 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803163  Vali macro F1 0.9725850 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 40 cost time: 1.3884806632995605
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0071384  Vali Loss: 0.0587700 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803163  Vali macro F1 0.9725850 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 41 cost time: 1.3974361419677734
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0072585  Vali Loss: 0.0584823 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803163  Vali macro F1 0.9725850 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 42 cost time: 1.3879680633544922
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0081075  Vali Loss: 0.0579150 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803163  Vali macro F1 0.9725850 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9841629  Test weighted F1: 0.9842504  Test macro F1 0.9806102 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1125747
pruned model Parameter : 1128786
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.599104404449463
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0142003  Vali Loss: 0.0298376 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886820  Vali macro F1 0.9829451 
Validation loss decreased (inf --> 0.029838).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.5981988906860352
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0112975  Vali Loss: 0.0552124 Vali Accuracy: 0.9774011  Vali weighted F1: 0.9774555  Vali macro F1 0.9675487 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.5993866920471191
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0098758  Vali Loss: 0.0486143 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803117  Vali macro F1 0.9697000 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 4 cost time: 1.598512887954712
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0089202  Vali Loss: 0.0596402 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803117  Vali macro F1 0.9697000 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 5 cost time: 1.5996687412261963
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0101571  Vali Loss: 0.0471561 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9828981  Vali macro F1 0.9727959 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 6 cost time: 1.6025974750518799
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0085959  Vali Loss: 0.0450379 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858093  Vali macro F1 0.9779131 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 1.5975286960601807
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0098497  Vali Loss: 0.0521870 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831726  Vali macro F1 0.9747363 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 1.6008124351501465
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0078516  Vali Loss: 0.0576259 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831726  Vali macro F1 0.9747363 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 1.5993015766143799
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0071178  Vali Loss: 0.0602543 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9803117  Vali macro F1 0.9697000 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 1.6014151573181152
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0066356  Vali Loss: 0.0515771 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831726  Vali macro F1 0.9747363 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 11 cost time: 1.5996639728546143
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0061719  Vali Loss: 0.0530385 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831726  Vali macro F1 0.9747363 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 1.6009666919708252
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0078393  Vali Loss: 0.0491572 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831726  Vali macro F1 0.9747363 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 1.598602056503296
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0065018  Vali Loss: 0.0513814 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831726  Vali macro F1 0.9747363 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 1.6027240753173828
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0062157  Vali Loss: 0.0545274 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831726  Vali macro F1 0.9747363 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 1.5986380577087402
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0065618  Vali Loss: 0.0566226 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831726  Vali macro F1 0.9747363 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1.0000000000000002e-06
Fine Tuning Epoch: 16 cost time: 1.6006543636322021
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0056584  Vali Loss: 0.0567249 Vali Accuracy: 0.9830508  Vali weighted F1: 0.9831726  Vali macro F1 0.9747363 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9852941  Test weighted F1: 0.9853447  Test macro F1 0.9818496 
================ the 2 th CV Experiment ================ 
Overlapping random Experiment : The 3 Part as the test
[-] Target sampling weights:  [0.00277008 0.00236407 0.00247525 0.00325733 0.00543478 0.00574713
 0.00328947 0.00277008 0.00242131 0.00393701]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.3845105171203613
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.1065173  Vali Loss: 1.5816446 Vali Accuracy: 0.5000000  Vali weighted F1: 0.4761777  Vali macro F1 0.4623725 
Validation loss decreased (inf --> 1.581645).  Saving model ...
Epoch: 2 cost time: 1.3940176963806152
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.2379719  Vali Loss: 0.8100505 Vali Accuracy: 0.7090395  Vali weighted F1: 0.6701065  Vali macro F1 0.6129623 
new best score!!!!
Validation loss decreased (1.581645 --> 0.810050).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.3843250274658203
VALI: Epoch: 3, Steps: 13 | Train Loss: 0.7289113  Vali Loss: 0.5159385 Vali Accuracy: 0.8333333  Vali weighted F1: 0.8186862  Vali macro F1 0.7793019 
new best score!!!!
Validation loss decreased (0.810050 --> 0.515938).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.3894920349121094
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.5038565  Vali Loss: 0.3651651 Vali Accuracy: 0.8587571  Vali weighted F1: 0.8502018  Vali macro F1 0.8132105 
new best score!!!!
Validation loss decreased (0.515938 --> 0.365165).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.384803295135498
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.3750508  Vali Loss: 0.2847021 Vali Accuracy: 0.8898305  Vali weighted F1: 0.8843092  Vali macro F1 0.8389520 
new best score!!!!
Validation loss decreased (0.365165 --> 0.284702).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.3839190006256104
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.2810340  Vali Loss: 0.2316364 Vali Accuracy: 0.9152542  Vali weighted F1: 0.9052598  Vali macro F1 0.8623600 
new best score!!!!
Validation loss decreased (0.284702 --> 0.231636).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.3847606182098389
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.2332460  Vali Loss: 0.1939928 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9136290  Vali macro F1 0.8636650 
new best score!!!!
Validation loss decreased (0.231636 --> 0.193993).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.4021108150482178
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.1908426  Vali Loss: 0.1616846 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9225038  Vali macro F1 0.8723451 
new best score!!!!
Validation loss decreased (0.193993 --> 0.161685).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.3888869285583496
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.1568443  Vali Loss: 0.1291844 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9576268  Vali macro F1 0.9292118 
new best score!!!!
Validation loss decreased (0.161685 --> 0.129184).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.385244607925415
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.1442934  Vali Loss: 0.1277379 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9349619  Vali macro F1 0.8955831 
new best score!!!!
Validation loss decreased (0.129184 --> 0.127738).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.3825454711914062
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.1377609  Vali Loss: 0.1144587 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9475153  Vali macro F1 0.9137695 
new best score!!!!
Validation loss decreased (0.127738 --> 0.114459).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.394850492477417
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1153543  Vali Loss: 0.1126259 Vali Accuracy: 0.9519774  Vali weighted F1: 0.9442404  Vali macro F1 0.9026258 
new best score!!!!
Validation loss decreased (0.114459 --> 0.112626).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.3869309425354004
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0969006  Vali Loss: 0.0921198 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9509162  Vali macro F1 0.9132275 
new best score!!!!
Validation loss decreased (0.112626 --> 0.092120).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.388462781906128
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0815313  Vali Loss: 0.0919974 Vali Accuracy: 0.9576271  Vali weighted F1: 0.9559716  Vali macro F1 0.9281430 
new best score!!!!
Validation loss decreased (0.092120 --> 0.091997).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.389267921447754
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0678584  Vali Loss: 0.0658390 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9738132  Vali macro F1 0.9568721 
new best score!!!!
Validation loss decreased (0.091997 --> 0.065839).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.387608289718628
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0506781  Vali Loss: 0.0524805 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915254  Vali macro F1 0.9853659 
new best score!!!!
Validation loss decreased (0.065839 --> 0.052481).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.3876194953918457
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0427785  Vali Loss: 0.0475437 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886820  Vali macro F1 0.9829451 
new best score!!!!
Validation loss decreased (0.052481 --> 0.047544).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.3860230445861816
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0360851  Vali Loss: 0.0550089 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9797368  Vali macro F1 0.9645022 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 19 cost time: 1.383260726928711
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0451205  Vali Loss: 0.0821819 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9675793  Vali macro F1 0.9470845 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 20 cost time: 1.383770227432251
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0417632  Vali Loss: 0.0382365 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971785  Vali macro F1 0.9951103 
new best score!!!!
Validation loss decreased (0.047544 --> 0.038237).  Saving model ...
new best score!!!!
Epoch: 21 cost time: 1.3872044086456299
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0312172  Vali Loss: 0.0388512 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943555  Vali macro F1 0.9928302 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 22 cost time: 1.390505313873291
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0283176  Vali Loss: 0.0364932 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858740  Vali macro F1 0.9807476 
new best score!!!!
Validation loss decreased (0.038237 --> 0.036493).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.388016939163208
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0214277  Vali Loss: 0.0371516 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 24 cost time: 1.387192964553833
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0218580  Vali Loss: 0.0451304 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858093  Vali macro F1 0.9779131 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 25 cost time: 1.396449327468872
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0215802  Vali Loss: 0.0230159 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943570  Vali macro F1 0.9902381 
new best score!!!!
Validation loss decreased (0.036493 --> 0.023016).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.3864831924438477
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0150209  Vali Loss: 0.0202145 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971785  Vali macro F1 0.9951103 
new best score!!!!
Validation loss decreased (0.023016 --> 0.020214).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.3879952430725098
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0127528  Vali Loss: 0.0234968 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 1.3955137729644775
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0120872  Vali Loss: 0.0320718 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915296  Vali macro F1 0.9879509 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 29 cost time: 1.387155294418335
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0129416  Vali Loss: 0.0407528 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 30 cost time: 1.3856961727142334
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0112734  Vali Loss: 0.0273987 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 31 cost time: 1.3864319324493408
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0090714  Vali Loss: 0.0177308 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971785  Vali macro F1 0.9951103 
new best score!!!!
Validation loss decreased (0.020214 --> 0.017731).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 1.3883187770843506
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0138887  Vali Loss: 0.0285750 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886323  Vali macro F1 0.9801932 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 1.3868472576141357
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0082614  Vali Loss: 0.0173238 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971785  Vali macro F1 0.9951103 
new best score!!!!
Validation loss decreased (0.017731 --> 0.017324).  Saving model ...
new best score!!!!
Epoch: 34 cost time: 1.388645887374878
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0090133  Vali Loss: 0.0216537 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971785  Vali macro F1 0.9951103 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 1.395052433013916
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0098744  Vali Loss: 0.0318291 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943570  Vali macro F1 0.9902381 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 1.387554407119751
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0097714  Vali Loss: 0.0224744 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943563  Vali macro F1 0.9927692 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 1.3871469497680664
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0121430  Vali Loss: 0.0255671 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943555  Vali macro F1 0.9928302 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 1.4001352787017822
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0132665  Vali Loss: 0.0206857 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943511  Vali macro F1 0.9928231 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 39 cost time: 1.3851675987243652
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0072831  Vali Loss: 0.0201321 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971785  Vali macro F1 0.9951103 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 1.3860423564910889
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0064511  Vali Loss: 0.0181572 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971785  Vali macro F1 0.9951103 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 1.3900322914123535
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0051874  Vali Loss: 0.0176471 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971785  Vali macro F1 0.9951103 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 1.3851487636566162
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0047110  Vali Loss: 0.0177785 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971785  Vali macro F1 0.9951103 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 1.386242151260376
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0042122  Vali Loss: 0.0183786 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971785  Vali macro F1 0.9951103 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 44 cost time: 1.3861238956451416
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0041408  Vali Loss: 0.0183895 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971785  Vali macro F1 0.9951103 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 45 cost time: 1.3855431079864502
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0045874  Vali Loss: 0.0183490 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971785  Vali macro F1 0.9951103 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 46 cost time: 1.385735034942627
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0043435  Vali Loss: 0.0183030 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971785  Vali macro F1 0.9951103 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 47 cost time: 1.3832247257232666
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0048762  Vali Loss: 0.0183306 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971785  Vali macro F1 0.9951103 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 48 cost time: 1.3956241607666016
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0049505  Vali Loss: 0.0183896 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971785  Vali macro F1 0.9951103 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9954751  Test weighted F1: 0.9954720  Test macro F1 0.9959629 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1125747
pruned model Parameter : 1128786
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.597618579864502
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0071450  Vali Loss: 0.0175038 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971785  Vali macro F1 0.9951103 
Validation loss decreased (inf --> 0.017504).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.5978126525878906
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0069820  Vali Loss: 0.0192413 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.5973625183105469
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0048672  Vali Loss: 0.0170951 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971785  Vali macro F1 0.9951103 
new best score!!!!
Validation loss decreased (0.017504 --> 0.017095).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 1.5957820415496826
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0044006  Vali Loss: 0.0175141 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 1.5945751667022705
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0038792  Vali Loss: 0.0162536 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971785  Vali macro F1 0.9951103 
new best score!!!!
Validation loss decreased (0.017095 --> 0.016254).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 6 cost time: 1.594672441482544
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0036252  Vali Loss: 0.0170268 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971785  Vali macro F1 0.9951103 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 7 cost time: 1.5961949825286865
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0040494  Vali Loss: 0.0206363 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 8 cost time: 1.5981519222259521
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0033695  Vali Loss: 0.0180356 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 9 cost time: 1.5970687866210938
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0030069  Vali Loss: 0.0169178 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971785  Vali macro F1 0.9951103 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 10 cost time: 1.5967271327972412
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0031771  Vali Loss: 0.0184346 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 11 cost time: 1.5956621170043945
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0028436  Vali Loss: 0.0173404 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971785  Vali macro F1 0.9951103 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 12 cost time: 1.5944328308105469
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0032622  Vali Loss: 0.0186232 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 13 cost time: 1.5964219570159912
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0027284  Vali Loss: 0.0169975 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971785  Vali macro F1 0.9951103 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 14 cost time: 1.596757173538208
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0022249  Vali Loss: 0.0171729 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971785  Vali macro F1 0.9951103 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 15 cost time: 1.5962398052215576
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0021728  Vali Loss: 0.0178340 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971785  Vali macro F1 0.9951103 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 16 cost time: 1.5962049961090088
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0020653  Vali Loss: 0.0177901 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971785  Vali macro F1 0.9951103 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 17 cost time: 1.597900629043579
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0025323  Vali Loss: 0.0178579 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971785  Vali macro F1 0.9951103 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 18 cost time: 1.596632719039917
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0022789  Vali Loss: 0.0177811 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971785  Vali macro F1 0.9951103 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 19 cost time: 1.5967433452606201
Fine Tuning VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0027742  Vali Loss: 0.0179901 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971785  Vali macro F1 0.9951103 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 20 cost time: 1.5971717834472656
Fine Tuning VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0026873  Vali Loss: 0.0178200 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971785  Vali macro F1 0.9951103 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9943439  Test weighted F1: 0.9943412  Test macro F1 0.9926074 
================ the 3 th CV Experiment ================ 
Overlapping random Experiment : The 4 Part as the test
[-] Target sampling weights:  [0.00271003 0.0023753  0.00240964 0.00321543 0.00543478 0.00591716
 0.00318471 0.00295858 0.00248756 0.00381679]
Train data number :  3185
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  884
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.3877556324005127
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.1105228  Vali Loss: 1.5531023 Vali Accuracy: 0.4887006  Vali weighted F1: 0.4764370  Vali macro F1 0.4667034 
Validation loss decreased (inf --> 1.553102).  Saving model ...
Epoch: 2 cost time: 1.3920600414276123
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.2067760  Vali Loss: 0.7746769 Vali Accuracy: 0.7175141  Vali weighted F1: 0.7013077  Vali macro F1 0.6579289 
new best score!!!!
Validation loss decreased (1.553102 --> 0.774677).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.385364294052124
VALI: Epoch: 3, Steps: 13 | Train Loss: 0.7022503  Vali Loss: 0.4916308 Vali Accuracy: 0.8192090  Vali weighted F1: 0.8164459  Vali macro F1 0.7752185 
new best score!!!!
Validation loss decreased (0.774677 --> 0.491631).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.384509563446045
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.4814913  Vali Loss: 0.3507751 Vali Accuracy: 0.8644068  Vali weighted F1: 0.8442440  Vali macro F1 0.7938481 
new best score!!!!
Validation loss decreased (0.491631 --> 0.350775).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.3834764957427979
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.3580564  Vali Loss: 0.2688759 Vali Accuracy: 0.8898305  Vali weighted F1: 0.8905831  Vali macro F1 0.8561249 
new best score!!!!
Validation loss decreased (0.350775 --> 0.268876).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.3847100734710693
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.2758728  Vali Loss: 0.2274493 Vali Accuracy: 0.9039548  Vali weighted F1: 0.9039048  Vali macro F1 0.8632668 
new best score!!!!
Validation loss decreased (0.268876 --> 0.227449).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.3845117092132568
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.2359872  Vali Loss: 0.1956338 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9113440  Vali macro F1 0.8549222 
new best score!!!!
Validation loss decreased (0.227449 --> 0.195634).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.384751558303833
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.2022842  Vali Loss: 0.1816260 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9157951  Vali macro F1 0.8635642 
new best score!!!!
Validation loss decreased (0.195634 --> 0.181626).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.3872382640838623
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.1695792  Vali Loss: 0.1594626 Vali Accuracy: 0.9322034  Vali weighted F1: 0.9251067  Vali macro F1 0.8876208 
new best score!!!!
Validation loss decreased (0.181626 --> 0.159463).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.3833129405975342
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.1535813  Vali Loss: 0.1375692 Vali Accuracy: 0.9265537  Vali weighted F1: 0.9264552  Vali macro F1 0.8884406 
new best score!!!!
Validation loss decreased (0.159463 --> 0.137569).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.382279634475708
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.1362359  Vali Loss: 0.1381432 Vali Accuracy: 0.9491525  Vali weighted F1: 0.9491918  Vali macro F1 0.9256271 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 12 cost time: 1.3827009201049805
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1228392  Vali Loss: 0.0980973 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9649576  Vali macro F1 0.9385000 
new best score!!!!
Validation loss decreased (0.137569 --> 0.098097).  Saving model ...
new best score!!!!
Epoch: 13 cost time: 1.3827528953552246
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1021558  Vali Loss: 0.0956242 Vali Accuracy: 0.9632768  Vali weighted F1: 0.9633172  Vali macro F1 0.9389594 
new best score!!!!
Validation loss decreased (0.098097 --> 0.095624).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.3840858936309814
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0883702  Vali Loss: 0.1113155 Vali Accuracy: 0.9548023  Vali weighted F1: 0.9463622  Vali macro F1 0.9062375 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 15 cost time: 1.3845317363739014
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0759987  Vali Loss: 0.0828498 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9689173  Vali macro F1 0.9530775 
new best score!!!!
Validation loss decreased (0.095624 --> 0.082850).  Saving model ...
new best score!!!!
Epoch: 16 cost time: 1.3839635848999023
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0616849  Vali Loss: 0.0765628 Vali Accuracy: 0.9661017  Vali weighted F1: 0.9649551  Vali macro F1 0.9456160 
new best score!!!!
Validation loss decreased (0.082850 --> 0.076563).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.3825013637542725
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0592867  Vali Loss: 0.0817007 Vali Accuracy: 0.9689266  Vali weighted F1: 0.9671106  Vali macro F1 0.9475530 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 18 cost time: 1.3803606033325195
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0594362  Vali Loss: 0.0596702 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858396  Vali macro F1 0.9773548 
new best score!!!!
Validation loss decreased (0.076563 --> 0.059670).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.383678913116455
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0449636  Vali Loss: 0.0384656 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
new best score!!!!
Validation loss decreased (0.059670 --> 0.038466).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.3810715675354004
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0388653  Vali Loss: 0.0386985 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858563  Vali macro F1 0.9808996 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 1.3860702514648438
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0327145  Vali Loss: 0.0535841 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9798935  Vali macro F1 0.9655255 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 22 cost time: 1.3860607147216797
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0377066  Vali Loss: 0.0382254 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915051  Vali macro F1 0.9852252 
new best score!!!!
Validation loss decreased (0.038466 --> 0.038225).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.3846094608306885
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0305687  Vali Loss: 0.0328187 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915254  Vali macro F1 0.9853659 
new best score!!!!
Validation loss decreased (0.038225 --> 0.032819).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.3873748779296875
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0269950  Vali Loss: 0.0261674 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943533  Vali macro F1 0.9929824 
new best score!!!!
Validation loss decreased (0.032819 --> 0.026167).  Saving model ...
new best score!!!!
Epoch: 25 cost time: 1.396871566772461
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0253005  Vali Loss: 0.0482434 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886980  Vali macro F1 0.9830787 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 26 cost time: 1.3907296657562256
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0193453  Vali Loss: 0.0215200 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
new best score!!!!
Validation loss decreased (0.026167 --> 0.021520).  Saving model ...
new best score!!!!
Epoch: 27 cost time: 1.385906457901001
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0160860  Vali Loss: 0.0318646 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 28 cost time: 1.3850071430206299
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0143907  Vali Loss: 0.0198034 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971785  Vali macro F1 0.9951103 
new best score!!!!
Validation loss decreased (0.021520 --> 0.019803).  Saving model ...
new best score!!!!
Epoch: 29 cost time: 1.3864624500274658
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0096960  Vali Loss: 0.0304319 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886829  Vali macro F1 0.9828841 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 30 cost time: 1.385673999786377
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0091703  Vali Loss: 0.0234781 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943563  Vali macro F1 0.9927692 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 31 cost time: 1.3878042697906494
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0094254  Vali Loss: 0.0307119 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915001  Vali macro F1 0.9906179 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 32 cost time: 1.3860499858856201
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0084383  Vali Loss: 0.0299334 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886797  Vali macro F1 0.9851467 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 33 cost time: 1.3867144584655762
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0098478  Vali Loss: 0.0320312 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887010  Vali macro F1 0.9855633 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 34 cost time: 1.3843772411346436
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0076061  Vali Loss: 0.0299243 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887010  Vali macro F1 0.9855633 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 35 cost time: 1.38606595993042
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0066990  Vali Loss: 0.0301294 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887010  Vali macro F1 0.9855633 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 36 cost time: 1.3848090171813965
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0064219  Vali Loss: 0.0286767 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886737  Vali macro F1 0.9883315 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 37 cost time: 1.3833858966827393
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0057471  Vali Loss: 0.0272669 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886737  Vali macro F1 0.9883315 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 38 cost time: 1.3878443241119385
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0052362  Vali Loss: 0.0291429 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858455  Vali macro F1 0.9834126 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 39 cost time: 1.3854455947875977
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0059331  Vali Loss: 0.0291991 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858455  Vali macro F1 0.9834126 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 40 cost time: 1.3857598304748535
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0050810  Vali Loss: 0.0292294 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858455  Vali macro F1 0.9834126 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 41 cost time: 1.386277437210083
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0056153  Vali Loss: 0.0294097 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858455  Vali macro F1 0.9834126 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 42 cost time: 1.3847472667694092
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0058993  Vali Loss: 0.0296953 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858455  Vali macro F1 0.9834126 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 43 cost time: 1.385349988937378
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0057316  Vali Loss: 0.0304650 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858455  Vali macro F1 0.9834126 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9966063  Test weighted F1: 0.9966064  Test macro F1 0.9957953 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1125747
pruned model Parameter : 1128786
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.5919129848480225
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0111189  Vali Loss: 0.0292845 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915281  Vali macro F1 0.9878503 
Validation loss decreased (inf --> 0.029284).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.5850274562835693
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0094974  Vali Loss: 0.0206885 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971785  Vali macro F1 0.9951103 
new best score!!!!
Validation loss decreased (0.029284 --> 0.020688).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 3 cost time: 1.5910613536834717
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0079505  Vali Loss: 0.0186796 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971785  Vali macro F1 0.9951103 
new best score!!!!
Validation loss decreased (0.020688 --> 0.018680).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 1.5890355110168457
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0081225  Vali Loss: 0.0195306 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971785  Vali macro F1 0.9951103 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 1.5894176959991455
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0066648  Vali Loss: 0.0201122 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971785  Vali macro F1 0.9951103 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 1.5864148139953613
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0071531  Vali Loss: 0.0195133 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943511  Vali macro F1 0.9928231 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 1.5872399806976318
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0069810  Vali Loss: 0.0225869 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943563  Vali macro F1 0.9927692 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 8 cost time: 1.5866329669952393
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0058474  Vali Loss: 0.0227449 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943563  Vali macro F1 0.9927692 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 9 cost time: 1.5888516902923584
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0058576  Vali Loss: 0.0232666 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943503  Vali macro F1 0.9901914 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 1.5885684490203857
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0057782  Vali Loss: 0.0214366 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943563  Vali macro F1 0.9927692 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 1.589958906173706
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0059458  Vali Loss: 0.0311425 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915001  Vali macro F1 0.9906179 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 1.5878257751464844
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0061399  Vali Loss: 0.0269979 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886719  Vali macro F1 0.9856990 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 1.588514804840088
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0050428  Vali Loss: 0.0258567 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915281  Vali macro F1 0.9878503 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 14 cost time: 1.588611125946045
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0058608  Vali Loss: 0.0273296 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915281  Vali macro F1 0.9878503 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 1.5890145301818848
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0049186  Vali Loss: 0.0290682 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915281  Vali macro F1 0.9878503 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 1.5907917022705078
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0045973  Vali Loss: 0.0294346 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915281  Vali macro F1 0.9878503 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 1.590122938156128
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0044618  Vali Loss: 0.0288456 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915281  Vali macro F1 0.9878503 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 1.5870020389556885
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0044193  Vali Loss: 0.0321559 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915281  Vali macro F1 0.9878503 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9977376  Test weighted F1: 0.9977381  Test macro F1 0.9969727 
================ the 4 th CV Experiment ================ 
Overlapping random Experiment : The 5 Part as the test
[-] Target sampling weights:  [0.00280112 0.00238095 0.00246914 0.00320513 0.00543478 0.00588235
 0.00315457 0.00289017 0.00235849 0.00404858]
Train data number :  3182
The number of classes is :  10
The input_length  is :  84
The channel_in is :  30
Validation data number :  354
Test data number :  887
================ Build the model ================ 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Epoch: 1 cost time: 1.3871867656707764
VALI: Epoch: 1, Steps: 13 | Train Loss: 2.1306941  Vali Loss: 1.6205050 Vali Accuracy: 0.4604520  Vali weighted F1: 0.4369381  Vali macro F1 0.4236231 
Validation loss decreased (inf --> 1.620505).  Saving model ...
Epoch: 2 cost time: 1.3872413635253906
VALI: Epoch: 2, Steps: 13 | Train Loss: 1.2507636  Vali Loss: 0.8427921 Vali Accuracy: 0.7570621  Vali weighted F1: 0.7410276  Vali macro F1 0.7099010 
new best score!!!!
Validation loss decreased (1.620505 --> 0.842792).  Saving model ...
new best score!!!!
Epoch: 3 cost time: 1.384720802307129
VALI: Epoch: 3, Steps: 13 | Train Loss: 0.7184938  Vali Loss: 0.5335255 Vali Accuracy: 0.8248588  Vali weighted F1: 0.8242074  Vali macro F1 0.7796709 
new best score!!!!
Validation loss decreased (0.842792 --> 0.533526).  Saving model ...
new best score!!!!
Epoch: 4 cost time: 1.3838996887207031
VALI: Epoch: 4, Steps: 13 | Train Loss: 0.4726235  Vali Loss: 0.3780160 Vali Accuracy: 0.8870056  Vali weighted F1: 0.8869195  Vali macro F1 0.8799678 
new best score!!!!
Validation loss decreased (0.533526 --> 0.378016).  Saving model ...
new best score!!!!
Epoch: 5 cost time: 1.384134292602539
VALI: Epoch: 5, Steps: 13 | Train Loss: 0.3431845  Vali Loss: 0.2834363 Vali Accuracy: 0.9067797  Vali weighted F1: 0.9020192  Vali macro F1 0.8645093 
new best score!!!!
Validation loss decreased (0.378016 --> 0.283436).  Saving model ...
new best score!!!!
Epoch: 6 cost time: 1.3835656642913818
VALI: Epoch: 6, Steps: 13 | Train Loss: 0.2650080  Vali Loss: 0.2163156 Vali Accuracy: 0.9124294  Vali weighted F1: 0.8932088  Vali macro F1 0.8418779 
new best score!!!!
Validation loss decreased (0.283436 --> 0.216316).  Saving model ...
new best score!!!!
Epoch: 7 cost time: 1.383608341217041
VALI: Epoch: 7, Steps: 13 | Train Loss: 0.2166414  Vali Loss: 0.1853871 Vali Accuracy: 0.9293785  Vali weighted F1: 0.9265652  Vali macro F1 0.8956111 
new best score!!!!
Validation loss decreased (0.216316 --> 0.185387).  Saving model ...
new best score!!!!
Epoch: 8 cost time: 1.38313627243042
VALI: Epoch: 8, Steps: 13 | Train Loss: 0.1991285  Vali Loss: 0.1581020 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9281636  Vali macro F1 0.8895490 
new best score!!!!
Validation loss decreased (0.185387 --> 0.158102).  Saving model ...
new best score!!!!
Epoch: 9 cost time: 1.38307523727417
VALI: Epoch: 9, Steps: 13 | Train Loss: 0.1615451  Vali Loss: 0.1454429 Vali Accuracy: 0.9152542  Vali weighted F1: 0.8959984  Vali macro F1 0.8444174 
new best score!!!!
Validation loss decreased (0.158102 --> 0.145443).  Saving model ...
new best score!!!!
Epoch: 10 cost time: 1.3831961154937744
VALI: Epoch: 10, Steps: 13 | Train Loss: 0.1424600  Vali Loss: 0.1391885 Vali Accuracy: 0.9209040  Vali weighted F1: 0.9016260  Vali macro F1 0.8486929 
new best score!!!!
Validation loss decreased (0.145443 --> 0.139189).  Saving model ...
new best score!!!!
Epoch: 11 cost time: 1.3844575881958008
VALI: Epoch: 11, Steps: 13 | Train Loss: 0.1319471  Vali Loss: 0.1195489 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9603572  Vali macro F1 0.9457352 
new best score!!!!
Validation loss decreased (0.139189 --> 0.119549).  Saving model ...
new best score!!!!
Epoch: 12 cost time: 1.3840234279632568
VALI: Epoch: 12, Steps: 13 | Train Loss: 0.1238949  Vali Loss: 0.1219593 Vali Accuracy: 0.9378531  Vali weighted F1: 0.9199541  Vali macro F1 0.8619889 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 13 cost time: 1.3824970722198486
VALI: Epoch: 13, Steps: 13 | Train Loss: 0.1136606  Vali Loss: 0.0959184 Vali Accuracy: 0.9717514  Vali weighted F1: 0.9717527  Vali macro F1 0.9556984 
new best score!!!!
Validation loss decreased (0.119549 --> 0.095918).  Saving model ...
new best score!!!!
Epoch: 14 cost time: 1.383117914199829
VALI: Epoch: 14, Steps: 13 | Train Loss: 0.1053693  Vali Loss: 0.0920073 Vali Accuracy: 0.9604520  Vali weighted F1: 0.9589157  Vali macro F1 0.9362459 
new best score!!!!
Validation loss decreased (0.095918 --> 0.092007).  Saving model ...
new best score!!!!
Epoch: 15 cost time: 1.3827619552612305
VALI: Epoch: 15, Steps: 13 | Train Loss: 0.1017045  Vali Loss: 0.1048272 Vali Accuracy: 0.9350282  Vali weighted F1: 0.9258392  Vali macro F1 0.8858102 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 16 cost time: 1.3864974975585938
VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0952063  Vali Loss: 0.0825735 Vali Accuracy: 0.9802260  Vali weighted F1: 0.9795531  Vali macro F1 0.9652851 
new best score!!!!
Validation loss decreased (0.092007 --> 0.082574).  Saving model ...
new best score!!!!
Epoch: 17 cost time: 1.3865447044372559
VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0904464  Vali Loss: 0.0754585 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9741013  Vali macro F1 0.9562719 
new best score!!!!
Validation loss decreased (0.082574 --> 0.075458).  Saving model ...
new best score!!!!
Epoch: 18 cost time: 1.381955623626709
VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0805896  Vali Loss: 0.0631039 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887289  Vali macro F1 0.9799499 
new best score!!!!
Validation loss decreased (0.075458 --> 0.063104).  Saving model ...
new best score!!!!
Epoch: 19 cost time: 1.39125394821167
VALI: Epoch: 19, Steps: 13 | Train Loss: 0.0754257  Vali Loss: 0.0548956 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887147  Vali macro F1 0.9856694 
new best score!!!!
Validation loss decreased (0.063104 --> 0.054896).  Saving model ...
new best score!!!!
Epoch: 20 cost time: 1.382159948348999
VALI: Epoch: 20, Steps: 13 | Train Loss: 0.0604271  Vali Loss: 0.0701728 Vali Accuracy: 0.9745763  Vali weighted F1: 0.9735468  Vali macro F1 0.9578310 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 21 cost time: 1.3860511779785156
VALI: Epoch: 21, Steps: 13 | Train Loss: 0.0530719  Vali Loss: 0.0483910 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887020  Vali macro F1 0.9885081 
new best score!!!!
Validation loss decreased (0.054896 --> 0.048391).  Saving model ...
new best score!!!!
Epoch: 22 cost time: 1.3855493068695068
VALI: Epoch: 22, Steps: 13 | Train Loss: 0.0434623  Vali Loss: 0.0431263 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858859  Vali macro F1 0.9835114 
new best score!!!!
Validation loss decreased (0.048391 --> 0.043126).  Saving model ...
new best score!!!!
Epoch: 23 cost time: 1.404977798461914
VALI: Epoch: 23, Steps: 13 | Train Loss: 0.0402575  Vali Loss: 0.0278831 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971803  Vali macro F1 0.9972851 
new best score!!!!
Validation loss decreased (0.043126 --> 0.027883).  Saving model ...
new best score!!!!
Epoch: 24 cost time: 1.3851096630096436
VALI: Epoch: 24, Steps: 13 | Train Loss: 0.0362698  Vali Loss: 0.0285600 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943607  Vali macro F1 0.9922568 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 25 cost time: 1.3863646984100342
VALI: Epoch: 25, Steps: 13 | Train Loss: 0.0347966  Vali Loss: 0.0242645 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943563  Vali macro F1 0.9928202 
new best score!!!!
Validation loss decreased (0.027883 --> 0.024265).  Saving model ...
new best score!!!!
Epoch: 26 cost time: 1.3875174522399902
VALI: Epoch: 26, Steps: 13 | Train Loss: 0.0374357  Vali Loss: 0.0587721 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9856510  Vali macro F1 0.9756691 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 27 cost time: 1.3861405849456787
VALI: Epoch: 27, Steps: 13 | Train Loss: 0.0323956  Vali Loss: 0.0214486 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943607  Vali macro F1 0.9922568 
new best score!!!!
Validation loss decreased (0.024265 --> 0.021449).  Saving model ...
new best score!!!!
Epoch: 28 cost time: 1.3863353729248047
VALI: Epoch: 28, Steps: 13 | Train Loss: 0.0314826  Vali Loss: 0.0298104 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943563  Vali macro F1 0.9928202 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 29 cost time: 1.38458251953125
VALI: Epoch: 29, Steps: 13 | Train Loss: 0.0422166  Vali Loss: 0.0301999 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9886703  Vali macro F1 0.9899659 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 30 cost time: 1.3861150741577148
VALI: Epoch: 30, Steps: 13 | Train Loss: 0.0346376  Vali Loss: 0.0187252 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971805  Vali macro F1 0.9949717 
new best score!!!!
Validation loss decreased (0.021449 --> 0.018725).  Saving model ...
new best score!!!!
Epoch: 31 cost time: 1.3863704204559326
VALI: Epoch: 31, Steps: 13 | Train Loss: 0.0236711  Vali Loss: 0.0157533 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971805  Vali macro F1 0.9949717 
new best score!!!!
Validation loss decreased (0.018725 --> 0.015753).  Saving model ...
new best score!!!!
Epoch: 32 cost time: 1.385068655014038
VALI: Epoch: 32, Steps: 13 | Train Loss: 0.0154900  Vali Loss: 0.0176875 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943563  Vali macro F1 0.9928202 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 33 cost time: 1.383371353149414
VALI: Epoch: 33, Steps: 13 | Train Loss: 0.0144774  Vali Loss: 0.0191712 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943543  Vali macro F1 0.9928172 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 34 cost time: 1.3845629692077637
VALI: Epoch: 34, Steps: 13 | Train Loss: 0.0127402  Vali Loss: 0.0199713 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943543  Vali macro F1 0.9928172 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 35 cost time: 1.3850808143615723
VALI: Epoch: 35, Steps: 13 | Train Loss: 0.0169114  Vali Loss: 0.0107698 Vali Accuracy: 1.0000000  Vali weighted F1: 1.0000000  Vali macro F1 1.0000000 
new best score!!!!
Validation loss decreased (0.015753 --> 0.010770).  Saving model ...
new best score!!!!
Epoch: 36 cost time: 1.3859410285949707
VALI: Epoch: 36, Steps: 13 | Train Loss: 0.0149323  Vali Loss: 0.0275745 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943563  Vali macro F1 0.9928202 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 37 cost time: 1.3833866119384766
VALI: Epoch: 37, Steps: 13 | Train Loss: 0.0215022  Vali Loss: 0.0142353 Vali Accuracy: 0.9971751  Vali weighted F1: 0.9971738  Vali macro F1 0.9978455 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 38 cost time: 1.3844022750854492
VALI: Epoch: 38, Steps: 13 | Train Loss: 0.0188742  Vali Loss: 0.0323308 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887006  Vali macro F1 0.9855934 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 39 cost time: 1.3852672576904297
VALI: Epoch: 39, Steps: 13 | Train Loss: 0.0126102  Vali Loss: 0.0293063 Vali Accuracy: 0.9858757  Vali weighted F1: 0.9858916  Vali macro F1 0.9806851 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 40 cost time: 1.3852338790893555
VALI: Epoch: 40, Steps: 13 | Train Loss: 0.0099635  Vali Loss: 0.0296753 Vali Accuracy: 0.9887006  Vali weighted F1: 0.9887229  Vali macro F1 0.9874059 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Epoch: 41 cost time: 1.3835618495941162
VALI: Epoch: 41, Steps: 13 | Train Loss: 0.0107339  Vali Loss: 0.0165745 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943543  Vali macro F1 0.9928172 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 42 cost time: 1.3860607147216797
VALI: Epoch: 42, Steps: 13 | Train Loss: 0.0070230  Vali Loss: 0.0149573 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915308  Vali macro F1 0.9906662 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 43 cost time: 1.3828771114349365
VALI: Epoch: 43, Steps: 13 | Train Loss: 0.0064488  Vali Loss: 0.0151301 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915308  Vali macro F1 0.9906662 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 44 cost time: 1.3864479064941406
VALI: Epoch: 44, Steps: 13 | Train Loss: 0.0058535  Vali Loss: 0.0160401 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915308  Vali macro F1 0.9906662 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 45 cost time: 1.3858606815338135
VALI: Epoch: 45, Steps: 13 | Train Loss: 0.0059012  Vali Loss: 0.0156713 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915308  Vali macro F1 0.9906662 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Epoch: 46 cost time: 1.3845837116241455
VALI: Epoch: 46, Steps: 13 | Train Loss: 0.0061090  Vali Loss: 0.0156309 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915308  Vali macro F1 0.9906662 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Epoch: 47 cost time: 1.385124683380127
VALI: Epoch: 47, Steps: 13 | Train Loss: 0.0059634  Vali Loss: 0.0155883 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915308  Vali macro F1 0.9906662 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Epoch: 48 cost time: 1.3851361274719238
VALI: Epoch: 48, Steps: 13 | Train Loss: 0.0057704  Vali Loss: 0.0154813 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915308  Vali macro F1 0.9906662 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Epoch: 49 cost time: 1.3904261589050293
VALI: Epoch: 49, Steps: 13 | Train Loss: 0.0062231  Vali Loss: 0.0154176 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915308  Vali macro F1 0.9906662 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Epoch: 50 cost time: 1.3849256038665771
VALI: Epoch: 50, Steps: 13 | Train Loss: 0.0052666  Vali Loss: 0.0153708 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915308  Vali macro F1 0.9906662 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best validation model!
Final Test Performance : Test Accuracy: 0.9830891  Test weighted F1: 0.9830646  Test macro F1 0.9760128 
clone the  wavefiler weight
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
Wavelet Filtering Regularization
Build the DeepConvLSTM model!
------------Fine Tuning  :  1   will be pruned   -----------------------------------------
old model Parameter : 1125747
pruned model Parameter : 1128786
----------------------------------------------------------------------------------------
Fine Tuning Epoch: 1 cost time: 1.5868792533874512
Fine Tuning VALI: Epoch: 1, Steps: 13 | Train Loss: 0.0126483  Vali Loss: 0.0195398 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943543  Vali macro F1 0.9928172 
Validation loss decreased (inf --> 0.019540).  Saving model ...
Fine Tuning Epoch: 2 cost time: 1.5821738243103027
Fine Tuning VALI: Epoch: 2, Steps: 13 | Train Loss: 0.0100945  Vali Loss: 0.0215680 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915308  Vali macro F1 0.9906662 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 3 cost time: 1.584280014038086
Fine Tuning VALI: Epoch: 3, Steps: 13 | Train Loss: 0.0092579  Vali Loss: 0.0131721 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943543  Vali macro F1 0.9928172 
new best score!!!!
Validation loss decreased (0.019540 --> 0.013172).  Saving model ...
new best score!!!!
Fine Tuning Epoch: 4 cost time: 1.5834269523620605
Fine Tuning VALI: Epoch: 4, Steps: 13 | Train Loss: 0.0074968  Vali Loss: 0.0170945 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943543  Vali macro F1 0.9928172 
EarlyStopping counter: 1 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 5 cost time: 1.5839905738830566
Fine Tuning VALI: Epoch: 5, Steps: 13 | Train Loss: 0.0080848  Vali Loss: 0.0189173 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943543  Vali macro F1 0.9928172 
EarlyStopping counter: 2 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 6 cost time: 1.5876553058624268
Fine Tuning VALI: Epoch: 6, Steps: 13 | Train Loss: 0.0100255  Vali Loss: 0.0251565 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915308  Vali macro F1 0.9906662 
EarlyStopping counter: 3 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 7 cost time: 1.5871577262878418
Fine Tuning VALI: Epoch: 7, Steps: 13 | Train Loss: 0.0069435  Vali Loss: 0.0218428 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915308  Vali macro F1 0.9906662 
EarlyStopping counter: 4 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 8 cost time: 1.585012435913086
Fine Tuning VALI: Epoch: 8, Steps: 13 | Train Loss: 0.0092290  Vali Loss: 0.0152111 Vali Accuracy: 0.9943503  Vali weighted F1: 0.9943543  Vali macro F1 0.9928172 
EarlyStopping counter: 5 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 0.0001
Fine Tuning Epoch: 9 cost time: 1.5820014476776123
Fine Tuning VALI: Epoch: 9, Steps: 13 | Train Loss: 0.0074190  Vali Loss: 0.0187154 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915308  Vali macro F1 0.9906662 
EarlyStopping counter: 6 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 10 cost time: 1.5843007564544678
Fine Tuning VALI: Epoch: 10, Steps: 13 | Train Loss: 0.0063252  Vali Loss: 0.0214310 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915308  Vali macro F1 0.9906662 
EarlyStopping counter: 7 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 11 cost time: 1.5871829986572266
Fine Tuning VALI: Epoch: 11, Steps: 13 | Train Loss: 0.0062780  Vali Loss: 0.0177835 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915308  Vali macro F1 0.9906662 
EarlyStopping counter: 8 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 12 cost time: 1.5868923664093018
Fine Tuning VALI: Epoch: 12, Steps: 13 | Train Loss: 0.0050897  Vali Loss: 0.0204143 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915308  Vali macro F1 0.9906662 
EarlyStopping counter: 9 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 13 cost time: 1.5823233127593994
Fine Tuning VALI: Epoch: 13, Steps: 13 | Train Loss: 0.0052813  Vali Loss: 0.0187789 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915308  Vali macro F1 0.9906662 
EarlyStopping counter: 10 out of 15
Learning rate adjusting counter: 5 out of 5
Updating learning rate to 1e-05
Fine Tuning Epoch: 14 cost time: 1.5868432521820068
Fine Tuning VALI: Epoch: 14, Steps: 13 | Train Loss: 0.0047699  Vali Loss: 0.0173189 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915308  Vali macro F1 0.9906662 
EarlyStopping counter: 11 out of 15
Learning rate adjusting counter: 1 out of 5
Fine Tuning Epoch: 15 cost time: 1.5850300788879395
Fine Tuning VALI: Epoch: 15, Steps: 13 | Train Loss: 0.0046352  Vali Loss: 0.0161073 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915308  Vali macro F1 0.9906662 
EarlyStopping counter: 12 out of 15
Learning rate adjusting counter: 2 out of 5
Fine Tuning Epoch: 16 cost time: 1.5847864151000977
Fine Tuning VALI: Epoch: 16, Steps: 13 | Train Loss: 0.0043169  Vali Loss: 0.0163195 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915308  Vali macro F1 0.9906662 
EarlyStopping counter: 13 out of 15
Learning rate adjusting counter: 3 out of 5
Fine Tuning Epoch: 17 cost time: 1.5804474353790283
Fine Tuning VALI: Epoch: 17, Steps: 13 | Train Loss: 0.0052386  Vali Loss: 0.0159736 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915308  Vali macro F1 0.9906662 
EarlyStopping counter: 14 out of 15
Learning rate adjusting counter: 4 out of 5
Fine Tuning Epoch: 18 cost time: 1.58488130569458
Fine Tuning VALI: Epoch: 18, Steps: 13 | Train Loss: 0.0044769  Vali Loss: 0.0143098 Vali Accuracy: 0.9915254  Vali weighted F1: 0.9915308  Vali macro F1 0.9906662 
EarlyStopping counter: 15 out of 15
Early stopping
Loading the best finetuned validation model!
Fine Tuning Final Test Performance : Test Accuracy: 0.9875986  Test weighted F1: 0.9875834  Test macro F1 0.9835089 

============================= JOB FEEDBACK =============================

NodeName=uc2n565
Job ID: 20948453
Cluster: uc2
User/Group: px3192/tm
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 20
CPU Utilized: 00:52:27
CPU Efficiency: 4.77% of 18:19:40 core-walltime
Job Wall-clock time: 00:54:59
Memory Utilized: 4.83 GB
Memory Efficiency: 0.00% of 0.00 MB
